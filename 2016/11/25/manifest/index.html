<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>èŠä¸€èŠH5åº”ç”¨ç¼“å­˜-Manifest | louis blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="manifest offline cache applicationCache">
<meta name="keywords" content="Web">
<meta property="og:type" content="article">
<meta property="og:title" content="èŠä¸€èŠH5åº”ç”¨ç¼“å­˜-Manifest">
<meta property="og:url" content="http://louiszhai.github.io/2016/11/25/manifest/index.html">
<meta property="og:site_name" content="louis blog">
<meta property="og:description" content="manifest offline cache applicationCache">
<meta property="og:image" content="http://ww2.sinaimg.cn/large/006y8lVagw1fa479nwxhmj30pm08hdgj.jpg">
<meta property="og:updated_time" content="2018-03-27T11:13:22.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="èŠä¸€èŠH5åº”ç”¨ç¼“å­˜-Manifest">
<meta name="twitter:description" content="manifest offline cache applicationCache">
<meta name="twitter:image" content="http://ww2.sinaimg.cn/large/006y8lVagw1fa479nwxhmj30pm08hdgj.jpg">
  
    <link rel="alternative" href="/atom.xml" title="louis blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
<div id="container">
    <div class="left-col">
        <div class="overlay">
	<!--<input type="text" class="st-default-search-input" style="position:absolute;top: 50px;left: 35px;">-->
</div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars2.githubusercontent.com/u/8412301?v=3&amp;s=320" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">è·¯æ˜“æ–¯</a></h1>
		</hgroup>

		
		<p class="header-subtitle">åšæŒåŸè‘—, æ·±åº¦æ€è€ƒ, åŠ›æ±‚ç®€å•é€šä¿—å™äº‹</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Links</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">ä¸»é¡µ</a></li>
				        
							<li><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/Louiszhai" title="github">github</a>
					        
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/CSS/" style="font-size: 16.67px;">CSS</a> <a href="/tags/JavaScript/" style="font-size: 20px;">JavaScript</a> <a href="/tags/JavaScript-Canvas/" style="font-size: 10px;">JavaScript Canvas</a> <a href="/tags/JavaScript-Chrome-Extension/" style="font-size: 10px;">JavaScript Chrome-Extension</a> <a href="/tags/Tool/" style="font-size: 10px;">Tool</a> <a href="/tags/Web/" style="font-size: 16.67px;">Web</a> <a href="/tags/XSS/" style="font-size: 10px;">XSS</a> <a href="/tags/css/" style="font-size: 13.33px;">css</a> <a href="/tags/javascript/" style="font-size: 10px;">javascript</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.ruanyifeng.com/blog/">é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.zhangxinxu.com/wordpress/category/js/">å¼ é‘«æ—­-é‘«ç©ºé—´-é‘«ç”Ÿæ´»</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://evanyou.me/">å°¤é›¨æºªä¸»é¡µ</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
        <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">è·¯æ˜“æ–¯</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="https://avatars2.githubusercontent.com/u/8412301?v=3&amp;s=320" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">è·¯æ˜“æ–¯</h1>
			</hgroup>
			
			<p class="header-subtitle">åšæŒåŸè‘—, æ·±åº¦æ€è€ƒ, åŠ›æ±‚ç®€å•é€šä¿—å™äº‹</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">ä¸»é¡µ</a></li>
		        
					<li><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Louiszhai" title="github">github</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

        <div class="body-wrap"><article id="post-manifest" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/11/25/manifest/" class="article-date">
  	<time datetime="2016-11-25T00:08:21.000Z" itemprop="datePublished">2016-11-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      èŠä¸€èŠH5åº”ç”¨ç¼“å­˜-Manifest
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web/">Web</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          <span class="toc-arrow"></span>
<div id="toc" class="toc-article">
    <div class="toc-title">ç›®å½•</div>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#å¯¼è¯»"><span class="toc-text">å¯¼è¯»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æè¿°"><span class="toc-text">æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ”¯æŒæ€§"><span class="toc-text">æ”¯æŒæ€§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¦‚ä½•å¼€å¯åº”ç”¨ç¼“å­˜"><span class="toc-text">å¦‚ä½•å¼€å¯åº”ç”¨ç¼“å­˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#manifestç¼“å­˜æ¸…å•"><span class="toc-text">manifestç¼“å­˜æ¸…å•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#manifestç¼“å­˜çŠ¶æ€"><span class="toc-text">manifestç¼“å­˜çŠ¶æ€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#applicationCache"><span class="toc-text">applicationCache</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#manifestç¼“å­˜ç‹¬ç«‹æ€§"><span class="toc-text">manifestç¼“å­˜ç‹¬ç«‹æ€§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#manifestç¼“å­˜è§„åˆ™"><span class="toc-text">manifestç¼“å­˜è§„åˆ™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#webviewçš„ç¼“å­˜ç°è±¡"><span class="toc-text">webviewçš„ç¼“å­˜ç°è±¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æœ€ä½³å®è·µ"><span class="toc-text">æœ€ä½³å®è·µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å…·ä½“è½åœ°æ­¥éª¤"><span class="toc-text">å…·ä½“è½åœ°æ­¥éª¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¦‚ä½•æ›´æ–°ç¼“å­˜"><span class="toc-text">å¦‚ä½•æ›´æ–°ç¼“å­˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å…¶ä»–"><span class="toc-text">å…¶ä»–</span></a></li></ol>
</div>
      
        <h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>Manifest æ˜¯ H5æä¾›çš„ä¸€ç§åº”ç”¨ç¼“å­˜æœºåˆ¶, åŸºäºå®ƒwebåº”ç”¨å¯ä»¥å®ç°ç¦»çº¿è®¿é—®(offline cache). ä¸ºæ­¤, æµè§ˆå™¨è¿˜æä¾›äº†åº”ç”¨ç¼“å­˜çš„apiâ€“applicationCache. è™½ç„¶manifestçš„æŠ€æœ¯å·²è¢«webæ ‡å‡†åºŸå¼ƒ, ä½†è¿™ä¸å½±å“æˆ‘ä»¬å°è¯•å»äº†è§£å®ƒ. ä¹Ÿæ­£æ˜¯å› ä¸ºmanifestçš„åº”ç”¨ç¼“å­˜æœºåˆ¶å¦‚æ­¤è¯±äºº, é¥¿äº†ä¹ˆ å’Œ office 365é‚®ç®±ç­‰éƒ½è¿˜åœ¨ä½¿ç”¨ç€å®ƒ!</p>
<a id="more"></a>
<h3 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h3><p>å¯¹manifestç†Ÿæ‚‰çš„åŒå­¦å¯ä»¥è·³è¿‡æ­¤èŠ‚.</p>
<p>é‰´äºmanifeståº”ç”¨ç¼“å­˜çš„æŠ€æœ¯, æˆ‘ä»¬å¯ä»¥åšåˆ°:</p>
<ul>
<li>ç¦»çº¿è®¿é—®: å³ä½¿æœåŠ¡å™¨æŒ‚äº†, æˆ–è€…æ²¡æœ‰ç½‘ç»œ, ç”¨æˆ·ä¾ç„¶å¯ä»¥æ­£å¸¸æµè§ˆç½‘é¡µå†…å®¹.</li>
<li>è®¿é—®æ›´å¿«: æ•°æ®å­˜åœ¨äºæœ¬åœ°, çœå»äº†æµè§ˆå™¨å‘èµ·httpè¯·æ±‚çš„æ—¶é—´, å› æ­¤è®¿é—®æ›´å¿«, ç§»åŠ¨ç«¯æ•ˆæœæ›´ä¸ºæ˜æ˜¾.</li>
<li>é™ä½è´Ÿè½½: æµè§ˆå™¨åªåœ¨manifestæ–‡ä»¶æ”¹åŠ¨æ—¶æ‰å»æœåŠ¡å™¨ä¸‹è½½éœ€è¦ç¼“å­˜çš„èµ„æº, å¤§å¤§é™ä½äº†æœåŠ¡å™¨è´Ÿè½½.</li>
</ul>
<p>manifestç¼“å­˜çš„è¿‡ç¨‹å¦‚ä¸‹(æ¥è‡ªç½‘ç»œ):</p>
<p><img src="http://ww2.sinaimg.cn/large/006y8lVagw1fa479nwxhmj30pm08hdgj.jpg" alt="manifest"></p>
<h3 id="æ”¯æŒæ€§"><a href="#æ”¯æŒæ€§" class="headerlink" title="æ”¯æŒæ€§"></a>æ”¯æŒæ€§</h3><p>ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒmanifeståº”ç”¨ç¼“å­˜æŠ€æœ¯. å¦‚ä¸‹è¡¨æ ¼:</p>
<table>
<thead>
<tr>
<th style="text-align:center">IE</th>
<th style="text-align:center">Edge</th>
<th style="text-align:center">Firefox</th>
<th style="text-align:center">Chrome</th>
<th style="text-align:center">Safari</th>
<th style="text-align:center">Opera</th>
<th style="text-align:center">ios</th>
<th style="text-align:center">Android</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">10+</td>
<td style="text-align:center">12+</td>
<td style="text-align:center">3.5+</td>
<td style="text-align:center">4+</td>
<td style="text-align:center">4+</td>
<td style="text-align:center">11.5+</td>
<td style="text-align:center">7.1+</td>
<td style="text-align:center">2.3+</td>
</tr>
</tbody>
</table>
<p>H5æ ‡å‡†ä¸­, <a href="https://html.spec.whatwg.org/#offline" target="_blank" rel="external">Offline Web applications</a> éƒ¨åˆ†æœ‰å¦‚ä¸‹æè¿°:</p>
<blockquote>
<p>This feature is in the process of being removed from the Web platform. (This is a long process that takes many years.) Using any of the offline Web application features at this time is highly discouraged. Use service workers instead. <a href="https://html.spec.whatwg.org/#refsSW" target="_blank" rel="external">[SW]</a></p>
</blockquote>
<p>å› æ­¤åç»­æˆ‘å°†åœ¨å…¶ä»–æ–‡ç« ä¸­ç»§ç»­ä»‹ç» service workers, æœ¬ç¯‡ç»§ç»­å…³æ³¨manifest.</p>
<h3 id="å¦‚ä½•å¼€å¯åº”ç”¨ç¼“å­˜"><a href="#å¦‚ä½•å¼€å¯åº”ç”¨ç¼“å­˜" class="headerlink" title="å¦‚ä½•å¼€å¯åº”ç”¨ç¼“å­˜"></a>å¦‚ä½•å¼€å¯åº”ç”¨ç¼“å­˜</h3><p>manifestä½¿ç”¨ç¼“å­˜æ¸…å•è¿›è¡Œç®¡ç†, ç¼“å­˜æ¸…å•éœ€è¦ä¸htmlæ ‡ç­¾è¿›è¡Œå…³è”. å¦‚ä¸‹:</p>
<pre><code class="html">&lt;html manifest=&quot;test.appcache&quot;&gt;
  ...
&lt;/html&gt;
</code></pre>
<p>åœ¨htmlæ ‡ç­¾ä¸­æŒ‡å®šmanifestæ–‡ä»¶, ä¾¿è¡¨ç¤ºè¯¥ç½‘é¡µä½¿ç”¨manifestè¿›è¡Œç¦»çº¿ç¼“å­˜. è¯¥ç½‘é¡µå†…éœ€è¦ç¼“å­˜çš„æ–‡ä»¶åˆ—è¡¨éœ€è¦åœ¨ test.appcache æ–‡æœ¬æ–‡ä»¶ä¸­æŒ‡å®š.</p>
<h3 id="manifestç¼“å­˜æ¸…å•"><a href="#manifestç¼“å­˜æ¸…å•" class="headerlink" title="manifestç¼“å­˜æ¸…å•"></a>manifestç¼“å­˜æ¸…å•</h3><p>å°±åƒå†™ä½œæ–‡ä¸€æ ·, manifesté‡‡ç”¨ç»å…¸çš„ä¸‰æ®µå¼. åˆ†åˆ«ä¸º: <code>CACHE</code>, <code>NETWORK</code> å’Œ <code>FALLBACK</code>. å¦‚ä¸‹, å…ˆçœ‹ä¸€ä¸ªæ —å­ğŸŒ°:</p>
<pre><code>CACHE MANIFEST
# v1.0.0
content.css

NETWORK:
app.js

FALLBACK:
/other 404.html
</code></pre><p>å…¶ä¸­ç¬¬ä¸€è¡Œå¿…é¡»ä»¥ <code>CACHE MANIFEST</code> å¼€å¤´, åå¯è·Ÿè‹¥å¹²å­—ç¬¦æ³¨é‡Š, æ³¨é‡Šä»#å·å¼€å§‹. è·Ÿåœ¨  <code>CACHE MANIFEST</code>  è¡Œåçš„æ–‡ä»¶, æ¯è¡Œåˆ—å‡ºä¸€ä¸ª, è¿™äº›æ–‡ä»¶æ˜¯éœ€è¦ç¼“å­˜çš„æ–‡ä»¶. å› æ­¤ content.css ä¼šè¢«ç¼“å­˜, ä¸éœ€è¦è®¿é—®ç½‘ç»œ.</p>
<p>ç¬¬äºŒæ®µå†…å®¹ä»¥ <code>NETWORK:</code> å¼€å§‹, è·Ÿåœ¨è¯¥è¡Œåçš„æ–‡ä»¶è¡¨ç¤ºéœ€è¦è®¿é—®ç½‘ç»œ. å¦‚: app.js å°†ç›´æ¥ä»ç½‘ç»œä¸Šä¸‹è½½, å¹¶ä¸èµ°manifest cache, å¦‚æœé™¤äº†ç¬¬ä¸€æ®µä¸­ç¼“å­˜çš„æ–‡ä»¶ä»¥å¤–, å…¶ä»–æ–‡ä»¶éƒ½ä»ç½‘ç»œä¸Šè·å–, é‚£ä¹ˆæ­¤æ—¶å¯å°† app.js æ”¹ä¸º * (é€šé…ç¬¦).</p>
<p>ç¬¬ä¸‰æ®µå†…å®¹ä»¥ <code>FALLBACK:</code> å¼€å§‹, è·Ÿåœ¨è¯¥è¡Œåçš„æ–‡ä»¶è¡¨ç¤ºä¼šæœ‰ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆ. å¦‚: å½“è®¿é—® /other è·¯å¾„æ—¶, å¦‚æœè®¿é—®å¤±è´¥, é‚£ä¹ˆå°†è‡ªåŠ¨åŠ è½½ 404.html ä½œä¸ºæ›¿ä»£.</p>
<h3 id="manifestç¼“å­˜çŠ¶æ€"><a href="#manifestç¼“å­˜çŠ¶æ€" class="headerlink" title="manifestç¼“å­˜çŠ¶æ€"></a>manifestç¼“å­˜çŠ¶æ€</h3><p>æ¯ä¸ªmanifestç¼“å­˜éƒ½æœ‰ä¸€ä¸ªçŠ¶æ€, æ ‡ç¤ºç€ç¼“å­˜çš„æƒ…å†µ. ä¸€ä»½ç¼“å­˜æ¸…å•åªæœ‰ä¸€ä¸ªç¼“å­˜çŠ¶æ€, å³ä½¿å®ƒè¢«å¤šä¸ªé¡µé¢å¼•ç”¨. ä»¥ä¸‹æ˜¯å„ä¸ªç¼“å­˜çŠ¶æ€:</p>
<ul>
<li><em>UNCACHED</em>(æœªç¼“å­˜): è¡¨æ˜åº”ç”¨ç¼“å­˜å¯¹è±¡è¿˜æ²¡æœ‰åˆå§‹åŒ–å®Œæˆ.</li>
<li><em>IDLE</em>(ç©ºé—²): åº”ç”¨ç¼“å­˜å¹¶æœªå¤„äºæ›´æ–°çŠ¶æ€.</li>
<li><em>CHECKING</em>(æ£€æŸ¥): æ­£åœ¨æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ›´æ–°.</li>
<li><em>DOWNLOADING</em>(ä¸‹è½½): æ¸…å•æ›´æ–°å, é‡æ–°ä¸‹è½½å…¨éƒ¨èµ„æºåˆ°ä¸´æ—¶ç¼“å­˜ä¸­.</li>
<li><em>UPDATEREADY</em>(æ›´æ–°å°±ç»ª): æ–°ç‰ˆæœ¬çš„ç¼“å­˜ä¸‹è½½å®Œæˆ, å…¨éƒ¨å°±ç»ª, éšå³è§¦å‘äº‹ä»¶ updateready.</li>
<li><em>OBSOLETE</em>(åºŸå¼ƒ): åº”ç”¨ç¼“å­˜å·²è¢«åºŸå¼ƒ.</li>
</ul>
<p>ä¸Šè¿°ç¼“å­˜çŠ¶æ€å¸¸é‡ä¾æ¬¡å–å€¼0, 1, 2, 3, 4, 5.</p>
<h3 id="applicationCache"><a href="#applicationCache" class="headerlink" title="applicationCache"></a>applicationCache</h3><p>applicationCacheæ˜¯æ“ä½œåº”ç”¨ç¼“å­˜çš„ç‘å£«å†›åˆ€, ä¹Ÿæ˜¯å”¯ä¸€çš„ä¸€æŠŠåˆ€.</p>
<p>é¦–å…ˆæˆ‘ä»¬æ¥è·å–è¯¥å¯¹è±¡.</p>
<pre><code class="js">//webviewä¸‹
var cache = window.applicationCache;
//shared workerä¸­
var cache = self.applicationCache;
</code></pre>
<p>ä»¥ä¸‹æ˜¯å…¶å±æ€§å’Œæ–¹æ³•ä»‹ç»(å¤§ç¥è¯·ç»•è¿‡):</p>
<ul>
<li><p>status: è¿”å›å½“å‰é¡µé¢çš„åº”ç”¨ç¼“å­˜çš„çŠ¶æ€, é€šå¸¸å¼€å¯åº”ç”¨ç¼“å­˜çš„é¡µé¢å¯èƒ½è¿”å›1, å…¶ä»–é¡µé¢åˆ™è¿”å›0.</p>
</li>
<li><p>update(): æ‰‹åŠ¨è§¦å‘åº”ç”¨ç¼“å­˜çš„æ›´æ–°. </p>
<p>(1) è‹¥æœ‰æ›´æ–°, åˆ™ä¾æ¬¡è§¦å‘â‘ æ£€æŸ¥äº‹ä»¶(Checking event), â‘¡ä¸‹è½½äº‹ä»¶(Downloading event), â‘¢ä¸‹è½½è¿›åº¦äº‹ä»¶(Progress event), â‘£æ›´æ–°å®Œæˆäº‹ä»¶(UpdateReady event);</p>
<p>(2) è‹¥æ— æ›´æ–°, åˆ™ä¾æ¬¡è§¦å‘â‘ æ£€æŸ¥äº‹ä»¶(Checking event), â‘¡æ— æ›´æ–°äº‹ä»¶(NoUpdate event);</p>
<p>(3) åœ¨æœªå¼€å¯åº”ç”¨ç¼“å­˜çš„é¡µé¢è°ƒç”¨å°†æŠ›å‡º<code>Uncaught DOMException</code> é”™è¯¯.</p>
<p>update() æ–¹æ³•é€šå¸¸åœ¨é•¿æ—¶é—´ä¸å…³é—­çš„é¡µé¢ä½¿ç”¨, æ¯”å¦‚è¯´é‚®ç®±åº”ç”¨, ç”¨äºå®šæœŸæ£€æµ‹å¯èƒ½çš„æ›´æ–°.</p>
</li>
<li><p>abort(): å–æ¶ˆåº”ç”¨ç¼“å­˜çš„æ›´æ–°. å¯ç”¨äºèŠ‚çœæœ‰é™çš„ç½‘ç»œå¸¦å®½.</p>
</li>
<li><p>swapCache(): å¦‚æœå­˜åœ¨ä¸€ä¸ªæ›´æ–°ç‰ˆæœ¬çš„åº”ç”¨ç¼“å­˜, é‚£ä¹ˆå®ƒå°†åˆ‡æ¢è¿‡å», å¦åˆ™å°†æŠ›å‡º <code>Uncaught DOMException</code> é”™è¯¯. é€šå¸¸, æˆ‘ä»¬ä¼šåœ¨updatereadyäº‹ä»¶è§¦å‘ä¹‹åæ‰‹åŠ¨è°ƒç”¨swapCache()æ–¹æ³•, swapCacheçš„åˆ‡æ¢åªå¯¹åç»­åŠ è½½çš„ç¼“å­˜æ–‡ä»¶æœ‰æ•ˆ, å·²ç»åŠ è½½æˆåŠŸçš„èµ„æºå¹¶ä¸ä¼šé‡æ–°åŠ è½½.</p>
</li>
</ul>
<p>é‚£ä¹ˆå¦‚ä½•åˆ©ç”¨å¥½ä¸Šè¿°apiæ›´æ–°ä¸€ä¸ªé¡µé¢çš„åº”ç”¨ç¼“å­˜å‘¢? åˆ«æ€¥, <a href="http://www.html5rocks.com/en/tutorials/appcache/beginner/" target="_blank" rel="external">Beginnerâ€™s Guide to Using the Application Cache</a> ä¸€æ–‡ä¸­æä¾›äº†å¦‚ä¸‹çš„æ ·æ¿æ–¹æ³•:</p>
<pre><code class="js">// Check if a new cache is available on page load.
window.addEventListener(&#39;load&#39;, function(e) {
  window.applicationCache.addEventListener(&#39;updateready&#39;, function(e) {
    if (window.applicationCache.status == window.applicationCache.UPDATEREADY) {
      // Browser downloaded a new app cache.
      // Swap it in and reload the page to get the new hotness.
      window.applicationCache.swapCache();
      if (confirm(&#39;A new version of this site is available. Load it?&#39;)) {
        window.location.reload();
      }
    } else {
      // Manifest didn&#39;t changed. Nothing new to server.
    }
  }, false);
}, false);
</code></pre>
<h3 id="manifestç¼“å­˜ç‹¬ç«‹æ€§"><a href="#manifestç¼“å­˜ç‹¬ç«‹æ€§" class="headerlink" title="manifestç¼“å­˜ç‹¬ç«‹æ€§"></a>manifestç¼“å­˜ç‹¬ç«‹æ€§</h3><ol>
<li>manifestçš„ç¼“å­˜å’Œæµè§ˆå™¨é»˜è®¤çš„ç¼“å­˜æ˜¯ä¸¤å¥—æœºåˆ¶, ç›¸äº’ç‹¬ç«‹, å¹¶ä¸”ä¸å—æµè§ˆå™¨ç¼“å­˜å¤§å°é™åˆ¶(Chromeä¸‹æµ‹è¯•ç»“æœ).</li>
<li>å„ä¸ªmanifestæ–‡ä»¶çš„ç¼“å­˜ç›¸äº’ç‹¬ç«‹, å„è‡ªåœ¨ç‹¬ç«‹çš„åŒºåŸŸè¿›è¡Œç¼“å­˜. å³ä½¿æ˜¯ç¼“å­˜åŒä¸€ä¸ªæ–‡ä»¶, ä¹Ÿå¯èƒ½ç”±äºç¼“å­˜çš„ç‰ˆæœ¬ä¸ä¸€è‡´, è€Œé€ æˆå„ä¸ªé¡µé¢èµ„æºä¸ä¸€è‡´.</li>
</ol>
<h3 id="manifestç¼“å­˜è§„åˆ™"><a href="#manifestç¼“å­˜è§„åˆ™" class="headerlink" title="manifestç¼“å­˜è§„åˆ™"></a>manifestç¼“å­˜è§„åˆ™</h3><ol>
<li>éµå¾ªå…¨é‡ç¼“å­˜çš„è§„å¾‹. å³: manifestæ–‡ä»¶æ”¹åŠ¨å, å°†é‡æ–°ç¼“å­˜ä¸€éæ‰€æœ‰çš„æ–‡ä»¶(åŒ…æ‹¬htmlæœ¬èº«å’ŒåŠ¨æ€æ·»åŠ çš„éœ€è¦ç¼“å­˜çš„æ–‡ä»¶,å³ä½¿ç¼“å­˜åˆ—è¡¨ä¸­æ²¡æœ‰è¯¥html). ç¬¬ä¸€æ¬¡ç¼“å­˜è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°ç¼“å­˜å¤±è´¥çš„æ–‡ä»¶, é‚£ä¹ˆ, ç¬¬äºŒè®¿é—®, åˆå°†é‡æ–°ç¼“å­˜ä¸€éæ‰€æœ‰çš„æ–‡ä»¶. ä»¥æ­¤ç±»æ¨.</li>
<li>manifestæ–‡ä»¶æœ¬èº«ä¸èƒ½å†™è¿›ç¼“å­˜æ¸…å•, å¦åˆ™è¿åŒhtmlå’Œèµ„æºåœ¨å…¶ç¼“å­˜å¤±æ•ˆä¹‹å‰, å°†æ°¸è¿œä¸èƒ½è·å¾—æ›´æ–°.</li>
<li>å³ä½¿manifestæ–‡ä»¶ä¸¢å¤±, åŸç¼“å­˜ä¾ç„¶æœ‰æ•ˆ. å¦‚æœä¸åˆ é™¤htmlèŠ‚ç‚¹çš„manifestå±æ€§, å¼•å…¥è¯¥manifestçš„html, å°†æ°¸è¿œä¸èƒ½è·å¾—æ›´æ–°. å› æ­¤æ­£ç¡®çš„æ¸…é™¤ç¼“å­˜å§¿åŠ¿ä¸ºï¼šåˆ é™¤manifestæ–‡ä»¶ï¼Œå¹¶ä¸”åˆ é™¤htmlèŠ‚ç‚¹çš„manifestå±æ€§ï¼Œä»è€Œå½»åº•è§£é™¤ç»‘å®šï¼ˆæ­¤åé¡µé¢åœ¨ç¬¬äºŒæ¬¡åŠ è½½æ—¶å°±ä¼šè·å–æœ€æ–°å†…å®¹ï¼‰.</li>
</ol>
<h3 id="webviewçš„ç¼“å­˜ç°è±¡"><a href="#webviewçš„ç¼“å­˜ç°è±¡" class="headerlink" title="webviewçš„ç¼“å­˜ç°è±¡"></a>webviewçš„ç¼“å­˜ç°è±¡</h3><p>é€šå¸¸, webviewçš„ç¼“å­˜æœ‰å¦‚ä¸‹ä¸‰ç§ç°è±¡:</p>
<ol>
<li>æ™®é€šç½‘é¡µ(æ— manifestæ–‡ä»¶), ä¸å—manifestç¼“å­˜å½±å“, ç¼“å­˜åªèµ° http cache.</li>
<li>åŒ…å«manifestæ–‡ä»¶çš„ç½‘é¡µ, ç¼“å­˜æ–‡ä»¶åªå—manifestç¼“å­˜å½±å“(åªæœ‰manifestæ–‡ä»¶æ”¹å˜æ—¶æ‰ä¼šæ›´æ–°ç¼“å­˜èµ„æº), ç¼“å­˜èµ„æºå®Œå…¨ä¸ http cache æ— å…³, ä½†æ˜¯ <code>NETWORK</code> æ®µè½åéœ€è¦è®¿é—®ç½‘ç»œçš„æ–‡ä»¶, å°†ç»§ç»­èµ° http cache.</li>
<li>webviewç›´æ¥åŠ è½½manifestç¼“å­˜è¿‡çš„æ–‡ä»¶æ—¶, ä¼˜å…ˆåŠ è½½ç¬¬ä¸€ä¸ªmanifestç¼“å­˜çš„è¯¥æ–‡ä»¶, å¦‚æœæ²¡æœ‰æ‰¾åˆ°manifestç¼“å­˜, é‚£ä¹ˆå®ƒå°†è‡ªåŠ¨å¯»æ‰¾ http cache æˆ–è€… åœ¨çº¿åŠ è½½.</li>
</ol>
<h3 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h3><ol>
<li>é€šå¸¸åªä½¿ç”¨ä¸€ä¸ªmanifestæ–‡ä»¶, å¹¶ä¿è¯ç¼“å­˜çš„æ–‡ä»¶å°½å¯èƒ½çš„å°‘, ä»¥å‡å°manifestæ¯æ¬¡æ›´æ–°æ¸…å•ä¸­æ–‡ä»¶æ‰€è€—è´¹çš„æ—¶é—´å’Œæµé‡.</li>
<li>å¦‚æœä¸€å®šè¦ä½¿ç”¨ä¸¤ä¸ªåŠä»¥ä¸Šmanifestæ–‡ä»¶, ç¼“å­˜æ–‡ä»¶è¯·å°½é‡ä¸è¦ç›¸åŒ.</li>
<li>å¦‚æœä»¥ä¸Šä¸¤æ¡éƒ½ä¸èƒ½ä¿è¯, é‚£ä¹ˆ, è¯·ä¿è¯å°½å¯èƒ½åœ¨manifestç¼“å­˜çš„çŠ¶æ€æ›´æ–°æ—¶, ä¸»åŠ¨å»åˆ·æ–°ç½‘é¡µ.(æ­¤æ—¶å¹¶ä¸èƒ½ä¿è¯ä¸åŒç½‘é¡µä¹‹é—´åŒä¸€ä¸ªç¼“å­˜æ–‡ä»¶ç‰ˆæœ¬ä¸€è‡´)</li>
</ol>
<h3 id="å…·ä½“è½åœ°æ­¥éª¤"><a href="#å…·ä½“è½åœ°æ­¥éª¤" class="headerlink" title="å…·ä½“è½åœ°æ­¥éª¤"></a>å…·ä½“è½åœ°æ­¥éª¤</h3><ol>
<li><p>å¦‚æœç¼“å­˜çš„æ–‡ä»¶éœ€è¦åŠ å‚æ•°è¿è¡Œ, å»ºè®®å°†å‚æ•°å†…å®¹åŠ åˆ°hashä¸­, å¦‚:cached-page.html#parameterName=value</p>
</li>
<li><p>manifest çš„å¼•å…¥å¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–è€…ç›¸å¯¹è·¯å¾„, å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç»å¯¹è·¯å¾„, é‚£ä¹ˆä½ çš„manifestæ–‡ä»¶å¿…é¡»å’Œä½ çš„ç«™ç‚¹å¤„äºåŒä¸€ä¸ªåŸŸåä¸‹.</p>
</li>
<li><p>manifestæ–‡ä»¶ä½ å¯ä»¥ä¿å­˜ä¸ºä»»æ„çš„æ‰©å±•å, ä½†æ˜¯å“åº”å¤´ä¸­ä»¥ä¸‹å­—æ®µé¡»å–ä»¥ä¸‹å®šå€¼, ä»¥ä¿è¯manifestæ–‡ä»¶æ­£ç¡®è¢«è§£æ, å¹¶ä¸”å®ƒæ²¡æœ‰httpç¼“å­˜.</p>
<pre><code class="http">Content-Type: text/cache-manifest
Cache-Control: max-age=0
Expires: [CURRENT TIME]
</code></pre>
</li>
</ol>
<h3 id="å¦‚ä½•æ›´æ–°ç¼“å­˜"><a href="#å¦‚ä½•æ›´æ–°ç¼“å­˜" class="headerlink" title="å¦‚ä½•æ›´æ–°ç¼“å­˜"></a>å¦‚ä½•æ›´æ–°ç¼“å­˜</h3><ol>
<li>æ›´æ–°manifestæ–‡ä»¶å, webviewå°†è‡ªåŠ¨æ›´æ–°ç¼“å­˜.</li>
<li>jsæ›´æ–°ç¼“å­˜(æ‰‹åŠ¨è§¦å‘manifestæ›´æ–°): window.applicationCache.update();</li>
</ol>
<h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><p>chromeæµè§ˆå™¨ä¸‹é€šè¿‡è®¿é—® <a href="chrome://appcache-internals/" target="_blank" rel="external">chrome://appcache-internals/</a> å¯ä»¥æŸ¥çœ‹ç¼“å­˜åœ¨æœ¬åœ°çš„èµ„æºæ–‡ä»¶.</p>
<p>å¦å¤–, é™¤äº†æœ¬æ–‡å‚è€ƒçš„ä¸€ç¯‡ MDN çš„æ–‡ç« ä»¥åŠ HTML5 Rocksçš„ <a href="http://www.html5rocks.com/en/tutorials/appcache/beginner/" target="_blank" rel="external">Beginnerâ€™s Guide to Using the Application Cache</a> ä¸€æ–‡, è¿˜æœ‰å¦‚ä¸‹ä¸‰ä¸ªé“¾æ¥å¯ä¾›æ‚¨æ¯”è¾ƒé˜…è¯», è°¢è°¢.</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/Cache_manifest_in_HTML5" target="_blank" rel="external">Cache manifest in HTML5</a> on Wikipedia</li>
<li><a href="http://www.w3.org/TR/offline-webapps/" target="_blank" rel="external">Offline Web Applications</a> W3C Working Group Note</li>
<li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html" target="_blank" rel="external">Offline Web applications</a> at WHATWG</li>
</ul>
<hr>
<p>æœ¬é—®å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/11/25/manifest/">http://louiszhai.github.io/2016/11/25/manifest/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/HTML/Using_the_application_cache" target="_blank" rel="external">Using the application cache | MDN</a></li>
</ul>

      
    </div>
    
  </div>
  
  
    <! -- æ·»åŠ æèµ å›¾æ ‡ -->
<div class ="post-donate">
    <div id="donate_board" class="donate_bar center">
        <a id="btn_donate" class="btn_donate" href="javascript:;" title="æ‰“èµ"></a>
        <span class="donate_txt">
           &uarr;<br>
       æ”¯æŒä¸€æ¯å’–å•¡å§ï¼
        </span>
      </div>  
  <div id="donate_guide" class="donate_bar center hidden" >
    <!-- æ”¯ä»˜å®æ‰“èµå›¾æ¡ˆ -->
    <img src="/img/alipay.gif" alt="æ”¯ä»˜å®æ‰“èµ"> 
    <!-- å¾®ä¿¡æ‰“èµå›¾æ¡ˆ -->
    <img src="/img/weixin.gif" alt="å¾®ä¿¡æ‰“èµ">  
    </div>
  <script type="text/javascript">
    document.getElementById('btn_donate').onclick = function(){
      $('#donate_board').addClass('hidden');
      $('#donate_guide').removeClass('hidden');
    }
  </script>
</div>
<! -- æ·»åŠ æèµ å›¾æ ‡ -->
  

  
    
<nav id="article-nav">
  
    <a href="/2016/12/23/sort/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          JSä¸­å¯èƒ½ç”¨å¾—åˆ°çš„å…¨éƒ¨çš„æ’åºç®—æ³•
        
      </div>
    </a>
  
  
    <a href="/2016/11/02/ajax/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">AjaxçŸ¥è¯†ä½“ç³»å¤§æ¢³ç†</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share_jia">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">Share to: &nbsp; </span>
		<a class="jiathis_button_facebook"></a> 
    <a class="jiathis_button_twitter"></a>
    <a class="jiathis_button_plus"></a> 
    <a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>










  <style>
/*
    Name:     Kimbie (light)
    Author:   Jan T. Sott
    License:  Creative Commons Attribution-ShareAlike 4.0 Unported License
    URL:      https://github.com/idleberg/Kimbie-highlight.js
*/

/* Kimbie Comment */
.hljs-comment,
.hljs-quote {
  color: #a57a4c;
}

/* Kimbie Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-meta {
  color: #dc3958;
}

/* Kimbie Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-deletion,
.hljs-link {
  color: #f79a32;
}

/* Kimbie Yellow */
.hljs-title,
.hljs-section,
.hljs-attribute {
  color: #f06431;
}

/* Kimbie Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
  color: #889b4a;
}

/* Kimbie Purple */
.hljs-keyword,
.hljs-selector-tag,
.hljs-function {
  color: #98676a;
}

.hljs {
  display: block;
  overflow-x: auto;
  /*background: #fbebd4;*/
  color: #84613d;
  padding: 0.5em;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
</style>
  <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
  <script>
    // hljs.initHighlightingOnLoad();
    [].slice.call(document.querySelectorAll('pre code')).forEach(function(block, i) {
      hljs.highlightBlock(block);
      var lines = block.innerText.split('\n').length - 1;
      var ul = document.createElement('ul');
      ul.className = 'pre-numbering';
      block.className += ' has-numbering';
      block.parentNode.appendChild(ul);
      for(i=1;i<=lines;i++){
        var li = document.createElement('li');
        li.innerText = i;
        ul.appendChild(li);
      }
    });
  </script>
</div>
        <link rel="stylesheet" href="/css/content.css" type="text/css">
<footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <img src="/img/top_arrow.png" class="top_arrow" id="top_arrow">
    	<div class="footer-left">
    		&copy; 2018 è·¯æ˜“æ–¯

        <span style="position:relative;top:2px" id="cnzz_stat_icon_1256923583"></span>
        <script type="text/javascript">
          var s = document.createElement('script');
          var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
          s.src = cnzz_protocol + "s11.cnzz.com/z_stat.php?id=1256923583&show=pic";
          document.body.appendChild(s);
        </script>

    	</div>
      	<div class="footer-right">
      		<a href="https://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
<script type="text/javascript">
  //swifty
  /*(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
  
  _st('install','4AmBuvmx4Cy-3hvyxeh8','2.0.0');*/
</script>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/content.js"></script>







</div>
<script src="/js/screenfull.js"></script>
<a href="https://github.com/Louiszhai" style="position: fixed; top: 0; right: 0; border: 0;z-index:9999"><img
            source="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67"
            src="/img/fork_me_on_github.png" alt="Fork me on GitHub"
            data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>
</body>
</html>
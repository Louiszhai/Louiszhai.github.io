!function(e,t,n,i,o,s){function r(e,t,n){e&&"function"==typeof e.dispatchEvent||(n=t,t=e,e=null);var i=document.createEvent("Event");if(i.initEvent("ppt"+t,!0,!0),i.stopped=!1,i.stop=function(){i.preventDefault(),i.stopPropagation(),i.stopped=!0},n)for(var o in n)n.hasOwnProperty(o)&&(i[o]=n[o]);return e&&e.dispatchEvent&&e.dispatchEvent(i),i}function a(){Ce.current=de+1,U&&(U.style.width=(de+1)/(ee+1)*100+"%")}function c(e){return oe.slice.call(e)}function l(e,n){return n=n&&1===n.nodeType?n:t,n.querySelectorAll(e)}function u(e){return t.getElementById(e)}function d(e){if(y())return void Ce.curItem--;Ce.curItem=0,b(Z[de]),fe=de,--de<0&&(de=0),k("prev",!e)}function f(e){if(L())return void Ce.curItem++;Ce.curItem=0,b(Z[de]),fe=de,++de>ee&&(de=ee),k("next",!e),g(Z[de])(Z[de+1])}function p(){Le&&clearTimeout(Le),Le=setTimeout(h,800)}function v(e){if(!e)return e;e=e.split(".");for(var t=window,n=0,i=e.length;n<i;n++){var o=typeof t[e[n]];if("object"!==o&&"function"!==o)break;t=t[e[n]]}return"function"==typeof t?t:null}function h(){var e=Z[de];if(e&&(!e||1===e.nodeType)){var t=e.dataset,n=t.incallback||t.onEnter,i=v(n),o=r("Enter",{container:e});i&&"function"==typeof i&&W(n,o),["Keypress","Build"].forEach(function(n){var i=t["on"+n];(i=v(i))&&"function"==typeof i&&e.addEventListener("ppt"+n,i,!0)});var s=c(l("iframe[data-src]",e));s.length&&s.forEach(function(e){var t=e.dataset.src;t&&(e.src=t,delete e.dataset.src)})}}function b(e){!e||e&&1!==e.nodeType||(ye&&clearTimeout(ye),ye=setTimeout(function(){m(e)},1500))}function m(e){var t=e.dataset,n=t.outcallback||t.onLeave,i=v(n),o=r("Leave",{container:e});i&&"function"==typeof i&&W(n,o),["Keypress","Build"].forEach(function(n){var i=t["on"+n];(i=v(i))&&"function"==typeof i&&e.removeEventListener("ppt"+n,i,!0)})}function g(e){var t=arguments.callee;if(e&&1===e.nodeType)for(var n=l("preload",e),i=n.length;i--;){var o=n[i],s=o.dataset,r=s.type,a=s.url,c=te["load"+r.toUpperCase()];"function"==typeof c&&c(a,function(e){return function(){e.parentNode&&e.parentNode.removeChild(e),e=null}}(o))}return t}function L(e){if(ie.classList.contains("overview"))return!1;$curSlide=Z[de];var t=r($curSlide,"Build",{direction:"next",container:$curSlide});if(t.stopped)return t.stopped;var n,i=c(l(".building"),$curSlide);if(i.length)for(;n=i.shift();)n=n.classList,n.remove("building"),n.add("builded");var o=l(".tobuild",$curSlide);return!!o.length&&(n=o.item(0).classList,n.remove("tobuild"),n.contains("subSlide")&&c(l(".subSlide.builded",$curSlide)).forEach(function(e){e.classList.add("subBuilded")}),n.add("building"),!0)}function y(e){if(ie.classList.contains("overview"))return!1;$curSlide=Z[de];var t=r($curSlide,"Build",{direction:"prev",container:$curSlide});if(t.stopped)return t.stopped;var n,i,o=c(l(".building"),$curSlide),s=o.length;if(s)for(;n=o.shift();){var a=n.classList;if(a.remove("building"),a.add("tobuild"),i=n,a.contains("subSlide")){var u=c(l(".subSlide.builded.subBuilded",$curSlide)).pop();u&&u.classList.remove("subBuilded")}}var d=c(l(".builded",$curSlide));if(!d.length&&!s)return!1;var f=d.pop();return f&&(i||(i=f),n=f.classList,n.remove("builded"),0===s?(n.add("tobuild"),f=d.pop(),f.classList.remove("builded"),f.classList.add("building")):n.add("building")),!0}function x(){for(var e,t=ee,n=Ie.transition;e=Z[t--];){var i=c(l(".build > *,.fadeIn > *,.rollIn > *,.moveIn > *,.bounceIn > *,.zoomIn > *,.fade > *,.subSlide",e)),o=e.dataset;i.forEach(function(e,t){e.classList.add("tobuild"),"index"in e.dataset||(e.dataset.index=t)}),o.transition||(o.transition=n)}}function k(n){if(E(),a(),le&&(ue=!0,e.location.hash="#"+de),p(n),Ee(),t.body.classList.contains("overview"))return void S();t.body.classList.contains("popup")||t.body.classList.remove("with-notes")}function E(){var e=de,t="pagedown";if(fe!==de||($cur=Z[de],!$cur.classList.contains("pageup"))){fe>de&&(t="pageup");for(var i=0,o=Z.length;i<o;++i)switch(i){case e-2:T(Z[i],"far-past",t);break;case e-1:T(Z[i],"past",t);break;case e:T(Z[i],"current",t);break;case e+1:T(Z[i],"next",t);break;case e+2:T(Z[i],"far-next",t);break;default:T(Z[i])}n.fire("slide.update",de,0,t)}}function w(e){ie.classList.toggle("overview"),S(),e||n.fire("overview")}function S(){for(var e,n=t.body.classList.contains("overview"),i=0;e=Z[i];i++)e.style.transform=e.style.webkitTransform=e.style.msTransform=e.style.mozTransform=n?"translateZ(-2500px) translate("+105*(i-de)+"%, 0%)":"",e.style.animation=e.style.webkitAnimation=e.style.msAnimation=e.style.mozAnimation=n?"none":"",Ce.fire(n?"overviewshown":"overviewhidden")}function T(e,t,n){if(e){t&&e.classList.add(t),n&&-1===location.href.indexOf("_multiscreen=control")&&-1===location.href.indexOf("iscontroller=1")&&e.classList.add(n);["next","past","far-next","far-past","current","pagedown","pageup"].forEach(function(i){t!==i&&n!==i&&e.classList.remove(i)})}}function F(e){var i=e.keyCode,o=e.target;if(!/^(input|textarea)$/i.test(o.nodeName)&&!o.isContentEditable){e.isFromControl||n.fire("nodepptEvent:eventKeyup",e),n.fire("slide.keyup",e);var s=Z[de],a=r(s,"Keypress",{keyCode:i,orgiTarget:o,container:s});if(a.stopped)return a.stopped;switch(i){case 122:he.supportsFullScreen&&he.requestFullScreen(document.body);break;case 13:if(t.body.classList.contains("overview"))w(e.isFromControl);else{var c=parseInt(pe)-1;c>=0&&c<=ee&&A(c)}pe="";break;case 72:t.body.classList.toggle("highlight-code"),setTimeout(function(){t.body.classList.toggle("highlight-code")},2e3);break;case 87:e.shiftKey&&e.metaKey||ie.classList.contains("popup")||G.classList.toggle("layout-widescreen");break;case 79:w(e.isFromControl);break;case 78:ie.classList.contains("popup")||t.body.classList.toggle("with-notes");break;case 80:ie.classList.contains("popup")||K(e.isFromControl);break;case 66:if(Q.context){Q.context.strokeStyle="rgba(0,0,255,0.5)";break}case 89:if(Q.context){Q.context.strokeStyle="rgba(255,255,0,0.5)";break}case 82:if(Q.context){Q.context.strokeStyle="rgba(255,0,0,0.5)";break}case 71:if(Q.context){Q.context.strokeStyle="rgba(0,255,0,0.5)";break}case 77:if(Q.context){Q.context.strokeStyle="rgba(255,0,255,0.5)";break}case 49:pe+="1",Q.context&&(Q.context.lineWidth=3);break;case 50:pe+="2",Q.context&&(Q.context.lineWidth=7);break;case 51:pe+="3",Q.context&&(Q.context.lineWidth=11);break;case 52:pe+="4",Q.context&&(Q.context.lineWidth=15);break;case 48:pe+="0";break;case 53:pe+="5";break;case 54:pe+="6";break;case 55:pe+="7";break;case 56:pe+="8";break;case 57:pe+="9";break;case 67:ie.classList.contains("popup")||Ee(e.isFromControl);break;case 33:case 37:case 38:d();break;case 32:case 34:case 39:case 40:f()}}}function I(e){if(!xe&&1===e.touches.length){se=0,re=0;var t=e.touches[0];ae=t.pageX,ce=t.pageY,ie.addEventListener("touchmove",C,!0),ie.addEventListener("touchend",$,!0)}}function C(e){if(e.touches.length>1)X();else{var t=e.touches[0];se=t.pageX-ae,re=t.pageY-ce}try{e.preventDefault()}catch(e){console.log(e)}}function $(e){var t=Math.abs(se),n=Math.abs(re);if(t>15&&n<2*t/3&&se>0)return X(),D(38);D(39),X()}function D(e){var t=document.createEvent("Event");t.initEvent("keyup",!0,!0),t.keyCode=e,document.dispatchEvent(t)}function X(){ie.removeEventListener("touchmove",C,!0),ie.removeEventListener("touchend",$,!0)}function Y(){t.addEventListener("keyup",F,!1),ie.addEventListener("touchstart",I,!1),u("_btn-bar").addEventListener("click",function(){var e=!1;return function(){e?(this.classList.remove("fa-close"),this.classList.add("fa-bars"),u("_btn-box").style.display="none"):(this.classList.remove("fa-bars"),this.classList.add("fa-close"),u("_btn-box").style.display="inline-block"),e=!e}}(),!1),u("_btn-prev").addEventListener("click",function(){D(38)},!1),u("_btn-next").addEventListener("click",function(){D(39)},!1),u("_btn-overview").addEventListener("click",function(){var e=!1;return function(){e?(this.classList.add("fa-compress"),this.classList.remove("fa-expand")):(this.classList.add("fa-expand"),this.classList.remove("fa-compress")),w(),e=!e}}(),!1),u("_btn-brush").addEventListener("click",function(){var e=!1;return function(){e?(this.classList.add("fa-paint-brush"),this.classList.remove("fa-eraser"),Ee()):(K(),this.classList.add("fa-eraser"),this.classList.remove("fa-paint-brush")),e=!e}}(),!1),e.addEventListener("hashchange",function(){location.hash&&!ue&&(le=!1,b(Z[de]),fe=de,de=0|location.hash.substr(1),k(),le=!0),ue=!1},!0)}function B(){Q.context=Q.getContext("2d");var e=Q.context;e.lineWidth=3,e.lineJoin="round",e.strokeStyle="rgba(255,0,0,0.5)"}function K(e){Q&&(xe=!0,ie.classList.contains("with-notes")&&(ke=1,ie.classList.remove("with-notes"),ie.classList.remove("popup")),Q.width=ie.clientWidth,Q.height=ie.clientHeight,B(),Q.style.display="",G.style.overflow="hidden",Q.addEventListener("mousedown",we,!0),Q.addEventListener("mouseup",Te,!0),Q.addEventListener("mousemove",Fe,!0),Q.addEventListener("touchmove",Fe,!0),Q.addEventListener("touchend",Te,!0),Q.addEventListener("touchcancel",Te,!0),Q.addEventListener("touchstart",we,!0),t.addEventListener("selectstart",M,!0),e||n.fire("nodepptEvent:show paint"))}function M(){return!1}function O(){G.style.overflow="",Q.context&&Q.context.clearRect(0,0,H,R),Q.style.display="none"}function W(e,t){v(e)(t)}function _(){V=u(Ie.tipID),G=u(Ie.containerID),H=Ie.width,R=Ie.height,U=u(Ie.progressID),Ce.$slides=Z=c(l(Ie.slideClass,G)),ee=Z.length,Ce.count=ee,ee--,(Q=u(Ie.drawBoardID))&&(Q.style.display="none")}function z(){i(Ie.dir+"img.screenfull.js",function(){var e=c(l(Ie.slideClass+" img",G));screenfull(e)})}function P(){Ie.theme&&o("/css/theme."+Ie.theme+".css")}function q(){ve&&ve.print&&c(l("iframe[data-src]")).forEach(function(e){0===e.src.indexOf("about:blank")&&e.dataset.src&&(e.src=e.dataset.src)})}function J(e){e=e||{};for(var t in Ie)t in e&&(Ie[t]=e[t]);if(["theme","transition"].forEach(function(e){ve&&ve[e]&&(Ie[e]=ve[e])}),Ce.dir=Ie.dir,Ie.control){var n=Ie.control;i(Ie.dir+"nodeppt.control.js",function(){Ce.Control.load(n.type,n.args)})}_(),P(),x(),z(),Y(),fe=de,ve&&ve.print?q():(location.hash&&(de=0|location.hash.substr(1))?k():(E(),a(),p()),g(Z[de])(Z[de+1])),ie.style.opacity=1}function N(e){var t=l(".magic",e.container);if(t.length){t=t[0];var n=0|(t.dataset.index||0),i="pagedown";"prev"===e.direction&&(i="pageup");var o=c(l(".magicItem",t)),s=o.length;if(!e.firstKiss){if("prev"===e.direction){if(--n<0)return n=0,t.dataset.index=n,void(t.dataset.status="wait");e.stop()}else{if(++n===s)return n=s-1,t.dataset.index=n,void(t.dataset.status="done");e.stop()}t.dataset.index=n}if(e.firstKiss){o[n].addEventListener(ne,function(){t.style.visibility="visible"})}for(var r=0;r<s;++r)switch(r){case n-2:T(o[r],"far-past",i);break;case n-1:T(o[r],"past",i);break;case n:T(o[r],"current",i);break;case n+1:T(o[r],"next",i);break;case n+2:T(o[r],"far-next",i);break;default:T(o[r])}}}function j(){return de}function A(e){fe=e-1,fe=fe<0?0:fe,de=e,k()}var H,R,U,G,Z,Q,V,ee,te={loadJS:i,loadCSS:o},ne=function(){var e,t=document.createElement("fakeelement"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(void 0!==t.style[e])return n[e]}(),ie=t.body,oe=[],se=0,re=0,ae=0,ce=0,le=!0,ue=!1,de=0,fe=0,pe="",ve=function(e){e=e?decodeURIComponent(e):"";var t=e.split("?"),n=t[1]?t[1]:t[0],i=n.split("&"),o={};return i.forEach(function(e){e=e.split("="),e[0].length>0&&(o[e[0]]=e[1]||"")}),o}(location.search),he={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},be="webkit moz o ms".split(" ");if(void 0!==document.cancelFullScreen)he.supportsFullScreen=!0;else for(var me=0,ge=be.length;me<ge;me++)if(he.prefix=be[me],void 0!==document[he.prefix+"CancelFullScreen"]){he.supportsFullScreen=!0;break}he.supportsFullScreen&&(he.fullScreenEventName=he.prefix+"fullscreenchange",he.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},he.requestFullScreen=function(e){return""===this.prefix?e.requestFullScreen():e[this.prefix+"RequestFullScreen"]()},he.cancelFullScreen=function(e){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()});var Le,ye,xe=!1,ke=0,Ee=function(e){O(),pe="",ke&&(ie.classList.add("with-notes"),ie.classList.add("popup")),xe=!1,Q.removeEventListener("mousedown",we),Q.removeEventListener("mouseup",Te),Q.removeEventListener("mousemove",Fe),Q.removeEventListener("touchstart",we),Q.removeEventListener("touchmove",Fe),Q.removeEventListener("touchend",Te),Q.removeEventListener("touchcancel",Te),t.removeEventListener("selectstart",M,!0),e||n.fire("nodepptEvent:remove paint")},we=function(n){Q.isMouseDown=!0;try{n=n.targetTouches[0]}catch(e){}var i=Q.iLastX=n.layerX||n.offsetX||n.clientX-Q.offsetLeft+(e.pageXOffset||t.body.scrollLeft||t.documentElement.scrollLeft),o=Q.iLastY=n.layerY||n.offsetY||n.clientY-Q.offsetTop+(e.pageYOffset||t.body.scrollTop||t.documentElement.scrollTop);return Se.push({x:i,y:o}),!1},Se=[],Te=function(e){Q.isMouseDown=!1,Q.iLastX=-1,Q.iLastY=-1,e.isFromControl||n.fire("nodepptEvent:paint points",Se),Se.length=0};n.on("controlEvent:paint points",function(e){var t=e.points,n=e.screen,i=n.width/2,o=n.height/2,s=ie.offsetWidth,r=ie.offsetHeight,a=s/2,c=r/2,l=s/n.width,u=r/n.height,d=Q.context;if(d){d.beginPath();var f=a-(i-t[0].x)*l,p=c-(o-t[0].y)*u;d.moveTo(f,p);for(var v=0,h=t.length;v<h;v++)d.lineTo(a-(i-t[v].x)*l,c-(o-t[v].y)*u);d.stroke()}});var Fe=function(n){var i=n;if(Q.isMouseDown){try{n=n.targetTouches[0]}catch(e){console.log(e)}var o=n.layerX||n.offsetX||n.clientX-Q.offsetLeft+(e.pageXOffset||t.body.scrollLeft||t.documentElement.scrollLeft),s=n.layerY||n.offsetY||n.clientY-Q.offsetTop+(e.pageYOffset||t.body.scrollTop||t.documentElement.scrollTop),r=Q.context;r.beginPath(),r.moveTo(Q.iLastX,Q.iLastY),r.lineTo(o,s),r.stroke(),Q.iLastX=o,Q.iLastY=s,Se.push({x:o,y:s});try{i.preventDefault()}catch(e){console.log(e)}return!1}},Ie={containerID:"container",isControlDevice:!1,drawBoardID:"drawBoard",slideClass:".slide",buildClass:".build",progressID:"progress",transition:"",tipID:"tip",webSocketHost:"",width:900,dir:"./",height:700,control:!1};N.init=function(e){var t=l(".magic",e.container);if(t.length){t=t[0];var n=t.dataset.index||0;switch(t.dataset.status){case"done":t.dataset.index=n,n--;break;case"wait":break;default:e.firstKiss=!0,N(e)}}};var Ce={current:0,curItem:0,init:J,setIndex:function(e,t){function n(){t--<=0||(L(),setTimeout(n,300))}e--,e<0&&(e=0),A(e),t>0&&n()},next:f,prev:d,doSlide:k,proxyFn:W,showPaint:K,removePaint:Ee,buildNextItem:L,buildPrevItem:y,magic:N};["on","un","fire"].forEach(function(e){Ce[e]=function(){var t=c(arguments);t[0]="slide."+t[0],n[e].apply(null,t)}}),e.Slide=Ce,e.jumpSlide=A,e.getcurIndex=j;try{window.console&&window.console.log&&(console.log("blog, %c http://louiszhai.github.io/2016/06/13/regexp/","color:red"),console.log("Github: %c http://github.com/Louiszhai/","color:red"))}catch(e){}}(window,document,MixJS.event.broadcast,MixJS.loadJS,MixJS.loadCSS);
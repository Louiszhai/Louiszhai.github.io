<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>louis blog</title>
  <subtitle>ç¨‹åºçŒ¿ å‰ç«¯æ”»åŸå¸ˆ</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://louiszhai.github.io/"/>
  <updated>2017-03-12T13:32:15.000Z</updated>
  <id>http://louiszhai.github.io/</id>
  
  <author>
    <name>louis</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Promiseä½¿ç”¨æ‰‹å†Œ</title>
    <link href="http://louiszhai.github.io/2017/03/12/promise/"/>
    <id>http://louiszhai.github.io/2017/03/12/promise/</id>
    <published>2017-03-12T13:28:23.000Z</published>
    <updated>2017-03-12T13:32:15.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>Promiseé—®ä¸–å·²ä¹…, å…¶ç§‘æ™®ç±»æ–‡ç« äº¦ä¸è®¡å…¶æ•°. é‚æœ¬ç¯‡åˆè¡·ä¸ä¸ºç§‘æ™®, åªä¸ºèƒ½å¤Ÿæ¸©æ•…è€ŒçŸ¥æ–°.</p>
<p>æ¯”å¦‚è¯´, catchèƒ½æ•è·æ‰€æœ‰çš„é”™è¯¯å—? ä¸ºä»€ä¹ˆæœ‰äº›æ—¶å€™ä¼šæŠ›å‡ºâ€Uncaught (in promise) â€¦â€? <code>Promise.resolve</code> å’Œ <code>Promise.reject</code> å¤„ç†Promiseå¯¹è±¡æ—¶åˆæœ‰ä»€ä¹ˆä¸ä¸€æ ·çš„åœ°æ–¹?</p>
<p>å¼€å§‹å†™æœ¬ç¯‡æ–‡å­—æ—¶, æˆ‘ä¸€ç›´ä¸æ˜¯å¾ˆæ˜ç™½ä»»åŠ¡é˜Ÿåˆ—çš„æœºåˆ¶, æ•…æƒ³å†™ç¯‡æ–‡ç« å¼„æ‡‚å®ƒ. äºæ˜¯æˆ‘å°è¯•ä»¥Promiseä¸ºæ ¸å¿ƒ, é€æ­¥å±•å¼€, æœ€ç»ˆåˆ†æprocess.nextTick , promise.then , setTimeout , setImmediate å®ƒä»¬çš„å¼‚æ­¥æœºåˆ¶.</p>
<a id="more"></a>
<h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><h4 id="å¼•å­"><a href="#å¼•å­" class="headerlink" title="å¼•å­"></a>å¼•å­</h4><p>é˜…è¯»æ­¤ç¯‡ä¹‹å‰, æˆ‘ä»¬å…ˆä½“éªŒä¸€ä¸‹å¦‚ä¸‹ä»£ç :</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">4</span>)</div><div class="line">&#125;, <span class="number">0</span>);</div><div class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</div><div class="line">    i == <span class="number">9999</span> &amp;&amp; resolve()</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">5</span>)</div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(<span class="number">3</span>);</div></pre></td></tr></table></figure>
<p>è¿™é‡Œå…ˆå–ä¸ªå…³å­, åç»­å°†ç»™å‡ºç­”æ¡ˆå¹¶æä¾›è¯¦ç»†åˆ†æ.</p>
<p>å’Œå¾€å¸¸æ–‡ç« ä¸€æ ·, æˆ‘å–œæ¬¢ä»apiå…¥æ‰‹, å…ˆå…·è±¡åœ°äº†è§£ä¸€ä¸ªæ¦‚å¿µ, ç„¶åå†æŠ½è±¡æˆ–æ‰©å±•è¿™ä¸ªæ¦‚å¿µ, æ¥ç€å†è°ˆè°ˆæ¦‚å¿µçš„å…·ä½“åº”ç”¨åœºæ™¯, é€šå¸¸æœ«å°¾è¿˜ä¼šæœ‰ä¸€ä¸ªç®€çŸ­çš„å°ç»“. è¿™æ ·, æŸ¥è¯¢apiçš„è¯»è€…å¯ä»¥é€‰æ‹©æ€§åœ°é˜…è¯»ä¸Šæ–‡, å¸Œæœ›æ·±å…¥çš„è¯»è€…å¯ä»¥ç»§ç»­å‰–ææ¦‚å¿µ, å½“ç„¶æˆ‘æ›´å¸Œæœ›ä½ èƒ½è€å¿ƒåœ°è¯»åˆ°åº”ç”¨åœºæ™¯å¤„, è¿™æ ·ä¾¿èƒ½å‡åå¯¹è¿™ä¸ªæ¦‚å¿µæˆ–æŠ€æœ¯çš„è¿ç”¨, ä¹Ÿèƒ½é¿å…è¸©å‘.</p>
<h4 id="new-Promise"><a href="#new-Promise" class="headerlink" title="new Promise"></a>new Promise</h4><p>Promiseçš„è®¾è®¡åˆè¡·æ˜¯é¿å…å¼‚æ­¥å›è°ƒåœ°ç‹±. å®ƒæä¾›æ›´ç®€æ´çš„api, åŒæ—¶å±•å¹³å›è°ƒä¸ºé“¾å¼è°ƒç”¨, ä½¿å¾—ä»£ç æ›´åŠ æ¸…çˆ½, æ˜“è¯».</p>
<p>å¦‚ä¸‹, å³åˆ›å»ºä¸€ä¸ªPromiseå¯¹è±¡:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Create a new Promise.'</span>);</div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(p);</div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/promise01.png" alt="new Promise"></p>
<p>åˆ›å»ºPromiseæ—¶, æµè§ˆå™¨åŒæ­¥æ‰§è¡Œä¼ å…¥çš„ç¬¬ä¸€ä¸ªæ–¹æ³•, ä»è€Œè¾“å‡ºlog. æ–°åˆ›å»ºçš„promiseå®ä¾‹å¯¹è±¡, åˆå§‹çŠ¶æ€ä¸ºç­‰å¾…(pending), é™¤æ­¤ä¹‹å¤–, Promiseè¿˜æœ‰å¦å¤–ä¸¤ä¸ªçŠ¶æ€:</p>
<ul>
<li>fulfilled, è¡¨ç¤ºæ“ä½œå®Œæˆ, å®ç°äº†. åªåœ¨resolveæ–¹æ³•æ‰§è¡Œæ—¶æ‰è¿›å…¥è¯¥çŠ¶æ€.</li>
<li>rejected, è¡¨ç¤ºæ“ä½œå¤±è´¥, æ‹’ç»äº†. åªåœ¨rejectæ–¹æ³•æ‰§è¡Œæ—¶æˆ–æŠ›å‡ºé”™è¯¯çš„æƒ…å†µä¸‹æ‰è¿›å…¥è¯¥çŠ¶æ€.</li>
</ul>
<p>å¦‚ä¸‹å›¾å±•ç¤ºäº†Promiseçš„çŠ¶æ€å˜åŒ–è¿‡ç¨‹(å›¾ç‰‡æ¥è‡ª<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="external">MDN</a>):</p>
<p><img src="http://louiszhai.github.io/docImages/promise03.png" alt="Promise state"></p>
<p>ä»åˆå§‹çŠ¶æ€(pending)åˆ°å®ç°(fulfilled)æˆ–æ‹’ç»(rejected)çŠ¶æ€çš„è½¬æ¢, è¿™æ˜¯ä¸¤ä¸ªåˆ†æ”¯, å®ç°æˆ–æ‹’ç»å³æœ€ç»ˆçŠ¶æ€, ä¸€æ—¦åˆ°è¾¾å…¶ä¸­ä¹‹ä¸€çš„çŠ¶æ€, promiseçš„çŠ¶æ€ä¾¿ç¨³å®šäº†. (å› æ­¤, ä¸è¦å°è¯•å®ç°æˆ–æ‹’ç»çŠ¶æ€çš„äº’è½¬, å®ƒä»¬éƒ½æ˜¯æœ€ç»ˆçŠ¶æ€, æ²¡æ³•è½¬æ¢)</p>
<p>ä»¥ä¸Š, åˆ›å»ºPromiseå¯¹è±¡æ—¶, ä¼ å…¥çš„å›è°ƒå‡½æ•°<code>function(resolve, reject){}</code>é»˜è®¤æ‹¥æœ‰ä¸¤ä¸ªå‚æ•°, åˆ†åˆ«ä¸º:</p>
<ul>
<li>resolve, ç”¨äºæ”¹å˜è¯¥Promiseæœ¬èº«çš„çŠ¶æ€ä¸ºå®ç°, æ‰§è¡Œå, å°†è§¦å‘thençš„onFulfilledå›è°ƒ, å¹¶æŠŠresolveçš„å‚æ•°ä¼ é€’ç»™onFulfilledå›è°ƒ.</li>
<li>reject, ç”¨äºæ”¹å˜è¯¥Promiseæœ¬èº«çš„çŠ¶æ€ä¸ºæ‹’ç», æ‰§è¡Œå, å°†è§¦å‘ then | catchçš„onRejectedå›è°ƒ, å¹¶æŠŠrejectçš„å‚æ•°ä¼ é€’ç»™onRejectedå›è°ƒ.</li>
</ul>
<p>Promiseçš„åŸå‹ä»…æœ‰ä¸¤ä¸ªè‡ªèº«æ–¹æ³•, åˆ†åˆ«ä¸º <code>Promise.prototype.then</code> , <code>Promise.prototype.catch</code> . è€Œå®ƒè‡ªèº«ä»…æœ‰å››ä¸ªæ–¹æ³•, åˆ†åˆ«ä¸º  <code>Promise.reject</code> , <code>Promise.resolve</code> , <code>Promise.all</code> , <code>Promise.race</code> .</p>
<h4 id="then"><a href="#then" class="headerlink" title="then"></a>then</h4><p>è¯­æ³•: <em>Promise.prototype.then(onFulfilled, onRejected)</em></p>
<p>ç”¨äºç»‘å®šåç»­æ“ä½œ. ä½¿ç”¨ååˆ†ç®€å•:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'æ­¤å¤„æ‰§è¡Œåç»­æ“ä½œ'</span>);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// å½“ç„¶, thençš„æœ€å¤§ä¾¿åˆ©ä¹‹å¤„ä¾¿æ˜¯å¯ä»¥é“¾å¼è°ƒç”¨</span></div><div class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'å…ˆåšä¸€ä»¶äº‹'</span>);</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'å†åšä¸€ä»¶äº‹'</span>);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// thenè¿˜å¯ä»¥åŒæ—¶æ¥ä¸¤ä¸ªå›è°ƒ,åˆ†åˆ«å¤„ç†æˆåŠŸå’Œå¤±è´¥çŠ¶æ€</span></div><div class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params">SuccessRes</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'å¤„ç†æˆåŠŸçš„æ“ä½œ'</span>);</div><div class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">failRes</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'å¤„ç†å¤±è´¥çš„æ“ä½œ'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸ä»…å¦‚æ­¤, Promiseçš„thenä¸­è¿˜å¯è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡, åç»­çš„thenå°†æ¥ç€ç»§ç»­å¤„ç†è¿™ä¸ªæ–°çš„Promiseå¯¹è±¡.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'è¿™é‡Œæ˜¯ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡'</span>);</div><div class="line">    resolve(<span class="string">'New Promise resolve.'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(res);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆ, å¦‚æœæ²¡æœ‰æŒ‡å®šè¿”å›å€¼, ä¼šæ€ä¹ˆæ ·?</p>
<p>æ ¹æ®Promiseè§„èŒƒ, <strong>thenæˆ–catchå³ä½¿æœªæ˜¾å¼æŒ‡å®šè¿”å›å€¼, å®ƒä»¬ä¹Ÿæ€»æ˜¯é»˜è®¤è¿”å›ä¸€ä¸ªæ–°çš„fulfilledçŠ¶æ€çš„promiseå¯¹è±¡</strong>.</p>
<h4 id="catch"><a href="#catch" class="headerlink" title="catch"></a>catch</h4><p>è¯­æ³•: <em>Promise.prototype.catch(onRejected)</em></p>
<p>ç”¨äºæ•è·å¹¶å¤„ç†å¼‚å¸¸. æ— è®ºæ˜¯ç¨‹åºæŠ›å‡ºçš„å¼‚å¸¸, è¿˜æ˜¯ä¸»åŠ¨rejectæ‰Promiseè‡ªèº«, éƒ½ä¼šè¢«catchæ•è·åˆ°.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  reject(<span class="string">'è¯¥prormiseå·²è¢«æ‹’ç»'</span>);</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'catch:'</span>, reason);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>åŒthenè¯­å¥ä¸€æ ·, catchä¹Ÿæ˜¯å¯ä»¥é“¾å¼è°ƒç”¨çš„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</div><div class="line">  reject(<span class="string">'è¯¥prormiseå·²è¢«æ‹’ç»'</span>);</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'catch:'</span>, reason);</div><div class="line">  <span class="built_in">console</span>.log(a);</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(reason);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, å°†ä¾æ¬¡è¾“å‡ºä¸¤æ¬¡log, ç¬¬ä¸€æ¬¡è¾“å‡ºpromiseè¢«æ‹’ç», ç¬¬äºŒæ¬¡è¾“å‡ºâ€ReferenceError a is not definedâ€çš„å †æ ˆä¿¡æ¯.</p>
<h5 id="catchèƒ½æ•è·å“ªäº›é”™è¯¯"><a href="#catchèƒ½æ•è·å“ªäº›é”™è¯¯" class="headerlink" title="catchèƒ½æ•è·å“ªäº›é”™è¯¯"></a>catchèƒ½æ•è·å“ªäº›é”™è¯¯</h5><p>é‚£æ˜¯ä¸æ˜¯catchå¯ä»¥æ•è·æ‰€æœ‰é”™è¯¯å‘¢? å¯ä»¥, æ€ä¹ˆä¸å¯ä»¥, æˆ‘ä»¥å‰ä¹Ÿè¿™ä¹ˆå¤©çœŸçš„è®¤ä¸º. ç›´åˆ°æœ‰ä¸€å¤©æˆ‘æ‰§è¡Œäº†å¦‚ä¸‹çš„è¯­å¥, æˆ‘å°±å­¦ä¹–äº†.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</div><div class="line">  <span class="built_in">Promise</span>.reject(<span class="string">'è¿”å›ä¸€ä¸ªæ‹’ç»çŠ¶æ€çš„Promise'</span>);</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'catch:'</span>, reason);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/promise02.png" alt=""></p>
<p>ä¸ºä»€ä¹ˆcatchæ²¡æœ‰æ•è·åˆ°è¯¥é”™è¯¯å‘¢? è¿™ä¸ªé—®é¢˜, å¾…ä¸‹ä¸€èŠ‚æˆ‘ä»¬äº†è§£äº†Promise.rejectè¯­æ³•åå†åšåˆ†æ.</p>
<h4 id="Promise-reject"><a href="#Promise-reject" class="headerlink" title="Promise.reject"></a>Promise.reject</h4><p>è¯­æ³•: <em>Promise.reject(value)</em></p>
<p>è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ‹’ç»çŠ¶æ€çš„Promiseå¯¹è±¡, åŒæ—¶ä¼ å…¥çš„å‚æ•°ä½œä¸ºPromiseValue.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//params: String</span></div><div class="line"><span class="built_in">Promise</span>.reject(<span class="string">'è¯¥prormiseå·²è¢«æ‹’ç»'</span>);</div><div class="line">.catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'catch:'</span>, reason);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//params: Error</span></div><div class="line"><span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'è¿™æ˜¯ä¸€ä¸ªerror'</span>)).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'fulfilled:'</span>, res);</div><div class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">reason</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'rejected:'</span>, reason); <span class="comment">// rejected: Error: è¿™æ˜¯ä¸€ä¸ªerror...</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å³ä½¿å‚æ•°ä¸ºPromiseå¯¹è±¡, å®ƒä¹Ÿä¸€æ ·ä¼šæŠŠPromiseå½“ä½œæ‹’ç»çš„ç†ç”±, åœ¨å¤–éƒ¨å†åŒ…è£…ä¸€ä¸ªæ‹’ç»çŠ¶æ€çš„Promiseå¯¹è±¡äºˆä»¥è¿”å›.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//params: Promise</span></div><div class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'This is a promise'</span>);</div><div class="line">&#125;);</div><div class="line"><span class="built_in">Promise</span>.reject(p).catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'rejected:'</span>, reason);</div><div class="line">  <span class="built_in">console</span>.log(p == reason);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// "This is a promise"</span></div><div class="line"><span class="comment">// rejected: Promise &#123;[[PromiseStatus]]: "pending", [[PromiseValue]]: undefined&#125;</span></div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä»£ç ç‰‡æ®µ, <code>Promise.reject(p)</code> è¿›å…¥åˆ°äº†catchè¯­å¥ä¸­, è¯´æ˜å…¶è¿”å›äº†ä¸€ä¸ªæ‹’ç»çŠ¶æ€çš„Promise, åŒæ—¶æ‹’ç»çš„ç†ç”±å°±æ˜¯ä¼ å…¥çš„å‚æ•°p.</p>
<h4 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†</h4><p>æˆ‘ä»¬éƒ½çŸ¥é“, Promise.rejectè¿”å›äº†ä¸€ä¸ªæ‹’ç»çŠ¶æ€çš„Promiseå¯¹è±¡. å¯¹äºè¿™æ ·çš„Promiseå¯¹è±¡, å¦‚æœå…¶åç»­then | catchä¸­éƒ½æ²¡æœ‰å£°æ˜onRejectedå›è°ƒ, å®ƒå°†ä¼šæŠ›å‡ºä¸€ä¸ª â€œUncaught (in promise) â€¦â€çš„é”™è¯¯. å¦‚ä¸Šå›¾æ‰€ç¤º, åŸè¯­å¥æ˜¯ â€œPromise.reject(â€˜è¿”å›ä¸€ä¸ªæ‹’ç»çŠ¶æ€çš„Promiseâ€™);â€ å…¶åç»­å¹¶æ²¡æœ‰è·Ÿéšä»»ä½•then | catchè¯­å¥, å› æ­¤å®ƒå°†æŠ›å‡ºé”™è¯¯, ä¸”è¯¥é”™å¤–éƒ¨çš„Promiseæ— æ³•æ•è·.</p>
<p>ä¸ä»…å¦‚æ­¤, Promiseä¹‹é—´æ³¾æ¸­åˆ†æ˜, å†…éƒ¨PromiseæŠ›å‡ºçš„ä»»ä½•é”™è¯¯, å¤–éƒ¨Promiseå¯¹è±¡éƒ½æ— æ³•æ„ŸçŸ¥å¹¶æ•è·. åŒæ—¶, ç”±äºpromiseæ˜¯å¼‚æ­¥çš„, try catchè¯­å¥ä¹Ÿæ— æ³•æ•è·å…¶é”™è¯¯.</p>
<p>å› æ­¤å…»æˆè‰¯å¥½ä¹ æƒ¯, promiseè®°å¾—å†™ä¸Šcatch.</p>
<p>é™¤äº†catch, nodejsä¸‹PromiseæŠ›å‡ºçš„é”™è¯¯, è¿˜ä¼šè¢«è¿›ç¨‹çš„<code>unhandledRejection</code> å’Œ <code>rejectionHandled</code>äº‹ä»¶æ•è·.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</div><div class="line">  <span class="comment">//console.log(a);</span></div><div class="line">  reject(<span class="string">'rejected'</span>);</div><div class="line">&#125;);</div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  p.catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.info(<span class="string">'promise catch:'</span>, reason);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div><div class="line">process.on(<span class="string">'uncaughtException'</span>, (e) =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.error(<span class="string">'uncaughtException'</span>, e);</div><div class="line">&#125;);</div><div class="line">process.on(<span class="string">'unhandledRejection'</span>, (e) =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.info(<span class="string">'unhandledRejection:'</span>, e);</div><div class="line">&#125;);</div><div class="line">process.on(<span class="string">'rejectionHandled'</span>, (e) =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.info(<span class="string">'rejectionHandled'</span>, e);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//unhandledRejection: rejected</span></div><div class="line"><span class="comment">//rejectionHandled Promise &#123; &lt;rejected&gt; 'rejected' &#125;</span></div><div class="line"><span class="comment">//promise catch: rejected</span></div></pre></td></tr></table></figure>
<p>å³ä½¿å»æ‰ä»¥ä¸Šä»£ç ä¸­çš„æ³¨é‡Š, è¾“å‡ºä¾ç„¶ä¸€è‡´. å¯è§, Promiseå†…éƒ¨æŠ›å‡ºçš„é”™è¯¯, éƒ½ä¸ä¼šè¢«<code>uncaughtException</code>äº‹ä»¶æ•è·.</p>
<h5 id="é“¾å¼å†™æ³•çš„å¥½å¤„"><a href="#é“¾å¼å†™æ³•çš„å¥½å¤„" class="headerlink" title="é“¾å¼å†™æ³•çš„å¥½å¤„"></a>é“¾å¼å†™æ³•çš„å¥½å¤„</h5><p>è¯·çœ‹å¦‚ä¸‹ä»£ç :</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  resolve(<span class="string">'New Promise resolve.'</span>);</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"oops..."</span>);</div><div class="line">&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'then catch:'</span>, error);</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'catch:'</span>, reason);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//catch: Error: oops...</span></div></pre></td></tr></table></figure>
<p>å¯è§, thenè¯­å¥çš„onRejectedå›è°ƒå¹¶ä¸èƒ½æ•è·onFulfilledå›è°ƒå†…æŠ›å‡ºçš„é”™è¯¯, å°¾éšå…¶åçš„catchè¯­å¥å´å¯ä»¥, å› æ­¤æ¨èé“¾å¼å†™æ³•.</p>
<h4 id="Promise-resolve"><a href="#Promise-resolve" class="headerlink" title="Promise.resolve"></a>Promise.resolve</h4><p>è¯­æ³•: <em>Promise.resolve(value | promise | thenable)</em></p>
<p>thenable è¡¨ç¤ºä¸€ä¸ªå®šä¹‰äº† <code>then</code> æ–¹æ³•çš„å¯¹è±¡æˆ–å‡½æ•°.</p>
<p>å‚æ•°ä¸ºpromiseæ—¶, è¿”å›promiseæœ¬èº«.</p>
<p>å‚æ•°ä¸ºthenableçš„å¯¹è±¡æˆ–å‡½æ•°æ—¶, å°†å…¶thenå±æ€§ä½œä¸ºnew promiseæ—¶çš„å›è°ƒ, è¿”å›ä¸€ä¸ªåŒ…è£…çš„promiseå¯¹è±¡.(æ³¨æ„: è¿™é‡Œä¸Promise.rejectç›´æ¥åŒ…è£…ä¸€ä¸ªæ‹’ç»çŠ¶æ€çš„Promiseä¸åŒ)</p>
<p>å…¶ä»–æƒ…å†µä¸‹, è¿”å›ä¸€ä¸ªå®ç°çŠ¶æ€çš„Promiseå¯¹è±¡, åŒæ—¶ä¼ å…¥çš„å‚æ•°ä½œä¸ºPromiseValue.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//params: String</span></div><div class="line"><span class="comment">//return: fulfilled Promise</span></div><div class="line"><span class="built_in">Promise</span>.resolve(<span class="string">'è¿”å›ä¸€ä¸ªfulfilledçŠ¶æ€çš„promise'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(res); <span class="comment">// "è¿”å›ä¸€ä¸ªfulfilledçŠ¶æ€çš„promise"</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//params: Array</span></div><div class="line"><span class="comment">//return: fulfilled Promise</span></div><div class="line"><span class="built_in">Promise</span>.resolve([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(res); <span class="comment">// ["a", "b", "c"]</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//params: Promise</span></div><div class="line"><span class="comment">//return: Promise self</span></div><div class="line"><span class="keyword">let</span> resolveFn;</div><div class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</div><div class="line">  resolveFn = resolve;</div><div class="line">&#125;);</div><div class="line"><span class="keyword">const</span> r2 = <span class="built_in">Promise</span>.resolve(p2);</div><div class="line">r2.then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(res);</div><div class="line">&#125;);</div><div class="line">resolveFn(<span class="string">'xyz'</span>); <span class="comment">// "xyz"</span></div><div class="line"><span class="built_in">console</span>.log(r2 === p2); <span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="comment">//params: thenable Object</span></div><div class="line"><span class="comment">//return: æ ¹æ®thenableçš„æœ€ç»ˆçŠ¶æ€è¿”å›ä¸åŒçš„promise</span></div><div class="line"><span class="keyword">const</span> thenable = &#123;</div><div class="line">  <span class="attr">then</span>: <span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123; <span class="comment">//ä½œä¸ºnew promiseæ—¶çš„å›è°ƒå‡½æ•°</span></div><div class="line">    reject(<span class="string">'promise rejected!'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">Promise</span>.resolve(thenable).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'res:'</span>, res);</div><div class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">reason</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'reason:'</span>, reason);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å¯è§, Promise.resolveå¹¶éè¿”å›å®ç°çŠ¶æ€çš„Promiseè¿™ä¹ˆç®€å•, æˆ‘ä»¬è¿˜éœ€åŸºäºä¼ å…¥çš„å‚æ•°åŠ¨æ€åˆ¤æ–­.</p>
<p>è‡³æ­¤, æˆ‘ä»¬åŸºæœ¬ä¸Šä¸ç”¨æœŸæœ›ä½¿ç”¨Promiseå…¨å±€æ–¹æ³•ä¸­å»æ”¹å˜å…¶æŸä¸ªå®ä¾‹çš„çŠ¶æ€.</p>
<ul>
<li>å¯¹äºPromise.reject(promise), å®ƒåªæ˜¯ç®€å•åœ°åŒ…äº†ä¸€ä¸ªæ‹’ç»çŠ¶æ€çš„promiseå£³, å‚æ•°promiseä»€ä¹ˆéƒ½æ²¡å˜.</li>
<li>å¯¹äºPromise.resolve(promise), ä»…ä»…è¿”å›å‚æ•°promiseæœ¬èº«.</li>
</ul>
<h4 id="Promise-all"><a href="#Promise-all" class="headerlink" title="Promise.all"></a>Promise.all</h4><p>è¯­æ³•: <em>Promise.all(iterable)</em></p>
<p>è¯¥æ–¹æ³•æ¥ä¸€ä¸ªè¿­ä»£å™¨(å¦‚æ•°ç»„ç­‰), è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡. å¦‚æœè¿­ä»£å™¨ä¸­æ‰€æœ‰çš„Promiseå¯¹è±¡éƒ½è¢«å®ç°, é‚£ä¹ˆ, è¿”å›çš„Promiseå¯¹è±¡çŠ¶æ€ä¸ºâ€fulfilledâ€, åä¹‹åˆ™ä¸ºâ€rejectedâ€. æ¦‚å¿µä¸Šç±»ä¼¼Array.prototype.every.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//params: all fulfilled promise</span></div><div class="line"><span class="comment">//return: fulfilled promise</span></div><div class="line"><span class="built_in">Promise</span>.all([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'promise fulfilled:'</span>, res); <span class="comment">// promise fulfilled: [1, 2, 3]</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//params: has rejected promise</span></div><div class="line"><span class="comment">//return: rejected promise</span></div><div class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</div><div class="line">  reject(<span class="string">'rejected'</span>);</div><div class="line">&#125;);</div><div class="line"><span class="built_in">Promise</span>.all([<span class="number">1</span>, <span class="number">2</span>, p]).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'promise fulfilled:'</span>, res);</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'promise reject:'</span>, reason); <span class="comment">// promise reject: rejected</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Promise.allç‰¹åˆ«é€‚ç”¨äºå¤„ç†ä¾èµ–å¤šä¸ªå¼‚æ­¥è¯·æ±‚çš„ç»“æœçš„åœºæ™¯.</p>
<h4 id="Promise-race"><a href="#Promise-race" class="headerlink" title="Promise.race"></a>Promise.race</h4><p>è¯¥æ–¹æ³•æ¥ä¸€ä¸ªè¿­ä»£å™¨(å¦‚æ•°ç»„ç­‰), è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡. åªè¦è¿­ä»£å™¨ä¸­æœ‰ä¸€ä¸ªPromiseå¯¹è±¡çŠ¶æ€æ”¹å˜(è¢«å®ç°æˆ–è¢«æ‹’ç»), é‚£ä¹ˆè¿”å›çš„Promiseå°†ä»¥ç›¸åŒçš„å€¼è¢«å®ç°æˆ–æ‹’ç», ç„¶åå®ƒå°†å¿½ç•¥è¿­ä»£å™¨ä¸­å…¶ä»–Promiseçš„çŠ¶æ€å˜åŒ–.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Promise</span>.race([<span class="number">1</span>, <span class="built_in">Promise</span>.reject(<span class="number">2</span>)]).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'promise fulfilled:'</span>, res);</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'promise reject:'</span>, reason);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// promise fulfilled: 1</span></div></pre></td></tr></table></figure>
<p>å¦‚æœè°ƒæ¢ä»¥ä¸Šå‚æ•°çš„é¡ºåº, ç»“æœå°†è¾“å‡º â€œpromise reject: 2â€. å¯è§å¯¹äºçŠ¶æ€ç¨³å®šçš„Promise(fulfilled æˆ– rejectedçŠ¶æ€), å“ªä¸ªæ’ç¬¬ä¸€, å°†è¿”å›å“ªä¸ª.</p>
<p>Promise.raceé€‚ç”¨äºå¤šè€…ä¸­å–å…¶ä¸€çš„åœºæ™¯, æ¯”å¦‚åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚, åªè¦æœ‰ä¸€ä¸ªè¯·æ±‚æˆåŠŸ, é‚£ä¹ˆå°±ä»¥è¯¥Promiseçš„çŠ¶æ€ä½œä¸ºæœ€ç»ˆçš„çŠ¶æ€, è¯¥Promiseçš„å€¼ä½œä¸ºæœ€ç»ˆçš„å€¼, åŒ…è£…æˆä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡äºˆä»¥è¿”å›.</p>
<p>åœ¨ <a href="http://louiszhai.github.io/2016/11/02/fetch/#abort">Fetchè¿›é˜¶æŒ‡å—</a> ä¸€æ–‡ä¸­, æˆ‘æ›¾åˆ©ç”¨Promise.raceæ¨¡æ‹Ÿäº†Promiseçš„abortå’Œtimeoutæœºåˆ¶.</p>
<h3 id="Promises-A-è§„èŒƒçš„è¦ç‚¹"><a href="#Promises-A-è§„èŒƒçš„è¦ç‚¹" class="headerlink" title="Promises/A+è§„èŒƒçš„è¦ç‚¹"></a>Promises/A+è§„èŒƒçš„è¦ç‚¹</h3><p>promise.then(onFulfilled, onRejected)ä¸­, å‚æ•°éƒ½æ˜¯å¯é€‰çš„, å¦‚æœonFulfilledæˆ–onRejectedä¸æ˜¯å‡½æ•°, é‚£ä¹ˆå°†å¿½ç•¥å®ƒä»¬.</p>
<p>catchåªæ˜¯thençš„è¯­æ³•ç³–, ç›¸å½“äºpromise.then(null, onRejected).</p>
<h3 id="ä»»åŠ¡é˜Ÿåˆ—ä¹‹è°œ"><a href="#ä»»åŠ¡é˜Ÿåˆ—ä¹‹è°œ" class="headerlink" title="ä»»åŠ¡é˜Ÿåˆ—ä¹‹è°œ"></a>ä»»åŠ¡é˜Ÿåˆ—ä¹‹è°œ</h3><p>ç»ˆäº, æˆ‘ä»¬è¦ä¸€èµ·æ¥çœ‹çœ‹æ–‡ç« èµ·å§‹çš„ä¸€é“é¢˜ç›®.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">4</span>)</div><div class="line">&#125;, <span class="number">0</span>);</div><div class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</div><div class="line">    i == <span class="number">9999</span> &amp;&amp; resolve()</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">5</span>)</div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(<span class="number">3</span>);</div></pre></td></tr></table></figure>
<p>è¿™é“é¢˜ç›®æ¥è‡ªçŸ¥ä¹(æœºæ™ºçš„ä½ å¯èƒ½æ—©å·²çœ‹ç©¿, ä½†åƒä¸‡åˆ«æˆ³ç ´ğŸ˜‚), å¯ä»¥æˆ³æ­¤é“¾æ¥ <a href="https://www.zhihu.com/question/36972010" target="_blank" rel="external">Promiseçš„é˜Ÿåˆ—ä¸setTimeoutçš„é˜Ÿåˆ—æœ‰ä½•å…³è”</a> å›´è§‚ç‚¹èµ.</p>
<p>å›´è§‚å®Œäº†, åˆ«å¿˜äº†ç»§ç»­è¯»ä¸‹å», è¿™é‡Œè¯·å…è®¸æˆ‘ç«™åœ¨è¯¸ä½çŸ¥ä¹å¤§ç¥çš„è‚©è†€ä¸Š, ç»§ç»­æ·±å…¥åˆ†æ.</p>
<p>ä»¥ä¸Šä»£ç , æœ€ç»ˆè¿è¡Œç»“æœæ˜¯1,2,3,5,4. å¹¶ä¸æ˜¯1,2,3,4,5.</p>
<ol>
<li>é¦–å…ˆå‰é¢æœ‰æåˆ°, new Promiseç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°å†…çš„è¯­å¥åŒæ­¥æ‰§è¡Œ, å› æ­¤æ§åˆ¶å°å°†é¡ºåºè¾“å‡º1,2, æ­¤å¤„åº”æ— å¼‚è®®.</li>
<li><code>console.log(3)</code>, è¿™é‡Œæ˜¯åŒæ­¥æ‰§è¡Œ, å› æ­¤æ¥ç€å°†è¾“å‡º3, æ­¤å¤„åº”æ— å¼‚è®®.</li>
<li>å‰©ä¸‹ä¾¿æ˜¯setTimeout å’Œ Promiseçš„thençš„åšå¼ˆäº†, åŒä¸ºå¼‚æ­¥äº‹ä»¶, ä¸ºä»€ä¹ˆthenåæ³¨å†Œå´å…ˆäºsetTimeoutæ‰§è¡Œ?</li>
</ol>
<p>ä¹‹å‰, æˆ‘ä»¬åœ¨ <a href="http://louiszhai.github.io/2016/11/02/ajax/#ajaxæœ‰æ²¡æœ‰ç ´åjså•çº¿ç¨‹æœºåˆ¶">AjaxçŸ¥è¯†ä½“ç³»</a> ä¸€æ–‡ä¸­æœ‰æåˆ°:</p>
<blockquote>
<p>æµè§ˆå™¨ä¸­, jså¼•æ“çº¿ç¨‹ä¼šå¾ªç¯ä» <code>ä»»åŠ¡é˜Ÿåˆ—</code> ä¸­è¯»å–äº‹ä»¶å¹¶ä¸”æ‰§è¡Œ, è¿™ç§è¿è¡Œæœºåˆ¶ç§°ä½œ <code>Event Loop</code> (äº‹ä»¶å¾ªç¯).</p>
</blockquote>
<p>ä¸ä»…å¦‚æ­¤, event loopè‡³å°‘æ‹¥æœ‰å¦‚ä¸‹ä¸¤ç§é˜Ÿåˆ—:</p>
<ul>
<li>task queue, ä¹Ÿå«macrotask queue, æŒ‡çš„æ˜¯å®ä»»åŠ¡é˜Ÿåˆ—, åŒ…æ‹¬rendering, script(é¡µé¢è„šæœ¬), é¼ æ ‡, é”®ç›˜, ç½‘ç»œè¯·æ±‚ç­‰äº‹ä»¶è§¦å‘, setTimeout, setInterval, setImmediate(node)ç­‰ç­‰.</li>
</ul>
<ul>
<li>microtask queue, æŒ‡çš„æ˜¯å¾®ä»»åŠ¡é˜Ÿåˆ—, ç”¨äºåœ¨æµè§ˆå™¨é‡æ–°æ¸²æŸ“å‰æ‰§è¡Œ, åŒ…å«Promise, process.nextTick(node), Object.observe, MutationObserverå›è°ƒç­‰.</li>
</ul>
<p>å¦‚ä¸‹æ˜¯HTMLè§„èŒƒåŸæ–‡:</p>
<blockquote>
<p>An <a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop" target="_blank" rel="external">event loop</a> has one or more task queues. A <a href="https://html.spec.whatwg.org/multipage/webappapis.html#task-queue" target="_blank" rel="external">task queue</a> is an ordered list of tasks, which are algorithms that are responsible for such work as: events, parsing, callbacks, using a resource, reacting to DOM manipulationâ€¦</p>
<p>Each <a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop" target="_blank" rel="external">event loop</a> has a microtask queue. A microtask is a <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" target="_blank" rel="external">task</a> that is originally to be queued on the <a href="https://html.spec.whatwg.org/multipage/webappapis.html#microtask-queue" target="_blank" rel="external">microtask queue</a> rather than a <a href="https://html.spec.whatwg.org/multipage/webappapis.html#task-queue" target="_blank" rel="external">task queue</a>.</p>
</blockquote>
<p>æµè§ˆå™¨(æˆ–å®¿ä¸»ç¯å¢ƒ) éµå¾ªé˜Ÿåˆ—å…ˆè¿›å…ˆå‡ºåŸåˆ™, ä¾æ¬¡éå†macrotask queueä¸­çš„æ¯ä¸€ä¸ªtask, ä¸è¿‡æ¯æ‰§è¡Œä¸€ä¸ªmacrotask, å¹¶ä¸æ˜¯ç«‹å³å°±æ‰§è¡Œä¸‹ä¸€ä¸ª, è€Œæ˜¯æ‰§è¡Œä¸€émicrotask queueä¸­çš„ä»»åŠ¡, ç„¶ååˆ‡æ¢GUIçº¿ç¨‹é‡æ–°æ¸²æŸ“æˆ–åƒåœ¾å›æ”¶ç­‰.</p>
<p>ä¸Šè¿°ä»£ç å—å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªmacrotask, å¯¹äºå…¶æ‰§è¡Œè¿‡ç¨‹, ä¸å¦¨ä½œå¦‚ä¸‹ç®€åŒ–:</p>
<ol>
<li>é¦–å…ˆæ‰§è¡Œå½“å‰macrotask, å°†setTimeoutå›è°ƒä»¥ä¸€ä¸ªæ–°çš„taskå½¢å¼, åŠ å…¥åˆ°macrotask queueæœ«å°¾.</li>
<li>å½“å‰macrotaskç»§ç»­æ‰§è¡Œ, åˆ›å»ºä¸€ä¸ªæ–°çš„Promise, åŒæ­¥æ‰§è¡Œå…¶å›è°ƒå‡½æ•°, è¾“å‡º1; forå¾ªç¯1wæ¬¡, ç„¶åæ‰§è¡Œresolveæ–¹æ³•, å°†è¯¥Promiseå›è°ƒåŠ å…¥åˆ°microtask queueæœ«å°¾, å¾ªç¯ç»“æŸ, æ¥ç€è¾“å‡º2.</li>
<li>å½“å‰macrotaskç»§ç»­æ‰§è¡Œ, è¾“å‡º3. è‡³æ­¤, å½“å‰macrotaskæ‰§è¡Œå®Œæ¯•.</li>
<li>å¼€å§‹é¡ºåºæ‰§è¡Œmicrotask queueä¸­çš„æ‰€æœ‰ä»»åŠ¡, ä¹ŸåŒ…æ‹¬åˆšåˆšåŠ å…¥åˆ°é˜Ÿåˆ—æœ«å°¾ Promiseå›è°ƒ, æ•…è¾“å‡º5. è‡³æ­¤, microtask queueä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œæ¯•, microtask queueæ¸…ç©º.</li>
<li>æµè§ˆå™¨æŒ‚èµ·jså¼•æ“, å¯èƒ½åˆ‡æ¢è‡³GUIçº¿ç¨‹æˆ–è€…æ‰§è¡Œåƒåœ¾å›æ”¶ç­‰.</li>
<li>åˆ‡æ¢å›jså¼•æ“, ç»§ç»­ä»macrotask queueå–å‡ºä¸‹ä¸€ä¸ªmacrotask, æ‰§è¡Œä¹‹, ç„¶åå†å–å‡ºmicrotask queue, æ‰§è¡Œä¹‹, åç»­æ‰€æœ‰çš„macrotaskå‡å¦‚æ­¤é‡å¤. è‡ªç„¶, ä¹ŸåŒ…æ‹¬åˆšåˆšåŠ å…¥åˆ°é˜Ÿåˆ—æœ«å°¾çš„setTimeoutå›è°ƒ, æ•…è¾“å‡º4.</li>
</ol>
<p>è¿™é‡Œç›´æ¥ç»™å‡ºäº‹ä»¶å›è°ƒä¼˜å…ˆçº§:</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">process</span>.nextTick &gt; promise.then &gt; <span class="built_in">setTimeout</span> ? setImmediate</div></pre></td></tr></table></figure>
<p>nodejsä¸­æ¯ä¸€æ¬¡event loopç§°ä½œtick. _tickCallbackåœ¨macrotask queueä¸­æ¯ä¸ªtaskæ‰§è¡Œå®Œæˆåè§¦å‘. å®é™…ä¸Š, _tickCallbackå†…éƒ¨å…±å¹²äº†ä¸¤ä»¶äº‹:</p>
<ol>
<li>æ‰§è¡ŒnextTick queueä¸­çš„æ‰€æœ‰ä»»åŠ¡, åŒ…æ‹¬process.nextTickæ³¨å†Œçš„å›è°ƒ.</li>
<li>ç¬¬ä¸€æ­¥å®Œæˆåæ‰§è¡Œ _runMicrotaskså‡½æ•°, å³æ‰§è¡Œmicrotask queueä¸­çš„æ‰€æœ‰ä»»åŠ¡, åŒ…æ‹¬promise.thenæ³¨å†Œçš„å›è°ƒ.</li>
</ol>
<p>å› æ­¤, process.nextTickä¼˜å…ˆçº§æ¯”promise.thené«˜.</p>
<p>é‚£ä¹ˆsetTimeoutä¸setImmediateåˆ°åº•å“ªä¸ªæ›´å¿«å‘¢? å›ç­”æ˜¯å¹¶ä¸ç¡®å®š. è¯·çœ‹å¦‚ä¸‹ä»£ç :</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">setImmediate(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="number">1</span>);</div><div class="line">&#125;);</div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="number">0</span>);</div><div class="line">&#125;, <span class="number">0</span>);</div></pre></td></tr></table></figure>
<p>å‰åä¸¤æ¬¡çš„æ‰§è¡Œç»“æœå¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/promise04.png" alt=""></p>
<p>æµ‹è¯•æ—¶, æˆ‘æœ¬åœ°nodeç‰ˆæœ¬æ˜¯v5.7.0.</p>
<hr>
<p>æœ¬é—®å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2017/02/25/promise/">http://louiszhai.github.io/2017/02/25/promise/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="http://www.th7.cn/web/js/201511/134740.shtml" target="_blank" rel="external">å®Œå…¨ç†è§£Promise_JavaScript_ç¬¬ä¸ƒåŸå¸‚</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="external">Promise - JavaScript | MDN</a></li>
<li><a href="https://www.zhihu.com/question/36972010" target="_blank" rel="external">Promiseçš„é˜Ÿåˆ—ä¸setTimeoutçš„é˜Ÿåˆ—çš„æœ‰ä½•å…³è” -çŸ¥ä¹</a></li>
<li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop" target="_blank" rel="external">HTML Standard event loop</a></li>
<li><a href="https://promisesaplus.com/#point-11" target="_blank" rel="external">Promises/A+</a></li>
<li><a href="http://jphpsf.github.io/setImmediate-shim-demo/" target="_blank" rel="external">setImmediate API demo</a></li>
<li><a href="https://www.zhihu.com/question/23028843" target="_blank" rel="external">Process.nextTick å’Œ setImmediate çš„åŒºåˆ«ï¼Ÿ - çŸ¥ä¹</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      promise promise.race promise.all Promise.reject Promise.resolve then catch Promises/A+ process.nextTick setImmediate
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://louiszhai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ºä»€ä¹ˆWeb Appçš„è¿”å›é€»è¾‘å¦‚æ­¤å¤æ‚</title>
    <link href="http://louiszhai.github.io/2017/02/24/back/"/>
    <id>http://louiszhai.github.io/2017/02/24/back/</id>
    <published>2017-02-24T07:59:01.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>æœ€è¿‘æˆ‘åœ¨æ¢³ç†å…¬å¸web appæ–°äº§å“çº¿çš„è¿”å›é€»è¾‘, æ¨æ¼”äº†Nç§æ–¹æ¡ˆ, ç«Ÿç„¶æ²¡æœ‰ä¸€ç§å®Œå…¨é€šç”¨çš„. è¿™è®©æˆ‘è¿·æƒ‘ä¸å·². ä»”ç»†ä½“éªŒäº†å…¬å¸çš„å„ç§H5é¡µé¢, å‘ç°è¿”å›é€»è¾‘è¿˜çœŸæ˜¯äº”èŠ±å…«é—¨. é‚£ä¹ˆ, é—®é¢˜æ¥äº†, ä¸ºä»€ä¹ˆWeb Appçš„è¿”å›é€»è¾‘å¦‚æ­¤éš¾ä»¥è®¾è®¡?</p>
<a id="more"></a>
<h3 id="å¯ä¾›å°è¯•çš„api"><a href="#å¯ä¾›å°è¯•çš„api" class="headerlink" title="å¯ä¾›å°è¯•çš„api"></a>å¯ä¾›å°è¯•çš„api</h3><p>ç›¸å¯¹äºè¾ƒå¤æ‚çš„è¿”å›åœºæ™¯, å¯ç”¨çš„apiå°‘å¾—å¯æ€œ. webviewçš„historyå¯¹è±¡ä¸­, ä»… back å’Œ go æ–¹æ³•å¯ç”¨. å®ƒä»¬éµå¾ªå¦‚ä¸‹è§„å¾‹:</p>
<ul>
<li>è°ƒç”¨<code>history.back</code> å¦‚æœå­˜åœ¨å†å²çš„è¯, åªèƒ½å›åˆ°å‰ä¸€ä¸ªé¡µé¢, å¦åˆ™å°†é™é»˜å¤±è´¥.</li>
<li>è°ƒç”¨<code>history.go(-n)</code> å¦‚æœå­˜åœ¨å†å²çš„è¯, å¯ä»¥å›åˆ°å‰nä¸ªé¡µé¢, å¦åˆ™å°†é™é»˜å¤±è´¥.</li>
</ul>
<p>ä»è¿™é‡Œçœ‹èµ·æ¥, ä¼¼ä¹æƒ³å›åˆ°å“ªå°±å›åˆ°å“ª. è‡ªç„¶ä¸æ˜¯, ä¸ç„¶å°±ä¸ä¼šæœ‰è¿™ç¯‡æ–‡ç« äº†.</p>
<p>ä¸å¾—ä¸è¯´çš„æ˜¯, H5ä¸­æœ‰ä¸ªå ªç§°å‘çˆ¹çš„è®¾å®š, å°±æ˜¯<code>history.length</code>å±æ€§, è¯¥å±æ€§æ— è®ºä½•æ—¶, éƒ½æ˜¯å½“å‰webviewå†å²æ ˆçš„æ€»é•¿åº¦. ä¹Ÿå°±æ˜¯è¯´, æ— è®ºä½ çš„ç½‘é¡µæ˜¯ç¬¬ä¸€ä¸ªæ‰“å¼€çš„, è¿˜æ˜¯ä¸­é—´æ‰“å¼€çš„, è¿˜æ˜¯æœ€åä¸€ä¸ªæ‰“å¼€çš„, åªè¦è¿”å›åˆ°ä½ çš„ç½‘é¡µ, ä½ è·å–åˆ°çš„<code>history.length</code>éƒ½æ˜¯ç›¸åŒçš„å€¼. æ— è®ºå¦‚ä½•ä½ éƒ½ä¸èƒ½ç›´æ¥æ‹¿åˆ°ä½ çš„ç½‘é¡µåœ¨webviewå†å²æ ˆä¸­çš„ä½ç½®(æˆ–è€…åºå·), è¿™å°†å¯¼è‡´ä½ ä¸çŸ¥é“è¦å¾€å‰è·³å‡ æ­¥(å‡è®¾è¦è·³è¿‡è‹¥å¹²ä¸ªå†å²), å› æ­¤ä½ ä¸èƒ½éšå¿ƒæ‰€æ¬²çš„è°ƒç”¨<code>history.go</code>æ–¹æ³•.</p>
<p>é€šå¸¸æƒ…å†µä¸‹,è‹¥web appè‡ªå¸¦è¿”å›æŒ‰é’®, å¦‚æœå…¶ä¸­ä¸€ä¸ªç½‘é¡µAæ˜¯é€šè¿‡é‡å®šå‘æ¨¡æ‹Ÿè¿”å›åˆ°å®ƒä¹‹å‰çš„æŸä¸ªç½‘é¡µB, ç”¨æˆ·åœ¨æ–°çš„ç½‘é¡µBç‚¹å‡»è¿”å›æŒ‰é’®, å°†è¿”å›åˆ°ç½‘é¡µA, æ­¤æ—¶å†ç‚¹å‡»ç½‘é¡µAçš„è¿”å›æŒ‰é’®, é‚£ä¹ˆåˆå°†è¿›å…¥åˆ°æ–°çš„ç½‘é¡µB2ä¸­. å¦‚ä¸‹:</p>
<p>â‘ â€”&gt;A â€”â‘¡é‡å®šå‘â€”&gt; B â€”â‘¢è¿”å›â€”&gt; A â€”â‘£é‡å®šå‘â€”&gt; B2 â€”â‘¤è¿”å›â€”&gt; A</p>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹webviewå†å²æ ˆå‘ç”Ÿäº†ä»€ä¹ˆ, å‡è®¾å†å²æ ˆå·²ç»å­˜å‚¨äº†né¡¹å†å²:</p>
<ul>
<li>â‘ æ ˆé¡¶å‹å…¥Aé¡µé¢, æ­¤æ—¶å½“å‰é¡µé¢æŒ‡é’ˆåç§»1ä½, æŒ‡å‘Aé¡µé¢, ä¸”Aé¡µé¢ä½äºæ ˆé¡¶, æ­¤æ—¶å†å²æ ˆé•¿åº¦ä¸ºn+1;</li>
<li>â‘¡æ ˆé¡¶å‹å…¥Bé¡µé¢, æ­¤æ—¶å½“å‰é¡µé¢æŒ‡é’ˆåç§»1ä½, æŒ‡å‘Bé¡µé¢, ä¸”Bé¡µé¢ä½äºæ ˆé¡¶, æ­¤æ—¶å†å²æ ˆé•¿åº¦ä¸ºn+2;</li>
<li>â‘¢å½“å‰é¡µé¢æŒ‡é’ˆå‰ç§»1ä½, æŒ‡å‘Aé¡µé¢, æ­¤æ—¶Bé¡µé¢ä½äºæ ˆé¡¶, å†å²æ ˆé•¿åº¦ä¾ç„¶ä¸ºn+2;</li>
<li>â‘£å½“å‰é¡µé¢æŒ‡é’ˆåçš„æ ˆè¢«æ¸…ç©º, å†å²æ ˆé•¿åº¦ä¸ºn+1, æ ˆé¡¶å‹å…¥B2é¡µé¢, å½“å‰é¡µé¢æŒ‡é’ˆåç§»1ä½, æŒ‡å‘B2é¡µé¢, ä¸”B2é¡µé¢ä½äºæ ˆé¡¶, æ­¤æ—¶å†å²æ ˆé•¿åº¦ä¸ºn+2;</li>
<li>â‘¤å½“å‰é¡µé¢æŒ‡é’ˆå‰ç§»1ä½, æŒ‡å‘Aé¡µé¢, æ­¤æ—¶B2é¡µé¢ä½äºæ ˆé¡¶, å†å²æ ˆé•¿åº¦ä¾ç„¶ä¸ºn+2;</li>
</ul>
<p>Bå’ŒB2å…¶å®æ˜¯åŒä¸€ä¸ªç½‘é¡µ, é™¤äº†å†å²æ ˆä¸­çš„ä½ç½®ä¸åŒ, ä»–ä»¬æ²¡æœ‰ä»»ä½•ä¸åŒ. å¦‚æ­¤é€»è¾‘å°†ä½¿å¾—æˆ‘ä»¬å°†é™·å…¥è¿”å›çš„æ­»å¾ªç¯ä¸­. ä¸ºé¿å…è¿™ç§ä½“éªŒä¸Šçš„ç¼ºé™·, è¯·å°½é‡ä¸è¦åœ¨è¿”å›é€»è¾‘ä¸­é‡å®šå‘åˆ°æŸä¸ªä¹‹å‰çš„é¡µé¢.</p>
<blockquote>
<p>webviewä¸­é€šè¿‡location.hrefæ–¹å¼è·³è½¬é“¾æ¥, å¯èµ·åˆ°æ¸…ç†æµè§ˆå†å²é¡¹çš„ä½œç”¨, å¦‚æ­¤æ—¶webviewä¸­å…±å­˜åœ¨100ä¸ªå†å²é¡¹, æˆ‘ä»¬ä¸€è·¯è¿”å›è‡³ç¬¬90ä¸ªé¡µé¢(è¯¥é¡µé¢çš„history.lengthä¾ç„¶æ˜¯100), ç„¶ååœ¨è¯¥é¡µé¢é€šè¿‡location.hrefè·³è½¬è‡³å¦ä¸€ä¸ªé¡µé¢, é‚£ä¹ˆæ–°çš„é¡µé¢å°†å¤„äºå†å²é¡¹çš„ç¬¬91é¡¹, åŸæ¥çš„ç¬¬91~100é¡¹å†å²å°†è¢«æ¸…ç©º. äºæ˜¯æ–°çš„é¡µé¢ä¸­è·å–çš„history.lengthå°†å‡†ç¡®åœ°æ ‡ç¤ºäº†è¯¥é¡µé¢å¤„äºå†å²é¡¹çš„ç¬¬å‡ é¡¹.</p>
</blockquote>
<h3 id="é‡å®šå‘è¿‡åæ€ä¹ˆè¿”å›"><a href="#é‡å®šå‘è¿‡åæ€ä¹ˆè¿”å›" class="headerlink" title="é‡å®šå‘è¿‡åæ€ä¹ˆè¿”å›"></a>é‡å®šå‘è¿‡åæ€ä¹ˆè¿”å›</h3><p>æ„¿æœ›æ˜¯ç¾å¥½çš„, ç°å®æ˜¯æ®‹é…·çš„. çº¯H5ä¸‹æƒ³è¦åœ¨è¿”å›é€»è¾‘ä¸­ä¸é‡å®šå‘, å…ˆç äº†è¿™äº›éœ€æ±‚å†è¯´:</p>
<ul>
<li>ä»ç½‘é¡µAè·³èµ°, ä¸­é—´ç»è¿‡nä¸ªå…¶ä»–åŸŸåçš„ç½‘é¡µ, æœ€ç»ˆä¸å¸Œæœ›ç”¨æˆ·æŒ‰æ­¥è¿”å›, å¸Œæœ›èƒ½å¤Ÿç›´æ¥è¿”å›ç½‘é¡µAçš„åœºæ™¯.</li>
<li>ä»è¯¦æƒ…é¡µBè·³èµ°, ä¸­é—´éœ€è¦ç»è¿‡å„ç§æ”¯ä»˜ä¸­é—´é¡µ, ç„¶åè¿›å…¥webç‰ˆæ”¶é“¶å°, å¼¹å‡ºæ”¯ä»˜å®æˆ–è€…å¾®ä¿¡æ”¯ä»˜å¼¹æ¡†, æ”¯ä»˜æˆåŠŸåè¿›å…¥åˆ°æˆåŠŸé¡µ, ä»æˆåŠŸé¡µè¿”å›æ—¶å¸Œæœ›ç›´æ¥å›åˆ°è¯¦æƒ…é¡µBçš„åœºæ™¯.</li>
</ul>
<p>ä»äº§å“ä¸Šçœ‹, è¿™äº›éœ€æ±‚éƒ½æ˜¯åˆç†çš„. é‚£ä¹ˆå¦‚ä½•ä»æœ€åä¸€ä¸ªé¡µé¢, æˆåŠŸåœ°è¿”å›åˆ°åˆå§‹çš„Aæˆ–Bé¡µé¢, è¿™é‡Œæˆ‘æƒ³åˆ°äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆ. æ€è·¯å¦‚ä¸‹:</p>
<p><code>history.go</code>æ–¹æ³•æ˜¯å¯ç”¨çš„. åªè¦getåˆ°äº†ç½‘é¡µå¤„äºå†å²æ ˆçš„ä½ç½®, å°±å¯ä»¥æ­£å¸¸çš„è¿”å›næ­¥. è™½ç„¶é€šå¸¸æƒ…å†µä¸‹ä»åˆå§‹é¡µé¢Aè·³å‡ºæ—¶, <code>history.length</code>å¹¶ä¸å¯é , ä½†æ˜¯ä»Aé¡µé¢è·³åˆ°(é€šè¿‡location.hrefè·³è½¬)çš„ç¬¬ä¸€ä¸ªé¡µé¢Xä¸­, <code>history.length</code>å´æ˜¯å¯é çš„, æ­¤æ—¶è¯¥å€¼å‡†ç¡®åœ°è®°å½•äº†é¡µé¢Xåœ¨å†å²æ ˆä¸­çš„ä½ç½®.(ä¸æ‡‚çš„å¯ä»¥å»çœ‹ä¸Šè¿°ç¬¬â‘£æ­¥è§£æ) åªè¦åœ¨é¡µé¢Xä¸­æ‰§è¡Œå¦‚ä¸‹è¯­å¥, ä¾¿å¯è®°å½•é¡µé¢Açš„ä½ç½®.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å‡å®šåŸé¡µé¢Aä¸­è·³è½¬æ—¶æ‰§è¡Œå¦‚ä¸‹è¯­å¥</span></div><div class="line"><span class="keyword">let</span> linkA = <span class="string">"http://www.a.com/a?params=abc"</span>;</div><div class="line">linkA = <span class="built_in">window</span>.encodeURIComponent(linkA);</div><div class="line"><span class="keyword">const</span> targetLink = <span class="string">`http://www.x.com/x?from=<span class="subst">$&#123;linkA&#125;</span>#test`</span>;</div><div class="line">location.href = targetLink;</div><div class="line"></div><div class="line"><span class="comment">//åœ¨é¡µé¢Xæ‰§è¡Œå¦‚ä¸‹è¯­å¥</span></div><div class="line"><span class="keyword">const</span> cursor = history.length - <span class="number">1</span>;</div><div class="line"><span class="keyword">let</span> params = location.search.match(<span class="regexp">/from=([^&amp;]*)/</span>),</div><div class="line">    <span class="keyword">from</span>;</div><div class="line"><span class="keyword">if</span> (params <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; params.length === <span class="number">2</span>) &#123;</div><div class="line">  <span class="comment">// è·å–åŸé¡µé¢Açš„é“¾æ¥</span></div><div class="line">  <span class="keyword">from</span> = <span class="built_in">window</span>.decodeURIComponent(params[<span class="number">1</span>]);</div><div class="line">  <span class="keyword">const</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</div><div class="line">  a.href = <span class="keyword">from</span>;</div><div class="line">  <span class="keyword">const</span> paramStr = <span class="string">`historyCursor=<span class="subst">$&#123;history.length - <span class="number">1</span>&#125;</span>`</span>;</div><div class="line">  <span class="comment">// è¿½åŠ historyCursor=history.lengthå‚æ•°</span></div><div class="line">  <span class="keyword">const</span> searchStr = a.search ? <span class="string">`<span class="subst">$&#123;a.search&#125;</span>&amp;<span class="subst">$&#123;paramStr&#125;</span>`</span> : <span class="string">`?<span class="subst">$&#123;paramStr&#125;</span>`</span>;</div><div class="line">  <span class="keyword">from</span> = a.origin + a.pathname + searchStr + a.hash;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é¡µé¢Xç»è¿‡næ¬¡è·³è½¬, å…¶ä¸­å¯èƒ½ç»è¿‡äº†å„ç§æ”¯ä»˜ä¸­é—´é¡µ, æœ€ç»ˆåˆé‡å®šå‘å›åˆ°é¡µé¢Xâ€™(ä¸é¡µé¢xé“¾æ¥ç›¸åŒ, ä½†æ˜¯æ–°çš„é¡µé¢), åœ¨é¡µé¢Xâ€™ä¸Šç‚¹å‡»è¿”å›æŒ‰é’®æ—¶, æ­¤æ—¶å¯ä»¥ç›´æ¥é‡å®šå‘å›åˆ°åŸé¡µé¢Aâ€™(ä¸é¡µé¢Aé“¾æ¥ç›¸ä¼¼, ä»…ä»…å¤šäº†å‚æ•°historyCursor, æ˜¯æ–°çš„é¡µé¢).</p>
<p>å¾…ç”¨æˆ·å›åˆ°äº†é¡µé¢Aâ€™å, æ­¤æ—¶ç‚¹å‡»è¿”å›æŒ‰é’®æ—¶, èµ°çš„å¹¶ä¸æ˜¯é€šå¸¸çš„<code>history.back</code> , è€Œåº”è¯¥æ˜¯å›åˆ°é¡µé¢Açš„å‰ä¸€ä¸ªé¡µé¢, æ¢å¥è¯è¯´ , æ­¤æ—¶ç”¨æˆ·å°†å¾€å›è·³nä¸ªé¡µé¢. è¿™é‡Œçš„ä¸»è¦åˆ¤æ–­é€»è¾‘å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">goBack</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> start, current, step;</div><div class="line">  <span class="keyword">const</span> params = location.search.match(<span class="regexp">/historyCursor=(\d+)/</span>);</div><div class="line">  <span class="keyword">if</span>(params <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; params.length === <span class="number">2</span>) &#123;</div><div class="line">    <span class="comment">// å¦‚å‚æ•°ä¸­å¸¦æœ‰historyCursor, è¿”å›æ—¶å°†å›è·³næ­¥</span></div><div class="line">    start = +params[<span class="number">1</span>];</div><div class="line">    current = history.length;</div><div class="line">    step = current - start + <span class="number">1</span>;</div><div class="line">    location.go(-step);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// é»˜è®¤å°†è¿”å›ä¸Šä¸€ä¸ªé¡µé¢</span></div><div class="line">    history.back();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, ç”±å¤šä¸ªé¡µé¢ä¼ é€’historyCursorçš„å€¼, åŸºæœ¬å°†éœ€æ±‚ä¸­çš„è¿”å›é€»è¾‘è½åœ°äº†. ç¾ä¸­ä¸è¶³çš„æ˜¯, é¡µé¢Açš„è¿”å›é€»è¾‘ä¾èµ–äº†é¡µé¢Xçš„ä»£ç (é¡µé¢Xä¸­éœ€è¦è®¾ç½®å¯¹çš„historyCursorå€¼), å­˜åœ¨è€¦åˆ. è¿™æ ·å¼€å‘é¡µé¢Açš„åŒå­¦å°†é€šçŸ¥å¼€å‘é¡µé¢Xçš„åŒå­¦, è¿”å›æ—¶ä½ è¦ç»™æˆ‘åŠ ä¸€ä¸ªhistoryCursorçš„å‚æ•°, å·´æ‹‰å·´æ‹‰. å¼€å‘é¡µé¢Xçš„åŒå­¦ä¹Ÿå¾ˆçº ç»“, å› ä¸ºä»–å§‹ç»ˆè¦ç¡®è®¤æ˜¯ä¸æ˜¯ä»é¡µé¢Aè·³è¿‡æ¥çš„, å¦‚æœæ˜¯, é‚£ä»–å°±è¦åŠ ä¸€ä¸ªhistoryCursorå‚æ•°, å¹¶ä¸”é‡å®šå‘åˆ°é¡µé¢A. åŒæ—¶Androidç³»ç»Ÿè‡ªå¸¦çš„è¿”å›é”®ä¹Ÿä¼šè®©è¿™å¥—æ–¹æ¡ˆæ›´åŠ é›ªä¸ŠåŠ éœœ.</p>
<p>æœ‰é‰´äºæ­¤, ä»¥ä¸Šçº¯H5çš„è§£å†³æ–¹æ¡ˆä¾¿ä¸å¤ªå®Œç¾.</p>
<h3 id="H5æ˜¯å¦å¯ä»¥æ‰“å¼€æ–°çš„ç½‘é¡µçª—å£"><a href="#H5æ˜¯å¦å¯ä»¥æ‰“å¼€æ–°çš„ç½‘é¡µçª—å£" class="headerlink" title="H5æ˜¯å¦å¯ä»¥æ‰“å¼€æ–°çš„ç½‘é¡µçª—å£"></a>H5æ˜¯å¦å¯ä»¥æ‰“å¼€æ–°çš„ç½‘é¡µçª—å£</h3><p>å¯¹äºéåµŒå…¥appçš„H5åº”ç”¨, é‚£ä¹ˆä½¿ç”¨åœºæ™¯å°±æ˜¯å„å®¶çš„æµè§ˆå™¨, åº”ç”¨ä¸­å¯¹äºæœ‰å¯èƒ½æ‰“ä¹±å†å²è®°å½•çš„ç½‘é¡µ, ç›´æ¥æ–°å¼€çª—å£å°±è¡Œ.</p>
<p>å¯¹äºåµŒå…¥appå†…çš„H5åº”ç”¨, é€šå¸¸æ¥è¯´, H5æœ¬èº«ä¸å…·å¤‡æ–°å¼€webviewçš„èƒ½åŠ›. è¿™é‡Œéœ€è¦nativeè¾…åŠ©. æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä¸»è¦å…³æ³¨åµŒå…¥appå†…çš„H5çš„åº”ç”¨.</p>
<h3 id="nativeæä¾›jsBridge"><a href="#nativeæä¾›jsBridge" class="headerlink" title="nativeæä¾›jsBridge"></a>nativeæä¾›jsBridge</h3><p>appå†…åµŒçš„H5åº”ç”¨, å¯å€ŸåŠ©nativeçš„jsBridgeæ–°å¼€webview, ä»è€Œé¿å…å†å²è®°å½•æ··ä¹±. ä¸ºæ­¤, nativeå®¢æˆ·ç«¯(åŒ…æ‹¬Androidå’ŒIOSä»¥åŠå…¶ä»–)å°†æä¾›æ¥å£ä»¥ä¾¿jsæ‰“å¼€æˆ–å…³é—­webview. å€¼å¾—è€ƒè™‘çš„æ˜¯, è¿™é‡Œé¢å¯èƒ½å¸¦æ¥ä¸€ä¸ªè´Ÿé¢å½±å“, jsæœ‰å¯èƒ½å¤šæ¬¡ç”³è¯·æ–°å¼€webview, ä»è€Œå¤§é‡æ¶ˆè€—å†…å­˜å’Œç”µé‡. å› æ­¤, nativeæœ‰å¿…è¦å¯¹webviewçš„ä¸ªæ•°äºˆä»¥é™åˆ¶.</p>
<h3 id="nativeç»´æŠ¤H5çš„å†å²è®°å½•"><a href="#nativeç»´æŠ¤H5çš„å†å²è®°å½•" class="headerlink" title="nativeç»´æŠ¤H5çš„å†å²è®°å½•"></a>nativeç»´æŠ¤H5çš„å†å²è®°å½•</h3><p>æ—¢ç„¶å¼€å¤šä¸ªwebviewå¼€é”€ä¼šå¢å¤§, åŸºäºæ­¤, æˆ‘çªå‘å¥‡æƒ³, æœ‰æ²¡æœ‰å¯èƒ½ç”±nativeå®¢æˆ·ç«¯æ¥ç»´æŠ¤å•ä¸ªwebviewçš„å†å²è®°å½•, ä»è€Œæ‰€æœ‰çš„é¡µé¢è·³è½¬å°†ç”±nativeæ¥ç®¡?</p>
<p>æˆ‘è®¤ä¸ºè¿™æ˜¯æœ‰å¯èƒ½çš„. é¦–å…ˆnativeå¯ä»¥ä¿ç•™æ¯æ¬¡åŠ è½½çš„é¡µé¢é“¾æ¥, åŒæ—¶, é¡µé¢è·³è½¬æ—¶å¯æå‰è®¾ç½®ä¸‹ä¸€ä¸ªé¡µé¢çš„è¿”å›é€»è¾‘. æ—¢ç„¶å†å²è®°å½•å’Œè¿”å›é€»è¾‘éƒ½åœ¨nativeä¸­æ³¨å†Œ, å‰©ä¸‹çš„é—®é¢˜å°±æ˜¯, jsæ€ä¹ˆé€šçŸ¥nativeè¿”å›äº†? è¿™ä¸ªä¹Ÿå¾ˆç®€å•, nativeä¸æ­¢å¯ä»¥loadUrl, è¿˜å¯ä»¥loadé¡µé¢ä¸Šçš„æ–¹æ³•. åˆé¡µé¢ä¸Šç”¨äºè¿”å›çš„ä¸¤ä¸ªjsæ–¹æ³•: <code>history.go</code> å’Œ <code>history.back</code> éƒ½æ˜¯å¯ä»¥é‡å†™çš„. å› æ­¤, nativeå¯åœ¨é¡µé¢DOMContentLoadedäº‹ä»¶å›è°ƒä¸­é‡å†™goå’Œbackæ–¹æ³•, æ”¹ä¸ºè°ƒç”¨jsBridgeæ¥å£(æ­¤å‰, ä¸ºäº†è§£å†³ç¬¬ä¸‰æ–¹OAuth2.0ç™»å½•åè¿”å›åˆ°ç©ºç™½é¡µçš„é—®é¢˜, æˆ‘å†™äº†éƒ¨åˆ†nativeé€»è¾‘, ç”¨äºé‡å†™jsåŸç”Ÿgoå’Œbackæ–¹æ³•å·²åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨).</p>
<p>æ€è·¯å¦‚ä¸‹:</p>
<ol>
<li><p><strong>è®°å½•å†å²æ ˆ</strong>: nativeå­˜å‚¨webviewä¸­åŠ è½½çš„æ¯ä¸€ä¸ªé¡µé¢, å½¢æˆä¸€ä¸ªå†å²è®°å½•æ ˆ. å¹¶ä¸”æ ‡è®°å½“å‰é¡µé¢å¤„äºè¯¥å†å²è®°å½•æ ˆçš„ä½ç½®.</p>
</li>
<li><p><strong>é‡å†™è¿”å›æ–¹æ³•</strong>: webviewä¸­æ¯ä¸ªé¡µé¢åŠ è½½å®Œæˆå, é‡å†™<code>history.go</code> å’Œ <code>history.back</code>æ–¹æ³•, æ”¹ä¸ºè°ƒç”¨jsBridgeæ¥å£, æ–¹ä¾¿nativeæ„ŸçŸ¥ç½‘é¡µçš„åé€€. (ä¸‹é¢å°†è¯¦ç»†è¯´æ˜é‡å†™çš„æ—¶æœº)</p>
</li>
<li><p><strong>è®¾ç½®ä¸‹ä¸€ä¸ªé¡µé¢çš„è¿”å›é€»è¾‘</strong>: é¡µé¢è·³è½¬ä¹‹å‰, å¯è°ƒç”¨jsBridgeå¼ºåˆ¶è®¾ç½®ä¸‹ä¸€ä¸ªé¡µé¢çš„è¿”å›url(å¦‚ä»aè·³è½¬è‡³bé¡µé¢, è®¾ç½®å, æ— è®ºbå¤„äºå†å²è®°å½•æ ˆçš„å“ªä¸€é¡¹, ä»bè¿”å›éƒ½å°†å›åˆ°aé¡µé¢)</p>
</li>
<li><p><strong>å›é€€æ—¶æ£€æŸ¥å½“å‰é¡µé¢çš„è¿”å›é€»è¾‘</strong>: ä¸€æ—¦H5ä¸­è°ƒç”¨<code>history.go</code> å’Œ <code>history.back</code>æ–¹æ³•è¿”å›ä¹‹å‰çš„é¡µé¢, nativeè‡ªåŠ¨æ£€æŸ¥è¯¥é¡µé¢ä¹‹å‰æ˜¯å¦è®¾ç½®è¿‡è¿”å›url, å¦‚æœ‰åˆ™ä»å†å²è®°å½•æ ˆä¸­æå‡ºè¯¥urlçš„ä½ç½®, ç»§ç»­è°ƒç”¨jsåŸç”Ÿçš„<code>history.go</code>æ–¹æ³•è¿›è¡Œè·³è½¬, åŒæ—¶å¿½ç•¥æœ¬æ¬¡å†å²; å¦‚æ— åˆ™ç›´æ¥é€šè¿‡åŸæ–¹æ³•è·³è½¬é¡µé¢, åŒæ—¶å¿½ç•¥æœ¬æ¬¡å†å².</p>
</li>
<li><p>é‡å†™Androidè‡ªå¸¦çš„ç‰©ç†è¿”å›é”®.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ”¹å†™ç‰©ç†è¿”å›é”®çš„é€»è¾‘</span></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onKeyDown</span><span class="params">(<span class="keyword">int</span> keyCode, KeyEvent event)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span>(keyCode==KeyEvent.KEYCODE_BACK)&#123;</div><div class="line">    <span class="comment">//å‚ç…§ç¬¬4æ­¥ç­–ç•¥å®ç°</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p><strong>æ¿€è¿›ç­–ç•¥â€”æ‹¦æˆªé¡µé¢ä¸»åŠ¨å‘èµ·çš„é‡å®šå‘(é€‰ç”¨)</strong>: æ¯æ¬¡åŠ è½½urlå‰, éƒ½å°†æ£€æŸ¥è¯¥urlæ˜¯å¦åœ¨å½“å‰é¡µé¢ä¹‹å‰çš„å†å²è®°å½•æ ˆä¸­å‡ºç°è¿‡, å¦‚æœ‰åˆ™ç›´æ¥è°ƒç”¨jsåŸç”Ÿçš„<code>history.go</code>æ–¹æ³•, å›é€€åˆ°è¯¥urlåŸæ¥çš„é¡µé¢.</p>
</li>
</ol>
<p>æ³¨: è™½ç„¶è¿”å›æ—¶shouldOverrideUrlLoadingäº‹ä»¶ä¸ä¼šè§¦å‘, ä½†onPageStartedå’ŒonPageFinishedä¼šä¾æ¬¡è§¦å‘ä¸€æ¬¡. å› æ­¤ä¸Šè¿°ç¬¬4æ­¥è¿”å›æ—¶éœ€è¦å¿½ç•¥æœ¬æ¬¡å†å².</p>
<p>é‚£ä¹ˆå¦‚ä½•è®°å½•webviewå†å²æ ˆ, å¹¶ä¸”é‡å†™jsæ–¹æ³•å‘¢? </p>
<p>å«Œæˆ‘å•°å—¦, ä½ å¯èƒ½ä¼šè¯´ â€œTalk is cheap, show me the code.â€ é‚£ä¹ˆ, è¯·çœ‹å¦‚ä¸‹Androidä»£ç :</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">History</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> url;</div><div class="line">  <span class="keyword">public</span> backItem;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">History</span><span class="params">(String url)</span></span>&#123;</div><div class="line">    <span class="keyword">this</span>.url = url;</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">History</span><span class="params">(String url, History backItem)</span></span>&#123;</div><div class="line">    <span class="keyword">this</span>.url = url;</div><div class="line">    <span class="keyword">this</span>.backItem = backItem;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*-----------åä¸½ä¸½çš„classåˆ†ç•Œçº¿------------*/</span></div><div class="line"></div><div class="line">ArrayList&lt;History&gt; historyList = <span class="keyword">new</span> ArrayList&lt;History&gt;;</div><div class="line"></div><div class="line"><span class="comment">/*-----------åä¸½ä¸½çš„classåˆ†ç•Œçº¿------------*/</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebViewManager</span> </span>&#123;</div><div class="line">  <span class="comment">//æ­¤å¤„ç•¥å»webViewå…ƒç´ çš„è·å–</span></div><div class="line">  webView.setWebViewClient(<span class="keyword">new</span> WebViewClient() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageStarted</span><span class="params">(WebView view, String url, Bitmap favicon)</span> </span>&#123;</div><div class="line">      <span class="comment">// å­˜å‚¨å½“å‰é¡µé¢URL</span></div><div class="line">      History history = <span class="keyword">new</span> History(url);</div><div class="line">      historyList.append(history);</div><div class="line">      <span class="comment">// é‡å†™jsè¿”å›æ–¹æ³•</span></div><div class="line">      String fnString = <span class="string">"(function()&#123;/*åœ¨è¿™é‡Œé‡å†™history.goå’Œhistory.backæ–¹æ³•*/&#125;)()"</span>;</div><div class="line">      webView.loadUrl(<span class="string">"javascript:"</span> + fnString);</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢åªæ˜¯Simpleçš„ä½“éªŒ, å®é™…è¯·æ±‚ä¸­, ä¸€å®šä¼šæœ‰urlé‡å®šå‘åœºæ™¯. æ¥ä¸‹æ¥æˆ‘ä»¬å°†ç€é‡è®¨è®ºè¿™ç§åœºæ™¯.</p>
<h3 id="å¦‚ä½•åœ¨webviewä¸­åˆ¤æ–­é¡µé¢æ˜¯å¦åŠ è½½å®Œæˆ"><a href="#å¦‚ä½•åœ¨webviewä¸­åˆ¤æ–­é¡µé¢æ˜¯å¦åŠ è½½å®Œæˆ" class="headerlink" title="å¦‚ä½•åœ¨webviewä¸­åˆ¤æ–­é¡µé¢æ˜¯å¦åŠ è½½å®Œæˆ"></a>å¦‚ä½•åœ¨webviewä¸­åˆ¤æ–­é¡µé¢æ˜¯å¦åŠ è½½å®Œæˆ</h3><p>é¦–å…ˆ, åŠ è½½é¡µé¢æœ‰ä¸¤ç§æ–¹å¼:</p>
<ol>
<li>webviewä¸»åŠ¨loadUrl.</li>
<li>é¡µé¢ä¸Šè§¦å‘çš„urlåŠ è½½è¡Œä¸º.</li>
</ol>
<p>æˆ‘ä»¬å…ˆæ¥æ¨¡æ‹Ÿä¸€ä¸ª<strong>ä¸¤æ¬¡</strong>é‡å®šå‘çš„åœºæ™¯, é€šå¸¸æƒ…å†µä¸‹, ç›´æ¥è®¿é—® <a href="http://www.baidu.com" target="_blank" rel="external">http://www.baidu.com</a> å°†å‘ç”Ÿä¸€æ¬¡é‡å®šå‘. åœ¨æ­¤ä¹‹å‰ç”¨ä¸€ä¸ªçŸ­é“¾æ¥é‡å®šå‘åˆ° <a href="http://www.baidu.com" target="_blank" rel="external">http://www.baidu.com</a> è¿™æ ·ä¾¿å¤šäº†ä¸€æ¬¡é‡å®šå‘. ä¸‹é¢å°†åŸºäºè¿™ä¸ªåœºæ™¯è¿›è¡Œä¸¤æ¬¡æµ‹è¯•.</p>
<p>é‚£ä¹ˆç¬¬ä¸€ç§æ–¹å¼, å°†ä¾æ¬¡è§¦å‘webviewçš„ä»¥ä¸‹äº‹ä»¶å›è°ƒ:</p>
<p><img src="http://louiszhai.github.io/docImages/back01.png" alt="webviewä¸»åŠ¨loadUrl"></p>
<p>æ•´ç†å¦‚ä¸‹:</p>
<ol>
<li>onPageStarted</li>
<li>onPageStarted</li>
<li>shouldOverrideUrlLoading</li>
<li>onPageFinished</li>
<li>onPageStarted</li>
<li>onPageStarted</li>
<li>shouldOverrideUrlLoading</li>
<li>onPageFinished</li>
<li>onPageStarted</li>
<li>onPageFinished</li>
</ol>
<p>ç¬¬äºŒç§æ–¹å¼, å°†ä¾æ¬¡è§¦å‘webviewçš„ä»¥ä¸‹äº‹ä»¶å›è°ƒ:</p>
<p><img src="http://louiszhai.github.io/docImages/back02.png" alt="é¡µé¢ä¸Šè§¦å‘çš„urlåŠ è½½è¡Œä¸º"></p>
<p>æ•´ç†å¦‚ä¸‹:</p>
<ol>
<li>shouldOverrideUrlLoading</li>
<li>onPageStarted</li>
<li>onPageStarted</li>
<li>shouldOverrideUrlLoading</li>
<li>onPageFinished</li>
<li>onPageStarted</li>
<li>onPageStarted</li>
<li>shouldOverrideUrlLoading</li>
<li>onPageFinished</li>
<li>onPageStarted</li>
<li>onPageFinished</li>
</ol>
<p>å¯è§, é™¤äº†æœ€åä¸€æ¬¡onPageFinishedäº‹ä»¶, å…¶ä»–çš„onPageFinishedäº‹ä»¶éƒ½ç´§è·ŸshouldOverrideUrlLoadingäº‹ä»¶ä¹‹åè§¦å‘.</p>
<p>åŸºäºä¸Šè¿°ç°è±¡, å¯ä»¥è®¾ç½®å…¨å±€çŠ¶æ€ä½(flag), onPageStartedè§¦å‘æ—¶è®¾ç½®ä¸º<code>true</code>, shouldOverrideUrlLoadingè§¦å‘æ—¶è®¾ç½®ä¸º<code>false</code>, onPageFinishedè§¦å‘æ—¶, åˆ¤æ–­flagæ˜¯å¦ä¸ºtrue, å¦‚æœä¸ºtrueåˆ™æ„å‘³ç€é¡µé¢åŠ è½½å®Œæˆ, æ­¤æ—¶ä¾¿å¯æ”¾å¿ƒçš„è®°å½•é¡µé¢urlä»¥åŠé‡å†™jsåŸç”Ÿè¿”å›æ–¹æ³•.</p>
<h3 id="åŸºäºhashè·³è½¬äº§ç”Ÿçš„å†å²é¡¹å¦‚ä½•è®°å½•"><a href="#åŸºäºhashè·³è½¬äº§ç”Ÿçš„å†å²é¡¹å¦‚ä½•è®°å½•" class="headerlink" title="åŸºäºhashè·³è½¬äº§ç”Ÿçš„å†å²é¡¹å¦‚ä½•è®°å½•"></a>åŸºäºhashè·³è½¬äº§ç”Ÿçš„å†å²é¡¹å¦‚ä½•è®°å½•</h3><p>ä¸Šè¿°æ–¹æ³•çœŸçš„å¯ä»¥è®°å½•webviewæ‰€æœ‰çš„å†å²é¡¹å—?</p>
<p>å…¶å®è¿˜ä¸èƒ½. å®é™…ä¸Š, webviewçš„ç½‘é¡µä¸Šè¿›è¡Œhashè·³è½¬æ—¶, onPageStarted å’Œ shouldOverrideUrlLoading éƒ½ä¸ä¼šè§¦å‘. æ‰€å¹¸çš„æ˜¯ onPageFinished èƒ½å¤Ÿæ„ŸçŸ¥åˆ°hashå€¼çš„å˜åŒ–. æˆ‘ä»¬å¯ä»¥åœ¨è¯¥æ–¹æ³•å†…ç»§ç»­ç»´æŠ¤å†å²è®°å½•æ ˆ.</p>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>è‡³æ­¤, æˆ‘æƒ³, åŸºäºnativeçš„è¿™å¥—è¿”å›æ–¹æ¡ˆåº”è¯¥æ˜¯å¯è¡Œ. ä½†æœ‰nativeçš„åŒå­¦å‘ŠçŸ¥: æœ‰äº›é¡µé¢nativeæ— æ³•è®°å½•é¡µé¢url? è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢? è‡³å°‘åˆ°ç›®å‰ä¸ºæ­¢, æˆ‘è¿˜æ²¡æœ‰å‘ç°è¿™æ ·çš„åœºæ™¯. æ¬¢è¿é˜…è¯»æœ¬æ–‡çš„ä½ ç•™ä¸‹ä¸ªè„šå°, ä¸€èµ·è®¨è®ºå’Œå®Œå–„web appè¿”å›æ–¹æ¡ˆ.</p>
<hr>
<p>æœ¬é—®å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2017/02/20/back/">http://louiszhai.github.io/2017/02/20/back/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="http://chuansong.me/n/361100051028" target="_blank" rel="external">æµ…è°ˆWebViewçš„é¡µé¢è·³è½¬_éƒ­éœ–_ä¼ é€é—¨</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      webè¿”å› HybirdAppè¿”å› H5è¿”å› appè¿”å›
    
    </summary>
    
    
      <category term="Web" scheme="http://louiszhai.github.io/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>box-shadowå±æ€§æ¢ç§˜</title>
    <link href="http://louiszhai.github.io/2017/02/19/box-shadow/"/>
    <id>http://louiszhai.github.io/2017/02/19/box-shadow/</id>
    <published>2017-02-19T08:23:34.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>æˆ‘æ€»æ˜¯è®°ä¸ä½css3çš„box-shadowå±æ€§æ‹¥æœ‰å‡ ä¸ªå€¼, å®ƒä»¬çš„é¡ºåºç©¶ç«Ÿå¦‚ä½•? å¯¹æˆ‘æ¥è¯´, è¿™æ˜¯ä¸€ä¸ªå¤§éš¾é¢˜. æˆ‘ä»¬éƒ½çŸ¥é“, ä½¿ç”¨ä¸€ä¸ªå±æ€§, æ€»æ˜¯å¯ä»¥ä¸åœåœ°åœ¨å¼€å‘è€…å·¥å…·ä¸Šæµ‹è¯•UIè¡¨ç°, ç›´åˆ°è¡¨ç°ä»¤äººæ»¡æ„. å¥½å§, æœ‰äº›æ—¶å€™å®ƒæ˜¯å¥æ•ˆçš„; è€Œå…¶å®ƒæ—¶å€™å‘¢, æˆ‘ä»¬ä¼šæ¶ˆè€—æ—¶é—´, ç§¯æ”’ç–²åŠ³å€¼, ä»¥åŠæˆå°±æ„Ÿä¸‹é™ç­‰. ä¸€æ—¦çŸ­æ—¶è®°å¿†å¤±æ•ˆ, æˆ‘ä»¬å®Œå…¨æœ‰å¯èƒ½é‡å¤ä¸€éä¹‹å‰ä¸æ„‰å¿«åœ°å°è¯•. å› æ­¤æˆ‘é€‰æ‹©å¤šèŠ±äº›æ—¶é—´, ç”¨åŠ›ä¸€æ¬¡è®°ä½å®ƒ. å¦‚æœä½ æ°å¥½ä¹Ÿæœ‰åŒæ ·çš„ç–‘æƒ‘, è¯·è¯»ä¸‹å».</p>
<a id="more"></a>
<h3 id="box-shadow"><a href="#box-shadow" class="headerlink" title="box-shadow"></a>box-shadow</h3><p>box-shadowç”¨äºåˆ›å»ºé˜´å½±, ä½¿å¾—å…ƒç´ æ›´æœ‰ç«‹ä½“æ„Ÿ, å®ƒçš„å€¼ç”±ä»¥ä¸‹å…­ä¸ªéƒ¨åˆ†ç»„æˆ:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: <span class="selector-tag">offsetX</span> <span class="selector-tag">offsetY</span> <span class="selector-tag">blur</span> <span class="selector-tag">spread</span> <span class="selector-tag">color</span> <span class="selector-tag">position</span>;</div></pre></td></tr></table></figure>
<p>å®ƒä»¬åˆ†åˆ«ä¸º: xè½´åç§» yè½´åç§» æ¨¡ç³ŠåŠå¾„ å¤§å° é¢œè‰² ä½ç½®.</p>
<p>xyè½´åç§», å‚ç…§cssä¸­çš„åæ ‡ç³», æ°´å¹³å‘å³(â†’)ä¸ºXè½´æ­£æ–¹å‘, å‚ç›´å‘ä¸‹(â†“)ä¸ºYè½´æ­£æ–¹å‘.</p>
<h4 id="offsetX"><a href="#offsetX" class="headerlink" title="offsetX"></a>offsetX</h4><p>å³æ°´å¹³åç§», å€¼å–æ­£æ•°æ—¶, é˜´å½±ä½äºå…ƒç´ å³è¾¹, å€¼å–è´Ÿæ•°æ—¶, é˜´å½±ä½äºå…ƒç´ å·¦è¾¹.</p>
<p>ä¸ºäº†ä¾¿äºè§‚å¯Ÿåˆ°æ•ˆæœ, æˆ‘å°†æ¨¡ç³ŠåŠå¾„é»˜è®¤è®¾ç½®æˆ10px.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 20<span class="selector-tag">px</span> 0 10<span class="selector-tag">px</span> 0 <span class="selector-tag">lightblue</span>; <span class="comment">/*é˜´å½±å‘å³åç§»20px*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow01.png" alt="offsetXä¸ºæ­£å€¼"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: <span class="selector-tag">-20px</span> 0 10<span class="selector-tag">px</span> 0 <span class="selector-tag">lightblue</span>; <span class="comment">/*é˜´å½±å‘å·¦åç§»20px*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow02.png" alt="offsetXä¸ºè´Ÿå€¼"></p>
<h4 id="offsetY"><a href="#offsetY" class="headerlink" title="offsetY"></a>offsetY</h4><p>å³å‚ç›´åç§», å€¼å–æ­£æ•°æ—¶, é˜´å½±ä½äºå…ƒç´ ä¸‹æ–¹, å€¼å–è´Ÿæ•°æ—¶, é˜´å½±ä½äºå…ƒç´ ä¸Šæ–¹.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 0 10<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> 0 <span class="selector-tag">lightblue</span>; <span class="comment">/*é˜´å½±å‘ä¸‹åç§»10px*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow03.png" alt="offsetYä¸ºæ­£å€¼"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 0 <span class="selector-tag">-10px</span> 10<span class="selector-tag">px</span> 0 <span class="selector-tag">lightblue</span>; <span class="comment">/*é˜´å½±å‘ä¸Šåç§»10px*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow04.png" alt="offsetYä¸ºè´Ÿå€¼"></p>
<h4 id="blur"><a href="#blur" class="headerlink" title="blur"></a>blur</h4><p>è®¾ç½®é˜´å½±çš„æ¨¡ç³ŠåŠå¾„, å€¼è¶Šå¤§æ—¶, é˜´å½±å°±è¶Šæ¨¡ç³Š, å€¼ä¸º0æ—¶åˆ™å®Œå…¨ä¸æ¨¡ç³Š, å€¼å°äº0æ—¶åˆ™æŒ‰ç…§0å¤„ç†.</p>
<p>æˆ‘è¯•ç€åŠ å¤§æ¨¡ç³ŠåŠå¾„, å–å€¼ä¸º50px, å¯ä»¥çœ‹åˆ°é˜´å½±å˜å¾—éå¸¸æ¨¡ç³Š.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 20<span class="selector-tag">px</span> 0 50<span class="selector-tag">px</span> 0 <span class="selector-tag">lightblue</span>; <span class="comment">/*é˜´å½±å‘å³åç§»20px, æ¨¡ç³ŠåŠå¾„ç”±10pxæ”¾å¤§è‡³50px*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow05.png" alt="offsetX+blur"></p>
<p>åŒæ—¶, ä¸Šä¸‹è¾¹ç•Œä¹Ÿæœ‰æ¨¡ç³Šé˜´å½±, ç†è®ºä¸Šè®², æ¨¡ç³ŠåŠå¾„åœ¨ä¸Šä¸‹å·¦å³å„ä¸ªæ–¹å‘åº”è¯¥éƒ½æœ‰æ•ˆæœ, ä¸‹é¢æˆ‘ä»¬æ¥éªŒè¯ä¹‹:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 0 0 50<span class="selector-tag">px</span> 0 <span class="selector-tag">lightblue</span>; <span class="comment">/*æ¨¡ç³ŠåŠå¾„è®¾ç½®ä¸º50px, æ— åç§»*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow06.png" alt="blur"></p>
<p>å¦‚ä¸Šå›¾, åŒçŒœæƒ³ä¸€è‡´, æ¨¡ç³Šé˜´å½±åœ¨ä¸Šä¸‹å·¦å³4ä¸ªæ–¹å‘åˆ†åˆ«å‘æ•£. æ­¤æ—¶, å¯¹è§’çº¿æ–¹å‘ä¸Šé˜´å½±æ˜¯æœ€æ·¡çš„, è¦æƒ³æ¨¡ç³Šé˜´å½±å‡åŒ€åˆ†å¸ƒåœ¨å…ƒç´ å‘¨å›´, åªéœ€å°†å…ƒç´ è®¾ç½®ä¸ºåœ†å½¢å³å¯.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 0 0 50<span class="selector-tag">px</span> 0 <span class="selector-tag">lightblue</span>; <span class="comment">/*æ¨¡ç³ŠåŠå¾„è®¾ç½®ä¸º50px, æ— åç§»*/</span></div><div class="line"><span class="selector-tag">border-radius</span>: 100%; <span class="comment">/*å…ƒç´ è®¾ç½®ä¸ºåœ†å½¢*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow07.png" alt="blur-circle"></p>
<h4 id="spread"><a href="#spread" class="headerlink" title="spread"></a>spread</h4><p>è®¾ç½®é˜´å½±å¤§å°. å½“blurå€¼ä¸º0æ—¶, spreadå°±åƒæ˜¯å…ƒç´ èƒŒåçš„ä¸€å—å¹•å¸ƒ, spreadå€¼è¶Šå¤§, é˜´å½±è¶Šå®½, å½“å…¶å–è´Ÿå€¼æ—¶, é˜´å½±å¤§å°ä¸ºå…ƒç´ é«˜å®½åˆ†åˆ«å‡å»spreadå€¼, æ­¤æ—¶, blurè®¾ç½®çš„æ¨¡ç³Šé˜´å½±åˆ™ä¼šå‘å†…é æ‹¢.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 0 0 0 10<span class="selector-tag">px</span> <span class="selector-tag">lightblue</span>; <span class="comment">/*é˜´å½±å¤§å°è®¾ç½®ä¸º+10px*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow08.png" alt="spread"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 0 0 10<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> <span class="selector-tag">lightblue</span>; <span class="comment">/*æ¨¡ç³ŠåŠå¾„è®¾ç½®ä¸º10px, é˜´å½±å¤§ä¸‹ä¸º+10px*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow09.png" alt="spread"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 0 0 10<span class="selector-tag">px</span> <span class="selector-tag">-1px</span> <span class="selector-tag">lightblue</span>; <span class="comment">/*æ¨¡ç³ŠåŠå¾„è®¾ç½®ä¸º10px, é˜´å½±å¤§ä¸‹ä¸º-1px, ç”±äºæ¨¡ç³Šé˜´å½±éƒ¨åˆ†å‘å†…é æ‹¢, é˜´å½±å˜å¾—éå¸¸è–„*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow10.png" alt="spread+blur"></p>
<p>ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ° ,å¯¹äºé˜´å½±å¤§å°, æˆ‘ä½¿ç”¨çš„æ˜¯+10px æˆ–è€… -1pxè¿™æ ·çš„å•ä½, è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢? è¿™é‡Œå–ä¸ªå…³å­å…ˆ, è¯·çœ‹å¦‚ä¸‹æ•ˆæœ.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 150<span class="selector-tag">px</span> 0 0 0<span class="selector-tag">px</span> <span class="selector-tag">lightblue</span>;</div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow19.png" alt="offsetX+spread"></p>
<p>ä»…ä»…å°†é˜´å½±æ°´å¹³å‘å³ç§»åŠ¨ä¸€æ®µè·ç¦», å¯è§, é˜´å½±æ˜¯æœ‰é»˜è®¤å¤§å°çš„, å¹¶ä¸”é»˜è®¤ä¸å…ƒç´ æ˜¯ä¸€èˆ¬å¤§å°. è€Œè¿™å‡ ä¹æ‰“ç ´äº†æˆ‘ä¸€åº¦çš„è®¤çŸ¥, è¯´å¥½çš„é˜´å½±å‘¢, ä¸æ˜¯ç¯ç»•å—!</p>
<p>å‰é¢æåˆ°äº†åœ†å½¢é˜´å½±, å®é™…ä¸Š, å°±æ˜¯<code>border-radius:100%</code>çš„ç‰¹ä¾‹, é‚£ä¹ˆå¦‚æœborder-radiusæ˜¯ä¸€ä¸ªå…·ä½“çš„å€¼å‘¢, æ­¤æ—¶é˜´å½±åˆè¯¥å½“å¦‚ä½•å‘ˆç°? è¯·è€å¿ƒå¾€ä¸‹çœ‹, æˆ‘å°†åœ¨å¤šé‡é˜´å½±çš„èŠ‚ç‚¹ç»™å‡ºåˆ†æ.</p>
<h4 id="color"><a href="#color" class="headerlink" title="color"></a>color</h4><p>è®¾ç½®é˜´å½±çš„é¢œè‰². æ”¯æŒå¸¸ç”¨è‰²å€¼, HEX(16è¿›åˆ¶), RGB, RGBA, HSL, HSLAç­‰é¢œè‰²å•ä½. ä»¥ä¸‹é¢œè‰²å…¨éƒ¨éƒ½æ˜¯æµ…è“è‰².</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 0 0 10<span class="selector-tag">px</span> 0 <span class="selector-tag">lightblue</span>;</div><div class="line"><span class="selector-tag">box-shadow</span>: 0 0 10<span class="selector-tag">px</span> 0 <span class="selector-id">#add8e6</span>;</div><div class="line"><span class="selector-tag">box-shadow</span>: 0 0 10<span class="selector-tag">px</span> 0 <span class="selector-tag">rgba</span>(173, 216, 230, 1);</div><div class="line"><span class="selector-tag">box-shadow</span>: 0 0 10<span class="selector-tag">px</span> 0 <span class="selector-tag">hsla</span>(195, 53%, 79%, 1);</div></pre></td></tr></table></figure>
<h4 id="position"><a href="#position" class="headerlink" title="position"></a>position</h4><p>è®¾ç½®é˜´å½±çš„ä½ç½®, é»˜è®¤ä¸ºå¤–éƒ¨é˜´å½±, å¯é€šè¿‡insetå€¼æ¥è®¾ç½®å†…éƒ¨é˜´å½±.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 0 0 20<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> <span class="selector-tag">lightblue</span>; <span class="comment">/*é»˜è®¤ä¸ºå¤–éƒ¨é˜´å½±*/</span></div><div class="line"><span class="selector-tag">box-shadow</span>: 0 0 20<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> <span class="selector-tag">lightblue</span> <span class="selector-tag">inset</span>; <span class="comment">/*è®¾ç½®ä¸ºinsetæ—¶, ä¸ºå†…éƒ¨é˜´å½±*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow11.png" alt="inset"></p>
<h3 id="å¤šé‡é˜´å½±"><a href="#å¤šé‡é˜´å½±" class="headerlink" title="å¤šé‡é˜´å½±"></a>å¤šé‡é˜´å½±</h3><p>box-shadowåŒbackgroundå±æ€§ä¸€æ ·, å®ƒä»¬éƒ½æ”¯æŒå¤šé‡æ•ˆæœçš„è®¾ç½®, ä¸”å¤šé‡å€¼ä»¥é€—å·åˆ†éš”.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 0 0 20<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> <span class="selector-tag">lightblue</span>,</div><div class="line">            0 0 20<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> <span class="selector-tag">lightblue</span> <span class="selector-tag">inset</span>; <span class="comment">/*åŒæ—¶è®¾ç½®å†…å¤–é˜´å½±*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow12.png" alt="å†…å¤–é˜´å½±"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: 10<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> 0<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> <span class="selector-id">#d0268c</span>,</div><div class="line">            <span class="selector-tag">-10px</span> <span class="selector-tag">-10px</span> 0<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(95, 167, 44, 0<span class="selector-class">.56</span>),</div><div class="line">            0<span class="selector-tag">px</span> 0<span class="selector-tag">px</span> 0<span class="selector-tag">px</span> 20<span class="selector-tag">px</span> <span class="selector-tag">lightgrey</span>; <span class="comment">/*å¤šé‡é˜´å½±æ•ˆæœ*/</span></div></pre></td></tr></table></figure>
<p><img src="http://louiszhai.github.io/docImages/box-shadow13.png" alt="å¤šé‡é˜´å½±"></p>
<p>ä¸Šé¢ç•™ä¸‹äº†ä¸€ä¸ªé—®é¢˜, ç­”æ¡ˆå°±åœ¨ä¸‹é¢çš„æ ·å¼ä¸­.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">border-radius</span>: 10<span class="selector-tag">px</span>;</div><div class="line"><span class="selector-tag">box-shadow</span>: 110<span class="selector-tag">px</span> 0 0 <span class="selector-tag">-10px</span> <span class="selector-id">#ccc</span>, 220<span class="selector-tag">px</span> 0 0 0 <span class="selector-id">#808080</span>, 360<span class="selector-tag">px</span> 0 0 10<span class="selector-tag">px</span> <span class="selector-tag">grey</span>;</div></pre></td></tr></table></figure>
<p>ç›´æ¥ä¸Šæ•ˆæœ.</p>
<p><img src="http://louiszhai.github.io/docImages/box-shadow20.png" alt="border-radiuså½±å“spreadçš„æ•ˆæœ"></p>
<p>ä»ç¬¬ä¸€ä¸ªé˜´å½±å¼€å§‹(ä¸Šå›¾å·¦äºŒ), éšç€é˜´å½±spreadå€¼çš„å˜åŒ–, é˜´å½±ç»å†äº†è¾¹æ¡†ç›´è§’, è¾¹æ¡†åœ†è§’, è¾¹æ¡†æ›´åœ†è§’(è¯ç©·)çš„è¿‡ç¨‹.</p>
<p>è¿™ä¸¤ä¸ªå±æ€§çš„å…³ç³»å¦‚ä¸‹: </p>
<ul>
<li>spreadå€¼è¶Šå¤§, border-radiusçš„å€¼å°±è¶Šå¤§, å½“spread&lt;0æ—¶, border-radiusä¼šå˜å°, æœ€å°ä¸º0.</li>
</ul>
<h3 id="æœ‰è¶£çš„æ•ˆæœ"><a href="#æœ‰è¶£çš„æ•ˆæœ" class="headerlink" title="æœ‰è¶£çš„æ•ˆæœ"></a>æœ‰è¶£çš„æ•ˆæœ</h3><h4 id="çº¸å¼ æŠ•å½±æ•ˆæœ"><a href="#çº¸å¼ æŠ•å½±æ•ˆæœ" class="headerlink" title="çº¸å¼ æŠ•å½±æ•ˆæœ"></a>çº¸å¼ æŠ•å½±æ•ˆæœ</h4><p>å…ˆæ¥çœ‹ä»¥ä¸‹çº¸å¼ æŠ•å½±æ•ˆæœæ˜¯ä¸ªä»€ä¹ˆæ ·.</p>
<p><img src="http://louiszhai.github.io/docImages/box-shadow14.png" alt="paper-shadow"></p>
<p>ä¸å°±æ˜¯åœ¨çº¸å¼ åº•éƒ¨åŠ ä¸ªæŠ•å½±å—, æ˜¯çš„, ä½ æ²¡çœ‹é”™. è¿™æ ·çš„æŠ•å½±, å®ç°èµ·æ¥ç°å¸¸ç®€å•, åªéœ€è¦å…ƒç´ åº•éƒ¨å·¦å³å„åŠ ä¸€ä¸ªbox-shadow, ç„¶åä½ä»¥transformå˜æ¢, ç¨å¾®æ”¹å˜ä¸ªè§’åº¦å°±å¤§åŠŸå‘Šæˆäº†. ä¸‹é¢æˆ‘ä»¬æ¥ç”¨ä¸‰æ­¥å®ç°å®Œæˆå®ƒ.</p>
<h5 id="å‡†å¤‡å…ƒç´ "><a href="#å‡†å¤‡å…ƒç´ " class="headerlink" title="å‡†å¤‡å…ƒç´ "></a>å‡†å¤‡å…ƒç´ </h5><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></div><div class="line">  <span class="selector-class">.drop-shadow</span> &#123;</div><div class="line">    <span class="attribute">position</span>: relative;</div><div class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</div><div class="line">    <span class="attribute">background</span>: <span class="number">#CCC</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="selector-class">.vertical-line</span>&#123;</div><div class="line">    <span class="attribute">position</span>: relative;</div><div class="line">    <span class="attribute">height</span>: <span class="number">96%</span>;</div><div class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">top</span>: <span class="number">2%</span>;</div><div class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</div><div class="line">    <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="number">#808080</span>;</div><div class="line">  &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"shadow"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"vertical-line"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>é˜¶æ®µæ€§æ•ˆæœå¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/box-shadow15.png" alt="paper-shadow-part01"></p>
<h5 id="æ·»åŠ é˜´å½±æ ·å¼"><a href="#æ·»åŠ é˜´å½±æ ·å¼" class="headerlink" title="æ·»åŠ é˜´å½±æ ·å¼"></a>æ·»åŠ é˜´å½±æ ·å¼</h5><p>å…ˆåœ¨å…ƒç´ åº•éƒ¨å·¦å³ä¸¤è¾¹å„ç”Ÿæˆä¸€ä¸ªé˜´å½±, é˜´å½±åº”è¯¥æ˜¯å‚ç›´å‘ä¸‹çš„, å’Œæ¨¡ç³Šçš„, é‚£ä¹ˆå±æ€§å¦‚ä¸‹è®¾ç½®.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.shadow</span><span class="selector-pseudo">::before</span>, <span class="selector-class">.shadow</span><span class="selector-pseudo">::after</span> &#123;</div><div class="line">    <span class="attribute">content</span>: <span class="string">""</span>;</div><div class="line">    <span class="attribute">position</span>: absolute;</div><div class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">width</span>: <span class="number">50%</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">10%</span>;</div><div class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">15px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(125, 125, 125, 0.9);</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.drop-shadow</span><span class="selector-pseudo">::after</span>&#123;</div><div class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</div><div class="line">  <span class="attribute">left</span>: auto;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é˜¶æ®µæ€§æ•ˆæœå¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/box-shadow16.png" alt="paper-shadow-part02"></p>
<p>è¿™ä¸ªæ—¶å€™, é˜´å½±åŸºæœ¬ä¸Šå‘ˆç°äº†, ä½†æœ‰ä¸¤ç‚¹ä¸å¤ªå®Œç¾:</p>
<ul>
<li>å·¦å³é˜´å½±åº”è¯¥æ˜¯å€¾æ–œçš„;</li>
<li>åº•éƒ¨é˜´å½±æœ‰äº›å¤ªåš, ä¸”è¾¹ç¼˜éƒ¨åˆ†åº”è¯¥æ·¡åŒ–.</li>
</ul>
<p>å€¾æ–œå¯ä½¿ç”¨ <code>transform: rotate(5deg)</code> å®ç°. é˜´å½±å¤ªåšæˆ–è¾¹ç¼˜æ·¡åŒ–åªéœ€å°†é˜´å½±å¾€å†…æ”¶ä¸€äº›å°±è¡Œ, å¦‚ <code>bottom: 20px; left:10px</code> ç­‰.</p>
<h5 id="ç»™é˜´å½±åŠ ä¸ªè§’åº¦å¹¶æ”¶ç¼©ä¸€äº›"><a href="#ç»™é˜´å½±åŠ ä¸ªè§’åº¦å¹¶æ”¶ç¼©ä¸€äº›" class="headerlink" title="ç»™é˜´å½±åŠ ä¸ªè§’åº¦å¹¶æ”¶ç¼©ä¸€äº›"></a>ç»™é˜´å½±åŠ ä¸ªè§’åº¦å¹¶æ”¶ç¼©ä¸€äº›</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.shadow</span><span class="selector-pseudo">::before</span>, <span class="selector-class">.shadow</span><span class="selector-pseudo">::after</span> &#123;</div><div class="line">    <span class="attribute">content</span>: <span class="string">""</span>;</div><div class="line">    <span class="attribute">position</span>: absolute;</div><div class="line">    <span class="attribute">bottom</span>: <span class="number">20px</span>;</div><div class="line">    <span class="attribute">left</span>: <span class="number">10px</span>;</div><div class="line">    <span class="attribute">width</span>: <span class="number">50%</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">10%</span>;</div><div class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">20px</span> <span class="number">30px</span> <span class="built_in">rgba</span>(125, 125, 125, 0.9);</div><div class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-5deg);</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.drop-shadow</span><span class="selector-pseudo">::after</span>&#123;</div><div class="line">  <span class="attribute">right</span>: <span class="number">10px</span>;</div><div class="line">  <span class="attribute">left</span>: auto;</div><div class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(5deg);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é˜¶æ®µæ€§æ•ˆæœå¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/box-shadow17.png" alt="paper-shadow-part03"></p>
<p>å¯ä»¥çœ‹åˆ°, é˜´å½±å‡ºç°åœ¨å…ƒç´ ä¹‹ä¸Š. å¯è®¾ç½®<code>z-index</code> ä¸º-1, å°†é˜´å½±å±‚çº§é™ä½ä¸€äº›, è¿™æ ·å°±å®ç°äº†ä¸Šè¿°æ‰€è¯´çš„çº¸å¼ é˜´å½±æ•ˆæœ.</p>
<p><img src="http://louiszhai.github.io/docImages/box-shadow14.png" alt="paper-shadow"></p>
<h4 id="å‡èµ·æ•ˆæœ"><a href="#å‡èµ·æ•ˆæœ" class="headerlink" title="å‡èµ·æ•ˆæœ"></a>å‡èµ·æ•ˆæœ</h4><p>åŒæ ·, æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹å‡èµ·æ•ˆæœé•¿ä»€ä¹ˆæ ·. å¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/box-shadow18.gif" alt="paper-shadow-part02"></p>
<p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„åŠ¨ç”», é¼ æ ‡ç§»å…¥, å…ƒç´ ä¸Šç§», åŒæ—¶é˜´å½±ç¼©å°, é¼ æ ‡ç§»å‡ºåˆ™åä¹‹. è¿™é‡Œ, æˆ‘ä»¬åˆ†ä¸¤æ­¥æ¥å®ç°å®ƒ.</p>
<h5 id="å‡†å¤‡å…ƒç´ å’Œé˜´å½±"><a href="#å‡†å¤‡å…ƒç´ å’Œé˜´å½±" class="headerlink" title="å‡†å¤‡å…ƒç´ å’Œé˜´å½±"></a>å‡†å¤‡å…ƒç´ å’Œé˜´å½±</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></div><div class="line">  <span class="selector-class">.rose</span> &#123;</div><div class="line">    <span class="attribute">position</span>: relative;</div><div class="line">    <span class="attribute">width</span>: <span class="number">80px</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">120px</span>;</div><div class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(0,0,0,0.2);</div><div class="line">    <span class="attribute">transition</span>: transform <span class="number">1s</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="selector-class">.rose</span><span class="selector-pseudo">::after</span> &#123;</div><div class="line">    <span class="attribute">content</span>: <span class="string">""</span>;</div><div class="line">    <span class="attribute">position</span>: absolute;</div><div class="line">    <span class="attribute">bottom</span>: -<span class="number">30px</span>;</div><div class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">8px</span>;</div><div class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</div><div class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</div><div class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(0,0,0,0.2);</div><div class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-50%, 0);</div><div class="line">    <span class="attribute">transition</span>: transform <span class="number">1s</span>;</div><div class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">0px</span> <span class="number">15px</span> <span class="number">0px</span> <span class="built_in">rgba</span>(0,0,0,0.2);</div><div class="line">  &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"rose"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h5 id="æ·»åŠ åŠ¨ç”»"><a href="#æ·»åŠ åŠ¨ç”»" class="headerlink" title="æ·»åŠ åŠ¨ç”»"></a>æ·»åŠ åŠ¨ç”»</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.rose</span><span class="selector-pseudo">:hover</span> &#123;</div><div class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-40px);</div><div class="line">    <span class="attribute">transition</span>: transform <span class="number">1s</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.rose</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">::after</span> &#123;</div><div class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-50%, 40px) <span class="built_in">scale</span>(0.75);</div><div class="line">  <span class="attribute">transition</span>: transform <span class="number">1s</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="box-decoration-break"><a href="#box-decoration-break" class="headerlink" title="box-decoration-break"></a>box-decoration-break</h3><p>æ¬²äº†è§£è¿™ä¸ªå±æ€§, æˆ‘ä»¬å…ˆè¯»ä¸€åˆ™è§„èŒƒ.</p>
<p>2016å¹´1æœˆ14æ—¥, W3Cå‘å¸ƒäº†CSSç‰‡æ®µæ¨¡å—(<a href="https://www.w3.org/TR/2016/CR-css-break-3-20160114/" target="_blank" rel="external">CSS Fragmentation Module Level 3</a>)çš„å€™é€‰æ¨èæ ‡å‡†, æ˜ç¡®å®šä¹‰äº†åœ¨ç›’é—´ã€ç›’å†…ã€è¡Œé—´ã€é¡µé—´è¿›è¡Œæ–­è¡Œçš„å±æ€§å’Œè§„åˆ™.</p>
<p>ç®€è¨€ä¹‹, å¯¹äºä¸€ä¸ªç›’å­æ¨¡å‹, å¦‚æœå®ƒè¢«åˆ†è£‚æˆå¤šä¸ªé•¿åº¦ä¸ç­‰çš„å°ç¢ç‰‡, é‚£ä¹ˆå®ƒå°†éµå¾ªä»¥ä¸‹è§„åˆ™æ¥è°ƒæ•´å¸ƒå±€:</p>
<ul>
<li>å¸ƒå±€å°†åœ¨æ¯ä¸ªç¢ç‰‡ä¸­ç”Ÿæ•ˆ, å¹¶åœ¨æ–­ç‚¹å¤„è¡”æ¥èµ·æ¥. ä½†æ˜¯é‡æ–°è®¡ç®—å¤§å°å’Œä½ç½®.</li>
<li>åç»­ç¢ç‰‡å¿…é¡»éµå¾ªå®šä½è§„åˆ™, å¹¶ä¸”ä¸èƒ½é«˜äºå‰é¢ç¢ç‰‡çš„è¾¹ç¼˜. å¦‚æœæƒ³å»¶ç»­ç¢ç‰‡å¼€å§‹æ—¶çš„è¾¹ç¼˜, éœ€æŒ‡å®š <code>box-decoration-break</code> ä¸º <code>clone</code>, é‚£ä¹ˆpadding å’Œ border å°†åŒ…è£¹åç»­ç¢ç‰‡çš„è¾¹ç¼˜.</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´, å½“è¡Œå†…å…ƒç´ æ¢è¡Œå, border, backgroundå°†ä¼šå‡ºç°æˆªæ–­ç°è±¡, box-shadowä¹Ÿä¼šå¦‚æ­¤. å¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/box-shadow21.png" alt="box-decoration-break:slice"></p>
<p>å®é™…ä¸Š, è¿™ç§æ•ˆæœå¹¶éä¸å¯æ”¹å˜, è®¾ç½® <code>box-decoration-break:clone</code> , ä»¥ä¸Šå„ä¸ªcssæ•ˆæœå°†æ¯è¡Œé‡æ–°æ¸²æŸ“, å½¼æ­¤ç›¸äº’ç‹¬ç«‹.</p>
<p><img src="http://louiszhai.github.io/docImages/box-shadow22.png" alt="box-decoration-break:clone"></p>
<p>box-decoration-breakå±æ€§ç”¨äºæè¿°ç›’å­ç¢ç‰‡(å¦‚è·¨è¡Œçš„inlineå…ƒç´ çš„å„ä¸ªéƒ¨åˆ†)å¦‚ä½•æ¸²æŸ“ä¸Šè¿°border, background, box-shadowç­‰cssæ•ˆæœ. è¯¥å±æ€§æ‹¥æœ‰ä¸¤ä¸ªå€¼, slice å’Œ clone, é»˜è®¤å€¼ä¸ºslice, å¦‚ä¸Šå›¾ä¸€æ•ˆæœ. ä»¥ä¸‹æ˜¯å®˜æ–¹åŸæ–‡.</p>
<blockquote>
<p>For <a href="https://www.w3.org/TR/css-break-3/#propdef-box-decoration-break" target="_blank" rel="external">box-decoration-break: slice</a>, backgrounds (and <a href="https://www.w3.org/TR/css3-background/#border-image" target="_blank" rel="external">border-image</a>) are drawn as if applied to a composite box consisting of all of the boxâ€™s fragments reassembled in visual order. This theoretical assembly occurs after the element has been laid out (including any justification, bidi reordering, page breaks, etc.). To assemble the composite boxâ€¦</p>
</blockquote>
<p>ä»box-decoration-breakå±æ€§çš„æ”¯æŒæ€§æ¥çœ‹, ç›®å‰firefoxé¥é¥é¢†å…ˆ, å®ƒä»v32ç‰ˆæœ¬å¼€å§‹å°±å·²ç»å…¨éƒ¨æ”¯æŒ. ä»¥ä¸‹æµè§ˆå™¨å‡éœ€è¦ -webkit-å‰ç¼€, å¹¶ä¸”ä¸æ”¯æŒè·¨åˆ—å’Œè·¨é¡µçš„æˆªæ–­æ•ˆæœ, å…¶ä»–æµè§ˆå™¨ç›®å‰è¿˜ä¸æ”¯æŒ.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Chrome</th>
<th style="text-align:center">Safari</th>
<th style="text-align:center">Opera</th>
<th style="text-align:center">ios Safari</th>
<th style="text-align:center">Opera mini</th>
<th style="text-align:center">Android</th>
<th style="text-align:center">Chrome Android</th>
<th style="text-align:center">QQ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">22+</td>
<td style="text-align:center">6.1+</td>
<td style="text-align:center">15+</td>
<td style="text-align:center">7.1+</td>
<td style="text-align:center">all</td>
<td style="text-align:center">4.4+</td>
<td style="text-align:center">55+</td>
<td style="text-align:center">1.2+</td>
</tr>
</tbody>
</table>
<p>æ³¨: ä¸æ”¯æŒbox-decoration-breakçš„æµè§ˆå™¨é»˜è®¤æŒ‰ç…§<code>box-decoration-break:slice</code> æ•ˆæœæ¥æ¸²æŸ“ç›’å­ç¢ç‰‡.</p>
<hr>
<p>æœ¬é—®å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2017/02/12/box-shadow/">http://louiszhai.github.io/2017/02/12/box-shadow/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="https://gold.xitu.io/entry/574664ba5bbb5000578cd2a0" target="_blank" rel="external">[è¯‘] box-shadow å±æ€§ - æ˜é‡‘</a></li>
<li><a href="https://segmentfault.com/a/1190000002793308" target="_blank" rel="external">CSS3å®ç°Drop-shadow - MockingBird åšå®¢ - SegmentFault</a></li>
<li><a href="https://www.w3.org/TR/css-break-3/#breaking-boxes" target="_blank" rel="external">CSS Fragmentation Module Level 3</a></li>
<li><a href="http://www.chinaw3c.org/archives/1236/" target="_blank" rel="external">W3Cå‘å¸ƒCSSç‰‡æ®µæ¨¡å—ï¼ˆCSS Fragmentation Module Level 3ï¼‰å€™é€‰æ¨èæ ‡å‡† å¾é›†å‚è€ƒå®ç° - W3Cä¸­å›½</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      box-shadow é˜´å½± å¤šé‡é˜´å½± çº¸å¼ æŠ•å½± å‡èµ·æ•ˆæœ box-decoration-break
    
    </summary>
    
    
      <category term="CSS" scheme="http://louiszhai.github.io/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>å¼¹æ€§ç›’æ¨¡å‹FlexæŒ‡å—</title>
    <link href="http://louiszhai.github.io/2017/01/13/flex/"/>
    <id>http://louiszhai.github.io/2017/01/13/flex/</id>
    <published>2017-01-13T00:42:01.000Z</published>
    <updated>2017-02-25T06:50:43.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>Web layout æ˜¯Web UIä¸­çš„åŸºç¡€æ¶æ„, é‡è¦æ€§ä¸è¨€è€Œå–». ä¼ ç»Ÿçš„ç›’æ¨¡å‹, å€ŸåŠ©display, position, float å±æ€§åº”å¯¹æ™®é€šå¸ƒå±€æ¸¸åˆƒæœ‰ä½™, ä½†é’ˆå¯¹å¤æ‚çš„æˆ–è‡ªé€‚åº”å¸ƒå±€, å¸¸å¸¸æ‰è¥Ÿè§è‚˜. æ¯”å¦‚å‚ç›´å±…ä¸­, å°±æ˜¯ä¸€ä¸ªè€å¤§éš¾çš„é—®é¢˜, å€ŸåŠ©flexå¼¹æ€§ç›’æ¨¡å‹, ä¸¤è¡Œä»£ç å°±å¯ä»¥ä¼˜é›…çš„å®ç°ä¹‹. (è¯¥æ–¹æ³•æ›¾åœ¨ <a href="http://louiszhai.github.io/2016/03/12/css-center/">16ç§æ–¹æ³•å®ç°æ°´å¹³å±…ä¸­å‚ç›´å±…ä¸­</a> ä¸€æ–‡ä¸­æåˆ°). å½“ç„¶, æœ¬æ¬¡æˆ‘ä»¬ä¸ä¼šåªè®¨è®ºå‚ç›´å±…ä¸­çš„é—®é¢˜, æˆ‘å°†åŠªåŠ›å°½å¯èƒ½çš„è¿˜åŸflexçš„åº”ç”¨ç”Ÿæ€.</p>
<a id="more"></a>
<h3 id="Flex"><a href="#Flex" class="headerlink" title="Flex"></a>Flex</h3><p>Flexå³å¼¹æ€§ç›’æ¨¡å‹, è¯¥å¸ƒå±€æ–¹æ¡ˆç”±W3Cäº2009å¹´æå‡º. æ­¤å, Flexæ–¹æ¡ˆä¾¿å†ç»v2009, v2011, v2012, v2014, v2015, v2016ç­‰ç‰ˆæœ¬, æœ€è¿‘æ–¹æ¡ˆæ˜¯2016å¹´5æœˆ26æ—¥èµ·è‰çš„ <a href="http://www.w3.org/TR/2016/CR-css-flexbox-1-20160526/" target="_blank" rel="external">CSS Flexible Box Layout Module Level 1</a>.</p>
<h3 id="å…¼å®¹æ€§"><a href="#å…¼å®¹æ€§" class="headerlink" title="å…¼å®¹æ€§"></a>å…¼å®¹æ€§</h3><p>é¦–å…ˆ, æˆ‘ä»¬æ¥å›é¡¾ä¸‹å¦‚ä»ŠPCç«¯çš„å…¼å®¹æ€§(ä»¥ä¸‹ä¸ºå®Œå…¨å…¼å®¹ç‰ˆæœ¬).</p>
<table>
<thead>
<tr>
<th style="text-align:center">IE</th>
<th style="text-align:center">Edge</th>
<th style="text-align:center">Firefox</th>
<th style="text-align:center">Chrome</th>
<th style="text-align:center">Safari</th>
<th style="text-align:center">Opera</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">-</td>
<td style="text-align:center">12+</td>
<td style="text-align:center">28+</td>
<td style="text-align:center">21+</td>
<td style="text-align:center">6.1+</td>
<td style="text-align:center">12.1+</td>
</tr>
</tbody>
</table>
<p>ä»¥ä¸Š, IE10+ä»…æ”¯æŒ2012ç‰ˆW3Cçš„flexè¯­æ³•, ä¸”å­˜åœ¨è¾ƒå¤šå·²çŸ¥çš„bug, æ­¤æ—¶ä½¿ç”¨flexå¸ƒå±€éœ€è°¨æ….</p>
<p>Chromeæµè§ˆå™¨v21~v28ç‰ˆæœ¬éœ€è¦æ·»åŠ  â€œ-webkit-â€œ å‰ç¼€.</p>
<p>Safariæµè§ˆå™¨v6.1~v8ç‰ˆæœ¬éœ€è¦æ·»åŠ  â€œ-webkit-â€œ å‰ç¼€.</p>
<p>Operaæµè§ˆå™¨v15~v16ç‰ˆæœ¬éœ€è¦æ·»åŠ  â€œ-webkit-â€œ å‰ç¼€.</p>
<p>å› æ­¤, çœ‹åˆ°ä¸€äº›sassç¼–è¯‘åçš„cssæ–‡ä»¶ä¸­å¸¦æœ‰ â€œ-webkit-â€œ å‰ç¼€æ— éœ€æƒŠæ…Œ.</p>
<p>å¹³æ—¶å¼€å‘æ—¶æœ€ä¸ºæ‹…å¿ƒçš„ä¾¿æ˜¯ç§»åŠ¨ç«¯å…¼å®¹æ€§, è¯·çœ‹:</p>
<table>
<thead>
<tr>
<th style="text-align:center">IOS Safari</th>
<th style="text-align:center">Opera mini</th>
<th style="text-align:center">Android</th>
<th style="text-align:center">Android Chrome</th>
<th style="text-align:center">UC</th>
<th style="text-align:center">å¾®ä¿¡</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">7.1+</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">4.4+</td>
<td style="text-align:center">55</td>
<td style="text-align:center">-</td>
<td style="text-align:center">å½“å‰æ”¯æŒ</td>
</tr>
</tbody>
</table>
<p>å¾®ä¿¡å½“å‰ç‰ˆæœ¬å·²æ”¯æŒflex.</p>
<p>UCä¸å¯¹å¤–æä¾›webviewå†…æ ¸, é™¤å»ä¸€äº›H5appçš„åº”ç”¨, å„ç§åˆ†äº«é¡µåŸºæœ¬(å¸¸åœ¨å¾®ä¿¡ä¸‹æ‰“å¼€)åŸºæœ¬ä¸éœ€è¦æ‹…å¿ƒå¯¹å…¶å…¼å®¹æ€§, å®åœ¨éœ€è¦å®ç°, UCè¿˜æ˜¯æ”¯æŒè€ç‰ˆæœ¬çš„å¼¹æ€§ç›’å­çš„, å¯ä»¥ä¼˜é›…é™çº§. å¯è§, Android4.4ä»¥ä¸ŠåŸºæœ¬å¯ä»¥å®‰å¿ƒä½¿ç”¨flex.</p>
<h3 id="Autoprefixer"><a href="#Autoprefixer" class="headerlink" title="Autoprefixer"></a>Autoprefixer</h3><p>å¼ºè®°å„ç§æµè§ˆå™¨çš„å‰ç¼€æ˜¯æ²¡æœ‰å¿…è¦çš„, å› ä¸ºautoprefixerè¯¥åšçš„, éƒ½å¸®æˆ‘ä»¬åšäº†. å› æ­¤å»ºè®®å°è¯•ä¸‹ä»¥ä¸‹ä¸‰ä¸ªæ’ä»¶ä¹‹ä¸€.</p>
<ul>
<li><a href="https://github.com/nDmitry/grunt-autoprefixer" target="_blank" rel="external">grunt-autoprefixer</a></li>
<li><a href="https://www.npmjs.com/package/gulp-autoprefixer" target="_blank" rel="external">gulp-autoprefixer</a></li>
<li><a href="https://github.com/postcss/autoprefixer" target="_blank" rel="external">PostCSS-autoprefixer</a></li>
</ul>
<h3 id="ä¼˜åŠ¿"><a href="#ä¼˜åŠ¿" class="headerlink" title="ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h3><p>Flexå¸ƒå±€ä½¿å¾—å­é¡¹ç›®èƒ½å¤Ÿâ€å¼¹æ€§â€çš„æ”¹å˜å…¶é«˜å®½, è‡ªç”±å¡«å……å®¹å™¨å‰©ä½™ç©ºé—´, ä»¥é€‚åº”å®¹å™¨å˜å¤§, æˆ–è€…å‹ç¼©å­é¡¹ç›®è‡ªèº«, ä»¥é€‚åº”å®¹å™¨å˜å°; åŒæ—¶è¿˜å¯ä»¥æ–¹ä¾¿çš„è°ƒèŠ‚å­é¡¹ç›®æ–¹å‘å’Œé¡ºåº. flexå¸¸ç”¨äºé«˜å®½éœ€è¦è‡ªé€‚åº”, æˆ–å­é¡¹ç›®å¤§å°æˆæ¯”ä¾‹, æˆ–æ°´å¹³å‚ç›´å¯¹é½ç­‰åœºæ™¯.</p>
<h3 id="æ¦‚å¿µé“ºå«"><a href="#æ¦‚å¿µé“ºå«" class="headerlink" title="æ¦‚å¿µé“ºå«"></a>æ¦‚å¿µé“ºå«</h3><p>Flexå¼¹æ€§ç›’æ¨¡å‹é‡Œ, æœ‰å®¹å™¨å’Œé¡¹ç›®ä¹‹åˆ†. è®¾ç½®<code>display:flex</code>çš„ä¸ºå®¹å™¨, å®¹å™¨å†…çš„å…ƒç´ ç§°ä½œå®ƒçš„å­é¡¹ç›®, å®¹å™¨æœ‰å®¹å™¨çš„ä¸€å¥—å±æ€§, å­é¡¹ç›®æœ‰å­é¡¹ç›®çš„å¦ä¸€å¥—å±æ€§. (å¯ä»¥è¿™ä¹ˆç†è§£: fatherä½œä¸ºå¼¹æ€§ç›’å­, åˆ¶å®šè¡Œä¸ºè§„èŒƒ, sonäº«å—ç›’å­çš„ä¾¿åˆ©, æŒ‰ç…§è§„èŒƒåˆ’åˆ†å„è‡ªçš„â€è¾–åŒºâ€).</p>
<p>ä»¥ä¸‹å›¾ç‰‡æ‘˜è‡ªå¤§æ¼ çš„<a href="6">ä¸€ä¸ªå®Œæ•´çš„FlexboxæŒ‡å—</a>æ–‡ä¸­.</p>
<p><img src="http://louiszhai.github.io/docImages/flex01.jpeg" alt="flexbox"></p>
<p>fatheråˆ¶å®šçš„è§„èŒƒ, åŸºäºä¸¤ä¸ªæ–¹å‘ â€” æ°´å¹³å’Œå‚ç›´. </p>
<ul>
<li>æ°´å¹³æ–¹å‘çš„ç§°ä¹‹ä¸ºä¸»è½´(main axis), å‚ç›´æ–¹å‘çš„ç§°ä¹‹ä¸ºäº¤å‰è½´(cross axis). </li>
<li>ä¸»è½´èµ·å§‹ä½ç½®, å«åš<code>main start</code>, æœ«å°¾ä½ç½®å«åš<code>main end</code>; </li>
<li>äº¤å‰è½´èµ·å§‹ä½ç½®, å«åš<code>cross start</code>, æœ«å°¾ä½ç½®å«åš<code>cross end</code>.</li>
<li>å­é¡¹ç›®åœ¨ä¸»è½´ä¸Šæ‰€å çš„å®½(é«˜)åº¦, å«åš<code>main size</code>, åœ¨äº¤å‰è½´ä¸Šæ‰€å çš„é«˜(å®½)åº¦, å«åš<code>cross size</code>.</li>
</ul>
<h3 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h3><p>display: flex | inline-flex;(å…ƒç´ å°†å‡çº§ä¸ºå¼¹æ€§ç›’å­). å‰è€…å®¹å™¨å‡çº§ä¸ºå—çº§ç›’å­, åè€…å®¹å™¨å°†å‡çº§ä¸ºè¡Œå†…ç›’å­. å…ƒç´ é‡‡ç”¨flexå¸ƒå±€ä»¥å, å­å…ƒç´ çš„float, clear, vertical-alignå±æ€§éƒ½å°†å¤±æ•ˆ.</p>
<h4 id="å®¹å™¨å±æ€§"><a href="#å®¹å™¨å±æ€§" class="headerlink" title="å®¹å™¨å±æ€§"></a>å®¹å™¨å±æ€§</h4><p>å®¹å™¨å…·æœ‰ä»¥ä¸‹6ä¸ªå±æ€§.</p>
<ul>
<li>flex-direction æŒ‡å®šä¸»è½´çš„æ–¹å‘.</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">flex-directionçš„å€¼</th>
<th style="text-align:center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>row</strong>(é»˜è®¤)</td>
<td style="text-align:center">æŒ‡å®šä¸»è½´æ°´å¹³, å­é¡¹ç›®ä»å·¦è‡³å³æ’åˆ—âœ</td>
</tr>
<tr>
<td style="text-align:center"><strong>row-reverse</strong></td>
<td style="text-align:center">æŒ‡å®šä¸»è½´æ°´å¹³, å­é¡¹ç›®ä»å³è‡³å·¦æ’åˆ—â¬…ï¸</td>
</tr>
<tr>
<td style="text-align:center"><strong>column</strong></td>
<td style="text-align:center">æŒ‡å®šä¸»è½´å‚ç›´, å­é¡¹ç›®ä»ä¸Šè‡³ä¸‹æ’åˆ—â¬‡ï¸</td>
</tr>
<tr>
<td style="text-align:center"><strong>column-reverse</strong></td>
<td style="text-align:center">æŒ‡å®šä¸»è½´å‚ç›´, å­é¡¹ç›®ä»ä¸‹è‡³ä¸Šæ’åˆ—â¬†ï¸</td>
</tr>
</tbody>
</table>
<ul>
<li>flex-wrap æŒ‡å®šå¦‚ä½•æ¢è¡Œ.</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">flex-wrapçš„å€¼</th>
<th style="text-align:center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>nowrap</strong>(é»˜è®¤)</td>
<td style="text-align:center">é»˜è®¤ä¸æ¢è¡Œ</td>
</tr>
<tr>
<td style="text-align:center"><strong>wrap</strong></td>
<td style="text-align:center">æ­£å¸¸æ¢è¡Œ</td>
</tr>
<tr>
<td style="text-align:center"><strong>wrap-reverse</strong></td>
<td style="text-align:center">æ¢è¡Œ, ä¸”å‰é¢çš„è¡Œåœ¨åº•éƒ¨</td>
</tr>
</tbody>
</table>
<ul>
<li>flex-flow å®ƒæ˜¯flex-direction å’Œ flex-wrapçš„ç®€å†™å½¢å¼, é»˜è®¤å€¼ä¸º<code>row nowrap</code>.</li>
<li>justify-content æŒ‡å®šä¸»è½´ä¸Šå­é¡¹ç›®çš„å¯¹é½æ–¹å¼.(é€šå¸¸ä¸ºæ°´å¹³æ–¹å‘å¯¹é½æ–¹å¼)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">justify-contentçš„å€¼</th>
<th style="text-align:center">æè¿°(å­é¡¹ç›®â€“ä¸»è½´æ–¹å‘)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>flex-start</strong>(é»˜è®¤)</td>
<td style="text-align:center">å­é¡¹ç›®èµ·å§‹ä½ç½®ä¸<code>main start</code>ä½ç½®å¯¹é½</td>
</tr>
<tr>
<td style="text-align:center"><strong>flex-end</strong></td>
<td style="text-align:center">å­é¡¹ç›®æœ«å°¾ä½ç½®ä¸<code>main end</code>ä½ç½®å¯¹é½</td>
</tr>
<tr>
<td style="text-align:center"><strong>center</strong></td>
<td style="text-align:center">åœ¨ä¸»è½´æ–¹å‘å±…ä¸­äºå®¹å™¨</td>
</tr>
<tr>
<td style="text-align:center"><strong>space-between</strong></td>
<td style="text-align:center">ä¸äº¤å‰è½´ä¸¤ç«¯å¯¹é½, å­é¡¹ç›®ä¹‹é—´çš„é—´éš”å…¨éƒ¨ç›¸ç­‰</td>
</tr>
<tr>
<td style="text-align:center"><strong>space-around</strong></td>
<td style="text-align:center">å­é¡¹ç›®ä¸¤ä¾§çš„è·ç¦»ç›¸ç­‰, å®ƒä»¬ä¹‹é—´çš„è·ç¦»ä¸¤å€äºå®ƒä»¬ä¸ä¸»è½´èµ·å§‹æˆ–æœ«å°¾ä½ç½®çš„è·ç¦».</td>
</tr>
</tbody>
</table>
<ul>
<li>align-items æŒ‡å®šäº¤å‰è½´ä¸Šå­é¡¹ç›®çš„å¯¹é½æ–¹å¼.(é€šå¸¸ä¸ºå‚ç›´æ–¹å‘å¯¹é½æ–¹å¼)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">align-itemsçš„å€¼</th>
<th style="text-align:center">æè¿°(å­é¡¹ç›®â€”äº¤å‰è½´æ–¹å‘)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>flex-start</strong></td>
<td style="text-align:center">å­é¡¹ç›®èµ·å§‹ä½ç½®ä¸<code>cross start</code>ä½ç½®å¯¹é½</td>
</tr>
<tr>
<td style="text-align:center"><strong>flex-end</strong></td>
<td style="text-align:center">å­é¡¹ç›®æœ«å°¾ä½ç½®ä¸<code>cross end</code>ä½ç½®å¯¹é½</td>
</tr>
<tr>
<td style="text-align:center"><strong>center</strong></td>
<td style="text-align:center">åœ¨äº¤å‰è½´æ–¹å‘å±…ä¸­äºå®¹å™¨</td>
</tr>
<tr>
<td style="text-align:center"><strong>baseline</strong></td>
<td style="text-align:center">ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½</td>
</tr>
<tr>
<td style="text-align:center"><strong>stretch</strong>(é»˜è®¤)</td>
<td style="text-align:center">é«˜åº¦æœªå®š(æˆ–auto)æ—¶, å°†å æ»¡å®¹å™¨çš„é«˜åº¦</td>
</tr>
</tbody>
</table>
<ul>
<li>align-content æŒ‡å®šå¤šæ ¹ä¸»è½´çš„å¯¹é½æ–¹å¼. è‹¥åªæœ‰ä¸€æ ¹ä¸»è½´, åˆ™æ— æ•ˆ.</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">align-contentçš„å€¼</th>
<th style="text-align:center">æè¿°(å­é¡¹ç›®)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>flex-start</strong></td>
<td style="text-align:center">é¡¶éƒ¨ä¸<code>cross start</code>ä½ç½®å¯¹é½</td>
</tr>
<tr>
<td style="text-align:center"><strong>flex-end</strong></td>
<td style="text-align:center">åº•éƒ¨ä¸<code>cross end</code>ä½ç½®å¯¹é½</td>
</tr>
<tr>
<td style="text-align:center"><strong>center</strong></td>
<td style="text-align:center">åœ¨äº¤å‰è½´æ–¹å‘å±…ä¸­äºå®¹å™¨</td>
</tr>
<tr>
<td style="text-align:center"><strong>space-between</strong></td>
<td style="text-align:center">ä¸äº¤å‰è½´ä¸¤ç«¯å¯¹é½, é—´éš”å…¨éƒ¨ç›¸ç­‰</td>
</tr>
<tr>
<td style="text-align:center"><strong>space-around</strong></td>
<td style="text-align:center">å­é¡¹ç›®ä¸¤ä¾§çš„è·ç¦»ç›¸ç­‰, å®ƒä»¬ä¹‹é—´çš„è·ç¦»ä¸¤å€äºå®ƒä»¬ä¸ä¸»è½´èµ·å§‹æˆ–æœ«å°¾ä½ç½®çš„è·ç¦».</td>
</tr>
<tr>
<td style="text-align:center"><strong>stretch</strong>(é»˜è®¤)</td>
<td style="text-align:center">å¤šæ ¹ä¸»è½´ä¸Šçš„å­é¡¹ç›®å……æ»¡äº¤å‰è½´</td>
</tr>
</tbody>
</table>
<h4 id="å­é¡¹ç›®å±æ€§"><a href="#å­é¡¹ç›®å±æ€§" class="headerlink" title="å­é¡¹ç›®å±æ€§"></a>å­é¡¹ç›®å±æ€§</h4><p>å­é¡¹ç›®å…·æœ‰ä»¥ä¸‹6ä¸ªå±æ€§.</p>
<ul>
<li><p><strong>flex-grow</strong> æŒ‡å®šå­é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹, é»˜è®¤ä¸º0(å³ä¸æ”¾å¤§). è¯¥å±æ€§å¯å–å€¼ä¸ºä»»ä½•æ­£æ•´æ•°. å‡è®¾å„ä¸ªå­é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ä¹‹å’Œä¸ºn, é‚£ä¹ˆå®¹å™¨å†…å‰©ä½™çš„ç©ºé—´å°†åˆ†é…nä»½, æ¯ä¸ªå­é¡¹ç›®å„è‡ªåˆ†åˆ°x/nä»½. (xä¸ºè¯¥å­é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹)</p>
</li>
<li><p><strong>flex-shrink</strong> æŒ‡å®šå­é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹, é»˜è®¤ä¸º<code>1</code>. è®¾ç½®ä¸º0æ—¶, ç©ºé—´ä¸è¶³è¯¥å­é¡¹ç›®å°†ä¸ç¼©å°. æˆ‘ä»¬çŸ¥é“, <code>å®¹å™¨çš„ç¼©å°æ€»å®½åº¦=å­é¡¹ç›®æ‰€éœ€è¦çš„æ€»å®½åº¦-å®¹å™¨å®é™…å®½åº¦</code>, å‡è®¾å®¹å™¨éœ€è¦ç¼©å°çš„å®½åº¦ä¸ºW, æŸå­é¡¹ç›®çš„é»˜è®¤å®½åº¦ä¸ºL, å…¶ç¼©å°æ¯”ä¾‹ä¸ºp, é‚£ä¹ˆè¯¥å­é¡¹ç›®å®é™…çš„å®½åº¦ä¸º<code>L-p*W</code>. </p>
<ul>
<li><p>ä¸Šé¢è½»ææ·¡å†™çš„ç»™å‡ºäº†å­é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹, å¯èƒ½ä¼šç»™ä½ ä¸€ç§é”™è§‰â€” â€œç¼©å°æ¯”ä¾‹å¾ˆå®¹æ˜“è®¡ç®—â€, å®é™…ä¸Š, <strong>æˆ‘ä»¬åœ¨è®¡ç®—å…ƒç´ éœ€è¦ç¼©å°æ¯”ä¾‹æ—¶, æ€»æ˜¯è¦è€ƒè™‘åˆ°å…ƒç´ è‡ªèº«é»˜è®¤çš„å¤§å°</strong>.</p>
</li>
<li><p>å‡è®¾ä¸Šè¿°å­é¡¹ç›®å…¶flex-shrinkå€¼ä¸ºx1, å¦ä¸€ä¸ªå­é¡¹ç›®çš„é»˜è®¤å®½åº¦ä¸ºR, flex-shrinkå€¼ä¸ºx2, è€ƒè™‘åˆ°å…ƒç´ è‡ªèº«å¤§å°. æœ€ç»ˆç¬¬ä¸€ä¸ªå­é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹æ˜¯åŠ æƒäº†è‡ªèº«é»˜è®¤å¤§å°åçš„ç»“æœ, å³<code>rate = L*x1/(L*x1 + R*x2)</code>.</p>
<p><img src="http://louiszhai.github.io/docImages/flex03.png" alt=""></p>
</li>
<li><p>ä¸ºä»€ä¹ˆè®¡ç®—ä¼šå¦‚æ­¤å¤æ‚, å¦‚æ­¤ä¸ç›´è§‚??? è¿™æ˜¯å› ä¸º, å­é¡¹ç›®çš„å¤§å°å„ä¸ä¸€è‡´, å‡å¦‚ä¸€ä¸ªå­é¡¹ç›®æ˜¯å¦ä¸€ä¸ªå­é¡¹ç›®ä¸»è½´å®½åº¦çš„9å€, å‰è€…çš„flex-shrinkå€¼ä¸º1, åè€…ä¸º9, è€Œå®¹å™¨å®é™…ä¸Šåªæœ‰ä»–ä»¬é»˜è®¤æ€»å®½åº¦çš„ä¸€åŠ. è¿™æ„å‘³ç€, è¿™ä¸¤ä¸ªå­é¡¹ç›®å…±è®¡è¦å‹ç¼©ä¸ºé»˜è®¤çš„ä¸€åŠ. å¦‚æœä»…ä»…æŒ‰ç…§flex-shrinkå€¼æ¥å†³å®šæ¯”ä¾‹, é‚£ä¹ˆç¬¬äºŒä¸ªå­é¡¹ç›®éœ€è¦å‹ç¼©å…¶é»˜è®¤çš„9/10, è€Œæˆ‘ä»¬çŸ¥é“, å®ƒé»˜è®¤æ˜¯å¦‚æ­¤çš„å°, å³ä½¿å…¨éƒ¨å‹ç¼©äº†, ä¹Ÿæ— æµäºäº‹; è€Œç¬¬ä¸€ä¸ªå…ƒç´ ä»…éœ€è¦å‹ç¼©å…¶é»˜è®¤çš„1/10, ç®€ç›´å°±æ˜¯ä¹ç‰›ä¸€æ¯›, æ ¹æœ¬è¾¾ä¸åˆ°é»˜è®¤æ€»å®½åº¦å‹ç¼©ä¸€åŠçš„æ•ˆæœ. å¾ˆæ˜æ˜¾, è¿™ç§å‹ç¼©æ¯”ä¾‹çš„åˆ†é…æ–¹å¼æ˜¯ä¸åˆç†çš„. å› æ­¤æœ€ç»ˆçš„å‹ç¼©æ¯”ä¾‹åŠ å…¥äº†é»˜è®¤å®½åº¦å€¼(å³flex-basiså€¼), è¡¨è¾¾å¼çš„åˆ†å­ä¸º <code>flex-shrink * flex-basis</code>, åˆ†æ¯ä¸ºå„å­é¡¹ç›®  <code>flex-shrink * flex-basis</code> ä¹‹å’Œ.</p>
</li>
</ul>
</li>
<li><p><strong>flex-basis</strong> æŒ‡å®šå­é¡¹ç›®åˆ†é…çš„é»˜è®¤ç©ºé—´, é»˜è®¤ä¸º<code>auto</code>. å³è¯¥å­é¡¹ç›®çš„åŸæœ¬å¤§å°.</p>
</li>
<li><p><strong>flex</strong> æ˜¯ flex-grow, flex-shrink, flex-basis 3ä¸ªå±æ€§çš„ç¼©å†™. é»˜è®¤ä¸º<code>0 1 auto</code>. è¯¥å±æ€§å–å€¼ä¸ºautoæ—¶ç­‰åŒäºè®¾ç½®ä¸º<code>1 1 auto</code>, å–å€¼ä¸ºnoneæ—¶ç­‰åŒäºè®¾ç½®ä¸º<code>0 0 auto</code>.</p>
</li>
<li><p><strong>align-self</strong> æŒ‡å®šå•ä¸ªå­é¡¹ç›®ç‹¬ç«‹çš„å¯¹é½æ–¹å¼. é»˜è®¤ä¸º<code>auto</code>, è¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„align-itemså±æ€§, å¦‚æ— çˆ¶å…ƒç´ , åˆ™ç­‰åŒäº<code>stretch</code>. è¯¥å±æ€§å…±æœ‰6ç§å€¼, å…¶ä»–å€¼ä¸ä¸Šè¿°align-itemså±æ€§ä¿æŒä¸€è‡´.</p>
</li>
<li><p><strong>order</strong> æŒ‡å®šå­é¡¹ç›®çš„é¡ºåº, æ•°å€¼è¶Šå°, é¡ºåºè¶Šé å‰, é»˜è®¤ä¸º<code>0</code>.</p>
</li>
</ul>
<h3 id="flexå±æ€§çš„ä¼˜å…ˆçº§"><a href="#flexå±æ€§çš„ä¼˜å…ˆçº§" class="headerlink" title="flexå±æ€§çš„ä¼˜å…ˆçº§"></a>flexå±æ€§çš„ä¼˜å…ˆçº§</h3><p>æˆ‘ä»¬å¯ä»¥ç»™inputè®¾ç½®<code>flex:1</code>, ä½¿å…¶å……æ»¡ä¸€è¡Œ, å¹¶ä¸”éšç€çˆ¶å…ƒç´ å¤§å°å˜åŒ–è€Œå˜åŒ–. ä¹Ÿå¯ä»¥ç»™divè®¾ç½®<code>flex:1</code>ä½¿å…¶å……æ»¡å‰©ä½™é«˜åº¦.</p>
<p>ä½¿ç”¨flexå¸ƒå±€è¿™äº›éƒ½ä¸æ˜¯éš¾äº‹, éœ€è¦æ³¨æ„çš„æ˜¯, è¿™å…¶ä¸­æœ‰å‘. ä¸ºäº†é¿å…è¸©å‘, æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹flexå±æ€§çš„ä¼˜å…ˆçº§:</p>
<p><strong>width|height &gt; è‡ªé€‚åº”æ–‡æœ¬å†…å®¹çš„å®½åº¦æˆ–é«˜åº¦ &gt; flex:æ•°å€¼</strong></p>
<p>è¿™æ„å‘³ç€, é¦–å…ˆæ˜¯å…ƒç´ å®½é«˜çš„å€¼ä¼˜å…ˆ, å…¶æ¬¡æ˜¯å†…å®¹çš„å®½é«˜, å†æ¬¡æ˜¯flexæ•°å€¼. ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å‘æ˜¯ä»€ä¹ˆ.</p>
<ol>
<li>ç»™inputå…ƒç´ è®¾ç½®<code>flex:1</code>æ—¶éœ€è¦æ³¨æ„, é€šå¸¸inputæ‹¥æœ‰ä¸€ä¸ªé»˜è®¤å®½åº¦(ç”¨äºå±•ç¤ºé»˜è®¤æ•°é‡çš„å­—ç¬¦), åœ¨chrome v55ä¸‹, è¿™ä¸ªå®½åº¦é»˜è®¤ä¸º126px(åŒæ—¶è¿˜åŒ…å«2pxçš„border). å› æ­¤æƒ³è¦å®ç°inputå®½åº¦è‡ªé€‚åº”, å¯ä»¥è®¾ç½®å…¶widthä¸º0.</li>
<li>ç»™divå…ƒç´ è®¾ç½®<code>flex:1</code>æ—¶, å› divçš„é«˜åº¦ä¼šå—å­çº§å…ƒç´ å½±å“, ä¸ºäº†ä½¿å¾—è¯¥divå æ»¡å…¶çˆ¶å…ƒç´ å‰©ä½™çš„é«˜åº¦, ä¸”ä¸è¶…å‡º, å»ºè®®å°†è¯¥divçš„<code>height</code>å±æ€§è®¾ç½®ä¸º0.</li>
</ol>
<h3 id="åœºæ™¯å›é¡¾"><a href="#åœºæ™¯å›é¡¾" class="headerlink" title="åœºæ™¯å›é¡¾"></a>åœºæ™¯å›é¡¾</h3><ol>
<li><p>æƒ³è¦å®ç°å‚ç›´å±…ä¸­çš„æ•ˆæœ, åªéœ€è¦è®¾ç½®çˆ¶å…ƒç´ ä¸º<code>display:flex;justify-content:center</code> å³å¯. (å½“ç„¶, çˆ¶å…ƒç´ æ ·å¼é‡‡ç”¨:<code>display:table;</code>, å­å…ƒç´ æ ·å¼é‡‡ç”¨:<code>display:table-cell;vertical-align:middle</code> ä¹Ÿæ˜¯å¯ä»¥å®ç°çš„), å¦‚ä¸‹å›¾.</p>
<p><img src="http://louiszhai.github.io/docImages/flex02.png" alt=""></p>
</li>
<li><p>æƒ³è¦å®ç°å·¦å³ä¸¤ä¸ªå…ƒç´ ç­‰é«˜(çˆ¶å…ƒç´ é«˜åº¦ç”±å­å…ƒç´ æ’‘å¼€), å¹¶ä¸”å„å ä¸€åŠçš„å®½åº¦. å¦‚ä¸Šå›¾.</p>
<ul>
<li>æ—©æœŸçš„å®ç°æ–¹æ¡ˆ, éœ€è¦å€ŸåŠ©è´Ÿmargin. çˆ¶å…ƒç´ æ ·å¼è®¾ç½®ä¸º<code>overflow:hidden</code>, å­å…ƒç´ æ ·å¼è®¾ç½®ä¸º<code>margin-bottom:-10000px;padding-bottom:10000px;</code>, è¿™æ ·, æ¯ä¸ªå­å…ƒç´ ä¾¿èƒ½å€ŸåŠ©paddingæ’‘å¼€, åŒæ—¶, å€ŸåŠ©è´Ÿmarginå’Œoverflowåˆç†è£å‰ª.</li>
<li>ç¬¬äºŒç§æ–¹æ¡ˆå°±æ˜¯å€ŸåŠ©IE8éƒ½æ”¯æŒçš„<code>display:table</code>å±æ€§, çˆ¶å…ƒç´ æ ·å¼è®¾ç½®ä¸º<code>display:table</code> , å­å…ƒç´ è®¾ç½®ä¸º<code>display:table-cell</code>. åˆ©ç”¨è¡¨æ ¼çš„è¡Œé«˜ä¸€è‡´æ€§, è½»æ¾å®ç°è¡Œé«˜ä¸€è‡´.</li>
<li>æœ€ç»ˆ, æˆ‘ä»¬å‘ç°, è¿˜æ˜¯flexå¼¹æ€§ç›’æ¨¡å‹æ¥å¾—æ–¹ä¾¿å¿«æ·, å®ƒåªéœ€è¦çˆ¶çº§å…ƒç´ æ ·å¼è®¾ç½®ä¸º<code>display:flex</code>.</li>
</ul>
</li>
</ol>
<p>æœ‰å…³flexçš„æ—§è¯­æ³•, è¯·æˆ³è¿™ç¯‡å›é¡¾  <a href="https://segmentfault.com/a/1190000003978624" target="_blank" rel="external">Flexå¸ƒå±€æ–°æ—§æ··åˆå†™æ³•è¯¦è§£ï¼ˆå…¼å®¹å¾®ä¿¡ï¼‰</a> .</p>
<p>æœ‰å…³ç§»åŠ¨ç«¯çš„æœ€ä½³å®è·µ, è¯·æˆ³è¿™ç¯‡å›´è§‚ <a href="https://isux.tencent.com/flexbox.html" target="_blank" rel="external">ç§»åŠ¨ç«¯å…¨å…¼å®¹çš„flexboxé€Ÿæˆç­</a> .</p>
<p>å½“ç„¶, è¿™é‡Œè¿˜æœ‰ä¸€ä¸ª <a href="https://github.com/philipwalton/flexbugs" target="_blank" rel="external">Flexbugs</a> åˆ—è¡¨, githubä¸Šå·²æœ‰è¿‘6kçš„star, æ„Ÿå…´è¶£å¯ä»¥å‰å»çœ‹çœ‹.</p>
<hr>
<p>æœ¬é—®å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2017/01/13/flex/">http://louiszhai.github.io/2017/01/13/flex/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="https://www.w3.org/TR/css-flexbox-1/" target="_blank" rel="external">CSS Flexible Box Layout Module Level 1</a></li>
<li><a href="https://www.w3.org/TR/2012/WD-css3-flexbox-20120322/" target="_blank" rel="external">2012 CSS Flexible Box Layout Module</a></li>
<li><a href="https://www.w3.org/TR/2009/WD-css3-flexbox-20090723/" target="_blank" rel="external">2009 CSS Flexible Box Layout Module</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html" target="_blank" rel="external">Flex å¸ƒå±€æ•™ç¨‹ï¼šè¯­æ³•ç¯‡ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a></li>
<li><a href="https://zm10.sm-tc.cn/?src=l4uLj8XQ0IiIiNGIzJyPk4qM0ZyQktCcjIzM0J7SmIqWm5rSi5DSmZOah52Qh9GXi5KT&amp;from=derive&amp;depth=2&amp;v=1&amp;link_type=12&amp;uid=5f61658d8b9f95c8d0141e9c09fa6e85&amp;hid=f2ad43235a237619a455bdb39512d4c1&amp;restype=1&amp;uc_param_str=dnntnwvepffrgibijbprsvdsei&amp;query=%E5%A4%A7%E6%BC%A0+flex" target="_blank" rel="external">ä¸€ä¸ªå®Œæ•´çš„FlexboxæŒ‡å—â€“å¤§æ¼ </a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      å¼¹æ€§ç›’æ¨¡å‹ flex flex-grow flex-shrink flex-basis align-items align-content order flex-flow flex-direction flex-wrap align-self
    
    </summary>
    
    
      <category term="CSS" scheme="http://louiszhai.github.io/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>JSä¸­å¯èƒ½ç”¨å¾—åˆ°çš„å…¨éƒ¨çš„æ’åºç®—æ³•</title>
    <link href="http://louiszhai.github.io/2016/12/23/sort/"/>
    <id>http://louiszhai.github.io/2016/12/23/sort/</id>
    <published>2016-12-23T03:55:14.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>æ’åºç®—æ³•å¯ä»¥ç§°å¾—ä¸Šæ˜¯æˆ‘çš„ç›²ç‚¹, æ›¾å‡ ä½•æ—¶å½“æˆ‘çŸ¥é“Chromeçš„Array.prototype.sortä½¿ç”¨äº†å¿«é€Ÿæ’åºæ—¶, æˆ‘çš„å†…å¿ƒæ˜¯å¥”æºƒçš„(å•¥æ˜¯å¿«æ’, æˆ‘åªçŸ¥é“å†’æ³¡å•Š?!), è¦çŸ¥é“å­¦ä¹ ä¸€é—¨æŠ€æœ¯æœ€å¥½çš„æ—¶é—´æ˜¯ä¸‰å¹´å‰, ä½†æ„¿æˆ‘ç°åœ¨è¡¥ä¹ è¿˜æ¥å¾—åŠ(æ‚è„¸).</p>
<p>å› æ­¤æœ¬ç¯‡é‡æ‹¾äº†å‡ºé•œæ¦‚ç‡æ¯”è¾ƒé«˜çš„åæ¥ç§æ’åºç®—æ³•, é€ä¸€åˆ†æå…¶æ’åºæ€æƒ³, å¹¶æ‰¹æ³¨æ³¨æ„äº‹é¡¹. æ¬¢è¿å¯¹ç®—æ³•æå‡ºæ”¹è¿›å’Œ<a href="#respond">è®¨è®º</a>.</p>
<a id="more"></a>
<h3 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h3><p><img src="http://louiszhai.github.io/docImages/sort02.gif" alt="æ°´æ³¡"></p>
<p>å†’æ³¡æ’åºéœ€è¦ä¸¤ä¸ªåµŒå¥—çš„å¾ªç¯. å…¶ä¸­, <code>å¤–å±‚å¾ªç¯</code>ç§»åŠ¨æ¸¸æ ‡; <code>å†…å±‚å¾ªç¯</code>éå†æ¸¸æ ‡åŠä¹‹å(æˆ–ä¹‹å‰)çš„å…ƒç´ , é€šè¿‡ä¸¤ä¸¤äº¤æ¢çš„æ–¹å¼, æ¯æ¬¡åªç¡®ä¿è¯¥å†…å¾ªç¯ç»“æŸä½ç½®æ’åºæ­£ç¡®, ç„¶å<code>å†…å±‚å¾ªç¯</code>å‘¨æœŸç»“æŸ, äº¤ç”±<code>å¤–å±‚å¾ªç¯</code>å¾€å(æˆ–å‰)ç§»åŠ¨æ¸¸æ ‡, éšå³å¼€å§‹ä¸‹ä¸€è½®<code>å†…å±‚å¾ªç¯</code>, ä»¥æ­¤ç±»æ¨, ç›´è‡³å¾ªç¯ç»“æŸ.</p>
<p><strong><em>Tips</em></strong>: ç”±äºå†’æ³¡æ’åºåªåœ¨ç›¸é‚»å…ƒç´ å¤§å°ä¸ç¬¦åˆè¦æ±‚æ—¶æ‰è°ƒæ¢ä»–ä»¬çš„ä½ç½®, å®ƒå¹¶ä¸æ”¹å˜ç›¸åŒå…ƒç´ ä¹‹é—´çš„ç›¸å¯¹é¡ºåº, å› æ­¤å®ƒæ˜¯ç¨³å®šçš„æ’åºç®—æ³•.</p>
<p>ç”±äºæœ‰ä¸¤å±‚å¾ªç¯, å› æ­¤å¯ä»¥æœ‰å››ç§å®ç°æ–¹å¼.</p>
<table>
<thead>
<tr>
<th style="text-align:center">æ–¹æ¡ˆ</th>
<th style="text-align:center">å¤–å±‚å¾ªç¯</th>
<th style="text-align:center">å†…å±‚å¾ªç¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">æ­£åº</td>
<td style="text-align:center">æ­£åº</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">æ­£åº</td>
<td style="text-align:center">é€†åº</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">é€†åº</td>
<td style="text-align:center">æ­£åº</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">é€†åº</td>
<td style="text-align:center">é€†åº</td>
</tr>
</tbody>
</table>
<p>å››ç§ä¸åŒå¾ªç¯æ–¹å‘, å®ç°æ–¹å¼ç•¥æœ‰å·®å¼‚.</p>
<p>å¦‚ä¸‹æ˜¯åŠ¨å›¾æ•ˆæœ(å¯¹åº”äºæ–¹æ¡ˆ1: å†…/å¤–å±‚å¾ªç¯å‡æ˜¯æ­£åºéå†.</p>
<p><img src="http://louiszhai.github.io/docImages/sort05.gif" alt="å†’æ³¡æ’åº"></p>
<p>å¦‚ä¸‹æ˜¯ä¸Šå›¾çš„ç®—æ³•å®ç°(å¯¹åº”<strong>æ–¹æ¡ˆä¸€</strong>: å†…/å¤–å±‚å¾ªç¯å‡æ˜¯æ­£åºéå†).</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å…ˆå°†äº¤æ¢å…ƒç´ éƒ¨åˆ†æŠ½è±¡å‡ºæ¥</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">swap</span>(<span class="params">i,j,array</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> temp = array[j];</div><div class="line">  array[j] = array[i];</div><div class="line">  array[i] = temp;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubbleSort</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> length = array.length, isSwap;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;			<span class="comment">//æ­£åº</span></div><div class="line">    isSwap = <span class="literal">false</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; length - <span class="number">1</span> - i; j++) &#123;	 <span class="comment">//æ­£åº</span></div><div class="line">      array[j] &gt; array[j+<span class="number">1</span>] &amp;&amp; (isSwap = <span class="literal">true</span>) &amp;&amp; swap(j,j+<span class="number">1</span>,array);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(!isSwap)</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, æ’åºçš„ç‰¹ç‚¹å°±æ˜¯: é åçš„å…ƒç´ ä½ç½®å…ˆç¡®å®š.</p>
<p><strong>æ–¹æ¡ˆäºŒ</strong>: å¤–å¾ªç¯æ­£åºéå†, å†…å¾ªç¯é€†åºéå†, ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubbleSort</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> length = array.length, isSwap;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;			<span class="comment">//æ­£åº</span></div><div class="line">    isSwap = <span class="literal">false</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = length - <span class="number">1</span>; j &gt;= i+<span class="number">1</span>; j--) &#123;	 <span class="comment">//é€†åº</span></div><div class="line">      array[j] &lt; array[j<span class="number">-1</span>] &amp;&amp; (isSwap = <span class="literal">true</span>) &amp;&amp; swap(j,j<span class="number">-1</span>,array);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(!isSwap)</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, é å‰çš„å…ƒç´ ä½ç½®å…ˆç¡®å®š.</p>
<p><strong>æ–¹æ¡ˆä¸‰</strong>: å¤–å¾ªç¯é€†åºéå†, å†…å¾ªç¯æ­£åºéå†, ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubbleSort</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> length = array.length, isSwap;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;	 <span class="comment">//é€†åº</span></div><div class="line">    isSwap = <span class="literal">false</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;			<span class="comment">//æ­£åº</span></div><div class="line">      array[j] &gt; array[j+<span class="number">1</span>] &amp;&amp; (isSwap = <span class="literal">true</span>) &amp;&amp; swap(j,j+<span class="number">1</span>,array);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(!isSwap)</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, ç”±äºå†…å¾ªç¯æ˜¯æ­£åºéå†, å› æ­¤é åçš„å…ƒç´ ä½ç½®å…ˆç¡®å®š.</p>
<p><strong>æ–¹æ¡ˆå››</strong>: å¤–å¾ªç¯é€†åºéå†, å†…å¾ªç¯é€†åºéå†, ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubbleSort</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> length = array.length, isSwap;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;				<span class="comment">//é€†åº</span></div><div class="line">    isSwap = <span class="literal">false</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = length - <span class="number">1</span>; j &gt;= length - <span class="number">1</span> - i; j--) &#123; <span class="comment">//é€†åº</span></div><div class="line">      array[j] &lt; array[j<span class="number">-1</span>] &amp;&amp; (isSwap = <span class="literal">true</span>) &amp;&amp; swap(j,j<span class="number">-1</span>,array);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(!isSwap)</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, ç”±äºå†…å¾ªç¯æ˜¯é€†åºéå†, å› æ­¤é å‰çš„å…ƒç´ ä½ç½®å…ˆç¡®å®š.</p>
<p>ä»¥ä¸‹æ˜¯å…¶ç®—æ³•å¤æ‚åº¦:</p>
<table>
<thead>
<tr>
<th style="text-align:center">å¹³å‡æ—¶é—´å¤æ‚åº¦</th>
<th style="text-align:center">æœ€å¥½æƒ…å†µ</th>
<th style="text-align:center">æœ€åæƒ…å†µ</th>
<th style="text-align:center">ç©ºé—´å¤æ‚åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(n)</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(1)</td>
</tr>
</tbody>
</table>
<p>å†’æ³¡æ’åºæ˜¯æœ€å®¹æ˜“å®ç°çš„æ’åº, æœ€åçš„æƒ…å†µæ˜¯æ¯æ¬¡éƒ½éœ€è¦äº¤æ¢, å…±éœ€éå†å¹¶äº¤æ¢å°†è¿‘nÂ²/2æ¬¡, æ—¶é—´å¤æ‚åº¦ä¸ºO(nÂ²). æœ€ä½³çš„æƒ…å†µæ˜¯å†…å¾ªç¯éå†ä¸€æ¬¡åå‘ç°æ’åºæ˜¯å¯¹çš„, å› æ­¤é€€å‡ºå¾ªç¯, æ—¶é—´å¤æ‚åº¦ä¸ºO(n). å¹³å‡æ¥è®², æ—¶é—´å¤æ‚åº¦ä¸ºO(nÂ²). ç”±äºå†’æ³¡æ’åºä¸­åªæœ‰ç¼“å­˜çš„tempå˜é‡éœ€è¦å†…å­˜ç©ºé—´, å› æ­¤ç©ºé—´å¤æ‚åº¦ä¸ºå¸¸é‡O(1).</p>
<h3 id="åŒå‘å†’æ³¡æ’åº"><a href="#åŒå‘å†’æ³¡æ’åº" class="headerlink" title="åŒå‘å†’æ³¡æ’åº"></a>åŒå‘å†’æ³¡æ’åº</h3><p>åŒå‘å†’æ³¡æ’åºæ˜¯å†’æ³¡æ’åºçš„ä¸€ä¸ªç®€æ˜“å‡çº§ç‰ˆ, åˆç§°é¸¡å°¾é…’æ’åº. å†’æ³¡æ’åºæ˜¯ä»ä½åˆ°é«˜(æˆ–è€…ä»é«˜åˆ°ä½)å•å‘æ’åº, åŒå‘å†’æ³¡æ’åºé¡¾åæ€ä¹‰å°±æ˜¯ä»ä¸¤ä¸ªæ–¹å‘åˆ†åˆ«æ’åº(é€šå¸¸, å…ˆä»ä½åˆ°é«˜, ç„¶åä»é«˜åˆ°ä½). å› æ­¤å®ƒæ¯”å†’æ³¡æ’åºæ€§èƒ½ç¨å¥½ä¸€äº›.</p>
<p>å¦‚ä¸‹æ˜¯ç®—æ³•å®ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bothwayBubbleSort</span>(<span class="params">array</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> tail = array.length<span class="number">-1</span>, i, isSwap = <span class="literal">false</span>;</div><div class="line">  <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; tail; tail--)&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j = tail; j &gt; i; j--)&#123;	<span class="comment">//ç¬¬ä¸€è½®, å…ˆå°†æœ€å°çš„æ•°æ®å†’æ³¡åˆ°å‰é¢</span></div><div class="line">      array[j<span class="number">-1</span>] &gt; array[j] &amp;&amp; (isSwap = <span class="literal">true</span>) &amp;&amp; swap(j,j<span class="number">-1</span>,array);</div><div class="line">    &#125;</div><div class="line">    i++;</div><div class="line">    <span class="keyword">for</span>(j = i; j &lt; tail; j++)&#123;		<span class="comment">//ç¬¬äºŒè½®, å°†æœ€å¤§çš„æ•°æ®å†’æ³¡åˆ°åé¢</span></div><div class="line">      array[j] &gt; array[j+<span class="number">1</span>] &amp;&amp; (isSwap = <span class="literal">true</span>) &amp;&amp; swap(j,j+<span class="number">1</span>,array);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="é€‰æ‹©æ’åº"><a href="#é€‰æ‹©æ’åº" class="headerlink" title="é€‰æ‹©æ’åº"></a>é€‰æ‹©æ’åº</h3><p>ä»ç®—æ³•é€»è¾‘ä¸Šçœ‹, é€‰æ‹©æ’åºæ˜¯ä¸€ç§ç®€å•ä¸”ç›´è§‚çš„æ’åºç®—æ³•. å®ƒä¹Ÿæ˜¯ä¸¤å±‚å¾ªç¯. <code>å†…å±‚å¾ªç¯</code>å°±åƒå·¥äººä¸€æ ·, å®ƒæ˜¯çœŸæ­£åšäº‹æƒ…çš„, <code>å†…å±‚å¾ªç¯</code>æ¯æ‰§è¡Œä¸€é, å°†é€‰å‡ºæœ¬æ¬¡å¾…æ’åºçš„å…ƒç´ ä¸­æœ€å°(æˆ–æœ€å¤§)çš„ä¸€ä¸ª, å­˜æ”¾åœ¨æ•°ç»„çš„èµ·å§‹ä½ç½®. è€Œ <code>å¤–å±‚å¾ªç¯</code>åˆ™åƒè€æ¿ä¸€æ ·, å®ƒå‘Šè¯‰<code>å†…å±‚å¾ªç¯</code>ä½ éœ€è¦ä¸åœçš„å·¥ä½œ, ç›´åˆ°å·¥ä½œå®Œæˆ(ä¹Ÿå°±æ˜¯å…¨éƒ¨çš„å…ƒç´ æ’åºå®Œæˆ).</p>
<p><strong><em>Tips</em></strong>: é€‰æ‹©æ’åºæ¯æ¬¡äº¤æ¢çš„å…ƒç´ éƒ½æœ‰å¯èƒ½ä¸æ˜¯ç›¸é‚»çš„, å› æ­¤å®ƒæœ‰å¯èƒ½æ‰“ç ´åŸæ¥å€¼ä¸ºç›¸åŒçš„å…ƒç´ ä¹‹é—´çš„é¡ºåº. æ¯”å¦‚æ•°ç»„[2,2,1,3], æ­£å‘æ’åºæ—¶, ç¬¬ä¸€ä¸ªæ•°å­—2å°†ä¸æ•°å­—1äº¤æ¢, é‚£ä¹ˆä¸¤ä¸ªæ•°å­—2ä¹‹é—´çš„é¡ºåºå°†å’ŒåŸæ¥çš„é¡ºåºä¸ä¸€è‡´, <strong>è™½ç„¶å®ƒä»¬çš„å€¼ç›¸åŒ, ä½†å®ƒä»¬ç›¸å¯¹çš„é¡ºåºå´å‘ç”Ÿäº†å˜åŒ–</strong>. æˆ‘ä»¬å°†è¿™ç§ç°è±¡ç§°ä½œ <code>ä¸ç¨³å®šæ€§</code> .</p>
<p>å¦‚ä¸‹æ˜¯åŠ¨å›¾æ•ˆæœ:</p>
<p><img src="http://louiszhai.github.io/docImages/sort06.gif" alt="é€‰æ‹©æ’åº"></p>
<p>å¦‚ä¸‹æ˜¯ä¸Šå›¾çš„ç®—æ³•å®ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">selectSort</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> length = array.length, min;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; length - <span class="number">1</span>; i++) &#123;</div><div class="line">    min = i;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = i + <span class="number">1</span>; j &lt; length; j++) &#123;</div><div class="line">      array[j] &lt; array[min] &amp;&amp; (min = j); <span class="comment">//è®°ä½æœ€å°æ•°çš„ä¸‹æ ‡</span></div><div class="line">    &#125;</div><div class="line">    min!=i &amp;&amp; swap(i,min,array);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯å…¶ç®—æ³•å¤æ‚åº¦:</p>
<table>
<thead>
<tr>
<th style="text-align:center">å¹³å‡æ—¶é—´å¤æ‚åº¦</th>
<th style="text-align:center">æœ€å¥½æƒ…å†µ</th>
<th style="text-align:center">æœ€åæƒ…å†µ</th>
<th style="text-align:center">ç©ºé—´å¤æ‚åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(1)</td>
</tr>
</tbody>
</table>
<p>é€‰æ‹©æ’åºçš„ç®€å•å’Œç›´è§‚åå‰¯å…¶å®, è¿™ä¹Ÿé€ å°±äº†å®ƒâ€å‡ºäº†åçš„æ…¢æ€§å­â€, æ— è®ºæ˜¯å“ªç§æƒ…å†µ, å“ªæ€•åŸæ•°ç»„å·²æ’åºå®Œæˆ, å®ƒä¹Ÿå°†èŠ±è´¹å°†è¿‘nÂ²/2æ¬¡éå†æ¥ç¡®è®¤ä¸€é. å³ä¾¿æ˜¯è¿™æ ·, å®ƒçš„æ’åºç»“æœä¹Ÿè¿˜æ˜¯ä¸ç¨³å®šçš„. å”¯ä¸€å€¼å¾—é«˜å…´çš„æ˜¯, å®ƒå¹¶ä¸è€—è´¹é¢å¤–çš„å†…å­˜ç©ºé—´.</p>
<h3 id="æ’å…¥æ’åº"><a href="#æ’å…¥æ’åº" class="headerlink" title="æ’å…¥æ’åº"></a>æ’å…¥æ’åº</h3><p>æ’å…¥æ’åºçš„è®¾è®¡åˆè¡·æ˜¯å¾€æœ‰åºçš„æ•°ç»„ä¸­å¿«é€Ÿæ’å…¥ä¸€ä¸ªæ–°çš„å…ƒç´ . å®ƒçš„ç®—æ³•æ€æƒ³æ˜¯: æŠŠè¦æ’åºçš„æ•°ç»„åˆ†ä¸ºäº†ä¸¤ä¸ªéƒ¨åˆ†, ä¸€éƒ¨åˆ†æ˜¯æ•°ç»„çš„å…¨éƒ¨å…ƒç´ (é™¤å»å¾…æ’å…¥çš„å…ƒç´ ), å¦ä¸€éƒ¨åˆ†æ˜¯å¾…æ’å…¥çš„å…ƒç´ ; å…ˆå°†ç¬¬ä¸€éƒ¨åˆ†æ’åºå®Œæˆ, ç„¶åå†æ’å…¥è¿™ä¸ªå…ƒç´ . å…¶ä¸­ç¬¬ä¸€éƒ¨åˆ†çš„æ’åºä¹Ÿæ˜¯é€šè¿‡å†æ¬¡æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†æ¥è¿›è¡Œçš„.</p>
<p>æ’å…¥æ’åºç”±äºæ“ä½œä¸å°½ç›¸åŒ, å¯åˆ†ä¸º <code>ç›´æ¥æ’å…¥æ’åº</code> , <code>æŠ˜åŠæ’å…¥æ’åº</code>(åˆç§°äºŒåˆ†æ’å…¥æ’åº), <code>é“¾è¡¨æ’å…¥æ’åº</code> , <code>å¸Œå°”æ’åº</code> .</p>
<h4 id="ç›´æ¥æ’å…¥æ’åº"><a href="#ç›´æ¥æ’å…¥æ’åº" class="headerlink" title="ç›´æ¥æ’å…¥æ’åº"></a>ç›´æ¥æ’å…¥æ’åº</h4><p>å®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯: å°†å¾…æ’åºçš„å…ƒç´ æŒ‰ç…§å¤§å°é¡ºåº, ä¾æ¬¡æ’å…¥åˆ°ä¸€ä¸ªå·²ç»æ’å¥½åºçš„æ•°ç»„ä¹‹ä¸­, ç›´åˆ°æ‰€æœ‰çš„å…ƒç´ éƒ½æ’å…¥è¿›å».</p>
<p>å¦‚ä¸‹æ˜¯åŠ¨å›¾æ•ˆæœ:</p>
<p><img src="http://louiszhai.github.io/docImages/sort07.gif" alt="ç›´æ¥æ’å…¥æ’åº"></p>
<p>å¦‚ä¸‹æ˜¯ä¸Šå›¾çš„ç®—æ³•å®ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">directInsertionSort</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> length = array.length, index, current;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; length; i++) &#123;</div><div class="line">    index = i - <span class="number">1</span>;		 <span class="comment">//å¾…æ¯”è¾ƒå…ƒç´ çš„ä¸‹æ ‡</span></div><div class="line">    current = array[i];	 <span class="comment">//å½“å‰å…ƒç´ </span></div><div class="line">    <span class="keyword">while</span>(index &gt;= <span class="number">0</span> &amp;&amp; array[index] &gt; current) &#123; <span class="comment">//å‰ç½®æ¡ä»¶ä¹‹ä¸€:å¾…æ¯”è¾ƒå…ƒç´ æ¯”å½“å‰å…ƒç´ å¤§</span></div><div class="line">      array[index+<span class="number">1</span>] = array[index];	<span class="comment">//å°†å¾…æ¯”è¾ƒå…ƒç´ åç§»ä¸€ä½</span></div><div class="line">      index--;					       <span class="comment">//æ¸¸æ ‡å‰ç§»ä¸€ä½</span></div><div class="line">      <span class="comment">//console.log(array);</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(index+<span class="number">1</span> != i)&#123;				   <span class="comment">//é¿å…åŒä¸€ä¸ªå…ƒç´ èµ‹å€¼ç»™è‡ªèº«</span></div><div class="line">      array[index+<span class="number">1</span>] = current;		    <span class="comment">//å°†å½“å‰å…ƒç´ æ’å…¥é¢„ç•™ç©ºä½</span></div><div class="line">      <span class="comment">//console.log(array);</span></div><div class="line">    &#125;		</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸ºäº†æ›´å¥½çš„è§‚å¯Ÿåˆ°ç›´æ¥æ’å…¥æ’åºçš„å®ç°è¿‡ç¨‹, æˆ‘ä»¬ä¸å¦¨å°†ä¸Šè¿°ä»£ç ä¸­çš„æ³¨é‡Šéƒ¨åˆ†åŠ å…¥. ä»¥æ•°ç»„ [5,4,3,2,1] ä¸ºä¾‹, å¦‚ä¸‹ä¾¿æ˜¯åŸæ•°ç»„çš„æ¼”åŒ–è¿‡ç¨‹.</p>
<p><img src="http://louiszhai.github.io/docImages/sort01.png" alt=""></p>
<p>å¯è§, æ•°ç»„çš„å„ä¸ªå…ƒç´ , ä»åå¾€å‰, åªè¦æ¯”å‰é¢çš„å…ƒç´ å°, éƒ½ä¾æ¬¡æ’å…¥åˆ°äº†åˆç†çš„ä½ç½®.</p>
<p><strong><em>Tips</em></strong>: ç”±äºç›´æ¥æ’å…¥æ’åºæ¯æ¬¡åªç§»åŠ¨ä¸€ä¸ªå…ƒç´ çš„ä½ç½®, å¹¶ä¸ä¼šæ”¹å˜å€¼ç›¸åŒçš„å…ƒç´ ä¹‹é—´çš„æ’åº, å› æ­¤å®ƒæ˜¯ä¸€ç§ç¨³å®šæ’åº.</p>
<h4 id="æŠ˜åŠæ’å…¥æ’åº"><a href="#æŠ˜åŠæ’å…¥æ’åº" class="headerlink" title="æŠ˜åŠæ’å…¥æ’åº"></a>æŠ˜åŠæ’å…¥æ’åº</h4><p>æŠ˜åŠæ’å…¥æ’åºæ˜¯ç›´æ¥æ’å…¥æ’åºçš„å‡çº§ç‰ˆ. é‰´äºæ’å…¥æ’åºç¬¬ä¸€éƒ¨åˆ†ä¸ºå·²æ’å¥½åºçš„æ•°ç»„, æˆ‘ä»¬ä¸å¿…æŒ‰é¡ºåºä¾æ¬¡å¯»æ‰¾æ’å…¥ç‚¹, åªéœ€æ¯”è¾ƒå®ƒä»¬çš„ä¸­é—´å€¼ä¸å¾…æ’å…¥å…ƒç´ çš„å¤§å°å³å¯.</p>
<p><strong><em>Tips</em></strong>: åŒç›´æ¥æ’å…¥æ’åºç±»ä¼¼, æŠ˜åŠæ’å…¥æ’åºæ¯æ¬¡äº¤æ¢çš„æ˜¯ç›¸é‚»çš„ä¸”å€¼ä¸ºä¸åŒçš„å…ƒç´ , å®ƒå¹¶ä¸ä¼šæ”¹å˜å€¼ç›¸åŒçš„å…ƒç´ ä¹‹é—´çš„é¡ºåº. å› æ­¤å®ƒæ˜¯ç¨³å®šçš„.</p>
<p>ç®—æ³•åŸºæœ¬æ€æƒ³æ˜¯: </p>
<ol>
<li>å–0 ~ i-1çš„ä¸­é—´ç‚¹( <code>m = (i-1)&gt;&gt;1</code> ), array[i] ä¸ array[m] è¿›è¡Œæ¯”è¾ƒ, è‹¥array[i] &lt; array[m] , åˆ™è¯´æ˜å¾…æ’å…¥çš„å…ƒç´ array[i] åº”è¯¥å¤„äºæ•°ç»„çš„ 0 ~ m ç´¢å¼•ä¹‹é—´; åä¹‹, åˆ™è¯´æ˜å®ƒåº”è¯¥å¤„äºæ•°ç»„çš„ m ~ i-1 ç´¢å¼•ä¹‹é—´.</li>
<li>é‡å¤æ­¥éª¤1, æ¯æ¬¡ç¼©å°ä¸€åŠçš„æŸ¥æ‰¾èŒƒå›´, ç›´è‡³æ‰¾åˆ°æ’å…¥çš„ä½ç½®.</li>
<li>å°†æ•°ç»„ä¸­æ’å…¥ä½ç½®ä¹‹åçš„å…ƒç´ å…¨éƒ¨åç§»ä¸€ä½.</li>
<li>åœ¨æŒ‡å®šä½ç½®æ’å…¥ç¬¬ i ä¸ªå…ƒç´ .</li>
</ol>
<blockquote>
<p>æ³¨: <code>x&gt;&gt;1</code> æ˜¯ä½è¿ç®—ä¸­çš„å³ç§»è¿ç®—, è¡¨ç¤ºå³ç§»ä¸€ä½, ç­‰åŒäºxé™¤ä»¥2å†å–æ•´, å³ <code>x&gt;&gt;1 == Math.floor(x/2)</code> .</p>
</blockquote>
<p>å¦‚ä¸‹æ˜¯ç®—æ³•å®ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">binaryInsertionSort</span>(<span class="params">array</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> current, i, j, low, high, m;</div><div class="line">  <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; array.length; i++)&#123;</div><div class="line">    low = <span class="number">0</span>;</div><div class="line">    high = i - <span class="number">1</span>;</div><div class="line">    current = array[i];</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(low &lt;= high)&#123;			<span class="comment">//æ­¥éª¤1&amp;2:æŠ˜åŠæŸ¥æ‰¾</span></div><div class="line">      m = (low + high)&gt;&gt;<span class="number">1</span>;</div><div class="line">      <span class="keyword">if</span>(array[i] &gt;= array[m])&#123;<span class="comment">//å€¼ç›¸åŒæ—¶, åˆ‡æ¢åˆ°é«˜åŠåŒºï¼Œä¿è¯ç¨³å®šæ€§</span></div><div class="line">        low = m + <span class="number">1</span>;		<span class="comment">//æ’å…¥ç‚¹åœ¨é«˜åŠåŒº</span></div><div class="line">      &#125;<span class="keyword">else</span>&#123;</div><div class="line">        high = m - <span class="number">1</span>;		<span class="comment">//æ’å…¥ç‚¹åœ¨ä½åŠåŒº</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(j = i; j &gt; low; j--)&#123;	 <span class="comment">//æ­¥éª¤3:æ’å…¥ä½ç½®ä¹‹åçš„å…ƒç´ å…¨éƒ¨åç§»ä¸€ä½</span></div><div class="line">      array[j] = array[j<span class="number">-1</span>];</div><div class="line">    &#125;</div><div class="line">    array[low] = current;		 <span class="comment">//æ­¥éª¤4:æ’å…¥è¯¥å…ƒç´ </span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸ºäº†ä¾¿äºå¯¹æ¯”, åŒæ ·ä»¥æ•°ç»„ [5,4,3,2,1] ä¸¾ä¾‹ğŸŒ°. åŸæ•°ç»„çš„æ¼”åŒ–è¿‡ç¨‹å¦‚ä¸‹(ä¸ä¸Šè¿°ä¸€æ ·):</p>
<p><img src="http://louiszhai.github.io/docImages/sort.png" alt="æŠ˜åŠæ’å…¥æ’åº"></p>
<p>è™½ç„¶æŠ˜åŠæ’å…¥æ’åºæ˜æ˜¾å‡å°‘äº†æŸ¥è¯¢çš„æ¬¡æ•°, ä½†æ˜¯æ•°ç»„å…ƒç´ ç§»åŠ¨çš„æ¬¡æ•°å´æ²¡æœ‰æ”¹å˜. å®ƒä»¬çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(nÂ²).</p>
<h4 id="å¸Œå°”æ’åº"><a href="#å¸Œå°”æ’åº" class="headerlink" title="å¸Œå°”æ’åº"></a>å¸Œå°”æ’åº</h4><p>å¸Œå°”æ’åºä¹Ÿç§°ç¼©å°å¢é‡æ’åº, å®ƒæ˜¯ç›´æ¥æ’å…¥æ’åºçš„å¦å¤–ä¸€ä¸ªå‡çº§ç‰ˆ, å®è´¨å°±æ˜¯åˆ†ç»„æ’å…¥æ’åº. å¸Œå°”æ’åºä»¥å…¶è®¾è®¡è€…å¸Œå°”(Donald Shell)çš„åå­—å‘½å, å¹¶äº1959å¹´å…¬å¸ƒ.</p>
<p>ç®—æ³•çš„åŸºæœ¬æ€æƒ³: </p>
<ol>
<li>å°†æ•°ç»„æ‹†åˆ†ä¸ºè‹¥å¹²ä¸ªå­åˆ†ç»„, æ¯ä¸ªåˆ†ç»„ç”±ç›¸è·ä¸€å®šâ€å¢é‡â€çš„å…ƒç´ ç»„æˆ. æ¯”æ–¹è¯´å°†[0,1,2,3,4,5,6,7,8,9,10]çš„æ•°ç»„æ‹†åˆ†ä¸ºâ€å¢é‡â€ä¸º5çš„åˆ†ç»„, é‚£ä¹ˆå­åˆ†ç»„åˆ†åˆ«ä¸º [0,5], [1,6], [2,7], [3,8], [4,9] å’Œ [5,10].</li>
<li>ç„¶åå¯¹æ¯ä¸ªå­åˆ†ç»„åº”ç”¨ç›´æ¥æ’å…¥æ’åº.</li>
<li>é€æ­¥å‡å°â€å¢é‡â€, é‡å¤æ­¥éª¤1,2.</li>
<li>ç›´è‡³â€å¢é‡â€ä¸º1, è¿™æ˜¯æœ€åä¸€ä¸ªæ’åº, æ­¤æ—¶çš„æ’åº, ä¹Ÿå°±æ˜¯å¯¹å…¨æ•°ç»„è¿›è¡Œç›´æ¥æ’å…¥æ’åº.</li>
</ol>
<p>å¦‚ä¸‹æ˜¯æ’åºçš„ç¤ºæ„å›¾:</p>
<p><img src="http://louiszhai.github.io/docImages/sort04.png" alt="å¸Œå°”æ’åºç¤ºæ„å›¾"></p>
<p>å¯è§, å¸Œå°”æ’åºå®é™…ä¸Šå°±æ˜¯ä¸æ–­çš„è¿›è¡Œç›´æ¥æ’å…¥æ’åº, åˆ†ç»„æ˜¯ä¸ºäº†å…ˆå°†å±€éƒ¨å…ƒç´ æœ‰åºåŒ–. å› ä¸ºç›´æ¥æ’å…¥æ’åºåœ¨å…ƒç´ åŸºæœ¬æœ‰åºçš„çŠ¶æ€ä¸‹, æ•ˆç‡éå¸¸é«˜. è€Œå¸Œå°”æ’åºå‘¢, é€šè¿‡å…ˆåˆ†ç»„åæ’åºçš„æ–¹å¼, åˆ¶é€ äº†ç›´æ¥æ’å…¥æ’åºé«˜æ•ˆè¿è¡Œçš„åœºæ™¯. å› æ­¤å¸Œå°”æ’åºæ•ˆç‡æ›´é«˜.</p>
<p>æˆ‘ä»¬è¯•ç€æŠ½è±¡å‡ºå…±åŒç‚¹, ä¾¿ä¸éš¾å‘ç°ä¸Šè¿°å¸Œå°”æ’åºçš„ç¬¬å››æ­¥å°±æ˜¯ä¸€æ¬¡ç›´æ¥æ’å…¥æ’åº, è€Œå¸Œå°”æ’åºåŸæœ¬å°±æ˜¯ä»â€å¢é‡â€ä¸ºnå¼€å§‹, ç›´è‡³â€å¢é‡â€ä¸º1, å¾ªç¯åº”ç”¨ç›´æ¥æ’å…¥æ’åºçš„ä¸€ç§å°è£…. å› æ­¤ç›´æ¥æ’å…¥æ’åºå°±å¯ä»¥çœ‹åšæ˜¯æ­¥é•¿ä¸º1çš„å¸Œå°”æ’åº. ä¸ºæ­¤æˆ‘ä»¬å…ˆæ¥å°è£…ä¸‹ç›´æ¥æ’å…¥æ’åº.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å½¢å‚å¢åŠ æ­¥æ•°gap(å®é™…ä¸Šå°±ç›¸å½“äºgapæ›¿æ¢äº†åŸæ¥çš„æ•°å­—1)</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">directInsertionSort</span>(<span class="params">array, gap</span>) </span>&#123;</div><div class="line">  gap = (gap == <span class="literal">undefined</span>) ? <span class="number">1</span> : gap;       <span class="comment">//é»˜è®¤ä»ä¸‹æ ‡ä¸º1çš„å…ƒç´ å¼€å§‹éå†</span></div><div class="line">  <span class="keyword">var</span> length = array.length, index, current;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = gap; i &lt; length; i++) &#123;</div><div class="line">    index = i - gap;	<span class="comment">//å¾…æ¯”è¾ƒå…ƒç´ çš„ä¸‹æ ‡</span></div><div class="line">    current = array[i];	<span class="comment">//å½“å‰å…ƒç´ </span></div><div class="line">    <span class="keyword">while</span>(index &gt;= <span class="number">0</span> &amp;&amp; array[index] &gt; current) &#123; <span class="comment">//å‰ç½®æ¡ä»¶ä¹‹ä¸€:å¾…æ¯”è¾ƒå…ƒç´ æ¯”å½“å‰å…ƒç´ å¤§</span></div><div class="line">      array[index + gap] = array[index];	<span class="comment">//å°†å¾…æ¯”è¾ƒå…ƒç´ åç§»gapä½</span></div><div class="line">      index -= gap;					       <span class="comment">//æ¸¸æ ‡å‰ç§»gapä½</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(index + gap != i)&#123;				   <span class="comment">//é¿å…åŒä¸€ä¸ªå…ƒç´ èµ‹å€¼ç»™è‡ªèº«</span></div><div class="line">      array[index + gap] = current;		    <span class="comment">//å°†å½“å‰å…ƒç´ æ’å…¥é¢„ç•™ç©ºä½</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå¸Œå°”æ’åºçš„ç®—æ³•å®ç°å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">shellSort</span>(<span class="params">array</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> length = array.length, gap = length&gt;&gt;<span class="number">1</span>, current, i, j;</div><div class="line">  <span class="keyword">while</span>(gap &gt; <span class="number">0</span>)&#123;</div><div class="line">    directInsertionSort(array, gap); <span class="comment">//æŒ‰æŒ‡å®šæ­¥é•¿è¿›è¡Œç›´æ¥æ’å…¥æ’åº</span></div><div class="line">    gap = gap&gt;&gt;<span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åŒæ ·ä»¥æ•°ç»„[5,4,3,2,1] ä¸¾ä¾‹ğŸŒ°. åŸæ•°ç»„çš„æ¼”åŒ–è¿‡ç¨‹å¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/sort03.png" alt="å¸Œå°”æ’åº"></p>
<p>å¯¹æ¯”ä¸Šè¿°ç›´æ¥æ’å…¥æ’åºå’ŒæŠ˜åŠæ’å…¥æ’åº, æ•°ç»„å…ƒç´ çš„ç§»åŠ¨æ¬¡æ•°ç”±14æ¬¡å‡å°‘ä¸º7æ¬¡. é€šè¿‡æ‹†åˆ†åŸæ•°ç»„ä¸ºç²’åº¦æ›´å°çš„å­æ•°ç»„, å¸Œå°”æ’åºè¿›ä¸€æ­¥æé«˜äº†æ’åºçš„æ•ˆç‡.</p>
<p>ä¸ä»…å¦‚æ­¤, ä»¥ä¸Šæ­¥é•¿è®¾ç½®ä¸ºäº† {N/2, (N/2)/2, â€¦, 1}. è¯¥åºåˆ—å³<a href="http://baike.baidu.com/view/10729635.htm" target="_blank" rel="external">å¸Œå°”å¢é‡</a>, å…¶å®ƒçš„å¢é‡åºåˆ— è¿˜æœ‰Hibbardï¼š{1, 3, â€¦, 2^k-1}. é€šè¿‡åˆç†è°ƒèŠ‚æ­¥é•¿, è¿˜èƒ½è¿›ä¸€æ­¥æå‡æ’åºæ•ˆç‡. å®é™…ä¸Šå·²çŸ¥çš„æœ€å¥½æ­¥é•¿åºåˆ—æ˜¯ç”±Sedgewickæå‡ºçš„(1, 5, 19, 41, 109,â€¦). è¯¥åºåˆ—ä¸­çš„é¡¹æˆ–è€…æ˜¯9*4^i - 9*2^i + 1æˆ–è€…æ˜¯4^i - 3*2^i + 1. å…·ä½“è¯·æˆ³ <a href="https://zh.wikipedia.org/wiki/%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F#æ­¥é•¿åºåˆ—" target="_blank" rel="external">å¸Œå°”æ’åº-ç»´åŸºç™¾ç§‘</a> .</p>
<p><strong><em>Tips</em></strong>: æˆ‘ä»¬çŸ¥é“, å•æ¬¡ç›´æ¥æ’å…¥æ’åºæ˜¯ç¨³å®šçš„, å®ƒä¸ä¼šæ”¹å˜ç›¸åŒå…ƒç´ ä¹‹é—´çš„ç›¸å¯¹é¡ºåº, ä½†åœ¨å¤šæ¬¡ä¸åŒçš„æ’å…¥æ’åºè¿‡ç¨‹ä¸­, ç›¸åŒçš„å…ƒç´ å¯èƒ½åœ¨å„è‡ªçš„æ’å…¥æ’åºä¸­ç§»åŠ¨, å¯èƒ½å¯¼è‡´ç›¸åŒå…ƒç´ ç›¸å¯¹é¡ºåºå‘ç”Ÿå˜åŒ–. å› æ­¤, å¸Œå°”æ’åºå¹¶ä¸ç¨³å®š.</p>
<h3 id="å½’å¹¶æ’åº"><a href="#å½’å¹¶æ’åº" class="headerlink" title="å½’å¹¶æ’åº"></a>å½’å¹¶æ’åº</h3><p>å½’å¹¶æ’åºå»ºç«‹åœ¨å½’å¹¶æ“ä½œä¹‹ä¸Š, å®ƒé‡‡å–åˆ†è€Œæ²»ä¹‹çš„æ€æƒ³, å°†æ•°ç»„æ‹†åˆ†ä¸ºä¸¤ä¸ªå­æ•°ç»„, åˆ†åˆ«æ’åº, æœ€åæ‰å°†ä¸¤ä¸ªå­æ•°ç»„åˆå¹¶; æ‹†åˆ†çš„ä¸¤ä¸ªå­æ•°ç»„, å†ç»§ç»­é€’å½’æ‹†åˆ†ä¸ºæ›´å°çš„å­æ•°ç»„, è¿›è€Œåˆ†åˆ«æ’åº, ç›´åˆ°æ•°ç»„é•¿åº¦ä¸º1, ç›´æ¥è¿”å›è¯¥æ•°ç»„ä¸ºæ­¢.</p>
<p><strong><em>Tips</em></strong>: å½’å¹¶æ’åºä¸¥æ ¼æŒ‰ç…§ä»å·¦å¾€å³(æˆ–ä»å³å¾€å·¦)çš„é¡ºåºå»åˆå¹¶å­æ•°ç»„, å®ƒå¹¶ä¸ä¼šæ”¹å˜ç›¸åŒå…ƒç´ ä¹‹é—´çš„ç›¸å¯¹é¡ºåº, å› æ­¤å®ƒä¹Ÿæ˜¯ä¸€ç§ç¨³å®šçš„æ’åºç®—æ³•.</p>
<p>å¦‚ä¸‹æ˜¯åŠ¨å›¾æ•ˆæœ:</p>
<p><img src="http://louiszhai.github.io/docImages/sort08.gif" alt="å½’å¹¶æ’åº"></p>
<p>å½’å¹¶æ’åºå¯é€šè¿‡ä¸¤ç§æ–¹å¼å®ç°:</p>
<ol>
<li>è‡ªä¸Šè€Œä¸‹çš„é€’å½’</li>
<li>è‡ªä¸‹è€Œä¸Šçš„è¿­ä»£</li>
</ol>
<p>å¦‚ä¸‹æ˜¯ç®—æ³•å®ç°(æ–¹å¼1:é€’å½’):</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeSort</span>(<span class="params">array</span>) </span>&#123;  <span class="comment">//é‡‡ç”¨è‡ªä¸Šè€Œä¸‹çš„é€’å½’æ–¹æ³•</span></div><div class="line">  <span class="keyword">var</span> length = array.length;</div><div class="line">  <span class="keyword">if</span>(length &lt; <span class="number">2</span>) &#123;</div><div class="line">    <span class="keyword">return</span> array;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">var</span> m = (length &gt;&gt; <span class="number">1</span>),</div><div class="line">      left = array.slice(<span class="number">0</span>, m),</div><div class="line">      right = array.slice(m); <span class="comment">//æ‹†åˆ†ä¸ºä¸¤ä¸ªå­æ•°ç»„</span></div><div class="line">  <span class="keyword">return</span> merge(mergeSort(left), mergeSort(right));<span class="comment">//å­æ•°ç»„ç»§ç»­é€’å½’æ‹†åˆ†,ç„¶åå†åˆå¹¶</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">merge</span>(<span class="params">left, right</span>)</span>&#123; <span class="comment">//åˆå¹¶ä¸¤ä¸ªå­æ•°ç»„</span></div><div class="line">  <span class="keyword">var</span> result = [];</div><div class="line">  <span class="keyword">while</span> (left.length &amp;&amp; right.length) &#123;</div><div class="line">    <span class="keyword">var</span> item = left[<span class="number">0</span>] &lt;= right[<span class="number">0</span>] ? left.shift() : right.shift();<span class="comment">//æ³¨æ„:åˆ¤æ–­çš„æ¡ä»¶æ˜¯å°äºæˆ–ç­‰äº,å¦‚æœåªæ˜¯å°äº,é‚£ä¹ˆæ’åºå°†ä¸ç¨³å®š.</span></div><div class="line">    result.push(item);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> result.concat(left.length ? left : right);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç”±ä¸Š, é•¿åº¦ä¸ºnçš„æ•°ç»„, æœ€ç»ˆä¼šè°ƒç”¨mergeSortå‡½æ•°2n-1æ¬¡. é€šè¿‡è‡ªä¸Šè€Œä¸‹çš„é€’å½’å®ç°çš„å½’å¹¶æ’åº, å°†å­˜åœ¨å †æ ˆæº¢å‡ºçš„é£é™©. äº²æµ‹å„æµè§ˆå™¨çš„å †æ ˆæº¢å‡ºæ‰€éœ€çš„é€’å½’è°ƒç”¨æ¬¡æ•°å¤§è‡´ä¸º:</p>
<ul>
<li>Chrome v55: 15670</li>
<li>Firefox v50: 44488</li>
<li>Safari v9.1.2: 50755</li>
</ul>
<p>ä»¥ä¸‹æ˜¯æµ‹è¯•ä»£ç :</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">computeMaxCallStackSize</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span> + computeMaxCallStackSize();</div><div class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">    <span class="comment">// Call stack overflow</span></div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> time = computeMaxCallStackSize();</div><div class="line"><span class="built_in">console</span>.log(time);</div></pre></td></tr></table></figure>
<p>ä¸ºæ­¤, ES6è§„èŒƒä¸­æå‡ºäº†å°¾è°ƒä¼˜åŒ–çš„æ€æƒ³: å¦‚æœä¸€ä¸ªå‡½æ•°çš„æœ€åä¸€æ­¥ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨, é‚£ä¹ˆè¯¥å‡½æ•°æ‰€éœ€è¦çš„æ ˆç©ºé—´å°†è¢«é‡Šæ”¾, å®ƒå°†ç›´æ¥è¿›å…¥åˆ°ä¸‹æ¬¡è°ƒç”¨ä¸­, æœ€ç»ˆè°ƒç”¨æ ˆé‡Œåªä¿ç•™æœ€åä¸€æ¬¡çš„è°ƒç”¨è®°å½•.</p>
<p>è™½ç„¶ES6è§„èŒƒå¦‚æ­¤è¯±äºº, ç„¶è€Œç›®å‰å¹¶æ²¡æœ‰æµè§ˆå™¨æ”¯æŒå°¾è°ƒä¼˜åŒ–, ç›¸ä¿¡åœ¨ä¸ä¹…çš„å°†æ¥, å°¾è°ƒä¼˜åŒ–å°±ä¼šå¾—åˆ°ä¸»æµæµè§ˆå™¨çš„æ”¯æŒ.</p>
<p>ä»¥ä¸‹æ˜¯å…¶ç®—æ³•å¤æ‚åº¦:</p>
<table>
<thead>
<tr>
<th style="text-align:center">å¹³å‡æ—¶é—´å¤æ‚åº¦</th>
<th style="text-align:center">æœ€å¥½æƒ…å†µ</th>
<th style="text-align:center">æœ€åæƒ…å†µ</th>
<th style="text-align:center">ç©ºé—´å¤æ‚åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(n)</td>
</tr>
</tbody>
</table>
<p>ä»æ•ˆç‡ä¸Šçœ‹, å½’å¹¶æ’åºå¯ç®—æ˜¯æ’åºç®—æ³•ä¸­çš„â€ä½¼ä½¼è€…â€. å‡è®¾æ•°ç»„é•¿åº¦ä¸ºn, é‚£ä¹ˆæ‹†åˆ†æ•°ç»„å…±éœ€lognæ­¥, åˆæ¯æ­¥éƒ½æ˜¯ä¸€ä¸ªæ™®é€šçš„åˆå¹¶å­æ•°ç»„çš„è¿‡ç¨‹, æ—¶é—´å¤æ‚åº¦ä¸ºO(n), æ•…å…¶ç»¼åˆæ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn). å¦ä¸€æ–¹é¢, å½’å¹¶æ’åºå¤šæ¬¡é€’å½’è¿‡ç¨‹ä¸­æ‹†åˆ†çš„å­æ•°ç»„éœ€è¦ä¿å­˜åœ¨å†…å­˜ç©ºé—´, å…¶ç©ºé—´å¤æ‚åº¦ä¸ºO(n).</p>
<h3 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h3><p>å¿«é€Ÿæ’åºå€Ÿç”¨äº†åˆ†æ²»çš„æ€æƒ³, å¹¶ä¸”åŸºäºå†’æ³¡æ’åºåšäº†æ”¹è¿›. å®ƒç”±C. A. R. Hoareåœ¨1962å¹´æå‡º. å®ƒå°†æ•°ç»„æ‹†åˆ†ä¸ºä¸¤ä¸ªå­æ•°ç»„, å…¶ä¸­ä¸€ä¸ªå­æ•°ç»„çš„æ‰€æœ‰å…ƒç´ éƒ½æ¯”å¦ä¸€ä¸ªå­æ•°ç»„çš„å…ƒç´ å°, ç„¶åå¯¹è¿™ä¸¤ä¸ªå­æ•°ç»„å†é‡å¤è¿›è¡Œä¸Šè¿°æ“ä½œ, ç›´åˆ°æ•°ç»„ä¸å¯æ‹†åˆ†, æ’åºå®Œæˆ.</p>
<p>å¦‚ä¸‹æ˜¯åŠ¨å›¾æ•ˆæœ:</p>
<p><img src="http://louiszhai.github.io/docImages/sort09.gif" alt="å¿«é€Ÿæ’åº"></p>
<p>å¦‚ä¸‹æ˜¯ç®—æ³•å®ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickSort</span>(<span class="params">array, left, right</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> partitionIndex,</div><div class="line">      left = <span class="keyword">typeof</span> left == <span class="string">'number'</span> ? left : <span class="number">0</span>,</div><div class="line">      right = <span class="keyword">typeof</span> right == <span class="string">'number'</span> ? right : array.length<span class="number">-1</span>;</div><div class="line">  <span class="keyword">if</span> (left &lt; right) &#123;</div><div class="line">    partitionIndex = partition(array, left, right);<span class="comment">//åˆ‡åˆ†çš„åŸºå‡†å€¼</span></div><div class="line">    quickSort(array, left, partitionIndex<span class="number">-1</span>);</div><div class="line">    quickSort(array, partitionIndex+<span class="number">1</span>, right);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">partition</span>(<span class="params">array, left ,right</span>) </span>&#123;   <span class="comment">//åˆ†åŒºæ“ä½œ</span></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = left+<span class="number">1</span>, j = left; i &lt;= right; i++) &#123;<span class="comment">//jæ˜¯è¾ƒå°å€¼å­˜å‚¨ä½ç½®çš„æ¸¸æ ‡</span></div><div class="line">    array[i] &lt; array[left] &amp;&amp; swap(i, ++j, array);<span class="comment">//ä»¥ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºåŸºå‡†</span></div><div class="line">  &#125;</div><div class="line">  swap(left, j, array);			<span class="comment">//å°†ç¬¬ä¸€ä¸ªå…ƒç´ ç§»è‡³ä¸­é—´</span></div><div class="line">  <span class="keyword">return</span> j;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯å…¶ç®—æ³•å¤æ‚åº¦:</p>
<table>
<thead>
<tr>
<th style="text-align:center">å¹³å‡æ—¶é—´å¤æ‚åº¦</th>
<th style="text-align:center">æœ€å¥½æƒ…å†µ</th>
<th style="text-align:center">æœ€åæƒ…å†µ</th>
<th style="text-align:center">ç©ºé—´å¤æ‚åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
</tr>
</tbody>
</table>
<p>å¿«é€Ÿæ’åºæ’åºæ•ˆç‡éå¸¸é«˜. è™½ç„¶å®ƒè¿è¡Œæœ€ç³Ÿç³•æ—¶å°†è¾¾åˆ°O(nÂ²)çš„æ—¶é—´å¤æ‚åº¦, ä½†é€šå¸¸, å¹³å‡æ¥çœ‹, å®ƒçš„æ—¶é—´å¤æ‚ä¸ºO(nlogn), æ¯”åŒæ ·ä¸ºO(nlogn)æ—¶é—´å¤æ‚åº¦çš„å½’å¹¶æ’åºè¿˜è¦å¿«. å¿«é€Ÿæ’åºä¼¼ä¹æ›´åçˆ±ä¹±åºçš„æ•°åˆ—, è¶Šæ˜¯ä¹±åºçš„æ•°åˆ—, å®ƒç›¸æ¯”å…¶ä»–æ’åºè€Œè¨€, ç›¸å¯¹æ•ˆç‡æ›´é«˜. ä¹‹å‰åœ¨ <a href="http://louiszhai.github.io/2015/12/29/array/#">æ‹ä¸€æ‹JSçš„æ•°ç»„</a> ä¸€æ–‡ä¸­å°±æåˆ°: <strong>Chromeçš„v8å¼•æ“ä¸ºäº†é«˜æ•ˆæ’åº, åœ¨æ’åºæ•°æ®è¶…è¿‡äº†10æ¡æ—¶, ä¾¿ä¼šé‡‡ç”¨å¿«é€Ÿæ’åº. å¯¹äº10æ¡åŠä»¥ä¸‹çš„æ•°æ®é‡‡ç”¨çš„ä¾¿æ˜¯æ’å…¥æ’åº.</strong></p>
<p><strong><em>Tips</em></strong>: åŒé€‰æ‹©æ’åºç›¸ä¼¼, å¿«é€Ÿæ’åºæ¯æ¬¡äº¤æ¢çš„å…ƒç´ éƒ½æœ‰å¯èƒ½ä¸æ˜¯ç›¸é‚»çš„, å› æ­¤å®ƒæœ‰å¯èƒ½æ‰“ç ´åŸæ¥å€¼ä¸ºç›¸åŒçš„å…ƒç´ ä¹‹é—´çš„é¡ºåº. å› æ­¤, å¿«é€Ÿæ’åºå¹¶ä¸ç¨³å®š.</p>
<h3 id="å †æ’åº"><a href="#å †æ’åº" class="headerlink" title="å †æ’åº"></a>å †æ’åº</h3><blockquote>
<p>1991å¹´çš„è®¡ç®—æœºå…ˆé©±å¥–è·å¾—è€…ã€æ–¯å¦ç¦å¤§å­¦è®¡ç®—æœºç§‘å­¦ç³»æ•™æˆç½—ä¼¯ç‰¹Â·å¼—æ´›ä¼Šå¾·(Robert Wï¼Floyd) å’Œå¨å»‰å§†æ–¯(Jï¼Williams) åœ¨1964å¹´å…±åŒå‘æ˜äº†è‘—åçš„å †æ’åºç®—æ³•(Heap Sort).</p>
</blockquote>
<p>å †æ’åºæ˜¯åˆ©ç”¨å †è¿™ç§æ•°æ®ç»“æ„æ‰€è®¾è®¡çš„ä¸€ç§æ’åºç®—æ³•. å®ƒæ˜¯é€‰æ‹©æ’åºçš„ä¸€ç§. å †åˆ†ä¸ºå¤§æ ¹å †å’Œå°æ ¹å †. å¤§æ ¹å †è¦æ±‚æ¯ä¸ªå­èŠ‚ç‚¹çš„å€¼éƒ½ä¸å¤§äºå…¶çˆ¶èŠ‚ç‚¹çš„å€¼, å³array[childIndex] &lt;= array[parentIndex], æœ€å¤§çš„å€¼ä¸€å®šåœ¨å †é¡¶. å°æ ¹å †ä¸ä¹‹ç›¸å, å³æ¯ä¸ªå­èŠ‚ç‚¹çš„å€¼éƒ½ä¸å°äºå…¶çˆ¶èŠ‚ç‚¹çš„å€¼, æœ€å°çš„å€¼ä¸€å®šåœ¨å †é¡¶. å› æ­¤æˆ‘ä»¬å¯ä½¿ç”¨å¤§æ ¹å †è¿›è¡Œå‡åºæ’åº, ä½¿ç”¨å°æ ¹å †è¿›è¡Œé™åºæ’åº.</p>
<p>å¹¶éæ‰€æœ‰çš„åºåˆ—éƒ½æ˜¯å †, å¯¹äºåºåˆ—k1, k2,â€¦kn, éœ€è¦æ»¡è¶³å¦‚ä¸‹æ¡ä»¶æ‰è¡Œ:</p>
<ul>
<li>ki &lt;= k(2i) ä¸” ki&lt;=k(2i+1)(1â‰¤iâ‰¤ n/2), å³ä¸ºå°æ ¹å †, å°†&lt;=æ¢æˆ&gt;=, é‚£ä¹ˆåˆ™æ˜¯å¤§æ ¹å †. æˆ‘ä»¬å¯ä»¥å°†è¿™é‡Œçš„å †çœ‹ä½œå®Œå…¨äºŒå‰æ ‘, k(i) ç›¸å½“äºæ˜¯äºŒå‰æ ‘çš„éå¶å­èŠ‚ç‚¹, k(2i) åˆ™æ˜¯å·¦å­èŠ‚ç‚¹, k(2i+1)æ˜¯å³å­èŠ‚ç‚¹.</li>
</ul>
<p>ç®—æ³•çš„åŸºæœ¬æ€æƒ³(ä»¥å¤§æ ¹å †ä¸ºä¾‹): </p>
<ol>
<li>å…ˆå°†åˆå§‹åºåˆ—K[1..n]å»ºæˆä¸€ä¸ªå¤§æ ¹å †, æ­¤å †ä¸ºåˆå§‹çš„æ— åºåŒº.</li>
<li>å†å°†å…³é”®å­—æœ€å¤§çš„è®°å½•K<a href="#respond">1</a> (å³å †é¡¶)å’Œæ— åºåŒºçš„æœ€åä¸€ä¸ªè®°å½•K[n]äº¤æ¢, ç”±æ­¤å¾—åˆ°æ–°çš„æ— åºåŒºK[1..n-1]å’Œæœ‰åºåŒºK[n], ä¸”æ»¡è¶³K[1..n-1].keysâ‰¤K[n].key</li>
<li>äº¤æ¢K<a href="#respond">1</a> å’Œ K[n] å, å †é¡¶å¯èƒ½è¿åå †æ€§è´¨, å› æ­¤éœ€å°†K[1..n-1]è°ƒæ•´ä¸ºå †. ç„¶åé‡å¤æ­¥éª¤2, ç›´åˆ°æ— åºåŒºåªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶åœæ­¢.</li>
</ol>
<p>å¦‚ä¸‹æ˜¯åŠ¨å›¾æ•ˆæœ:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1867034-bf2472770e2258a9.gif?imageMogr2/auto-orient/strip" alt="æ¡¶æ’åºç¤ºæ„å›¾"></p>
<p>å¦‚ä¸‹æ˜¯ç®—æ³•å®ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">heapAdjust</span>(<span class="params">array, i, length</span>) </span>&#123;<span class="comment">//å †è°ƒæ•´</span></div><div class="line">  <span class="keyword">var</span> left = <span class="number">2</span> * i + <span class="number">1</span>,</div><div class="line">      right = <span class="number">2</span> * i + <span class="number">2</span>,</div><div class="line">      largest = i;</div><div class="line">  <span class="keyword">if</span> (left &lt; length &amp;&amp; array[largest] &lt; array[left]) &#123;</div><div class="line">    largest = left;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (right &lt; length &amp;&amp; array[largest] &lt; array[right]) &#123;</div><div class="line">    largest = right;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (largest != i) &#123;</div><div class="line">    swap(i, largest, array);</div><div class="line">    heapAdjust(array, largest, length);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">heapSort</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">  <span class="comment">//å»ºç«‹å¤§é¡¶å †</span></div><div class="line">  length = array.length;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = length&gt;&gt;<span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">    heapAdjust(array, i, length);</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//è°ƒæ¢ç¬¬ä¸€ä¸ªä¸æœ€åä¸€ä¸ªå…ƒç´ ,é‡æ–°è°ƒæ•´ä¸ºå¤§é¡¶å †</span></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = length - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</div><div class="line">    swap(<span class="number">0</span>, i, array);</div><div class="line">    heapAdjust(array, <span class="number">0</span>, --length);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, â‘ å»ºç«‹å †çš„è¿‡ç¨‹, ä»length/2 ä¸€ç›´å¤„ç†åˆ°0, æ—¶é—´å¤æ‚åº¦ä¸ºO(n);</p>
<p>â‘¡è°ƒæ•´å †çš„è¿‡ç¨‹æ˜¯æ²¿ç€å †çš„çˆ¶å­èŠ‚ç‚¹è¿›è¡Œè°ƒæ•´, æ‰§è¡Œæ¬¡æ•°ä¸ºå †çš„æ·±åº¦, æ—¶é—´å¤æ‚åº¦ä¸ºO(lgn);</p>
<p>â‘¢å †æ’åºçš„è¿‡ç¨‹ç”±næ¬¡ç¬¬â‘¡æ­¥å®Œæˆ, æ—¶é—´å¤æ‚åº¦ä¸ºO(nlgn).</p>
<p><strong><em>Tips</em></strong>: ç”±äºå †æ’åºä¸­åˆå§‹åŒ–å †çš„è¿‡ç¨‹æ¯”è¾ƒæ¬¡æ•°è¾ƒå¤š, å› æ­¤å®ƒä¸å¤ªé€‚ç”¨äºå°åºåˆ—. åŒæ—¶ç”±äºå¤šæ¬¡ä»»æ„ä¸‹æ ‡ç›¸äº’äº¤æ¢ä½ç½®, ç›¸åŒå…ƒç´ ä¹‹é—´åŸæœ¬ç›¸å¯¹çš„é¡ºåºè¢«ç ´åäº†, å› æ­¤, å®ƒæ˜¯ä¸ç¨³å®šçš„æ’åº.</p>
<h3 id="è®¡æ•°æ’åº"><a href="#è®¡æ•°æ’åº" class="headerlink" title="è®¡æ•°æ’åº"></a>è®¡æ•°æ’åº</h3><p>è®¡æ•°æ’åºå‡ ä¹æ˜¯å”¯ä¸€ä¸€ä¸ªä¸åŸºäºæ¯”è¾ƒçš„æ’åºç®—æ³•, è¯¥ç®—æ³•äº1954å¹´ç”± Harold H. Seward æå‡º. ä½¿ç”¨å®ƒå¤„ç†ä¸€å®šèŒƒå›´å†…çš„æ•´æ•°æ’åºæ—¶, æ—¶é—´å¤æ‚åº¦ä¸ºO(n+k), å…¶ä¸­kæ˜¯æ•´æ•°çš„èŒƒå›´, å®ƒå‡ ä¹æ¯”ä»»ä½•åŸºäºæ¯”è¾ƒçš„æ’åºç®—æ³•éƒ½è¦å¿«( åªæœ‰å½“O(k)&gt;O(n*log(n))çš„æ—¶å€™å…¶æ•ˆç‡åè€Œä¸å¦‚åŸºäºæ¯”è¾ƒçš„æ’åº, å¦‚å½’å¹¶æ’åºå’Œå †æ’åº).</p>
<p>ä½¿ç”¨è®¡æ•°æ’åºéœ€è¦æ»¡è¶³å¦‚ä¸‹æ¡ä»¶:</p>
<ul>
<li>å¾…æ’åºçš„åºåˆ—å…¨éƒ¨ä¸ºæ•´æ•°</li>
<li>æ’åºéœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´</li>
</ul>
<p>ç®—æ³•çš„åŸºæœ¬æ€æƒ³: </p>
<blockquote>
<p>è®¡æ•°æ’åºåˆ©ç”¨äº†ä¸€ä¸ªç‰¹æ€§, å¯¹äºæ•°ç»„çš„æŸä¸ªå…ƒç´ , ä¸€æ—¦çŸ¥é“äº†æœ‰å¤šå°‘ä¸ªå…¶å®ƒå…ƒç´ æ¯”å®ƒå°(å‡è®¾ä¸ºmä¸ª), é‚£ä¹ˆå°±å¯ä»¥ç¡®å®šå‡ºè¯¥å…ƒç´ çš„æ­£ç¡®ä½ç½®(ç¬¬m+1ä½)</p>
</blockquote>
<ol>
<li>åˆå§‹åŒ–æ¸¸æ ‡iä¸º0, å¹¶å‡†å¤‡ä¸€ä¸ªç¼“å­˜æ•°ç»„B, é•¿åº¦ä¸ºå¾…æ’åºæ•°ç»„Açš„æœ€å¤§å€¼+1, å¾ªç¯ä¸€éå¾…æ’åºæ•°ç»„A, åœ¨ç¼“å­˜æ•°ç»„Bä¸­å­˜å‚¨Açš„å„ä¸ªå…ƒç´ å‡ºç°çš„æ¬¡æ•°.</li>
<li>â‘ å°†Bä¸­çš„å½“å‰å…ƒç´ itemä¸0æ¯”è¾ƒ, è‹¥å¤§äº0, åˆ™å¾€å¾…æ’åºæ•°ç»„Aä¸­å†™å…¥ä¸€é¡¹A[i] = item; ç„¶åi++, itemâ€”; ç„¶åé‡å¤æ­¥éª¤â‘ , ç›´åˆ°item==0, åˆ™è¿›å…¥åˆ°Bçš„ä¸‹ä¸€ä¸ªå…ƒç´ ä¸­.</li>
<li>éå†ç¼“å­˜æ•°ç»„B, å³å¾ªç¯æ‰§è¡Œæ­¥éª¤2. æœ€ç»ˆæ‰€æœ‰æœ‰æ•ˆå…ƒç´ éƒ½å°†ä¾æ¬¡å†™å›å¾…æ’åºæ•°ç»„Açš„ç¬¬1,2,â€¦né¡¹.</li>
</ol>
<p>å¦‚ä¸‹æ˜¯åŠ¨å›¾æ•ˆæœ:</p>
<p><img src="http://louiszhai.github.io/docImages/sort10.gif" alt="è®¡æ•°æ’åº"></p>
<p>å¦‚ä¸‹æ˜¯ç®—æ³•å®ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">countSort</span>(<span class="params">array, max</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> tempLength = max + <span class="number">1</span>,</div><div class="line">        temp = <span class="keyword">new</span> <span class="built_in">Array</span>(tempLength),</div><div class="line">        index = <span class="number">0</span>,</div><div class="line">        length = array.length;   </div><div class="line">    <span class="comment">//åˆå§‹åŒ–ç¼“å­˜æ•°ç»„å„é¡¹çš„å€¼</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</div><div class="line">        <span class="keyword">if</span> (!temp[array[i]]) &#123;</div><div class="line">            temp[array[i]] = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        temp[array[i]]++;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//ä¾æ¬¡å–å‡ºç¼“å­˜æ•°ç»„çš„å€¼,å¹¶å†™å…¥åŸæ•°ç»„</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; tempLength; j++) &#123;</div><div class="line">        <span class="keyword">while</span>(temp[j] &gt; <span class="number">0</span>) &#123;</div><div class="line">            array[index++] = j;</div><div class="line">            temp[j]--;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong><em>Tips</em></strong>: è®¡æ•°æ’åºä¸æ”¹å˜ç›¸åŒå…ƒç´ ä¹‹é—´åŸæœ¬ç›¸å¯¹çš„é¡ºåº, å› æ­¤å®ƒæ˜¯ç¨³å®šçš„æ’åºç®—æ³•.</p>
<h3 id="æ¡¶æ’åº"><a href="#æ¡¶æ’åº" class="headerlink" title="æ¡¶æ’åº"></a>æ¡¶æ’åº</h3><p>æ¡¶æ’åºå³æ‰€è°“çš„ç®±æ’åº, å®ƒæ˜¯å°†æ•°ç»„åˆ†é…åˆ°æœ‰é™æ•°é‡çš„æ¡¶å­é‡Œ. æ¯ä¸ªæ¡¶é‡Œå†å„è‡ªæ’åº(å› æ­¤æœ‰å¯èƒ½ä½¿ç”¨åˆ«çš„æ’åºç®—æ³•æˆ–ä»¥é€’å½’æ–¹å¼ç»§ç»­æ¡¶æ’åº). å½“æ¯ä¸ªæ¡¶é‡Œçš„å…ƒç´ ä¸ªæ•°è¶‹äºä¸€è‡´æ—¶, æ¡¶æ’åºåªéœ€èŠ±è´¹O(n)çš„æ—¶é—´. æ¡¶æ’åºé€šè¿‡ç©ºé—´æ¢æ—¶é—´çš„æ–¹å¼æé«˜äº†æ•ˆç‡, å› æ­¤å®ƒéœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´(å³æ¡¶çš„ç©ºé—´).</p>
<p>ç®—æ³•çš„åŸºæœ¬æ€æƒ³:</p>
<p>æ¡¶æ’åºçš„æ ¸å¿ƒå°±åœ¨äºæ€ä¹ˆæŠŠå…ƒç´ å¹³å‡åˆ†é…åˆ°æ¯ä¸ªæ¡¶é‡Œ, åˆç†çš„åˆ†é…å°†å¤§å¤§æé«˜æ’åºçš„æ•ˆç‡.</p>
<p>å¦‚ä¸‹æ˜¯ç®—æ³•å®ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bucketSort</span>(<span class="params">array, bucketSize</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (array.length === <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">return</span> array;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> i = <span class="number">1</span>,</div><div class="line">      min = array[<span class="number">0</span>],</div><div class="line">      max = min;</div><div class="line">  <span class="keyword">while</span> (i++ <span class="xml"><span class="tag">&lt; <span class="attr">array.length</span>) &#123;</span></span></div><div class="line">    <span class="attr">if</span> (<span class="attr">array</span>[<span class="attr">i</span>] &lt; <span class="attr">min</span>) &#123;</div><div class="line">      <span class="attr">min</span> = <span class="string">array[i];</span>                //è¾“å…¥æ•°æ®çš„æœ€å°å€¼</div><div class="line">    &#125; <span class="attr">else</span> <span class="attr">if</span> (<span class="attr">array</span>[<span class="attr">i</span>] &gt; max) &#123;</div><div class="line">      max = array[i];                //è¾“å…¥æ•°æ®çš„æœ€å¤§å€¼</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  //æ¡¶çš„åˆå§‹åŒ–</div><div class="line">  bucketSize = bucketSize || 5; //è®¾ç½®æ¡¶çš„é»˜è®¤å¤§å°ä¸º5</div><div class="line">  var bucketCount = ~~((max - min) / bucketSize) + 1, //æ¡¶çš„ä¸ªæ•°</div><div class="line">      buckets = new Array(bucketCount); //åˆ›å»ºæ¡¶</div><div class="line">  for (i = 0; i <span class="tag">&lt; <span class="attr">buckets.length</span>; <span class="attr">i</span>++) &#123;</span></div><div class="line">    <span class="attr">buckets</span>[<span class="attr">i</span>] = <span class="string">[];</span> //åˆå§‹åŒ–æ¡¶</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  //å°†æ•°æ®åˆ†é…åˆ°å„ä¸ªæ¡¶ä¸­,è¿™é‡Œç›´æ¥æŒ‰ç…§æ•°æ®å€¼çš„åˆ†å¸ƒæ¥åˆ†é…,ä¸€å®šèŒƒå›´å†…å‡åŒ€åˆ†å¸ƒçš„æ•°æ®æ•ˆç‡æœ€ä¸ºé«˜æ•ˆ</div><div class="line">  <span class="attr">for</span> (<span class="attr">i</span> = <span class="string">0;</span> <span class="attr">i</span> &lt; <span class="attr">array.length</span>; <span class="attr">i</span>++) &#123;</div><div class="line">    <span class="attr">buckets</span>[~~((<span class="attr">array</span>[<span class="attr">i</span>] <span class="attr">-</span> <span class="attr">min</span>) / <span class="attr">bucketSize</span>)]<span class="attr">.push</span>(<span class="attr">array</span>[<span class="attr">i</span>]);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="attr">array.length</span> = <span class="string">0;</span></div><div class="line">  <span class="attr">for</span> (<span class="attr">i</span> = <span class="string">0;</span> <span class="attr">i</span> &lt; <span class="attr">buckets.length</span>; <span class="attr">i</span>++) &#123;</div><div class="line">    <span class="attr">quickSort</span>(<span class="attr">buckets</span>[<span class="attr">i</span>]); //å¯¹æ¯ä¸ªæ¡¶è¿›è¡Œæ’åºï¼Œè¿™é‡Œä½¿ç”¨äº†å¿«é€Ÿæ’åº</div><div class="line">    <span class="attr">for</span> (<span class="attr">var</span> <span class="attr">j</span> = <span class="string">0;</span> <span class="attr">j</span> &lt; <span class="attr">buckets</span>[<span class="attr">i</span>]<span class="attr">.length</span>; <span class="attr">j</span>++) &#123;</div><div class="line">      <span class="attr">array.push</span>(<span class="attr">buckets</span>[<span class="attr">i</span>][<span class="attr">j</span>]); //å°†å·²æ’åºçš„æ•°æ®å†™å›æ•°ç»„ä¸­</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="attr">return</span> <span class="attr">array</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong><em>Tips</em></strong>: æ¡¶æ’åºæœ¬èº«æ˜¯ç¨³å®šçš„æ’åº, å› æ­¤å®ƒçš„ç¨³å®šæ€§ä¸æ¡¶å†…æ’åºçš„ç¨³å®šæ€§ä¿æŒä¸€è‡´.</p>
<p>å®é™…ä¸Š, æ¡¶ä¹Ÿåªæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µ, å®ƒçš„æ€æƒ³ä¸å½’å¹¶æ’åº,å¿«é€Ÿæ’åºç­‰ç±»ä¼¼, éƒ½æ˜¯é€šè¿‡å°†å¤§é‡æ•°æ®åˆ†é…åˆ°Nä¸ªä¸åŒçš„å®¹å™¨ä¸­, åˆ†åˆ«æ’åº, æœ€åå†åˆå¹¶æ•°æ®. è¿™ç§æ–¹å¼å¤§å¤§å‡å°‘äº†æ’åºæ—¶æ•´ä½“çš„éå†æ¬¡æ•°, æé«˜äº†ç®—æ³•æ•ˆç‡.</p>
<h3 id="åŸºæ•°æ’åº"><a href="#åŸºæ•°æ’åº" class="headerlink" title="åŸºæ•°æ’åº"></a>åŸºæ•°æ’åº</h3><p>åŸºæ•°æ’åºæºäºè€å¼ç©¿å­”æœº, æ’åºå™¨æ¯æ¬¡åªèƒ½çœ‹åˆ°ä¸€ä¸ªåˆ—. å®ƒæ˜¯åŸºäºå…ƒç´ å€¼çš„æ¯ä¸ªä½ä¸Šçš„å­—ç¬¦æ¥æ’åºçš„. å¯¹äºæ•°å­—è€Œè¨€å°±æ˜¯åˆ†åˆ«åŸºäºä¸ªä½, åä½, ç™¾ä½ æˆ–åƒä½ç­‰ç­‰æ•°å­—æ¥æ’åº. (ä¸æ˜ç™½ä¸è¦ç´§, æˆ‘ä¹Ÿä¸æ‡‚, è¯·æ¥ç€å¾€ä¸‹è¯»)</p>
<p>æŒ‰ç…§ä¼˜å…ˆä»é«˜ä½æˆ–ä½ä½æ¥æ’åºæœ‰ä¸¤ç§å®ç°æ–¹æ¡ˆ:</p>
<ul>
<li>MSD: ç”±é«˜ä½ä¸ºåŸºåº•, å…ˆæŒ‰k1æ’åºåˆ†ç»„, åŒä¸€ç»„ä¸­è®°å½•, å…³é”®ç k1ç›¸ç­‰, å†å¯¹å„ç»„æŒ‰k2æ’åºåˆ†æˆå­ç»„, ä¹‹å, å¯¹åé¢çš„å…³é”®ç ç»§ç»­è¿™æ ·çš„æ’åºåˆ†ç»„, ç›´åˆ°æŒ‰æœ€æ¬¡ä½å…³é”®ç kdå¯¹å„å­ç»„æ’åºå. å†å°†å„ç»„è¿æ¥èµ·æ¥, ä¾¿å¾—åˆ°ä¸€ä¸ªæœ‰åºåºåˆ—. MSDæ–¹å¼é€‚ç”¨äºä½æ•°å¤šçš„åºåˆ—.</li>
<li>LSD: ç”±ä½ä½ä¸ºåŸºåº•, å…ˆä»kdå¼€å§‹æ’åºï¼Œå†å¯¹kd-1è¿›è¡Œæ’åºï¼Œä¾æ¬¡é‡å¤ï¼Œç›´åˆ°å¯¹k1æ’åºåä¾¿å¾—åˆ°ä¸€ä¸ªæœ‰åºåºåˆ—. LSDæ–¹å¼é€‚ç”¨äºä½æ•°å°‘çš„åºåˆ—.</li>
</ul>
<p>å¦‚ä¸‹æ˜¯LSDçš„åŠ¨å›¾æ•ˆæœ:</p>
<p><img src="http://louiszhai.github.io//docImages/sort11.gif" alt="åŸºæ•°æ’åº">)</p>
<p>å¦‚ä¸‹æ˜¯ç®—æ³•å®ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">radixSort</span>(<span class="params">array, max</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> buckets = [],</div><div class="line">        unit = <span class="number">10</span>,</div><div class="line">        base = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; max; i++, base *= <span class="number">10</span>, unit *= <span class="number">10</span>) &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; array.length; j++) &#123;</div><div class="line">            <span class="keyword">var</span> index = ~~((array[j] % unit) / base);<span class="comment">//ä¾æ¬¡è¿‡æ»¤å‡ºä¸ªä½,åä½ç­‰ç­‰æ•°å­—</span></div><div class="line">            <span class="keyword">if</span>(buckets[index] == <span class="literal">null</span>) &#123;</div><div class="line">                buckets[index] = []; <span class="comment">//åˆå§‹åŒ–æ¡¶</span></div><div class="line">            &#125;</div><div class="line">            buckets[index].push(array[j]);<span class="comment">//å¾€ä¸åŒæ¡¶é‡Œæ·»åŠ æ•°æ®</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">var</span> pos = <span class="number">0</span>,</div><div class="line">            value;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>, length = buckets.length; j &lt; length; j++) &#123;</div><div class="line">            <span class="keyword">if</span>(buckets[j] != <span class="literal">null</span>) &#123;</div><div class="line">                <span class="keyword">while</span> ((value = buckets[j].shift()) != <span class="literal">null</span>) &#123;</div><div class="line">                      array[pos++] = value; <span class="comment">//å°†ä¸åŒæ¡¶é‡Œæ•°æ®æŒ¨ä¸ªæå‡ºæ¥,ä¸ºä¸‹ä¸€è½®é«˜ä½æ’åºåšå‡†å¤‡,ç”±äºé è¿‘æ¡¶åº•çš„å…ƒç´ æ’åé å‰,å› æ­¤ä»æ¡¶åº•å…ˆæ</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šç®—æ³•, å¦‚æœç”¨æ¥æ¯”è¾ƒæ—¶é—´, å…ˆæŒ‰æ—¥æ’åº, å†æŒ‰æœˆæ’åº, æœ€åæŒ‰å¹´æ’åº, ä»…éœ€æ’åºä¸‰æ¬¡.</p>
<p>åŸºæ•°æ’åºæ›´é€‚åˆç”¨äºå¯¹æ—¶é—´, å­—ç¬¦ä¸²ç­‰è¿™äº›æ•´ä½“æƒå€¼æœªçŸ¥çš„æ•°æ®è¿›è¡Œæ’åº.</p>
<p><strong><em>Tips</em></strong>: åŸºæ•°æ’åºä¸æ”¹å˜ç›¸åŒå…ƒç´ ä¹‹é—´çš„ç›¸å¯¹é¡ºåº, å› æ­¤å®ƒæ˜¯ç¨³å®šçš„æ’åºç®—æ³•.</p>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>å„ç§æ’åºæ€§èƒ½å¯¹æ¯”å¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th style="text-align:center">æ’åºç±»å‹</th>
<th style="text-align:center">å¹³å‡æƒ…å†µ</th>
<th style="text-align:center">æœ€å¥½æƒ…å†µ</th>
<th style="text-align:center">æœ€åæƒ…å†µ</th>
<th style="text-align:center">è¾…åŠ©ç©ºé—´</th>
<th style="text-align:center">ç¨³å®šæ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">å†’æ³¡æ’åº</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(n)</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(1)</td>
<td style="text-align:center">ç¨³å®š</td>
</tr>
<tr>
<td style="text-align:center">é€‰æ‹©æ’åº</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(1)</td>
<td style="text-align:center">ä¸ç¨³å®š</td>
</tr>
<tr>
<td style="text-align:center">ç›´æ¥æ’å…¥æ’åº</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(n)</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(1)</td>
<td style="text-align:center">ç¨³å®š</td>
</tr>
<tr>
<td style="text-align:center">æŠ˜åŠæ’å…¥æ’åº</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(n)</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(1)</td>
<td style="text-align:center">ç¨³å®š</td>
</tr>
<tr>
<td style="text-align:center">å¸Œå°”æ’åº</td>
<td style="text-align:center">O(n^1.3)</td>
<td style="text-align:center">O(nlogn)</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(1)</td>
<td style="text-align:center">ä¸ç¨³å®š</td>
</tr>
<tr>
<td style="text-align:center">å½’å¹¶æ’åº</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(n)</td>
<td style="text-align:center">ç¨³å®š</td>
</tr>
<tr>
<td style="text-align:center">å¿«é€Ÿæ’åº</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">ä¸ç¨³å®š</td>
</tr>
<tr>
<td style="text-align:center">å †æ’åº</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(nlogâ‚‚n)</td>
<td style="text-align:center">O(1)</td>
<td style="text-align:center">ä¸ç¨³å®š</td>
</tr>
<tr>
<td style="text-align:center">è®¡æ•°æ’åº</td>
<td style="text-align:center">O(n+k)</td>
<td style="text-align:center">O(n+k)</td>
<td style="text-align:center">O(n+k)</td>
<td style="text-align:center">O(k)</td>
<td style="text-align:center">ç¨³å®š</td>
</tr>
<tr>
<td style="text-align:center">æ¡¶æ’åº</td>
<td style="text-align:center">O(n+k)</td>
<td style="text-align:center">O(n+k)</td>
<td style="text-align:center">O(nÂ²)</td>
<td style="text-align:center">O(n+k)</td>
<td style="text-align:center">(ä¸)ç¨³å®š</td>
</tr>
<tr>
<td style="text-align:center">åŸºæ•°æ’åº</td>
<td style="text-align:center">O(d(n+k))</td>
<td style="text-align:center">O(d(n+k))</td>
<td style="text-align:center">O(d(n+kd))</td>
<td style="text-align:center">O(n+kd)</td>
<td style="text-align:center">ç¨³å®š</td>
</tr>
</tbody>
</table>
<p>æ³¨: æ¡¶æ’åºçš„ç¨³å®šæ€§å–å†³äºæ¡¶å†…æ’åºçš„ç¨³å®šæ€§, å› æ­¤å…¶ç¨³å®šæ€§ä¸ç¡®å®š. åŸºæ•°æ’åºä¸­, kä»£è¡¨å…³é”®å­—çš„åŸºæ•°, dä»£è¡¨é•¿åº¦, nä»£è¡¨å…³é”®å­—çš„ä¸ªæ•°.</p>
<p>æ„¿ä»¥æ­¤æ–‡æ€€å¿µä¸‹æˆ‘é‚£è¿œå»çš„ç®—æ³•è¯¾ç¨‹.</p>
<p>æœªå®Œå¾…ç»­â€¦</p>
<p>æ„Ÿè°¢ <a href="http://visualgo.net/" target="_blank" rel="external">http://visualgo.net/</a> æä¾›å›¾ç‰‡æ”¯æŒ. ç‰¹åˆ«æ„Ÿè°¢ <a href="http://www.jianshu.com/users/6c53fb7d1bce" target="_blank" rel="external">ä¸æ˜¯å°ç¾Šçš„è‚–æ©</a> åœ¨ç®€ä¹¦ä¸Šå‘å¸ƒçš„ <a href="http://www.jianshu.com/p/1b4068ccd505" target="_blank" rel="external">JSå®¶çš„æ’åºç®—æ³•</a> æä¾›çš„è®²è§£.</p>
<hr>
<p>æœ¬é—®å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/12/23/sort/">http://louiszhai.github.io/2016/12/23/sort/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="http://www.jianshu.com/p/1b4068ccd505" target="_blank" rel="external">JSå®¶çš„æ’åºç®—æ³• - ç®€ä¹¦</a></li>
<li><a href="http://blog.csdn.net/morewindows/article/details/6668714" target="_blank" rel="external">ç™½è¯ç»å…¸ç®—æ³•ç³»åˆ—ä¹‹ä¸‰ å¸Œå°”æ’åºçš„å®ç° - MoreWindows Blog - åšå®¢é¢‘é“ - CSDN.NET</a></li>
<li><a href="http://www.cnblogs.com/ludashi/p/6031379.html" target="_blank" rel="external">ç®—æ³•ä¸æ•°æ®ç»“æ„(åä¸‰) å†’æ³¡æ’åºã€æ’å…¥æ’åºã€å¸Œå°”æ’åºã€é€‰æ‹©æ’åºï¼ˆSwift3.0ç‰ˆï¼‰ - é’ç‰ä¼æ¡ˆ - åšå®¢å›­</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      ç®—æ³•
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://louiszhai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>èŠä¸€èŠH5åº”ç”¨ç¼“å­˜-Manifest</title>
    <link href="http://louiszhai.github.io/2016/11/25/manifest/"/>
    <id>http://louiszhai.github.io/2016/11/25/manifest/</id>
    <published>2016-11-25T00:08:21.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>Manifest æ˜¯ H5æä¾›çš„ä¸€ç§åº”ç”¨ç¼“å­˜æœºåˆ¶, åŸºäºå®ƒwebåº”ç”¨å¯ä»¥å®ç°ç¦»çº¿è®¿é—®(offline cache). ä¸ºæ­¤, æµè§ˆå™¨è¿˜æä¾›äº†åº”ç”¨ç¼“å­˜çš„apiâ€“applicationCache. è™½ç„¶manifestçš„æŠ€æœ¯å·²è¢«webæ ‡å‡†åºŸå¼ƒ, ä½†è¿™ä¸å½±å“æˆ‘ä»¬å°è¯•å»äº†è§£å®ƒ. ä¹Ÿæ­£æ˜¯å› ä¸ºmanifestçš„åº”ç”¨ç¼“å­˜æœºåˆ¶å¦‚æ­¤è¯±äºº, é¥¿äº†ä¹ˆ å’Œ office 365é‚®ç®±éƒ½è¿˜åœ¨ä½¿ç”¨ç€å®ƒ!</p>
<a id="more"></a>
<h3 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h3><p>å¯¹manifestç†Ÿæ‚‰çš„åŒå­¦å¯ä»¥è·³è¿‡æ­¤èŠ‚.</p>
<p>é‰´äºmanifeståº”ç”¨ç¼“å­˜çš„æŠ€æœ¯, æˆ‘ä»¬å¯ä»¥åšåˆ°:</p>
<ul>
<li>ç¦»çº¿è®¿é—®: å³ä½¿æœåŠ¡å™¨æŒ‚äº†, æˆ–è€…æ²¡æœ‰ç½‘ç»œ, ç”¨æˆ·ä¾ç„¶å¯ä»¥æ­£å¸¸æµè§ˆç½‘é¡µå†…å®¹.</li>
<li>è®¿é—®æ›´å¿«: æ•°æ®å­˜åœ¨äºæœ¬åœ°, çœå»äº†æµè§ˆå™¨å‘èµ·httpè¯·æ±‚çš„æ—¶é—´, å› æ­¤è®¿é—®æ›´å¿«, ç§»åŠ¨ç«¯æ•ˆæœæ›´ä¸ºæ˜æ˜¾.</li>
<li>é™ä½è´Ÿè½½: æµè§ˆå™¨åªåœ¨manifestæ–‡ä»¶æ”¹åŠ¨æ—¶æ‰å»æœåŠ¡å™¨ä¸‹è½½éœ€è¦ç¼“å­˜çš„èµ„æº, å¤§å¤§é™ä½äº†æœåŠ¡å™¨è´Ÿè½½.</li>
</ul>
<p>manifestç¼“å­˜çš„è¿‡ç¨‹å¦‚ä¸‹(æ¥è‡ªç½‘ç»œ):</p>
<p><img src="http://ww2.sinaimg.cn/large/006y8lVagw1fa479nwxhmj30pm08hdgj.jpg" alt="manifest"></p>
<h3 id="æ”¯æŒæ€§"><a href="#æ”¯æŒæ€§" class="headerlink" title="æ”¯æŒæ€§"></a>æ”¯æŒæ€§</h3><p>ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒmanifeståº”ç”¨ç¼“å­˜æŠ€æœ¯. å¦‚ä¸‹è¡¨æ ¼:</p>
<table>
<thead>
<tr>
<th style="text-align:center">IE</th>
<th style="text-align:center">Edge</th>
<th style="text-align:center">Firefox</th>
<th style="text-align:center">Chrome</th>
<th style="text-align:center">Safari</th>
<th style="text-align:center">Opera</th>
<th style="text-align:center">ios</th>
<th style="text-align:center">Android</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">10+</td>
<td style="text-align:center">12+</td>
<td style="text-align:center">3.5+</td>
<td style="text-align:center">4+</td>
<td style="text-align:center">4+</td>
<td style="text-align:center">11.5+</td>
<td style="text-align:center">7.1+</td>
<td style="text-align:center">2.3+</td>
</tr>
</tbody>
</table>
<p>H5æ ‡å‡†ä¸­, <a href="https://html.spec.whatwg.org/#offline" target="_blank" rel="external">Offline Web applications</a> éƒ¨åˆ†æœ‰å¦‚ä¸‹æè¿°:</p>
<blockquote>
<p>This feature is in the process of being removed from the Web platform. (This is a long process that takes many years.) Using any of the offline Web application features at this time is highly discouraged. Use service workers instead. <a href="https://html.spec.whatwg.org/#refsSW" target="_blank" rel="external">[SW]</a></p>
</blockquote>
<p>å› æ­¤åç»­æˆ‘å°†åœ¨å…¶ä»–æ–‡ç« ä¸­ç»§ç»­ä»‹ç» service workers, æœ¬ç¯‡ç»§ç»­å…³æ³¨manifest.</p>
<h3 id="å¦‚ä½•å¼€å¯åº”ç”¨ç¼“å­˜"><a href="#å¦‚ä½•å¼€å¯åº”ç”¨ç¼“å­˜" class="headerlink" title="å¦‚ä½•å¼€å¯åº”ç”¨ç¼“å­˜"></a>å¦‚ä½•å¼€å¯åº”ç”¨ç¼“å­˜</h3><p>manifestä½¿ç”¨ç¼“å­˜æ¸…å•è¿›è¡Œç®¡ç†, ç¼“å­˜æ¸…å•éœ€è¦ä¸htmlæ ‡ç­¾è¿›è¡Œå…³è”. å¦‚ä¸‹:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">manifest</span>=<span class="string">"test.appcache"</span>&gt;</span></div><div class="line">  ...</div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>åœ¨htmlæ ‡ç­¾ä¸­æŒ‡å®šmanifestæ–‡ä»¶, ä¾¿è¡¨ç¤ºè¯¥ç½‘é¡µä½¿ç”¨manifestè¿›è¡Œç¦»çº¿ç¼“å­˜. è¯¥ç½‘é¡µå†…éœ€è¦ç¼“å­˜çš„æ–‡ä»¶åˆ—è¡¨éœ€è¦åœ¨ test.appcache æ–‡æœ¬æ–‡ä»¶ä¸­æŒ‡å®š.</p>
<h3 id="manifestç¼“å­˜æ¸…å•"><a href="#manifestç¼“å­˜æ¸…å•" class="headerlink" title="manifestç¼“å­˜æ¸…å•"></a>manifestç¼“å­˜æ¸…å•</h3><p>å°±åƒå†™ä½œæ–‡ä¸€æ ·, manifesté‡‡ç”¨ç»å…¸çš„ä¸‰æ®µå¼. åˆ†åˆ«ä¸º: <code>CACHE</code>, <code>NETWORK</code> å’Œ <code>FALLBACK</code>. å¦‚ä¸‹, å…ˆçœ‹ä¸€ä¸ªæ —å­ğŸŒ°:</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">CACHE MANIFEST</div><div class="line"><span class="meta"># v1.0.0</span></div><div class="line">content.css</div><div class="line"></div><div class="line"><span class="symbol">NETWORK:</span></div><div class="line">app.js</div><div class="line"></div><div class="line"><span class="symbol">FALLBACK:</span></div><div class="line">/other <span class="number">404.</span>html</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ç¬¬ä¸€è¡Œå¿…é¡»ä»¥ <code>CACHE MANIFEST</code> å¼€å¤´, åå¯è·Ÿè‹¥å¹²å­—ç¬¦æ³¨é‡Š, æ³¨é‡Šä»#å·å¼€å§‹. è·Ÿåœ¨  <code>CACHE MANIFEST</code>  è¡Œåçš„æ–‡ä»¶, æ¯è¡Œåˆ—å‡ºä¸€ä¸ª, è¿™äº›æ–‡ä»¶æ˜¯éœ€è¦ç¼“å­˜çš„æ–‡ä»¶. å› æ­¤ content.css ä¼šè¢«ç¼“å­˜, ä¸éœ€è¦è®¿é—®ç½‘ç»œ.</p>
<p>ç¬¬äºŒæ®µå†…å®¹ä»¥ <code>NETWORK:</code> å¼€å§‹, è·Ÿåœ¨è¯¥è¡Œåçš„æ–‡ä»¶è¡¨ç¤ºéœ€è¦è®¿é—®ç½‘ç»œ. å¦‚: app.js å°†ç›´æ¥ä»ç½‘ç»œä¸Šä¸‹è½½, å¹¶ä¸èµ°manifest cache, å¦‚æœé™¤äº†ç¬¬ä¸€æ®µä¸­ç¼“å­˜çš„æ–‡ä»¶ä»¥å¤–, å…¶ä»–æ–‡ä»¶éƒ½ä»ç½‘ç»œä¸Šè·å–, é‚£ä¹ˆæ­¤æ—¶å¯å°† app.js æ”¹ä¸º * (é€šé…ç¬¦).</p>
<p>ç¬¬ä¸‰æ®µå†…å®¹ä»¥ <code>FALLBACK:</code> å¼€å§‹, è·Ÿåœ¨è¯¥è¡Œåçš„æ–‡ä»¶è¡¨ç¤ºä¼šæœ‰ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆ. å¦‚: å½“è®¿é—® /other è·¯å¾„æ—¶, å¦‚æœè®¿é—®å¤±è´¥, é‚£ä¹ˆå°†è‡ªåŠ¨åŠ è½½ 404.html ä½œä¸ºæ›¿ä»£.</p>
<h3 id="manifestç¼“å­˜çŠ¶æ€"><a href="#manifestç¼“å­˜çŠ¶æ€" class="headerlink" title="manifestç¼“å­˜çŠ¶æ€"></a>manifestç¼“å­˜çŠ¶æ€</h3><p>æ¯ä¸ªmanifestç¼“å­˜éƒ½æœ‰ä¸€ä¸ªçŠ¶æ€, æ ‡ç¤ºç€ç¼“å­˜çš„æƒ…å†µ. ä¸€ä»½ç¼“å­˜æ¸…å•åªæœ‰ä¸€ä¸ªç¼“å­˜çŠ¶æ€, å³ä½¿å®ƒè¢«å¤šä¸ªé¡µé¢å¼•ç”¨. ä»¥ä¸‹æ˜¯å„ä¸ªç¼“å­˜çŠ¶æ€:</p>
<ul>
<li><em>UNCACHED</em>(æœªç¼“å­˜): è¡¨æ˜åº”ç”¨ç¼“å­˜å¯¹è±¡è¿˜æ²¡æœ‰åˆå§‹åŒ–å®Œæˆ.</li>
<li><em>IDLE</em>(ç©ºé—²): åº”ç”¨ç¼“å­˜å¹¶æœªå¤„äºæ›´æ–°çŠ¶æ€.</li>
<li><em>CHECKING</em>(æ£€æŸ¥): æ­£åœ¨æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ›´æ–°.</li>
<li><em>DOWNLOADING</em>(ä¸‹è½½): æ¸…å•æ›´æ–°å, é‡æ–°ä¸‹è½½å…¨éƒ¨èµ„æºåˆ°ä¸´æ—¶ç¼“å­˜ä¸­.</li>
<li><em>UPDATEREADY</em>(æ›´æ–°å°±ç»ª): æ–°ç‰ˆæœ¬çš„ç¼“å­˜ä¸‹è½½å®Œæˆ, å…¨éƒ¨å°±ç»ª, éšå³è§¦å‘äº‹ä»¶ updateready.</li>
<li><em>OBSOLETE</em>(åºŸå¼ƒ): åº”ç”¨ç¼“å­˜å·²è¢«åºŸå¼ƒ.</li>
</ul>
<p>ä¸Šè¿°ç¼“å­˜çŠ¶æ€å¸¸é‡ä¾æ¬¡å–å€¼0, 1, 2, 3, 4, 5.</p>
<h3 id="applicationCache"><a href="#applicationCache" class="headerlink" title="applicationCache"></a>applicationCache</h3><p>applicationCacheæ˜¯æ“ä½œåº”ç”¨ç¼“å­˜çš„ç‘å£«å†›åˆ€, ä¹Ÿæ˜¯å”¯ä¸€çš„ä¸€æŠŠåˆ€.</p>
<p>é¦–å…ˆæˆ‘ä»¬æ¥è·å–è¯¥å¯¹è±¡.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//webviewä¸‹</span></div><div class="line"><span class="keyword">var</span> cache = <span class="built_in">window</span>.applicationCache;</div><div class="line"><span class="comment">//shared workerä¸­</span></div><div class="line"><span class="keyword">var</span> cache = self.applicationCache;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯å…¶å±æ€§å’Œæ–¹æ³•ä»‹ç»(å¤§ç¥è¯·ç»•è¿‡):</p>
<ul>
<li><p>status: è¿”å›å½“å‰é¡µé¢çš„åº”ç”¨ç¼“å­˜çš„çŠ¶æ€, é€šå¸¸å¼€å¯åº”ç”¨ç¼“å­˜çš„é¡µé¢å¯èƒ½è¿”å›1, å…¶ä»–é¡µé¢åˆ™è¿”å›0.</p>
</li>
<li><p>update(): æ‰‹åŠ¨è§¦å‘åº”ç”¨ç¼“å­˜çš„æ›´æ–°. </p>
<p>(1) è‹¥æœ‰æ›´æ–°, åˆ™ä¾æ¬¡è§¦å‘â‘ æ£€æŸ¥äº‹ä»¶(Checking event), â‘¡ä¸‹è½½äº‹ä»¶(Downloading event), â‘¢ä¸‹è½½è¿›åº¦äº‹ä»¶(Progress event), â‘£æ›´æ–°å®Œæˆäº‹ä»¶(UpdateReady event);</p>
<p>(2) è‹¥æ— æ›´æ–°, åˆ™ä¾æ¬¡è§¦å‘â‘ æ£€æŸ¥äº‹ä»¶(Checking event), â‘¡æ— æ›´æ–°äº‹ä»¶(NoUpdate event);</p>
<p>(3) åœ¨æœªå¼€å¯åº”ç”¨ç¼“å­˜çš„é¡µé¢è°ƒç”¨å°†æŠ›å‡º<code>Uncaught DOMException</code> é”™è¯¯.</p>
<p>update() æ–¹æ³•é€šå¸¸åœ¨é•¿æ—¶é—´ä¸å…³é—­çš„é¡µé¢ä½¿ç”¨, æ¯”å¦‚è¯´é‚®ç®±åº”ç”¨, ç”¨äºå®šæœŸæ£€æµ‹å¯èƒ½çš„æ›´æ–°.</p>
</li>
<li><p>abort(): å–æ¶ˆåº”ç”¨ç¼“å­˜çš„æ›´æ–°. å¯ç”¨äºèŠ‚çœæœ‰é™çš„ç½‘ç»œå¸¦å®½.</p>
</li>
<li><p>swapCache(): å¦‚æœå­˜åœ¨ä¸€ä¸ªæ›´æ–°ç‰ˆæœ¬çš„åº”ç”¨ç¼“å­˜, é‚£ä¹ˆå®ƒå°†åˆ‡æ¢è¿‡å», å¦åˆ™å°†æŠ›å‡º <code>Uncaught DOMException</code> é”™è¯¯. é€šå¸¸, æˆ‘ä»¬ä¼šåœ¨updatereadyäº‹ä»¶è§¦å‘ä¹‹åæ‰‹åŠ¨è°ƒç”¨swapCache()æ–¹æ³•, swapCacheçš„åˆ‡æ¢åªå¯¹åç»­åŠ è½½çš„ç¼“å­˜æ–‡ä»¶æœ‰æ•ˆ, å·²ç»åŠ è½½æˆåŠŸçš„èµ„æºå¹¶ä¸ä¼šé‡æ–°åŠ è½½.</p>
</li>
</ul>
<p>é‚£ä¹ˆå¦‚ä½•åˆ©ç”¨å¥½ä¸Šè¿°apiæ›´æ–°ä¸€ä¸ªé¡µé¢çš„åº”ç”¨ç¼“å­˜å‘¢? åˆ«æ€¥, <a href="http://www.html5rocks.com/en/tutorials/appcache/beginner/" target="_blank" rel="external">Beginnerâ€™s Guide to Using the Application Cache</a> ä¸€æ–‡ä¸­æä¾›äº†å¦‚ä¸‹çš„æ ·æ¿æ–¹æ³•:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Check if a new cache is available on page load.</span></div><div class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'load'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">  <span class="built_in">window</span>.applicationCache.addEventListener(<span class="string">'updateready'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.applicationCache.status == <span class="built_in">window</span>.applicationCache.UPDATEREADY) &#123;</div><div class="line">      <span class="comment">// Browser downloaded a new app cache.</span></div><div class="line">      <span class="comment">// Swap it in and reload the page to get the new hotness.</span></div><div class="line">      <span class="built_in">window</span>.applicationCache.swapCache();</div><div class="line">      <span class="keyword">if</span> (confirm(<span class="string">'A new version of this site is available. Load it?'</span>)) &#123;</div><div class="line">        <span class="built_in">window</span>.location.reload();</div><div class="line">      &#125;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="comment">// Manifest didn't changed. Nothing new to server.</span></div><div class="line">    &#125;</div><div class="line">  &#125;, <span class="literal">false</span>);</div><div class="line">&#125;, <span class="literal">false</span>);</div></pre></td></tr></table></figure>
<h3 id="manifestç¼“å­˜ç‹¬ç«‹æ€§"><a href="#manifestç¼“å­˜ç‹¬ç«‹æ€§" class="headerlink" title="manifestç¼“å­˜ç‹¬ç«‹æ€§"></a>manifestç¼“å­˜ç‹¬ç«‹æ€§</h3><ol>
<li>manifestçš„ç¼“å­˜å’Œæµè§ˆå™¨é»˜è®¤çš„ç¼“å­˜æ˜¯ä¸¤å¥—æœºåˆ¶, ç›¸äº’ç‹¬ç«‹, å¹¶ä¸”ä¸å—æµè§ˆå™¨ç¼“å­˜å¤§å°é™åˆ¶(Chromeä¸‹æµ‹è¯•ç»“æœ).</li>
<li>å„ä¸ªmanifestæ–‡ä»¶çš„ç¼“å­˜ç›¸äº’ç‹¬ç«‹, å„è‡ªåœ¨ç‹¬ç«‹çš„åŒºåŸŸè¿›è¡Œç¼“å­˜. å³ä½¿æ˜¯ç¼“å­˜åŒä¸€ä¸ªæ–‡ä»¶, ä¹Ÿå¯èƒ½ç”±äºç¼“å­˜çš„ç‰ˆæœ¬ä¸ä¸€è‡´, è€Œé€ æˆå„ä¸ªé¡µé¢èµ„æºä¸ä¸€è‡´.</li>
</ol>
<h3 id="manifestç¼“å­˜è§„åˆ™"><a href="#manifestç¼“å­˜è§„åˆ™" class="headerlink" title="manifestç¼“å­˜è§„åˆ™"></a>manifestç¼“å­˜è§„åˆ™</h3><ol>
<li>éµå¾ªå…¨é‡ç¼“å­˜çš„è§„å¾‹. å³: manifestæ–‡ä»¶æ”¹åŠ¨å, å°†é‡æ–°ç¼“å­˜ä¸€éæ‰€æœ‰çš„æ–‡ä»¶(åŒ…æ‹¬htmlæœ¬èº«å’ŒåŠ¨æ€æ·»åŠ çš„éœ€è¦ç¼“å­˜çš„æ–‡ä»¶,å³ä½¿ç¼“å­˜åˆ—è¡¨ä¸­æ²¡æœ‰è¯¥html). ç¬¬ä¸€æ¬¡ç¼“å­˜è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°ç¼“å­˜å¤±è´¥çš„æ–‡ä»¶, é‚£ä¹ˆ, ç¬¬äºŒè®¿é—®, åˆå°†é‡æ–°ç¼“å­˜ä¸€éæ‰€æœ‰çš„æ–‡ä»¶. ä»¥æ­¤ç±»æ¨.</li>
<li>manifestæ–‡ä»¶æœ¬èº«ä¸èƒ½å†™è¿›ç¼“å­˜æ¸…å•, å¦åˆ™è¿åŒhtmlå’Œèµ„æºåœ¨å…¶ç¼“å­˜å¤±æ•ˆä¹‹å‰, å°†æ°¸è¿œä¸èƒ½è·å¾—æ›´æ–°.</li>
<li>å³ä½¿manifestæ–‡ä»¶ä¸¢å¤±, ç¼“å­˜ä¾ç„¶æœ‰æ•ˆ. ä¸è¿‡ä»æ­¤ä»¥å, å¼•å…¥è¯¥manifestçš„html, å°†æ°¸è¿œä¸èƒ½è·å¾—æ›´æ–°.</li>
</ol>
<h3 id="webviewçš„ç¼“å­˜ç°è±¡"><a href="#webviewçš„ç¼“å­˜ç°è±¡" class="headerlink" title="webviewçš„ç¼“å­˜ç°è±¡"></a>webviewçš„ç¼“å­˜ç°è±¡</h3><p>é€šå¸¸, webviewçš„ç¼“å­˜æœ‰å¦‚ä¸‹ä¸‰ç§ç°è±¡:</p>
<ol>
<li>æ™®é€šç½‘é¡µ(æ— manifestæ–‡ä»¶), ä¸å—manifestç¼“å­˜å½±å“, ç¼“å­˜åªèµ° http cache.</li>
<li>åŒ…å«manifestæ–‡ä»¶çš„ç½‘é¡µ, ç¼“å­˜æ–‡ä»¶åªå—manifestç¼“å­˜å½±å“(åªæœ‰manifestæ–‡ä»¶æ”¹å˜æ—¶æ‰ä¼šæ›´æ–°ç¼“å­˜èµ„æº), ç¼“å­˜èµ„æºå®Œå…¨ä¸ http cache æ— å…³, ä½†æ˜¯ <code>NETWORK</code> æ®µè½åéœ€è¦è®¿é—®ç½‘ç»œçš„æ–‡ä»¶, å°†ç»§ç»­èµ° http cache.</li>
<li>webviewç›´æ¥åŠ è½½manifestç¼“å­˜è¿‡çš„æ–‡ä»¶æ—¶, ä¼˜å…ˆåŠ è½½ç¬¬ä¸€ä¸ªmanifestç¼“å­˜çš„è¯¥æ–‡ä»¶, å¦‚æœæ²¡æœ‰æ‰¾åˆ°manifestç¼“å­˜, é‚£ä¹ˆå®ƒå°†è‡ªåŠ¨å¯»æ‰¾ http cache æˆ–è€… åœ¨çº¿åŠ è½½.</li>
</ol>
<h3 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h3><ol>
<li>é€šå¸¸åªä½¿ç”¨ä¸€ä¸ªmanifestæ–‡ä»¶, å¹¶ä¿è¯ç¼“å­˜çš„æ–‡ä»¶å°½å¯èƒ½çš„å°‘, ä»¥å‡å°manifestæ¯æ¬¡æ›´æ–°æ¸…å•ä¸­æ–‡ä»¶æ‰€è€—è´¹çš„æ—¶é—´å’Œæµé‡.</li>
<li>å¦‚æœä¸€å®šè¦ä½¿ç”¨ä¸¤ä¸ªåŠä»¥ä¸Šmanifestæ–‡ä»¶, ç¼“å­˜æ–‡ä»¶è¯·å°½é‡ä¸è¦ç›¸åŒ.</li>
<li>å¦‚æœä»¥ä¸Šä¸¤æ¡éƒ½ä¸èƒ½ä¿è¯, é‚£ä¹ˆ, è¯·ä¿è¯å°½å¯èƒ½åœ¨manifestç¼“å­˜çš„çŠ¶æ€æ›´æ–°æ—¶, ä¸»åŠ¨å»åˆ·æ–°ç½‘é¡µ.(æ­¤æ—¶å¹¶ä¸èƒ½ä¿è¯ä¸åŒç½‘é¡µä¹‹é—´åŒä¸€ä¸ªç¼“å­˜æ–‡ä»¶ç‰ˆæœ¬ä¸€è‡´)</li>
</ol>
<h3 id="å…·ä½“è½åœ°æ­¥éª¤"><a href="#å…·ä½“è½åœ°æ­¥éª¤" class="headerlink" title="å…·ä½“è½åœ°æ­¥éª¤"></a>å…·ä½“è½åœ°æ­¥éª¤</h3><ol>
<li><p>å¦‚æœç¼“å­˜çš„æ–‡ä»¶éœ€è¦åŠ å‚æ•°è¿è¡Œ, å»ºè®®å°†å‚æ•°å†…å®¹åŠ åˆ°hashä¸­, å¦‚:cached-page.html#parameterName=value</p>
</li>
<li><p>manifest çš„å¼•å…¥å¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–è€…ç›¸å¯¹è·¯å¾„, å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç»å¯¹è·¯å¾„, é‚£ä¹ˆä½ çš„manifestæ–‡ä»¶å¿…é¡»å’Œä½ çš„ç«™ç‚¹å¤„äºåŒä¸€ä¸ªåŸŸåä¸‹.</p>
</li>
<li><p>manifestæ–‡ä»¶ä½ å¯ä»¥ä¿å­˜ä¸ºä»»æ„çš„æ‰©å±•å, ä½†æ˜¯å“åº”å¤´ä¸­ä»¥ä¸‹å­—æ®µé¡»å–ä»¥ä¸‹å®šå€¼, ä»¥ä¿è¯manifestæ–‡ä»¶æ­£ç¡®è¢«è§£æ, å¹¶ä¸”å®ƒæ²¡æœ‰httpç¼“å­˜.</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">Content-Type</span>: text/cache-manifest</div><div class="line"><span class="attribute">Cache-Control</span>: max-age=0</div><div class="line"><span class="attribute">Expires</span>: [CURRENT TIME]</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="å¦‚ä½•æ›´æ–°ç¼“å­˜"><a href="#å¦‚ä½•æ›´æ–°ç¼“å­˜" class="headerlink" title="å¦‚ä½•æ›´æ–°ç¼“å­˜"></a>å¦‚ä½•æ›´æ–°ç¼“å­˜</h3><ol>
<li>æ›´æ–°manifestæ–‡ä»¶å, webviewå°†è‡ªåŠ¨æ›´æ–°ç¼“å­˜.</li>
<li>jsæ›´æ–°ç¼“å­˜(æ‰‹åŠ¨è§¦å‘manifestæ›´æ–°): window.applicationCache.update();</li>
</ol>
<h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><p>chromeæµè§ˆå™¨ä¸‹é€šè¿‡è®¿é—® <a href="chrome://appcache-internals/" target="_blank" rel="external">chrome://appcache-internals/</a> å¯ä»¥æŸ¥çœ‹ç¼“å­˜åœ¨æœ¬åœ°çš„èµ„æºæ–‡ä»¶.</p>
<p>å¦å¤–, é™¤äº†æœ¬æ–‡å‚è€ƒçš„ä¸€ç¯‡ MDN çš„æ–‡ç« ä»¥åŠ HTML5 Rocksçš„ <a href="http://www.html5rocks.com/en/tutorials/appcache/beginner/" target="_blank" rel="external">Beginnerâ€™s Guide to Using the Application Cache</a> ä¸€æ–‡, è¿˜æœ‰å¦‚ä¸‹ä¸‰ä¸ªé“¾æ¥å¯ä¾›æ‚¨æ¯”è¾ƒé˜…è¯», è°¢è°¢.</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/Cache_manifest_in_HTML5" target="_blank" rel="external">Cache manifest in HTML5</a> on Wikipedia</li>
<li><a href="http://www.w3.org/TR/offline-webapps/" target="_blank" rel="external">Offline Web Applications</a> W3C Working Group Note</li>
<li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html" target="_blank" rel="external">Offline Web applications</a> at WHATWG</li>
</ul>
<hr>
<p>æœ¬é—®å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/11/25/manifest/">http://louiszhai.github.io/2016/11/25/manifest/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/HTML/Using_the_application_cache" target="_blank" rel="external">Using the application cache | MDN</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      manifest offline cache applicationCache
    
    </summary>
    
    
      <category term="Web" scheme="http://louiszhai.github.io/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>AjaxçŸ¥è¯†ä½“ç³»</title>
    <link href="http://louiszhai.github.io/2016/11/02/ajax/"/>
    <id>http://louiszhai.github.io/2016/11/02/ajax/</id>
    <published>2016-11-02T04:48:27.000Z</published>
    <updated>2017-03-10T03:35:29.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>Ajax å…¨ç§° Asynchronous JavaScript and XML, å³å¼‚æ­¥JSä¸XML. å®ƒæœ€æ—©åœ¨IE5ä¸­è¢«ä½¿ç”¨, ç„¶åç”±Mozilla, Apple, Googleæ¨å¹¿å¼€æ¥. å…¸å‹çš„ä»£è¡¨åº”ç”¨æœ‰ Outlook Web Access, ä»¥åŠ GMail. ç°ä»£ç½‘é¡µä¸­å‡ ä¹æ— ajaxä¸æ¬¢. å‰åç«¯åˆ†ç¦»ä¹Ÿæ­£æ˜¯å»ºç«‹åœ¨ajaxå¼‚æ­¥é€šä¿¡çš„åŸºç¡€ä¹‹ä¸Š.</p>
<a id="more"></a>
<h3 id="æµè§ˆå™¨ä¸ºajaxåšäº†ä»€ä¹ˆ"><a href="#æµè§ˆå™¨ä¸ºajaxåšäº†ä»€ä¹ˆ" class="headerlink" title="æµè§ˆå™¨ä¸ºajaxåšäº†ä»€ä¹ˆ"></a>æµè§ˆå™¨ä¸ºajaxåšäº†ä»€ä¹ˆ</h3><p>ç°ä»£æµè§ˆå™¨ä¸­, è™½ç„¶å‡ ä¹å…¨éƒ¨æ”¯æŒajax, ä½†å®ƒä»¬çš„æŠ€æœ¯æ–¹æ¡ˆå´åˆ†ä¸ºä¸¤ç§:</p>
<p>â‘  æ ‡å‡†æµè§ˆå™¨é€šè¿‡ <code>XMLHttpRequest</code> å¯¹è±¡å®ç°äº†ajaxçš„åŠŸèƒ½. åªéœ€è¦é€šè¿‡ä¸€è¡Œè¯­å¥ä¾¿å¯åˆ›å»ºä¸€ä¸ªç”¨äºå‘é€ajaxè¯·æ±‚çš„å¯¹è±¡.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</div></pre></td></tr></table></figure>
<p>â‘¡ IEæµè§ˆå™¨é€šè¿‡ <code>XMLHttpRequest</code> æˆ–è€… <code>ActiveXObject</code> å¯¹è±¡åŒæ ·å®ç°äº†ajaxçš„åŠŸèƒ½.</p>
<h4 id="MSXML"><a href="#MSXML" class="headerlink" title="MSXML"></a>MSXML</h4><p>é‰´äºIEç³»åˆ—å„ç§ â€œç¥çº§â€ è¡¨ç°,  æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹IEæµè§ˆå™¨é£éªšçš„èµ°ä½.</p>
<p>IEä¸‹çš„ä½¿ç”¨ç¯å¢ƒç•¥æ˜¾å¤æ‚, IE7åŠæ›´é«˜ç‰ˆæœ¬æµè§ˆå™¨å¯ä»¥ç›´æ¥ä½¿ç”¨BOMçš„ XMLHttpRequest å¯¹è±¡. MSDNä¼ é€é—¨: <a href="https://blogs.msdn.microsoft.com/ie/2006/01/23/native-xmlhttprequest-object/" target="_blank" rel="external">Native XMLHTTPRequest object</a>. IE6åŠæ›´ä½ç‰ˆæœ¬æµè§ˆå™¨åªèƒ½ä½¿ç”¨ <code>ActiveXObject</code> å¯¹è±¡æ¥åˆ›å»º XMLHttpRequest å¯¹è±¡å®ä¾‹. åˆ›å»ºæ—¶éœ€è¦æŒ‡æ˜ä¸€ä¸ªç±»ä¼¼â€Microsoft.XMLHTTPâ€è¿™æ ·çš„ProgID. è€Œå®é™…å‘¢, windowsç³»ç»Ÿç¯å¢ƒä¸‹, ä»¥ä¸‹ProgIDéƒ½åº”è¯¥å¯ä»¥åˆ›å»ºXMLHTTPå¯¹è±¡:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Microsoft</span><span class="selector-class">.XMLHTTP</span></div><div class="line"><span class="selector-tag">Microsoft</span><span class="selector-class">.XMLHTTP</span><span class="selector-class">.1</span><span class="selector-class">.0</span></div><div class="line"><span class="selector-tag">Msxml2</span><span class="selector-class">.ServerXMLHTTP</span></div><div class="line"><span class="selector-tag">Msxml2</span><span class="selector-class">.ServerXMLHTTP</span><span class="selector-class">.3</span><span class="selector-class">.0</span></div><div class="line"><span class="selector-tag">Msxml2</span><span class="selector-class">.ServerXMLHTTP</span><span class="selector-class">.4</span><span class="selector-class">.0</span></div><div class="line"><span class="selector-tag">Msxml2</span><span class="selector-class">.ServerXMLHTTP</span><span class="selector-class">.5</span><span class="selector-class">.0</span></div><div class="line"><span class="selector-tag">Msxml2</span><span class="selector-class">.ServerXMLHTTP</span><span class="selector-class">.6</span><span class="selector-class">.0</span></div><div class="line"><span class="selector-tag">Msxml2</span><span class="selector-class">.XMLHTTP</span></div><div class="line"><span class="selector-tag">Msxml2</span><span class="selector-class">.XMLHTTP</span><span class="selector-class">.3</span><span class="selector-class">.0</span></div><div class="line"><span class="selector-tag">Msxml2</span><span class="selector-class">.XMLHTTP</span><span class="selector-class">.4</span><span class="selector-class">.0</span></div><div class="line"><span class="selector-tag">Msxml2</span><span class="selector-class">.XMLHTTP</span><span class="selector-class">.5</span><span class="selector-class">.0</span></div><div class="line"><span class="selector-tag">Msxml2</span><span class="selector-class">.XMLHTTP</span><span class="selector-class">.6</span><span class="selector-class">.0</span></div></pre></td></tr></table></figure>
<p>ç®€è¨€ä¹‹, Microsoft.XMLHTTP å·²ç»éå¸¸è€äº†, ä¸»è¦ç”¨äºæä¾›å¯¹å†å²é—ç•™ç‰ˆæœ¬çš„æ”¯æŒ, ä¸å»ºè®®ä½¿ç”¨.å¯¹äº MSXML4, å®ƒå·²è¢« MSXML6 æ›¿ä»£; è€Œ MSXML5 åˆæ˜¯ä¸“é—¨é’ˆå¯¹officeåŠå…¬åœºæ™¯, åœ¨æ²¡æœ‰å®‰è£… Microsoft Office 2003 åŠæ›´é«˜ç‰ˆæœ¬åŠå…¬è½¯ä»¶çš„æƒ…å†µä¸‹, MSXML5 æœªå¿…å¯ç”¨. ç›¸æ¯”ä¹‹ä¸‹, MSXML6 å…·æœ‰æ¯” MSXML3 æ›´ç¨³å®š, æ›´é«˜æ€§èƒ½, æ›´å®‰å…¨çš„ä¼˜åŠ¿, åŒæ—¶å®ƒä¹Ÿæä¾›äº†ä¸€äº› MSXML3 ä¸­æ²¡æœ‰çš„åŠŸèƒ½, æ¯”å¦‚è¯´ XSD schema. å”¯ä¸€é—æ†¾çš„æ˜¯, MSXML6 åªåœ¨ vista ç³»ç»ŸåŠä»¥ä¸Šæ‰æ˜¯é»˜è®¤æ”¯æŒçš„; è€Œ MSXML3 åœ¨ Win2k SP4åŠä»¥ä¸Šç³»ç»Ÿå°±æ˜¯å¯ç”¨çš„. å› æ­¤ä¸€èˆ¬æƒ…å†µä¸‹, MSXML3 å¯ä»¥ä½œä¸º MSXML6 çš„ä¼˜é›…é™çº§æ–¹æ¡ˆ, æˆ‘ä»¬é€šè¿‡æŒ‡å®š PorgID ä¸º Msxml2.XMLHTTP å³å¯è‡ªåŠ¨æ˜ å°„åˆ° Msxml2.XMLHTTP.3.0. å¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"Msxml2.XMLHTTP"</span>);<span class="comment">// å³MSXML3,ç­‰åŒäºå¦‚ä¸‹è¯­å¥</span></div><div class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"MSXML2.XMLHTTP.3.0"</span>);</div></pre></td></tr></table></figure>
<p>MSDNæœ‰ç¯‡æ–‡ç« ä¸“é—¨è®²è§£äº†å„ä¸ªç‰ˆæœ¬çš„MSXML. ä¼ é€é—¨: <a href="https://blogs.msdn.microsoft.com/xmlteam/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer/" target="_blank" rel="external">Using the right version of MSXML in Internet Explorer</a>.</p>
<p>äº²æµ‹äº† IE5, IE5.5, IE6, IE7, IE8, IE9, IE10, IE edgeç­‰æµè§ˆå™¨, IE5åŠä¹‹åçš„æµè§ˆå™¨å‡å¯ä»¥é€šè¿‡å¦‚ä¸‹è¯­å¥è·å–xhrå¯¹è±¡:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"Msxml2.XMLHTTP"</span>);<span class="comment">// å³MSXML3</span></div><div class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);<span class="comment">// å¾ˆè€çš„api,è™½ç„¶æµè§ˆå™¨æ”¯æŒ,åŠŸèƒ½å¯èƒ½ä¸å®Œå–„,æ•…ä¸å»ºè®®ä½¿ç”¨</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, æ€è·¯å·²ç»å¾ˆæ¸…æ™°äº†, ä¸‹é¢ç»™å‡ºä¸ªå…¨å…¼å®¹çš„æ–¹æ³•.</p>
<h4 id="å…¨å¹³å°å…¼å®¹çš„XMLHttpRequestå¯¹è±¡"><a href="#å…¨å¹³å°å…¼å®¹çš„XMLHttpRequestå¯¹è±¡" class="headerlink" title="å…¨å¹³å°å…¼å®¹çš„XMLHttpRequestå¯¹è±¡"></a>å…¨å¹³å°å…¼å®¹çš„XMLHttpRequestå¯¹è±¡</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getXHR</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> xhr = <span class="literal">null</span>;</div><div class="line">  <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest) &#123;</div><div class="line">    xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.ActiveXObject) &#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"Msxml2.XMLHTTP"</span>);</div><div class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">      <span class="keyword">try</span> &#123;</div><div class="line">        xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);</div><div class="line">      &#125; <span class="keyword">catch</span> (e) &#123; </div><div class="line">        alert(<span class="string">"æ‚¨çš„æµè§ˆå™¨æš‚ä¸æ”¯æŒAjax!"</span>);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> xhr;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ajaxæœ‰æ²¡æœ‰ç ´åjså•çº¿ç¨‹æœºåˆ¶"><a href="#ajaxæœ‰æ²¡æœ‰ç ´åjså•çº¿ç¨‹æœºåˆ¶" class="headerlink" title="ajaxæœ‰æ²¡æœ‰ç ´åjså•çº¿ç¨‹æœºåˆ¶"></a>ajaxæœ‰æ²¡æœ‰ç ´åjså•çº¿ç¨‹æœºåˆ¶</h3><p>å¯¹äºè¿™ä¸ªé—®é¢˜, æˆ‘ä»¬å…ˆçœ‹ä¸‹æµè§ˆå™¨çº¿ç¨‹æœºåˆ¶. ä¸€èˆ¬æƒ…å†µä¸‹, æµè§ˆå™¨æœ‰å¦‚ä¸‹å››ç§çº¿ç¨‹:</p>
<ul>
<li>GUIæ¸²æŸ“çº¿ç¨‹</li>
<li>javascriptå¼•æ“çº¿ç¨‹</li>
<li>æµè§ˆå™¨äº‹ä»¶è§¦å‘çº¿ç¨‹</li>
<li>HTTPè¯·æ±‚çº¿ç¨‹</li>
</ul>
<p>é‚£ä¹ˆè¿™ä¹ˆå¤šçº¿ç¨‹, å®ƒä»¬ç©¶ç«Ÿæ˜¯æ€ä¹ˆåŒjså¼•æ“çº¿ç¨‹äº¤äº’çš„å‘¢?</p>
<p>é€šå¸¸, å®ƒä»¬çš„çº¿ç¨‹é—´äº¤äº’ä»¥äº‹ä»¶çš„æ–¹å¼å‘ç”Ÿ, é€šè¿‡äº‹ä»¶å›è°ƒçš„æ–¹å¼äºˆä»¥é€šçŸ¥. è€Œäº‹ä»¶å›è°ƒ, åˆæ˜¯ä»¥å…ˆè¿›å…ˆå‡ºçš„æ–¹å¼æ·»åŠ åˆ°<code>ä»»åŠ¡é˜Ÿåˆ—</code> çš„æœ«å°¾ , ç­‰åˆ°jså¼•æ“ç©ºé—²æ—¶, <code>ä»»åŠ¡é˜Ÿåˆ—</code> ä¸­æ’é˜Ÿçš„ä»»åŠ¡å°†ä¼šä¾æ¬¡è¢«æ‰§è¡Œ. è¿™äº›äº‹ä»¶å›è°ƒåŒ…æ‹¬ setTimeout, setInterval, click, ajaxå¼‚æ­¥è¯·æ±‚ç­‰å›è°ƒ.</p>
<p><strong>æµè§ˆå™¨ä¸­, jså¼•æ“çº¿ç¨‹ä¼šå¾ªç¯ä» <code>ä»»åŠ¡é˜Ÿåˆ—</code> ä¸­è¯»å–äº‹ä»¶å¹¶ä¸”æ‰§è¡Œ, è¿™ç§è¿è¡Œæœºåˆ¶ç§°ä½œ <code>Event Loop</code> (äº‹ä»¶å¾ªç¯).</strong></p>
<p>å¯¹äºä¸€ä¸ªajaxè¯·æ±‚, jså¼•æ“é¦–å…ˆç”Ÿæˆ <code>XMLHttpRequest</code> å®ä¾‹å¯¹è±¡, openè¿‡åå†è°ƒç”¨sendæ–¹æ³•. è‡³æ­¤, æ‰€æœ‰çš„è¯­å¥éƒ½æ˜¯åŒæ­¥æ‰§è¡Œ. ä½†ä»sendæ–¹æ³•å†…éƒ¨å¼€å§‹, æµè§ˆå™¨ä¸ºå°†è¦å‘ç”Ÿçš„ç½‘ç»œè¯·æ±‚åˆ›å»ºäº†æ–°çš„httpè¯·æ±‚çº¿ç¨‹, è¿™ä¸ªçº¿ç¨‹ç‹¬ç«‹äºjså¼•æ“çº¿ç¨‹, äºæ˜¯ç½‘ç»œè¯·æ±‚å¼‚æ­¥è¢«å‘é€å‡ºå»äº†. å¦ä¸€æ–¹é¢, jså¼•æ“å¹¶ä¸ä¼šç­‰å¾… ajax å‘èµ·çš„httpè¯·æ±‚æ”¶åˆ°ç»“æœ, è€Œæ˜¯ç›´æ¥é¡ºåºå¾€ä¸‹æ‰§è¡Œ.</p>
<p>å½“ajaxè¯·æ±‚è¢«æœåŠ¡å™¨å“åº”å¹¶ä¸”æ”¶åˆ°responseå, æµè§ˆå™¨äº‹ä»¶è§¦å‘çº¿ç¨‹æ•è·åˆ°äº†ajaxçš„å›è°ƒäº‹ä»¶ <code>onreadystatechange</code> (å½“ç„¶ä¹Ÿå¯èƒ½è§¦å‘onload, æˆ–è€… onerrorç­‰ç­‰) . è¯¥å›è°ƒäº‹ä»¶å¹¶æ²¡æœ‰è¢«ç«‹å³æ‰§è¡Œ, è€Œæ˜¯è¢«æ·»åŠ åˆ° <code>ä»»åŠ¡é˜Ÿåˆ—</code> çš„æœ«å°¾. ç›´åˆ°jså¼•æ“ç©ºé—²äº†, <code>ä»»åŠ¡é˜Ÿåˆ—</code> çš„ä»»åŠ¡æ‰è¢«æå‡ºæ¥, æŒ‰ç…§æ·»åŠ é¡ºåº, æŒ¨ä¸ªæ‰§è¡Œ, å½“ç„¶ä¹ŸåŒ…æ‹¬åˆšåˆšappendåˆ°é˜Ÿåˆ—æœ«å°¾çš„ <code>onreadystatechange</code> äº‹ä»¶.</p>
<p>åœ¨ <code>onreadystatechange</code> äº‹ä»¶å†…éƒ¨, æœ‰å¯èƒ½å¯¹domè¿›è¡Œæ“ä½œ. æ­¤æ—¶æµè§ˆå™¨ä¾¿ä¼šæŒ‚èµ·jså¼•æ“çº¿ç¨‹, è½¬è€Œæ‰§è¡ŒGUIæ¸²æŸ“çº¿ç¨‹, è¿›è¡ŒUIé‡ç»˜(repaint)æˆ–è€…å›æµ(reflow). å½“jså¼•æ“é‡æ–°æ‰§è¡Œæ—¶, GUIæ¸²æŸ“çº¿ç¨‹åˆä¼šè¢«æŒ‚èµ·, GUIæ›´æ–°å°†è¢«ä¿å­˜èµ·æ¥, ç­‰åˆ°jså¼•æ“ç©ºé—²æ—¶ç«‹å³è¢«æ‰§è¡Œ.</p>
<p>ä»¥ä¸Šæ•´ä¸ªajaxè¯·æ±‚è¿‡ç¨‹ä¸­, æœ‰æ¶‰åŠåˆ°æµè§ˆå™¨çš„4ç§çº¿ç¨‹. å…¶ä¸­é™¤äº† <code>GUIæ¸²æŸ“çº¿ç¨‹</code> å’Œ <code>jså¼•æ“çº¿ç¨‹</code> æ˜¯äº’æ–¥çš„. å…¶ä»–çº¿ç¨‹ç›¸äº’ä¹‹é—´, éƒ½æ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„. é€šè¿‡è¿™æ ·çš„ä¸€ç§æ–¹å¼, ajaxå¹¶æ²¡æœ‰ç ´åjsçš„å•çº¿ç¨‹æœºåˆ¶.</p>
<h3 id="ajaxä¸setTimeoutæ’é˜Ÿé—®é¢˜"><a href="#ajaxä¸setTimeoutæ’é˜Ÿé—®é¢˜" class="headerlink" title="ajaxä¸setTimeoutæ’é˜Ÿé—®é¢˜"></a>ajaxä¸setTimeoutæ’é˜Ÿé—®é¢˜</h3><p>é€šå¸¸, ajax å’Œ setTimeout çš„äº‹ä»¶å›è°ƒéƒ½è¢«åŒç­‰çš„å¯¹å¾…, æŒ‰ç…§é¡ºåºè‡ªåŠ¨çš„è¢«æ·»åŠ åˆ° <code>ä»»åŠ¡é˜Ÿåˆ—</code> çš„æœ«å°¾, ç­‰å¾…jså¼•æ“ç©ºé—²æ—¶æ‰§è¡Œ. ä½†è¯·æ³¨æ„, å¹¶éxhrçš„æ‰€æœ‰å›è°ƒæ‰§è¡Œéƒ½æ»åäºsetTImeoutçš„å›è°ƒ. è¯·çœ‹å¦‚ä¸‹ä»£ç :</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">url, method</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> xhr = getXHR();</div><div class="line">  xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  	<span class="built_in">console</span>.log(<span class="string">'xhr.readyState:'</span> + <span class="keyword">this</span>.readyState);</div><div class="line">  &#125;</div><div class="line">  xhr.onloadstart = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  	<span class="built_in">console</span>.log(<span class="string">'onloadStart'</span>);</div><div class="line">  &#125;</div><div class="line">  xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  	<span class="built_in">console</span>.log(<span class="string">'onload'</span>);</div><div class="line">  &#125;</div><div class="line">  xhr.open(method, url, <span class="literal">true</span>);</div><div class="line">  xhr.setRequestHeader(<span class="string">'Cache-Control'</span>,<span class="number">3600</span>);</div><div class="line">  xhr.send();</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> timer = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'setTimeout'</span>);</div><div class="line">&#125;,<span class="number">0</span>);</div><div class="line">ajax(<span class="string">'http://louiszhai.github.io/docImages/ajax01.png'</span>,<span class="string">'GET'</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šè¿°ä»£ç æ‰§è¡Œç»“æœå¦‚ä¸‹å›¾:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax27.png" alt="ajax &amp; setTimeout"></p>
<p>ç”±äºajaxå¼‚æ­¥, setTimeoutå›è°ƒæœ¬åº”è¯¥æœ€å…ˆè¢«æ‰§è¡Œ, ç„¶è€Œå®é™…ä¸Š, ä¸€æ¬¡ajaxè¯·æ±‚, å¹¶éæ‰€æœ‰çš„éƒ¨åˆ†éƒ½æ˜¯å¼‚æ­¥çš„, è‡³å°‘â€readyState==1â€çš„ <code>onreadystatechange</code> å›è°ƒä»¥åŠ <code>onloadstart</code> å›è°ƒå°±æ˜¯åŒæ­¥æ‰§è¡Œçš„. å› æ­¤å®ƒä»¬çš„è¾“å‡ºæ’åœ¨æœ€å‰é¢.</p>
<h3 id="XMLHttpRequest-å±æ€§è§£è¯»"><a href="#XMLHttpRequest-å±æ€§è§£è¯»" class="headerlink" title="XMLHttpRequest å±æ€§è§£è¯»"></a>XMLHttpRequest å±æ€§è§£è¯»</h3><p>é¦–å…ˆåœ¨Chrome consoleä¸‹åˆ›å»ºä¸€ä¸ª XMLHttpRequest å®ä¾‹å¯¹è±¡xhr. å¦‚ä¸‹æ‰€ç¤º:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax01.png" alt="XMLHttpRequest"></p>
<p>è¿è¡Œä»¥ä¸‹ä»£ç .</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest(),</div><div class="line">    i=<span class="number">0</span>;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> xhr)&#123;</div><div class="line">    <span class="keyword">if</span>(xhr.hasOwnProperty(key))&#123;</div><div class="line">       i++;</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(i);<span class="comment">//0</span></div></pre></td></tr></table></figure>
<p>å°±ä¼šå‘ç° XMLHttpRequest å®ä¾‹å¯¹è±¡å…¶å®å¹¶æ²¡æœ‰ä¸€ä¸ªè‡ªæœ‰å±æ€§! è¿™æ˜¯å› ä¸ºå®ƒæ˜¯BOMå¯¹è±¡(Browser Object Model).</p>
<h4 id="inherit"><a href="#inherit" class="headerlink" title="inherit"></a>inherit</h4><p>è¿½æ ¹æº¯æº, çœ‹ä¸€ä¸ªå¯¹è±¡, éœ€è¦å…ˆäº†è§£å®ƒçš„ç»§æ‰¿å…³ç³». è™½ç„¶ XMLHttpRequest å®ä¾‹å¯¹è±¡æ˜¯BOMå¯¹è±¡, ä½†å®ƒä¾ç„¶å…·æœ‰å¦‚ä¸‹çš„ç»§æ‰¿å…³ç³». (ä¸‹é¢ä»¥a&lt;&lt;bè¡¨ç¤ºaç»§æ‰¿b)</p>
<p><code>xhr</code> &lt;&lt; <code>XMLHttpRequest.prototype</code> &lt;&lt; <code>XMLHttpRequestEventTarget.prototype</code> &lt;&lt; <code>EventTarget.prototype</code> &lt;&lt; <code>Object.prototype</code></p>
<p>ç”±ä¸Š, xhrä¹Ÿå…·æœ‰Objectç­‰åŸå‹ä¸­çš„æ‰€æœ‰æ–¹æ³•. å¦‚toStringæ–¹æ³•.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xhr.toString();<span class="comment">//"[object XMLHttpRequest]"</span></div></pre></td></tr></table></figure>
<p>é€šå¸¸, ä¸€ä¸ªxhrå®ä¾‹å¯¹è±¡æ‹¥æœ‰10ä¸ªæ™®é€šå±æ€§+9ä¸ªæ–¹æ³•.</p>
<h4 id="readyState"><a href="#readyState" class="headerlink" title="readyState"></a>readyState</h4><p>åªè¯»å±æ€§, readyStateå±æ€§è®°å½•äº†ajaxè°ƒç”¨è¿‡ç¨‹ä¸­æ‰€æœ‰å¯èƒ½çš„çŠ¶æ€. å®ƒçš„å–å€¼ç®€å•æ˜äº†, å¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th>readyState</th>
<th>å¯¹åº”å¸¸é‡</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>0 (æœªåˆå§‹åŒ–)</td>
<td>xhr.UNSENT</td>
<td>è¯·æ±‚å·²å»ºç«‹, ä½†æœªåˆå§‹åŒ–(æ­¤æ—¶æœªè°ƒç”¨openæ–¹æ³•)</td>
</tr>
<tr>
<td>1 (åˆå§‹åŒ–)</td>
<td>xhr.OPENED</td>
<td>è¯·æ±‚å·²å»ºç«‹, ä½†æœªå‘é€ (å·²è°ƒç”¨openæ–¹æ³•, ä½†æœªè°ƒç”¨sendæ–¹æ³•)</td>
</tr>
<tr>
<td>2 (å‘é€æ•°æ®)</td>
<td>xhr.HEADERS_RECEIVED</td>
<td>è¯·æ±‚å·²å‘é€ (sendæ–¹æ³•å·²è°ƒç”¨, å·²æ”¶åˆ°å“åº”å¤´)</td>
</tr>
<tr>
<td>3 (æ•°æ®ä¼ é€ä¸­)</td>
<td>xhr.LOADING</td>
<td>è¯·æ±‚å¤„ç†ä¸­, å› å“åº”å†…å®¹ä¸å…¨, è¿™æ—¶é€šè¿‡responseBodyå’ŒresponseTextè·å–å¯èƒ½ä¼šå‡ºç°é”™è¯¯</td>
</tr>
<tr>
<td>4 (å®Œæˆ)</td>
<td>xhr.DONE</td>
<td>æ•°æ®æ¥æ”¶å®Œæ¯•, æ­¤æ—¶å¯ä»¥é€šè¿‡é€šè¿‡responseBodyå’ŒresponseTextè·å–å®Œæ•´çš„å“åº”æ•°æ®</td>
</tr>
</tbody>
</table>
<p>æ³¨æ„, readyState æ˜¯ä¸€ä¸ªåªè¯»å±æ€§, æƒ³è¦æ”¹å˜å®ƒçš„å€¼æ˜¯ä¸å¯è¡Œçš„.</p>
<h4 id="onreadystatechange"><a href="#onreadystatechange" class="headerlink" title="onreadystatechange"></a>onreadystatechange</h4><p>onreadystatechangeäº‹ä»¶å›è°ƒæ–¹æ³•åœ¨readystateçŠ¶æ€æ”¹å˜æ—¶è§¦å‘, åœ¨ä¸€ä¸ªæ”¶åˆ°å“åº”çš„ajaxè¯·æ±‚å‘¨æœŸä¸­, onreadystatechange æ–¹æ³•ä¼šè¢«è§¦å‘4æ¬¡. å› æ­¤å¯ä»¥åœ¨ onreadystatechange æ–¹æ³•ä¸­ç»‘å®šä¸€äº›äº‹ä»¶å›è°ƒ, æ¯”å¦‚:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(xhr.readystate==<span class="number">4</span>)&#123;</div><div class="line">    <span class="keyword">var</span> s = xhr.status;</div><div class="line">    <span class="keyword">if</span>((s &gt;= <span class="number">200</span> &amp;&amp; s &lt; <span class="number">300</span>) || s == <span class="number">304</span>)&#123;</div><div class="line">      <span class="keyword">var</span> resp = xhr.responseText;</div><div class="line">      <span class="comment">//TODO ...</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„: onreadystatechangeå›è°ƒä¸­é»˜è®¤ä¼šä¼ å…¥Eventå®ä¾‹, å¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax02.png" alt="Event"></p>
<h4 id="status"><a href="#status" class="headerlink" title="status"></a>status</h4><p>åªè¯»å±æ€§, statusè¡¨ç¤ºhttpè¯·æ±‚çš„çŠ¶æ€, åˆå§‹å€¼ä¸º0. å¦‚æœæœåŠ¡å™¨æ²¡æœ‰æ˜¾å¼åœ°æŒ‡å®šçŠ¶æ€ç , é‚£ä¹ˆstatuså°†è¢«è®¾ç½®ä¸ºé»˜è®¤å€¼, å³200.</p>
<h4 id="statusText"><a href="#statusText" class="headerlink" title="statusText"></a>statusText</h4><p>åªè¯»å±æ€§, statusTextè¡¨ç¤ºæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ä¿¡æ¯, å®ƒæ˜¯ä¸€ä¸ª UTF-16 çš„å­—ç¬¦ä¸², è¯·æ±‚æˆåŠŸä¸”status==20Xæ—¶, è¿”å›å¤§å†™çš„ <code>OK</code> . è¯·æ±‚å¤±è´¥æ—¶è¿”å›ç©ºå­—ç¬¦ä¸². å…¶ä»–æƒ…å†µä¸‹è¿”å›ç›¸åº”çš„çŠ¶æ€æè¿°. æ¯”å¦‚: 301çš„ <code>Moved Permanently</code> , 302çš„ <code>Found</code> , 303çš„ <code>See Other</code> , 307 çš„ <code>Temporary Redirect</code> , 400çš„ <code>Bad Request</code> , 401çš„ <code>Unauthorized</code> ç­‰ç­‰.</p>
<h4 id="onloadstart"><a href="#onloadstart" class="headerlink" title="onloadstart"></a>onloadstart</h4><p>onloadstartäº‹ä»¶å›è°ƒæ–¹æ³•åœ¨ajaxè¯·æ±‚å‘é€ä¹‹å‰è§¦å‘, è§¦å‘æ—¶æœºåœ¨ <code>readyState==1</code> çŠ¶æ€ä¹‹å, <code>readyState==2</code> çŠ¶æ€ä¹‹å‰.</p>
<p>onloadstartæ–¹æ³•ä¸­é»˜è®¤å°†ä¼ å…¥ä¸€ä¸ªProgressEventäº‹ä»¶è¿›åº¦å¯¹è±¡. å¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax03.png" alt="ProgressEvent"> </p>
<p>ProgressEventå¯¹è±¡å…·æœ‰ä¸‰ä¸ªé‡è¦çš„Read onlyå±æ€§.</p>
<ul>
<li>lengthComputable è¡¨ç¤ºé•¿åº¦æ˜¯å¦å¯è®¡ç®—, å®ƒæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼, åˆå§‹å€¼ä¸ºfalse.</li>
<li>loaded è¡¨ç¤ºå·²åŠ è½½èµ„æºçš„å¤§å°, å¦‚æœä½¿ç”¨httpä¸‹è½½èµ„æº, å®ƒä»…ä»…è¡¨ç¤ºå·²ä¸‹è½½å†…å®¹çš„å¤§å°, è€Œä¸åŒ…æ‹¬http headersç­‰. å®ƒæ˜¯ä¸€ä¸ªæ— ç¬¦å·é•¿æ•´å‹, åˆå§‹å€¼ä¸º0.</li>
<li>total è¡¨ç¤ºèµ„æºæ€»å¤§å°, å¦‚æœä½¿ç”¨httpä¸‹è½½èµ„æº, å®ƒä»…ä»…è¡¨ç¤ºå†…å®¹çš„æ€»å¤§å°, è€Œä¸åŒ…æ‹¬http headersç­‰, å®ƒåŒæ ·æ˜¯ä¸€ä¸ªæ— ç¬¦å·é•¿æ•´å‹, åˆå§‹å€¼ä¸º0.</li>
</ul>
<h4 id="onprogress"><a href="#onprogress" class="headerlink" title="onprogress"></a>onprogress</h4><p>onprogressäº‹ä»¶å›è°ƒæ–¹æ³•åœ¨ <code>readyState==3</code> çŠ¶æ€æ—¶å¼€å§‹è§¦å‘, é»˜è®¤ä¼ å…¥ ProgressEvent å¯¹è±¡, å¯é€šè¿‡ <code>e.loaded/e.total</code> æ¥è®¡ç®—åŠ è½½èµ„æºçš„è¿›åº¦, è¯¥æ–¹æ³•ç”¨äºè·å–èµ„æºçš„ä¸‹è½½è¿›åº¦.</p>
<p>æ³¨æ„: è¯¥æ–¹æ³•é€‚ç”¨äº IE10+ åŠå…¶ä»–ç°ä»£æµè§ˆå™¨.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">xhr.onprogress = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'progress:'</span>, e.loaded/e.total);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="onload"><a href="#onload" class="headerlink" title="onload"></a>onload</h4><p>onloadäº‹ä»¶å›è°ƒæ–¹æ³•åœ¨ajaxè¯·æ±‚æˆåŠŸåè§¦å‘, è§¦å‘æ—¶æœºåœ¨ <code>readyState==4</code> çŠ¶æ€ä¹‹å.</p>
<p>æƒ³è¦æ•æ‰åˆ°ä¸€ä¸ªajaxå¼‚æ­¥è¯·æ±‚çš„æˆåŠŸçŠ¶æ€, å¹¶ä¸”æ‰§è¡Œå›è°ƒ, ä¸€èˆ¬ä¸‹é¢çš„è¯­å¥å°±è¶³å¤Ÿäº†:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> s = xhr.status;</div><div class="line">  <span class="keyword">if</span>((s &gt;= <span class="number">200</span> &amp;&amp; s &lt; <span class="number">300</span>) || s == <span class="number">304</span>)&#123;</div><div class="line">    <span class="keyword">var</span> resp = xhr.responseText;</div><div class="line">    <span class="comment">//TODO ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="onloadend"><a href="#onloadend" class="headerlink" title="onloadend"></a>onloadend</h4><p>onloadendäº‹ä»¶å›è°ƒæ–¹æ³•åœ¨ajaxè¯·æ±‚å®Œæˆåè§¦å‘, è§¦å‘æ—¶æœºåœ¨ <code>readyState==4</code> çŠ¶æ€ä¹‹å(æ”¶åˆ°å“åº”æ—¶) æˆ–è€…  <code>readyState==2</code> çŠ¶æ€ä¹‹å(æœªæ”¶åˆ°å“åº”æ—¶).</p>
<p>onloadendæ–¹æ³•ä¸­é»˜è®¤å°†ä¼ å…¥ä¸€ä¸ªProgressEventäº‹ä»¶è¿›åº¦å¯¹è±¡.</p>
<h4 id="timeout"><a href="#timeout" class="headerlink" title="timeout"></a>timeout</h4><p>timeoutå±æ€§ç”¨äºæŒ‡å®šajaxçš„è¶…æ—¶æ—¶é•¿. é€šè¿‡å®ƒå¯ä»¥çµæ´»åœ°æ§åˆ¶ajaxè¯·æ±‚æ—¶é—´çš„ä¸Šé™. timeoutçš„å€¼æ»¡è¶³å¦‚ä¸‹è§„åˆ™:</p>
<ul>
<li>é€šå¸¸è®¾ç½®ä¸º0æ—¶ä¸ç”Ÿæ•ˆ.</li>
<li>è®¾ç½®ä¸ºå­—ç¬¦ä¸²æ—¶, å¦‚æœå­—ç¬¦ä¸²ä¸­å…¨éƒ¨ä¸ºæ•°å­—, å®ƒä¼šè‡ªåŠ¨å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—, åä¹‹è¯¥è®¾ç½®ä¸ç”Ÿæ•ˆ.</li>
<li>è®¾ç½®ä¸ºå¯¹è±¡æ—¶, å¦‚æœè¯¥å¯¹è±¡èƒ½å¤Ÿè½¬åŒ–ä¸ºæ•°å­—, é‚£ä¹ˆå°†è®¾ç½®ä¸ºè½¬åŒ–åçš„æ•°å­—.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">xhr.timeout = <span class="number">0</span>; <span class="comment">//ä¸ç”Ÿæ•ˆ</span></div><div class="line">xhr.timeout = <span class="string">'123'</span>; <span class="comment">//ç”Ÿæ•ˆ, å€¼ä¸º123</span></div><div class="line">xhr.timeout = <span class="string">'123s'</span>; <span class="comment">//ä¸ç”Ÿæ•ˆ</span></div><div class="line">xhr.timeout = [<span class="string">'123'</span>]; <span class="comment">//ç”Ÿæ•ˆ, å€¼ä¸º123</span></div><div class="line">xhr.timeout = &#123;<span class="attr">a</span>:<span class="number">123</span>&#125;; <span class="comment">//ä¸ç”Ÿæ•ˆ</span></div></pre></td></tr></table></figure>
<h4 id="ontimeout"><a href="#ontimeout" class="headerlink" title="ontimeout"></a>ontimeout</h4><p>ontimeoutæ–¹æ³•åœ¨ajaxè¯·æ±‚è¶…æ—¶æ—¶è§¦å‘, é€šè¿‡å®ƒå¯ä»¥åœ¨ajaxè¯·æ±‚è¶…æ—¶æ—¶åšä¸€äº›åç»­å¤„ç†.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">xhr.ontimeout = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.error(<span class="string">"è¯·æ±‚è¶…æ—¶!!!"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="response-responseText"><a href="#response-responseText" class="headerlink" title="response responseText"></a>response responseText</h4><p>å‡ä¸ºåªè¯»å±æ€§, responseè¡¨ç¤ºæœåŠ¡å™¨çš„å“åº”å†…å®¹, ç›¸åº”çš„, responseTextè¡¨ç¤ºæœåŠ¡å™¨å“åº”å†…å®¹çš„æ–‡æœ¬å½¢å¼.</p>
<h4 id="responseXML"><a href="#responseXML" class="headerlink" title="responseXML"></a>responseXML</h4><p>åªè¯»å±æ€§, responseXMLè¡¨ç¤ºxmlå½¢å¼çš„å“åº”æ•°æ®, ç¼ºçœä¸ºnull, è‹¥æ•°æ®ä¸æ˜¯æœ‰æ•ˆçš„xml, åˆ™ä¼šæŠ¥é”™.</p>
<h4 id="responseType"><a href="#responseType" class="headerlink" title="responseType"></a>responseType</h4><p>responseTypeè¡¨ç¤ºå“åº”çš„ç±»å‹, ç¼ºçœä¸ºç©ºå­—ç¬¦ä¸², å¯å– <code>&quot;arraybuffer&quot;</code> , <code>&quot;blob&quot;</code> , <code>&quot;document&quot;</code> , <code>&quot;json&quot;</code> , and <code>&quot;text&quot;</code> å…±äº”ç§ç±»å‹.</p>
<h4 id="responseURL"><a href="#responseURL" class="headerlink" title="responseURL"></a>responseURL</h4><p>responseURLè¿”å›ajaxè¯·æ±‚æœ€ç»ˆçš„URL, å¦‚æœè¯·æ±‚ä¸­å­˜åœ¨é‡å®šå‘, é‚£ä¹ˆresponseURLè¡¨ç¤ºé‡å®šå‘ä¹‹åçš„URL.</p>
<h4 id="withCredentials"><a href="#withCredentials" class="headerlink" title="withCredentials"></a>withCredentials</h4><p>withCredentialsæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼, é»˜è®¤ä¸ºfalse, è¡¨ç¤ºè·¨åŸŸè¯·æ±‚ä¸­ä¸å‘é€cookiesç­‰ä¿¡æ¯. å½“å®ƒè®¾ç½®ä¸ºtrueæ—¶, <code>cookies</code> , <code>authorization headers</code> æˆ–è€…<code>TLSå®¢æˆ·ç«¯è¯ä¹¦</code> éƒ½å¯ä»¥æ­£å¸¸å‘é€å’Œæ¥æ”¶. æ˜¾ç„¶å®ƒçš„å€¼å¯¹åŒåŸŸè¯·æ±‚æ²¡æœ‰å½±å“.</p>
<p>æ³¨æ„: è¯¥å±æ€§é€‚ç”¨äº IE10+, opera12+åŠå…¶ä»–ç°ä»£æµè§ˆå™¨.</p>
<h4 id="abort"><a href="#abort" class="headerlink" title="abort"></a>abort</h4><p>abortæ–¹æ³•ç”¨äºå–æ¶ˆajaxè¯·æ±‚, å–æ¶ˆå, readyState çŠ¶æ€å°†è¢«è®¾ç½®ä¸º <code>0</code> (<code>UNSENT</code>). å¦‚ä¸‹, è°ƒç”¨abort æ–¹æ³•å, è¯·æ±‚å°†è¢«å–æ¶ˆ.</p>
<p><img src="http://louiszhai.github.io/docImages/ajax04.png" alt="Event"></p>
<h4 id="getResponseHeader"><a href="#getResponseHeader" class="headerlink" title="getResponseHeader"></a>getResponseHeader</h4><p>getResponseHeaderæ–¹æ³•ç”¨äºè·å–ajaxå“åº”å¤´ä¸­æŒ‡å®šnameçš„å€¼. å¦‚æœresponse headersä¸­å­˜åœ¨ç›¸åŒçš„name, é‚£ä¹ˆå®ƒä»¬çš„å€¼å°†è‡ªåŠ¨ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿æ¥åœ¨ä¸€èµ·.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(xhr.getResponseHeader(<span class="string">'Content-Type'</span>));<span class="comment">//"text/html"</span></div></pre></td></tr></table></figure>
<h4 id="getAllResponseHeaders"><a href="#getAllResponseHeaders" class="headerlink" title="getAllResponseHeaders"></a>getAllResponseHeaders</h4><p>getAllResponseHeadersæ–¹æ³•ç”¨äºè·å–æ‰€æœ‰å®‰å…¨çš„ajaxå“åº”å¤´, å“åº”å¤´ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›. æ¯ä¸ªHTTPæŠ¥å¤´åç§°å’Œå€¼ç”¨å†’å·åˆ†éš”, å¦‚key:value, å¹¶ä»¥\r\nç»“æŸ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">this</span>.readyState == <span class="keyword">this</span>.HEADERS_RECEIVED) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.getAllResponseHeaders());</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//Content-Type: text/html"</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š,  <code>readyState === 2</code> çŠ¶æ€æ—¶, å°±æ„å‘³ç€å“åº”å¤´å·²æ¥å—å®Œæ•´. æ­¤æ—¶ä¾¿å¯ä»¥æ‰“å°å‡ºå®Œæ•´çš„ response headers.</p>
<h4 id="setRequestHeader"><a href="#setRequestHeader" class="headerlink" title="setRequestHeader"></a>setRequestHeader</h4><p>æ—¢ç„¶å¯ä»¥è·å–å“åº”å¤´, é‚£ä¹ˆè‡ªç„¶ä¹Ÿå¯ä»¥è®¾ç½®è¯·æ±‚å¤´, setRequestHeaderå°±æ˜¯å¹²è¿™ä¸ªçš„. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æŒ‡å®šè¯·æ±‚çš„typeä¸ºjsonæ ¼å¼</span></div><div class="line">xhr.setRequestHeader(<span class="string">"Content-type"</span>, <span class="string">"application/json"</span>);</div><div class="line"><span class="comment">//é™¤æ­¤ä¹‹å¤–, è¿˜å¯ä»¥è®¾ç½®å…¶ä»–çš„è¯·æ±‚å¤´</span></div><div class="line">xhr.setRequestHeader(<span class="string">'x-requested-with'</span>, <span class="string">'123456'</span>);</div></pre></td></tr></table></figure>
<h4 id="onerror"><a href="#onerror" class="headerlink" title="onerror"></a>onerror</h4><p>onerroræ–¹æ³•ç”¨äºåœ¨ajaxè¯·æ±‚å‡ºé”™åæ‰§è¡Œ. é€šå¸¸åªåœ¨ç½‘ç»œå‡ºç°é—®é¢˜æ—¶æˆ–è€…ERR_CONNECTION_RESETæ—¶è§¦å‘(å¦‚æœè¯·æ±‚è¿”å›çš„æ˜¯407çŠ¶æ€ç , chromeä¸‹ä¹Ÿä¼šè§¦å‘onerror).</p>
<h4 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h4><p>uploadå±æ€§é»˜è®¤è¿”å›ä¸€ä¸ª <code>XMLHttpRequestUpload</code> å¯¹è±¡, ç”¨äºä¸Šä¼ èµ„æº. è¯¥å¯¹è±¡å…·æœ‰å¦‚ä¸‹æ–¹æ³•:</p>
<ul>
<li>onloadstart</li>
<li>onprogress</li>
<li>onabort</li>
<li>onerror</li>
<li>onload</li>
<li>ontimeout</li>
<li>onloadend</li>
</ul>
<p>ä¸Šè¿°æ–¹æ³•åŠŸèƒ½åŒ xhr å¯¹è±¡ä¸­åŒåæ–¹æ³•ä¸€è‡´. å…¶ä¸­, onprogress äº‹ä»¶å›è°ƒæ–¹æ³•å¯ç”¨äºè·Ÿè¸ªèµ„æºä¸Šä¼ çš„è¿›åº¦.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">xhr.upload.onprogress = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> percent = <span class="number">100</span> * e.loaded / e.total |<span class="number">0</span>;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'upload: '</span> + precent + <span class="string">'%'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="overrideMimeType"><a href="#overrideMimeType" class="headerlink" title="overrideMimeType"></a>overrideMimeType</h4><p>overrideMimeTypeæ–¹æ³•ç”¨äºå¼ºåˆ¶æŒ‡å®šresponse çš„ MIME ç±»å‹, å³å¼ºåˆ¶ä¿®æ”¹responseçš„ <code>Content-Type</code> . å¦‚ä¸‹, æœåŠ¡å™¨è¿”å›çš„responseçš„ MIME ç±»å‹ä¸º <code>text/plain</code> .</p>
<p><img src="http://louiszhai.github.io/docImages/ajax05.png" alt="response headers"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">xhr.getResponseHeader(<span class="string">'Content-Type'</span>);<span class="comment">//"text/plain"</span></div><div class="line">xhr.responseXML;<span class="comment">//null</span></div></pre></td></tr></table></figure>
<p>é€šè¿‡overrideMimeTypeæ–¹æ³•å°†responseçš„MIMEç±»å‹è®¾ç½®ä¸º <code>text/xml;charset=utf-8</code> , å¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">xhr.overrideMimeType(<span class="string">"text/xml; charset = utf-8"</span>);</div><div class="line">xhr.send();</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶è™½ç„¶ response headers å¦‚ä¸Šå›¾, æ²¡æœ‰å˜åŒ–, ä½† <code>Content-Type</code> å·²æ›¿æ¢ä¸ºæ–°å€¼.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xhr.getResponseHeader(<span class="string">'Content-Type'</span>);<span class="comment">//"text/xml; charset = utf-8"</span></div></pre></td></tr></table></figure>
<p>æ­¤æ—¶, <code>xhr.responseXML</code> ä¹Ÿå°†è¿”å›DOMå¯¹è±¡, å¦‚ä¸‹å›¾.</p>
<p><img src="http://louiszhai.github.io/docImages/ajax06.png" alt="response headers"></p>
<h3 id="XHRä¸€çº§"><a href="#XHRä¸€çº§" class="headerlink" title="XHRä¸€çº§"></a>XHRä¸€çº§</h3><p>XHR1 å³ XMLHttpRequest Level 1. XHR1æ—¶, xhrå¯¹è±¡å…·æœ‰å¦‚ä¸‹ç¼ºç‚¹:</p>
<ul>
<li>ä»…æ”¯æŒæ–‡æœ¬æ•°æ®ä¼ è¾“, æ— æ³•ä¼ è¾“äºŒè¿›åˆ¶æ•°æ®.</li>
<li>ä¼ è¾“æ•°æ®æ—¶, æ²¡æœ‰è¿›åº¦ä¿¡æ¯æç¤º, åªèƒ½æç¤ºæ˜¯å¦å®Œæˆ.</li>
<li>å—æµè§ˆå™¨ <code>åŒæºç­–ç•¥</code> é™åˆ¶, åªèƒ½è¯·æ±‚åŒåŸŸèµ„æº.</li>
<li>æ²¡æœ‰è¶…æ—¶æœºåˆ¶, ä¸æ–¹ä¾¿æŒæ§ajaxè¯·æ±‚èŠ‚å¥.</li>
</ul>
<h3 id="XHRäºŒçº§"><a href="#XHRäºŒçº§" class="headerlink" title="XHRäºŒçº§"></a>XHRäºŒçº§</h3><p>XHR2 å³ XMLHttpRequest Level 2. XHR2é’ˆå¯¹XHR1çš„ä¸Šè¿°ç¼ºç‚¹åšäº†å¦‚ä¸‹æ”¹è¿›:</p>
<ul>
<li>æ”¯æŒäºŒè¿›åˆ¶æ•°æ®, å¯ä»¥ä¸Šä¼ æ–‡ä»¶, å¯ä»¥ä½¿ç”¨FormDataå¯¹è±¡ç®¡ç†è¡¨å•.</li>
<li>æä¾›è¿›åº¦æç¤º, å¯é€šè¿‡ <code>xhr.upload.onprogress</code> äº‹ä»¶å›è°ƒæ–¹æ³•è·å–ä¼ è¾“è¿›åº¦.</li>
<li>ä¾ç„¶å— <code>åŒæºç­–ç•¥</code> é™åˆ¶, è¿™ä¸ªå®‰å…¨æœºåˆ¶ä¸ä¼šå˜. XHR2æ–°æä¾› <code>Access-Control-Allow-Origin</code> ç­‰headers, è®¾ç½®ä¸º <code>*</code> æ—¶è¡¨ç¤ºå…è®¸ä»»ä½•åŸŸåè¯·æ±‚, ä»è€Œå®ç°è·¨åŸŸCORSè®¿é—®(æœ‰å…³CORSè¯¦ç»†ä»‹ç»è¯·è€å¿ƒå¾€ä¸‹è¯»).</li>
<li>å¯ä»¥è®¾ç½®timeout åŠ ontimeout, æ–¹ä¾¿è®¾ç½®è¶…æ—¶æ—¶é•¿å’Œè¶…æ—¶åç»­å¤„ç†.</li>
</ul>
<p>è¿™é‡Œå°±H5æ–°å¢çš„FormDataå¯¹è±¡ä¸¾ä¸ªä¾‹.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å¯ç›´æ¥åˆ›å»ºFormDataå®ä¾‹</span></div><div class="line"><span class="keyword">var</span> data = <span class="keyword">new</span> FormData();</div><div class="line">data.append(<span class="string">"name"</span>, <span class="string">"louis"</span>);</div><div class="line">xhr.send(data);</div><div class="line"><span class="comment">//è¿˜å¯ä»¥é€šè¿‡ä¼ å…¥è¡¨å•DOMå¯¹è±¡æ¥åˆ›å»ºFormDataå®ä¾‹</span></div><div class="line"><span class="keyword">var</span> form = <span class="built_in">document</span>.getElementById(<span class="string">'form'</span>);</div><div class="line"><span class="keyword">var</span> data = <span class="keyword">new</span> FormData(form);</div><div class="line">data.append(<span class="string">"password"</span>, <span class="string">"123456"</span>);</div><div class="line">xhr.send(data);</div></pre></td></tr></table></figure>
<p>ç›®å‰, ä¸»æµæµè§ˆå™¨åŸºæœ¬ä¸Šéƒ½æ”¯æŒXHR2, é™¤äº†IEç³»åˆ—éœ€è¦IE10åŠæ›´é«˜ç‰ˆæœ¬. å› æ­¤IE10ä»¥ä¸‹æ˜¯ä¸æ”¯æŒXHR2çš„.</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†, IE7, 8,9çš„ç”¨æˆ·æ€ä¹ˆåŠ? å¾ˆé—æ†¾, è¿™äº›ç”¨æˆ·æ˜¯æ¯”è¾ƒå°´å°¬çš„. å¯¹äºIE8,9è€Œè¨€, åªæœ‰ä¸€ä¸ªé˜‰å‰²ç‰ˆçš„ <code>XDomainRequest</code> å¯ç”¨,IE7åˆ™æ²¡æœ‰. ä¼°è®¡IE7ç”¨æˆ·åªèƒ½å“­æ™•åœ¨å•æ‰€äº†.</p>
<h3 id="XDomainRequest"><a href="#XDomainRequest" class="headerlink" title="XDomainRequest"></a>XDomainRequest</h3><p>XDomainRequest å¯¹è±¡æ˜¯IE8,9æŠ˜è…¾å‡ºæ¥çš„, ç”¨äºæ”¯æŒCORSè¯·æ±‚éæˆç†Ÿçš„è§£å†³æ–¹æ¡ˆ. ä»¥è‡³äºIE10ä¸­ç›´æ¥ç§»é™¤äº†å®ƒ, å¹¶é‡æ–°å›åˆ°äº† XMLHttpRequest çš„æ€€æŠ±.</p>
<p>XDomainRequest ä»…å¯ç”¨äºå‘é€ <code>GET</code>å’Œ <code>POST</code> è¯·æ±‚. å¦‚ä¸‹å³åˆ›å»ºè¿‡ç¨‹.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xdr = <span class="keyword">new</span> XDomainRequest();</div></pre></td></tr></table></figure>
<p>xdrå…·æœ‰å¦‚ä¸‹å±æ€§:</p>
<ul>
<li>timeout</li>
<li>responseText</li>
</ul>
<p>å¦‚ä¸‹æ–¹æ³•:</p>
<ul>
<li>open: åªèƒ½æ¥æ”¶Method,å’Œurlä¸¤ä¸ªå‚æ•°. åªèƒ½å‘é€å¼‚æ­¥è¯·æ±‚.</li>
<li>send</li>
<li>abort</li>
</ul>
<p>å¦‚ä¸‹äº‹ä»¶å›è°ƒ:</p>
<ul>
<li>onprogress</li>
<li>ontimeout</li>
<li>onerror</li>
<li>onload</li>
</ul>
<p>é™¤äº†ç¼ºå°‘ä¸€äº›æ–¹æ³•å¤–, XDomainRequest åŸºæœ¬ä¸Šå°±å’Œ XMLHttpRequest çš„ä½¿ç”¨æ–¹å¼ä¿æŒä¸€è‡´. </p>
<p>å¿…é¡»è¦æ˜ç¡®çš„æ˜¯:</p>
<ul>
<li>XDomainRequest ä¸æ”¯æŒè·¨åŸŸä¼ è¾“cookie.</li>
<li>åªèƒ½è®¾ç½®è¯·æ±‚å¤´çš„Content-Typeå­—æ®µ, ä¸”ä¸èƒ½è®¿é—®å“åº”å¤´ä¿¡æ¯.</li>
</ul>
<h3 id="ajax"><a href="#ajax" class="headerlink" title="$.ajax"></a>$.ajax</h3><p>$.ajaxæ˜¯jqueryå¯¹åŸç”Ÿajaxçš„ä¸€æ¬¡å°è£…. é€šè¿‡å°è£…ajax, jqueryæŠ¹å¹³äº†ä¸åŒç‰ˆæœ¬æµè§ˆå™¨å¼‚æ­¥httpçš„å·®å¼‚æ€§, å–è€Œä»£ä¹‹çš„æ˜¯é«˜åº¦ç»Ÿä¸€çš„api. jqueryä½œä¸ºjsç±»åº“æ—¶ä»£çš„å…ˆé©±, å¯¹å‰ç«¯å‘å±•æœ‰ç€æ·±è¿œçš„å½±å“. äº†è§£å¹¶ç†Ÿæ‚‰å…¶ajaxæ–¹æ³•, ä¸å¯è°“ä¸é‡è¦.</p>
<h4 id="å‚æ•°åˆ—è¡¨"><a href="#å‚æ•°åˆ—è¡¨" class="headerlink" title="å‚æ•°åˆ—è¡¨"></a>å‚æ•°åˆ—è¡¨</h4><p>$.ajax() åªæœ‰ä¸€ä¸ªå‚æ•°, è¯¥å‚æ•°ä¸ºkey-valueè®¾ç½®å¯¹è±¡. å®é™…ä¸Š, jqå‘é€çš„æ‰€æœ‰ajaxè¯·æ±‚, éƒ½æ˜¯é€šè¿‡è°ƒç”¨è¯¥ajaxæ–¹æ³•å®ç°çš„. å®ƒçš„è¯¦ç»†å‚æ•°å¦‚ä¸‹è¡¨:</p>
<table>
<thead>
<tr>
<th style="text-align:center">åºå·</th>
<th style="text-align:center">å‚æ•°</th>
<th style="text-align:center">ç±»å‹</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><strong><em>accepts</em></strong></td>
<td style="text-align:center"><em>PlainObject</em></td>
<td style="text-align:left">ç”¨äºé€šçŸ¥æœåŠ¡å™¨è¯¥è¯·æ±‚éœ€è¦æ¥æ”¶ä½•ç§ç±»å‹çš„è¿”å›ç»“æœ. å¦‚æœ‰å¿…è¦, æ¨èåœ¨ <code>$.ajaxSetup()</code> æ–¹æ³•ä¸­è®¾ç½®ä¸€æ¬¡.</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><strong><em>async</em></strong></td>
<td style="text-align:center"><em>Boolean</em></td>
<td style="text-align:left">é»˜è®¤ä¸ºtrue, å³å¼‚æ­¥.</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><strong><em>beforeSend</em></strong></td>
<td style="text-align:center"><em>Function</em></td>
<td style="text-align:left">è¯·æ±‚å‘é€å‰çš„å›è°ƒ, é»˜è®¤ä¼ å…¥å‚æ•°jqXHRå’Œsettings. å‡½æ•°å†…æ˜¾å¼è¿”å›falseå°†å–æ¶ˆæœ¬æ¬¡è¯·æ±‚.</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><strong><em>cache</em></strong></td>
<td style="text-align:center"><em>Boolean</em></td>
<td style="text-align:left">è¯·æ±‚æ˜¯å¦å¼€å¯ç¼“å­˜, é»˜è®¤ä¸ºtrue, å¦‚ä¸éœ€è¦ç¼“å­˜è¯·è®¾ç½®ä¸ºfalse. ä¸è¿‡, dataTypeä¸ºâ€scriptâ€å’Œâ€jsonpâ€æ—¶é»˜è®¤ä¸ºfalse.</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center"><strong><em>complete</em></strong></td>
<td style="text-align:center"><em>Function</em></td>
<td style="text-align:left">è¯·æ±‚å®Œæˆåçš„å›è°ƒ(è¯·æ±‚<code>success</code> å’Œ <code>error</code>ä¹‹åå‡è°ƒç”¨), é»˜è®¤ä¼ å…¥å‚æ•°jqXHRå’ŒtextStatus(è¯·æ±‚çŠ¶æ€, å–å€¼ä¸º â€œsuccessâ€,â€notmodifiedâ€,â€errorâ€,â€timeoutâ€,â€abortâ€,â€parsererrorâ€ä¹‹ä¸€). ä»jq1.5å¼€å§‹, completeå¯ä»¥è®¾ç½®ä¸ºä¸€ä¸ªåŒ…å«å‡½æ•°çš„æ•°ç»„. å¦‚æ­¤æ¯ä¸ªå‡½æ•°å°†ä¾æ¬¡è¢«è°ƒç”¨.</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center"><strong><em>contents</em></strong></td>
<td style="text-align:center"><em>PlainObject</em></td>
<td style="text-align:left">ä¸€ä¸ªä»¥â€{å­—ç¬¦ä¸²/æ­£åˆ™è¡¨è¾¾å¼}â€é…å¯¹çš„å¯¹è±¡, æ ¹æ®ç»™å®šçš„å†…å®¹ç±»å‹, è§£æè¯·æ±‚çš„è¿”å›ç»“æœ.</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center"><strong><em>contentType</em></strong></td>
<td style="text-align:center"><em>String</em></td>
<td style="text-align:left">ç¼–ç ç±»å‹, ç›¸å¯¹åº”äºhttpè¯·æ±‚å¤´åŸŸçš„â€Content-Typeâ€å­—æ®µ. é»˜è®¤å€¼ä¸ºâ€application/x-www-form-urlencoded; charset=UTF-8â€.</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center"><strong><em>context</em></strong></td>
<td style="text-align:center"><em>Object</em></td>
<td style="text-align:left">è®¾ç½®ajaxå›è°ƒå‡½æ•°çš„ä¸Šä¸‹æ–‡. é»˜è®¤ä¸Šä¸‹æ–‡ä¸ºajaxè¯·æ±‚ä¼ å…¥çš„å‚æ•°è®¾ç½®å¯¹è±¡. å¦‚è®¾ç½®ä¸ºdocument.body, é‚£ä¹ˆæ‰€æœ‰ajaxå›è°ƒå‡½æ•°ä¸­å°†ä»¥bodyä¸ºä¸Šä¸‹æ–‡.</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center"><strong><em>converters</em></strong></td>
<td style="text-align:center"><em>PlainObject</em></td>
<td style="text-align:left">ä¸€ä¸ªæ•°æ®ç±»å‹åˆ°æ•°æ®ç±»å‹è½¬æ¢å™¨çš„å¯¹è±¡. é»˜è®¤ä¸º <code>{&quot;* text&quot;: window.String, &quot;text html&quot;: true, &quot;text json&quot;: jQuery.parseJSON, &quot;text xml&quot;: jQuery.parseXML}</code> . å¦‚è®¾ç½®<code>converters:{&quot;json jsonp&quot;: function(msg){}}</code></td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center"><strong><em>crossDomain</em></strong></td>
<td style="text-align:center"><em>Boolean</em></td>
<td style="text-align:left">é»˜è®¤åŒåŸŸè¯·æ±‚ä¸ºfalse, è·¨åŸŸè¯·æ±‚ä¸ºtrue.</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center"><strong><em>data</em></strong></td>
<td style="text-align:center"><em>Object, Array</em></td>
<td style="text-align:left">å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®, é»˜è®¤dataä¸ºé”®å€¼å¯¹æ ¼å¼å¯¹è±¡, è‹¥dataä¸ºæ•°ç»„åˆ™æŒ‰ç…§<code>traditional</code>å‚æ•°çš„å€¼, è‡ªåŠ¨è½¬åŒ–ä¸ºä¸€ä¸ªåŒåçš„å¤šå€¼æŸ¥è¯¢å­—ç¬¦ä¸². å¦‚{a:1,b:2}å°†è½¬æ¢ä¸ºâ€&amp;a=1&amp;b=2â€.</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center"><strong><em>dataFilter</em></strong></td>
<td style="text-align:center"><em>Function</em></td>
<td style="text-align:left">å¤„ç†XMLHttpRequeståŸå§‹å“åº”æ•°æ®çš„å›è°ƒ, é»˜è®¤ä¼ å…¥dataå’Œtypeå‚æ•°, dataæ˜¯Ajaxè¿”å›çš„åŸå§‹æ•°æ®, typeæ˜¯è°ƒç”¨$.ajaxæ—¶æä¾›çš„dataTypeå‚æ•°</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td style="text-align:center"><strong><em>dataType</em></strong></td>
<td style="text-align:center"><em>String</em></td>
<td style="text-align:left">é¢„æœŸæœåŠ¡å™¨è¿”å›çš„æ•°æ®ç±»å‹, å¯è®¾ç½®ä¸ºâ€xmlâ€,â€htmlâ€,â€scriptâ€,â€jsonâ€,â€jsonpâ€,â€textâ€ä¹‹ä¸€, å…¶ä¸­è®¾ç½®ä¸ºâ€xmlâ€æˆ–â€textâ€ç±»å‹æ—¶, æ•°æ®ä¸ä¼šç»è¿‡å¤„ç†.</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center"><strong><em>error</em></strong></td>
<td style="text-align:center"><em>Function</em></td>
<td style="text-align:left">è¯·æ±‚å¤±è´¥æ—¶çš„å›è°ƒå‡½æ•°, é»˜è®¤ä¼ å…¥jqXHR(jq1.4ä»¥å‰ä¸ºåŸç”Ÿxhrå¯¹è±¡),textStatus(è¯·æ±‚çŠ¶æ€,å–å€¼ä¸ºnull,â€timeoutâ€,â€errorâ€,â€abortâ€ æˆ– â€œparsererrorâ€),errorString(é”™è¯¯å†…å®¹), å½“ä¸€ä¸ªHTTPé”™è¯¯å‘ç”Ÿæ—¶, <code>errorThrown</code> æ¥æ”¶HTTPçŠ¶æ€çš„æ–‡æœ¬éƒ¨åˆ†,æ¯”å¦‚â€Not Foundâ€ç­‰. ä»jq1.5å¼€å§‹, errorå¯ä»¥è®¾ç½®ä¸ºä¸€ä¸ªåŒ…å«å‡½æ•°çš„æ•°ç»„. å¦‚æ­¤æ¯ä¸ªå‡½æ•°å°†ä¾æ¬¡è¢«è°ƒç”¨.æ³¨æ„: è·¨åŸŸè„šæœ¬å’ŒJSONPè¯·æ±‚æ—¶errorä¸è¢«è°ƒç”¨.</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td style="text-align:center"><strong><em>global</em></strong></td>
<td style="text-align:center"><em>Boolean</em></td>
<td style="text-align:left">è¡¨ç¤ºæ˜¯å¦è§¦å‘å…¨å±€ajaxäº‹ä»¶, é»˜è®¤ä¸ºtrue. è®¾ä¸ºfalseå°†ä¸å†è§¦å‘ajaxStart,ajaxStop,ajaxSend,ajaxErrorç­‰. è·¨ç«™è„šæœ¬å’Œjsonpè¯·æ±‚, è¯¥å€¼è‡ªåŠ¨è®¾ç½®ä¸ºfalse.</td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td style="text-align:center"><strong><em>headers</em></strong></td>
<td style="text-align:center"><em>PlainObject</em></td>
<td style="text-align:left">è®¾ç½®è¯·æ±‚å¤´, æ ¼å¼ä¸ºk-vé”®å€¼å¯¹å¯¹è±¡. ç”±äºè¯¥è®¾ç½®ä¼šåœ¨beforeSendå‡½æ•°è¢«è°ƒç”¨ä¹‹å‰ç”Ÿæ•ˆ, å› æ­¤å¯åœ¨beforeSendå‡½æ•°å†…è¦†ç›–è¯¥å¯¹è±¡.</td>
</tr>
<tr>
<td style="text-align:center">17</td>
<td style="text-align:center"><strong><em>ifModified</em></strong></td>
<td style="text-align:center"><em>Boolean</em></td>
<td style="text-align:left">åªæœ‰ä¸Šæ¬¡è¯·æ±‚å“åº”æ”¹å˜æ—¶, æ‰å…è®¸è¯·æ±‚æˆåŠŸ. å®ƒä½¿ç”¨HTTPåŒ…çš„Last-Modified å¤´ä¿¡æ¯åˆ¤æ–­, é»˜è®¤ä¸ºfalse. è‹¥è®¾ç½®ä¸ºtrue, ä¸”æ•°æ®è‡ªä»ä¸Šæ¬¡è¯·æ±‚åæ²¡æœ‰æ›´æ”¹è¿‡å°±ä¼šæŠ¥é”™.</td>
</tr>
<tr>
<td style="text-align:center">18</td>
<td style="text-align:center"><strong><em>isLocal</em></strong></td>
<td style="text-align:center"><em>Boolean</em></td>
<td style="text-align:left">è¿è¡Œå½“å‰ç¯å¢ƒè®¾ç½®ä¸ºâ€æœ¬åœ°â€,é»˜è®¤ä¸ºfalse, è‹¥è®¾ç½®ä¸ºtrue, å°†å½±å“è¯·æ±‚å‘é€æ—¶çš„åè®®.</td>
</tr>
<tr>
<td style="text-align:center">19</td>
<td style="text-align:center"><strong><em>jsonp</em></strong></td>
<td style="text-align:center"><em>String</em></td>
<td style="text-align:left">æ˜¾å¼æŒ‡å®šjsonpè¯·æ±‚ä¸­çš„å›è°ƒå‡½æ•°çš„åç§°. å¦‚jsonp:cb, jqä¼šå°†cbä»£æ›¿callback, ä»¥ â€œcb=?â€ä¼ ç»™æœåŠ¡å™¨. ä»jq1.5å¼€å§‹, è‹¥è®¾ç½®jsonp:false, é‚£ä¹ˆéœ€è¦æ˜ç¡®è®¾ç½®jsonpCallback:â€callbackNameâ€.</td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td style="text-align:center"><strong><em>jsonpCallback</em></strong></td>
<td style="text-align:center"><em>String,Function</em></td>
<td style="text-align:left">ä¸ºjsonpè¯·æ±‚æŒ‡å®šä¸€ä¸ªå›è°ƒå‡½æ•°å, ä»¥å–ä»£jqè‡ªåŠ¨ç”Ÿæˆçš„éšæœºå‡½æ•°å. ä»jq1.5å¼€å§‹, å¯ä»¥å°†è¯¥å±æ€§è®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°, å‡½æ•°çš„è¿”å›å€¼å°±æ˜¯jsonpCallbackçš„ç»“æœ.</td>
</tr>
<tr>
<td style="text-align:center">21</td>
<td style="text-align:center"><strong><em>mimeType</em></strong></td>
<td style="text-align:center"><em>String</em></td>
<td style="text-align:left">è®¾ç½®ä¸€ä¸ªMIMEç±»å‹, ä»¥è¦†ç›–xhrçš„MIMç±»å‹(jq1.5æ–°å¢)</td>
</tr>
<tr>
<td style="text-align:center">22</td>
<td style="text-align:center"><strong><em>password</em></strong></td>
<td style="text-align:center"><em>String</em></td>
<td style="text-align:left">è®¾ç½®è®¤è¯è¯·æ±‚ä¸­çš„å¯†ç </td>
</tr>
<tr>
<td style="text-align:center">23</td>
<td style="text-align:center"><strong><em>processData</em></strong></td>
<td style="text-align:center"><em>Boolean</em></td>
<td style="text-align:left">jqçš„ajaxæ–¹æ³•é»˜è®¤ä¼šå°†ä¼ å…¥çš„dataéšå¼è½¬æ¢ä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²(å¦‚â€&amp;a=1&amp;b=2â€), ä»¥é…åˆ é»˜è®¤å†…å®¹ç±»å‹ â€œapplication/x-www-form-urlencodedâ€, å¦‚æœä¸å¸Œæœ›è½¬æ¢è¯·è®¾ç½®ä¸ºfalse. angularä¸­æƒ³è¦ç¦ç”¨é»˜è®¤è½¬æ¢, éœ€è¦é‡å†™transformRequestæ–¹æ³•.</td>
</tr>
<tr>
<td style="text-align:center">24</td>
<td style="text-align:center"><strong><em>scriptCharset</em></strong></td>
<td style="text-align:center"><em>String</em></td>
<td style="text-align:left">ä»…åœ¨â€scriptâ€è¯·æ±‚ä¸­ä½¿ç”¨(å¦‚è·¨åŸŸjsonp, dataTypeä¸ºâ€scriptâ€ç±»å‹). æ˜¾å¼æŒ‡å®šæ—¶, è¯·æ±‚ä¸­å°†åœ¨scriptæ ‡ç­¾ä¸Šè®¾ç½®<code>charset</code>å±æ€§, å¯åœ¨å‘ç°æœ¬åœ°å’Œè¿œç¨‹ç¼–ç ä¸ä¸€è‡´æ—¶ä½¿ç”¨.</td>
</tr>
<tr>
<td style="text-align:center">25</td>
<td style="text-align:center"><strong><em>statusCode</em></strong></td>
<td style="text-align:center"><em>PlainObject</em></td>
<td style="text-align:left">ä¸€ç»„httpçŠ¶æ€ç å’Œå›è°ƒå‡½æ•°å¯¹åº”çš„é”®å€¼å¯¹å¯¹è±¡. è¯¥å¯¹è±¡ä»¥ {404:function(){}} è¿™ç§å½¢å¼è¡¨ç¤º. å¯ç”¨äºæ ¹æ®ä¸åŒçš„httpçŠ¶æ€ç , æ‰§è¡Œä¸åŒçš„å›è°ƒ.(jq1.5æ–°å¢)</td>
</tr>
<tr>
<td style="text-align:center">26</td>
<td style="text-align:center"><strong><em>timeout</em></strong></td>
<td style="text-align:center"><em>Number</em></td>
<td style="text-align:left">è®¾ç½®è¶…æ—¶æ—¶é—´.</td>
</tr>
<tr>
<td style="text-align:center">27</td>
<td style="text-align:center"><strong><em>traditional</em></strong></td>
<td style="text-align:center"><em>Boolean</em></td>
<td style="text-align:left">æ˜¯å¦æŒ‰ç…§é»˜è®¤æ–¹å¼åºåˆ—åŒ–dataå¯¹è±¡, é»˜è®¤å€¼ä¸ºfalse.</td>
</tr>
<tr>
<td style="text-align:center">28</td>
<td style="text-align:center"><strong><em>type</em></strong></td>
<td style="text-align:center"><em>String</em></td>
<td style="text-align:left">å¯ä»¥è®¾ç½®ä¸º8ç§http methodä¹‹ä¸€, jqä¸­ä¸åŒºåˆ†å¤§å°å†™.</td>
</tr>
<tr>
<td style="text-align:center">29</td>
<td style="text-align:center"><strong><em>url</em></strong></td>
<td style="text-align:center"><em>String</em></td>
<td style="text-align:left">è¯·æ±‚çš„uriåœ°å€.</td>
</tr>
<tr>
<td style="text-align:center">30</td>
<td style="text-align:center"><strong><em>username</em></strong></td>
<td style="text-align:center"><em>String</em></td>
<td style="text-align:left">è®¾ç½®è®¤è¯è¯·æ±‚ä¸­çš„ç”¨æˆ·å</td>
</tr>
<tr>
<td style="text-align:center">31</td>
<td style="text-align:center"><strong><em>xhr</em></strong></td>
<td style="text-align:center"><em>Function</em></td>
<td style="text-align:left">åœ¨å›è°ƒå†…åˆ›å»ºå¹¶è¿”å›xhrå¯¹è±¡</td>
</tr>
<tr>
<td style="text-align:center">32</td>
<td style="text-align:center"><strong><em>xhrFields</em></strong></td>
<td style="text-align:center"><em>PlainObject</em></td>
<td style="text-align:left">é”®å€¼å¯¹å¯¹è±¡, ç”¨äºè®¾ç½®åŸç”Ÿçš„xhrå¯¹è±¡, å¦‚å¯ç”¨æ¥è®¾ç½®withCredentials:true(jq1.5.1æ–°å¢)</td>
</tr>
</tbody>
</table>
<h4 id="æ”¯æŒpromise"><a href="#æ”¯æŒpromise" class="headerlink" title="æ”¯æŒpromise"></a>æ”¯æŒpromise</h4><p>$.ajax() æ–¹æ³•è¿”å›jqXHRå¯¹è±¡(jq1.5èµ·), å¦‚æœä½¿ç”¨çš„ä¸æ˜¯XMLHttpRequestå¯¹è±¡æ—¶, å¦‚jsonpè¯·æ±‚, è¿”å›çš„jqXHRå¯¹è±¡å°†å°½å¯èƒ½æ¨¡æ‹ŸåŸç”Ÿçš„xhr. ä»jq1.5èµ·, è¿”å›çš„jqXHRå¯¹è±¡å®ç°äº†promiseæ¥å£, å…·æœ‰å¦‚ä¸‹æ–°æ–¹æ³•.</p>
<table>
<thead>
<tr>
<th style="text-align:center">æ–°æ–¹æ³•</th>
<th style="text-align:center">è¢«æ›¿ä»£çš„è€æ–¹æ³•(jq1.8èµ·å¼ƒç”¨)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">done(function(data, textStatus, jqXHR) {})</td>
<td style="text-align:center"><del>success</del></td>
</tr>
<tr>
<td style="text-align:center">fail(function(jqXHR, textStatus, errorThrown) {})</td>
<td style="text-align:center"><del>error</del></td>
</tr>
<tr>
<td style="text-align:center">always(function(data or jqXHR, textStatus, jqXHR or errorThrown) {})</td>
<td style="text-align:center"><del>complete</del></td>
</tr>
</tbody>
</table>
<p>ä»jq1.6å¼€å§‹, done, fail, alwaysæŒ‰ç…§FIFOé˜Ÿåˆ—å¯ä»¥åˆ†é…å¤šä¸ªå›è°ƒ.</p>
<h4 id="ä½¿ç”¨è½¬æ¢å™¨"><a href="#ä½¿ç”¨è½¬æ¢å™¨" class="headerlink" title="ä½¿ç”¨è½¬æ¢å™¨"></a>ä½¿ç”¨è½¬æ¢å™¨</h4><p>$.ajax() çš„è½¬æ¢å™¨å¯ä»¥å°†æ”¯æŒçš„æ•°æ®ç±»å‹æ˜ å°„åˆ°å…¶å®ƒæ•°æ®ç±»å‹. å¦‚æœéœ€è¦å°†è‡ªå®šä¹‰æ•°æ®ç±»å‹æ˜ å°„åˆ°å·²çŸ¥çš„ç±»å‹. éœ€è¦ä½¿ç”¨ <code>contents</code> é€‰é¡¹åœ¨å“åº”çš„ â€œContent-Typeâ€ å’Œå®é™…æ•°æ®ç±»å‹ä¹‹é—´æ·»åŠ ä¸€ä¸ªè½¬æ¢å‡½æ•°.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$.ajaxSetup(&#123;</div><div class="line">  <span class="attr">contents</span>: &#123;</div><div class="line">    <span class="attr">myContentType</span>: <span class="regexp">/myContentType/</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">converters</span>: &#123;</div><div class="line">    <span class="string">"myContentType json"</span>: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">      <span class="comment">//TODO something</span></div><div class="line">      <span class="keyword">return</span> newData;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è½¬æ¢ä¸€ä¸ªæ”¯æŒçš„ç±»å‹ä¸ºè‡ªå®šä¹‰ç±»å‹, ç„¶åå†è¿”å›. å¦‚ textâ€”&gt;myContentTypeâ€”&gt;json.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">$.ajaxSetup(&#123;</div><div class="line">  <span class="attr">contents</span>: &#123;</div><div class="line">    <span class="attr">myContentType</span>: <span class="regexp">/myContentType/</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">converters</span>: &#123;</div><div class="line">    <span class="string">"text myContentType"</span>: <span class="literal">true</span>,</div><div class="line">    <span class="string">"myContentType json"</span>: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">      <span class="comment">//TODO something</span></div><div class="line">      <span class="keyword">return</span> newData;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="äº‹ä»¶è§¦å‘é¡ºåº"><a href="#äº‹ä»¶è§¦å‘é¡ºåº" class="headerlink" title="äº‹ä»¶è§¦å‘é¡ºåº"></a>äº‹ä»¶è§¦å‘é¡ºåº</h4><p>$.ajax()æ–¹æ³•è§¦å‘çš„äº‹ä»¶çº·ç¹å¤æ‚, æœ‰å°†è¿‘20ä¸ªä¹‹å¤š. ä¸ºäº†å›Šæ‹¬æœ€å¤šçš„äº‹ä»¶, è¿™é‡Œä»¥ä¸€æ¬¡æˆåŠŸçš„ä¸Šä¼ è¯·æ±‚ä¸ºä¾‹, ä»¥ä¸‹æ˜¯å®ƒä»¬çš„è°ƒç”¨é¡ºåº(è¯·æ±‚å‡ºç°é”™è¯¯æ—¶çš„é¡ºåº, è¯·è‡ªè¡Œå¯¹åº”).</p>
<table>
<thead>
<tr>
<th style="text-align:center">åºå·</th>
<th style="text-align:center">äº‹ä»¶åç§°</th>
<th style="text-align:center">æ˜¯å¦å…¨å±€äº‹ä»¶</th>
<th style="text-align:center">æ˜¯å¦èƒ½å…³é—­</th>
<th style="text-align:center">é»˜è®¤å½¢å‚</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">$.ajaxPrefilter</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">function(options, originalOptions, jqXHR){}</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">$(document).ajaxStar</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">function(){}(åªåœ¨å½“å‰æ— æ¿€æ´»ajaxæ—¶è§¦å‘)</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">beforeSend</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">-</td>
<td style="text-align:center">function(jqXHR, settings){}</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">$(document).ajaxSend</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">function(){}</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">xhr.onloadstart</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">ProgressEvent</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">xhr.upload.onloadstart</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">ProgressEvent</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">xhr.upload.onprogress</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">ProgressEvent</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">xhr.upload.onload</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">ProgressEvent</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">xhr.upload.onloadend</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">ProgressEvent</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">xhr.onprogress</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">ProgressEvent</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">xhr.onload</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">ProgressEvent</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center"><del>success</del>(å¼ƒç”¨)</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">-</td>
<td style="text-align:center">function(data, textStatus, jqXHR){}</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td style="text-align:center">$(document).ajaxSuccess</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">function(event, jqXHR, options){}</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center"><del>complete</del>(å¼ƒç”¨)</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">-</td>
<td style="text-align:center">function(jqXHR, textStatus){}</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td style="text-align:center">$(document).ajaxComplete</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">function(event, jqXHR, textStatus)</td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td style="text-align:center">$(document).ajaxStop</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">function(){}</td>
</tr>
<tr>
<td style="text-align:center">17</td>
<td style="text-align:center">xhr.onloadend</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">ProgressEvent</td>
</tr>
</tbody>
</table>
<p>ä»jq1.8èµ·, å¯¹äºå‡½æ•° <code>ajaxStart</code>, <code>ajaxSend</code>, <code>ajaxSuccess</code>, <code>ajaxComplete</code>, <code>ajaxStop</code> , åªèƒ½ä¸º<code>document</code>å¯¹è±¡ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°, ä¸ºå…¶ä»–å…ƒç´ ç»‘å®šçš„äº‹ä»¶å¤„ç†å‡½æ•°ä¸ä¼šèµ·ä½œç”¨.</p>
<h3 id="Axios"><a href="#Axios" class="headerlink" title="Axios"></a>Axios</h3><p>å®é™…ä¸Š, å¦‚æœä½ ä»…ä»…åªæ˜¯æƒ³è¦ä¸€ä¸ªä¸é”™çš„httpåº“, ç›¸æ¯”äºåºå¤§è‡ƒè‚¿çš„jquery, çŸ­å°ç²¾æ‚çš„Axioså¯èƒ½æ›´åŠ é€‚åˆä½ . åŸå› å¦‚ä¸‹:</p>
<ul>
<li>Axiosæ”¯æŒnode, jqueryå¹¶ä¸æ”¯æŒ.</li>
<li>AxiosåŸºäºpromiseè¯­æ³•, jq3.0æ‰å¼€å§‹å…¨é¢æ”¯æŒ.</li>
<li>AxiosçŸ­å°ç²¾æ‚, æ›´åŠ é€‚åˆhttpåœºæ™¯, jqueryå¤§è€Œå…¨, åŠ è½½è¾ƒæ…¢.</li>
<li>vueä½œè€…å°¤å¤§æ”¾å¼ƒæ¨èvue-resource, è½¬å‘æ¨èAxios. ä»¥ä¸‹ä¸ºå°¤å¤§åŸè¯.</li>
</ul>
<blockquote>
<p>â€œæœ€è¿‘å›¢é˜Ÿè®¨è®ºäº†ä¸€ä¸‹, Ajax æœ¬èº«è·Ÿ Vue å¹¶æ²¡æœ‰ä»€ä¹ˆéœ€è¦ç‰¹åˆ«æ•´åˆçš„åœ°æ–¹, ä½¿ç”¨ fetch polyfill æˆ–æ˜¯ axiosã€superagent ç­‰ç­‰éƒ½å¯ä»¥èµ·åˆ°åŒç­‰çš„æ•ˆæœ, vue-resource æä¾›çš„ä»·å€¼å’Œå…¶ç»´æŠ¤æˆæœ¬ç›¸æ¯”å¹¶ä¸åˆ’ç®—, æ‰€ä»¥å†³å®šåœ¨ä¸ä¹…ä»¥åå–æ¶ˆå¯¹ vue-resource çš„å®˜æ–¹æ¨è.â€</p>
</blockquote>
<p>Axioså¤§å°ä»…12k, ç›®å‰æœ€æ–°ç‰ˆæœ¬å·ä¸º: <a href="https://www.npmjs.org/package/axios" target="_blank" rel="external"><img src="https://camo.githubusercontent.com/9f600e10007ac86da6a8b90c16ca1e9504901730/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f6178696f732e7376673f7374796c653d666c61742d737175617265" alt="npm version"></a></p>
<p>è¯­æ³•ä¸ŠAxiosåŸºæœ¬å°±å’Œpromiseä¸€æ ·, åœ¨thenæ–¹æ³•ä¸­å¤„ç†å›è°ƒ, åœ¨catchæ–¹æ³•ä¸­å¤„ç†å¼‚å¸¸. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">axios.get(<span class="string">"https://api.github.com/users/louiszhai"</span>)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(response);</div><div class="line">  &#125;)</div><div class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(error);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<p>é™¤äº†get, å®ƒè¿˜æ”¯æŒpost, delete, head, put, patch, requestè¯·æ±‚. å…·ä½“ä½¿ç”¨æ”»ç•¥, è¯·æˆ³è¿™é‡Œ: <a href="http://www.bootcdn.cn/axios/readme/" target="_blank" rel="external">axios</a> .</p>
<p>å¦‚éœ€åœ¨ç½‘é¡µä¸Šå¼•å…¥ Axios, å¯ä»¥é“¾æ¥CDN <a href="http://www.bootcdn.cn/axios/" target="_blank" rel="external">axios | Bootstrapä¸­æ–‡ç½‘å¼€æºé¡¹ç›®å…è´¹ CDN æœåŠ¡</a> æˆ–è€…å°†å…¶ä¸‹è½½åˆ°æœ¬åœ°.</p>
<h3 id="Fetch"><a href="#Fetch" class="headerlink" title="Fetch"></a>Fetch</h3><p>è¯´åˆ°ajax, å°±ä¸å¾—ä¸æåŠfetch, ç”±äºç¯‡å¹…è¾ƒé•¿, fetchå·²ä»æœ¬æ–‡ä¸­ç‹¬ç«‹å‡ºæ¥, è¯·æˆ³ <a href="http://louiszhai.github.io/2016/11/02/fetch/">Fetchè¿›é˜¶æŒ‡å—</a> .</p>
<h3 id="ajaxè·¨åŸŸè¯·æ±‚"><a href="#ajaxè·¨åŸŸè¯·æ±‚" class="headerlink" title="ajaxè·¨åŸŸè¯·æ±‚"></a>ajaxè·¨åŸŸè¯·æ±‚</h3><h4 id="ä»€ä¹ˆæ˜¯CORS"><a href="#ä»€ä¹ˆæ˜¯CORS" class="headerlink" title="ä»€ä¹ˆæ˜¯CORS"></a>ä»€ä¹ˆæ˜¯CORS</h4><p>CORSæ˜¯ä¸€ä¸ªW3C(World Wide Web)æ ‡å‡†, å…¨ç§°æ˜¯è·¨åŸŸèµ„æºå…±äº«(Cross-origin resource sharing).å®ƒå…è®¸æµè§ˆå™¨å‘è·¨åŸŸæœåŠ¡å™¨, å‘å‡ºå¼‚æ­¥httpè¯·æ±‚, ä»è€Œå…‹æœäº†ajaxå—åŒæºç­–ç•¥çš„é™åˆ¶. å®é™…ä¸Š, æµè§ˆå™¨ä¸ä¼šæ‹¦æˆªä¸åˆæ³•çš„è·¨åŸŸè¯·æ±‚, è€Œæ˜¯æ‹¦æˆªäº†ä»–ä»¬çš„å“åº”, å› æ­¤å³ä½¿è¯·æ±‚ä¸åˆæ³•, å¾ˆå¤šæ—¶å€™, æœåŠ¡å™¨ä¾ç„¶æ”¶åˆ°äº†è¯·æ±‚.(Chromeå’ŒFirefoxä¸‹httpsç½‘ç«™ä¸å…è®¸å‘é€httpå¼‚æ­¥è¯·æ±‚é™¤å¤–)</p>
<p>é€šå¸¸, ä¸€æ¬¡è·¨åŸŸè®¿é—®æ‹¥æœ‰å¦‚ä¸‹æµç¨‹:</p>
<p><img src="http://louiszhai.github.io/docImages/cross-domain02.jpg" alt=""></p>
<h4 id="ç§»åŠ¨ç«¯CORSå…¼å®¹æ€§"><a href="#ç§»åŠ¨ç«¯CORSå…¼å®¹æ€§" class="headerlink" title="ç§»åŠ¨ç«¯CORSå…¼å®¹æ€§"></a>ç§»åŠ¨ç«¯CORSå…¼å®¹æ€§</h4><p>å½“å‰å‡ ä¹æ‰€æœ‰çš„æ¡Œé¢æµè§ˆå™¨(Internet Explorer 8+, Firefox 3.5+, Safari 4+å’Œ Chrome 3+)éƒ½å¯é€šè¿‡åä¸ºè·¨åŸŸèµ„æºå…±äº«çš„åè®®æ”¯æŒajaxè·¨åŸŸè°ƒç”¨.</p>
<p>é‚£ä¹ˆç§»åŠ¨ç«¯å…¼å®¹æ€§åˆå¦‚ä½•å‘¢? è¯·çœ‹ä¸‹å›¾:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax25.png" alt="cors-mobile"></p>
<p>å¯è§, CORSçš„æŠ€æœ¯åœ¨IOS Safari7.1åŠAndroid webview2.3ä¸­å°±æ—©å·²æ”¯æŒ, å³ä½¿ä½ç‰ˆæœ¬ä¸‹webviewçš„canvasåœ¨ä½¿ç”¨è·¨åŸŸçš„videoæˆ–å›¾ç‰‡æ—¶ä¼šæœ‰é—®é¢˜, ä¹Ÿä¸æ¯«ä¸å½±å“CORSçš„åœ¨ç§»åŠ¨ç«¯çš„ä½¿ç”¨. è‡³æ­¤, æˆ‘ä»¬å°±å¯ä»¥æ”¾å¿ƒå¤§èƒ†çš„å»åº”ç”¨CORSäº†.</p>
<h4 id="CORSæœ‰å…³çš„headers"><a href="#CORSæœ‰å…³çš„headers" class="headerlink" title="CORSæœ‰å…³çš„headers"></a>CORSæœ‰å…³çš„headers</h4><p>1) HTTP Response Header(æœåŠ¡å™¨æä¾›):</p>
<ul>
<li><p>Access-Control-Allow-Origin: æŒ‡å®šå…è®¸å“ªäº›æºçš„ç½‘é¡µå‘é€è¯·æ±‚.</p>
</li>
<li><p>Access-Control-Allow-Credentials: æŒ‡å®šæ˜¯å¦å…è®¸cookieå‘é€.</p>
</li>
<li><p>Access-Control-Allow-Methods: æŒ‡å®šå…è®¸å“ªäº›è¯·æ±‚æ–¹æ³•.</p>
</li>
<li><p>Access-Control-Allow-Headers: æŒ‡å®šå…è®¸å“ªäº›å¸¸è§„çš„å¤´åŸŸå­—æ®µ, æ¯”å¦‚è¯´ Content-Type.</p>
</li>
<li><p>Access-Control-Expose-Headers: æŒ‡å®šå…è®¸å“ªäº›é¢å¤–çš„å¤´åŸŸå­—æ®µ, æ¯”å¦‚è¯´ X-Custom-Header.</p>
<p>è¯¥å­—æ®µå¯çœç•¥. CORSè¯·æ±‚æ—¶, xhr.getResponseHeader() æ–¹æ³•é»˜è®¤åªèƒ½è·å–6ä¸ªåŸºæœ¬å­—æ®µ: <code>Cache-Control</code>ã€<code>Content-Language</code>ã€<code>Content-Type</code>ã€<code>Expires</code>ã€<code>Last-Modified</code>ã€<code>Pragma</code> . å¦‚æœéœ€è¦è·å–å…¶ä»–å­—æ®µ, å°±éœ€è¦åœ¨Access-Control-Expose-Headers ä¸­æŒ‡å®š. å¦‚ä¸Š, è¿™æ ·xhr.getResponseHeader(â€˜X-Custom-Headerâ€™) æ‰èƒ½è¿”å›X-Custom-Headerå­—æ®µçš„å€¼.(è¯¥éƒ¨åˆ†æ‘˜è‡ªé˜®ä¸€å³°è€å¸ˆåšå®¢)</p>
</li>
<li><p>Access-Control-Max-Age: æŒ‡å®špreflight OPTIONSè¯·æ±‚çš„æœ‰æ•ˆæœŸ, å•ä½ä¸ºç§’.</p>
</li>
</ul>
<p>2) HTTP Request Header(æµè§ˆå™¨OPTIONSè¯·æ±‚é»˜è®¤è‡ªå¸¦):</p>
<ul>
<li>Access-Control-Request-Method: å‘ŠçŸ¥æœåŠ¡å™¨,æµè§ˆå™¨å°†å‘é€å“ªç§è¯·æ±‚, æ¯”å¦‚è¯´POST.</li>
<li>Access-Control-Request-Headers: å‘ŠçŸ¥æœåŠ¡å™¨, æµè§ˆå™¨å°†åŒ…å«å“ªäº›é¢å¤–çš„å¤´åŸŸå­—æ®µ.</li>
</ul>
<p>3) ä»¥ä¸‹æ‰€æœ‰çš„header name æ˜¯è¢«æ‹’ç»çš„:</p>
<ul>
<li>Accept-Charset</li>
<li>Accept-Encoding</li>
<li>Access-Control-Request-Headers</li>
<li>Access-Control-Request-Method</li>
<li>Connection</li>
<li>Content-Length</li>
<li>Cookie</li>
<li>Cookie2</li>
<li>Date</li>
<li>DNT</li>
<li>Expect</li>
<li>Host</li>
<li>Keep-Alive</li>
<li>Origin</li>
<li>Referer</li>
<li>TE</li>
<li>Trailer</li>
<li>Transfer-Encoding</li>
<li>Upgrade</li>
<li>Via</li>
<li>åŒ…å«ä»¥<code>Proxy-</code> æˆ– <code>Sec-</code> å¼€å¤´çš„header name</li>
</ul>
<h4 id="CORSè¯·æ±‚"><a href="#CORSè¯·æ±‚" class="headerlink" title="CORSè¯·æ±‚"></a>CORSè¯·æ±‚</h4><p>CORSè¯·æ±‚åˆ†ä¸ºä¸¤ç§, â‘  ç®€å•è¯·æ±‚; â‘¡ éç®€å•è¯·æ±‚.</p>
<p>æ»¡è¶³å¦‚ä¸‹ä¸¤ä¸ªæ¡ä»¶ä¾¿æ˜¯ç®€å•è¯·æ±‚, åä¹‹åˆ™ä¸ºéç®€å•è¯·æ±‚.(CORSè¯·æ±‚éƒ¨åˆ†æ‘˜è‡ªé˜®ä¸€å³°è€å¸ˆåšå®¢)</p>
<p>1) è¯·æ±‚æ˜¯ä»¥ä¸‹ä¸‰ç§ä¹‹ä¸€:</p>
<ul>
<li>HEAD</li>
<li>GET</li>
<li>POST</li>
</ul>
<p>2) httpå¤´åŸŸä¸è¶…å‡ºä»¥ä¸‹å‡ ç§å­—æ®µ:</p>
<ul>
<li>Accept</li>
<li>Accept-Language</li>
<li>Content-Language</li>
<li>Last-Event-ID</li>
<li>Content-Typeå­—æ®µé™ä¸‰ä¸ªå€¼ <code>application/x-www-form-urlencoded</code>ã€<code>multipart/form-data</code>ã€<code>text/plain</code></li>
</ul>
<p>å¯¹äºç®€å•è¯·æ±‚, æµè§ˆå™¨å°†å‘é€ä¸€æ¬¡httpè¯·æ±‚, åŒæ—¶åœ¨Requestå¤´åŸŸä¸­å¢åŠ  <code>Origin</code> å­—æ®µ, ç”¨æ¥æ ‡ç¤ºè¯·æ±‚å‘èµ·çš„æº, æœåŠ¡å™¨æ ¹æ®è¿™ä¸ªæºé‡‡å–ä¸åŒçš„å“åº”ç­–ç•¥. è‹¥æœåŠ¡å™¨è®¤ä¸ºè¯¥è¯·æ±‚åˆæ³•, é‚£ä¹ˆéœ€è¦å¾€è¿”å›çš„ HTTP Response ä¸­æ·»åŠ  <code>Access-Control-*</code> ç­‰å­—æ®µ.( <code>Access-Control-*</code> ç›¸å…³å­—æ®µè§£æè¯·é˜…è¯»æˆ‘ä¹‹å‰å†™çš„<a href="http://louiszhai.github.io/2016/01/11/cross-domain/#CORS__u8DE8_u57DF_u8BBF_u95EE]">CORS è·¨åŸŸè®¿é—®</a> )</p>
<p>å¯¹äºéç®€å•è¯·æ±‚, æ¯”å¦‚Methodä¸º<code>POST</code>ä¸”Content-Typeå€¼ä¸º <code>application/json</code> çš„è¯·æ±‚æˆ–è€…Methodä¸º <code>PUT</code> æˆ– <code>DELETE</code> çš„è¯·æ±‚, æµè§ˆå™¨å°†å‘é€ä¸¤æ¬¡httpè¯·æ±‚. ç¬¬ä¸€æ¬¡ä¸ºpreflighté¢„æ£€(Method: OPTIONS),ä¸»è¦éªŒè¯æ¥æºæ˜¯å¦åˆæ³•. å€¼å¾—æ³¨æ„çš„æ˜¯:OPTIONè¯·æ±‚å“åº”å¤´åŒæ ·éœ€è¦åŒ…å« <code>Access-Control-*</code> å­—æ®µç­‰. ç¬¬äºŒæ¬¡æ‰æ˜¯çœŸæ­£çš„HTTPè¯·æ±‚. æ‰€ä»¥æœåŠ¡å™¨å¿…é¡»å¤„ç†OPTIONSåº”ç­”(é€šå¸¸éœ€è¦è¿”å›20Xçš„çŠ¶æ€ç , å¦åˆ™xhr.onerroräº‹ä»¶å°†è¢«è§¦å‘).</p>
<p>ä»¥ä¸Šè¯·æ±‚æµç¨‹å›¾ä¸º:</p>
<p><img src="http://louiszhai.github.io/docImages/cross-domain01.jpg" alt=""></p>
<h4 id="HTMLå¯ç”¨CORS"><a href="#HTMLå¯ç”¨CORS" class="headerlink" title="HTMLå¯ç”¨CORS"></a>HTMLå¯ç”¨CORS</h4><p>http-equiv ç›¸å½“äºhttpçš„å“åº”å¤´, å®ƒå›åº”ç»™æµè§ˆå™¨ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯,ä»¥å¸®åŠ©æ­£ç¡®å’Œç²¾ç¡®åœ°æ˜¾ç¤ºç½‘é¡µå†…å®¹. å¦‚ä¸‹htmlå°†å…è®¸ä»»æ„åŸŸåä¸‹çš„ç½‘é¡µè·¨åŸŸè®¿é—®.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Access-Control-Allow-Origin"</span> <span class="attr">content</span>=<span class="string">"*"</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="å›¾ç‰‡å¯ç”¨CORS"><a href="#å›¾ç‰‡å¯ç”¨CORS" class="headerlink" title="å›¾ç‰‡å¯ç”¨CORS"></a>å›¾ç‰‡å¯ç”¨CORS</h4><p>é€šå¸¸, å›¾ç‰‡å…è®¸è·¨åŸŸè®¿é—®, ä¹Ÿå¯ä»¥åœ¨canvasä¸­ä½¿ç”¨è·¨åŸŸçš„å›¾ç‰‡, ä½†è¿™æ ·åšä¼šæ±¡æŸ“ç”»å¸ƒ, ä¸€æ—¦ç”»å¸ƒå—æ±¡æŸ“, å°†æ— æ³•è¯»å–å…¶æ•°æ®. æ¯”å¦‚æ— æ³•è°ƒç”¨ toBlob(), toDataURL() æˆ– getImageData()æ–¹æ³•. æµè§ˆå™¨çš„è¿™ç§å®‰å…¨æœºåˆ¶è§„é¿äº†æœªç»è®¸å¯çš„è¿œç¨‹æœåŠ¡å™¨å›¾ç‰‡è¢«æ»¥ç”¨çš„é£é™©.(è¯¥éƒ¨åˆ†å†…å®¹æ‘˜è‡ª <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/CORS_enabled_image" target="_blank" rel="external">å¯ç”¨äº† CORS çš„å›¾ç‰‡ - HTMLï¼ˆè¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼‰ | MDN</a>)</p>
<p>å› æ­¤å¦‚éœ€åœ¨canvasä¸­ä½¿ç”¨è·¨åŸŸçš„å›¾ç‰‡èµ„æº, è¯·å‚è€ƒå¦‚ä¸‹apacheé…ç½®ç‰‡æ®µ(æ¥è‡ª<a href="https://github.com/h5bp/server-configs-apache/blob/fc379c45f52a09dd41279dbf4e60ae281110a5b0/src/.htaccess#L36-L53" target="_blank" rel="external">HTML5 Boilerplate Apache server configs</a>).</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="section">&lt;IfModule mod_setenvif.c&gt;</span></div><div class="line">    <span class="section">&lt;IfModule mod_headers.c&gt;</span></div><div class="line">        <span class="section">&lt;FilesMatch "\.(cur|gif|ico|jpe?g|png|svgz?|webp)$"&gt;</span></div><div class="line">            <span class="attribute">SetEnvIf</span> Origin <span class="string">":"</span> IS_CORS</div><div class="line">            <span class="attribute"><span class="nomarkup">Header</span></span> set Access-Control-Allow-Origin <span class="string">"*"</span> env=IS_CORS</div><div class="line">        <span class="section">&lt;/FilesMatch&gt;</span></div><div class="line">    <span class="section">&lt;/IfModule&gt;</span></div><div class="line"><span class="section">&lt;/IfModule&gt;</span></div></pre></td></tr></table></figure>
<h3 id="ajaxæ–‡ä»¶ä¸Šä¼ "><a href="#ajaxæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="ajaxæ–‡ä»¶ä¸Šä¼ "></a>ajaxæ–‡ä»¶ä¸Šä¼ </h3><p>ajaxå®ç°æ–‡ä»¶ä¸Šä¼ éå¸¸ç®€å•, è¿™é‡Œæˆ‘é€‰å–åŸç”Ÿjs, jq, angular åˆ†åˆ«æ¥æ¯”è¾ƒä¸‹, å¹¶é¡ºä¾¿èŠèŠä½¿ç”¨å®ƒä»¬æ—¶çš„æ³¨æ„äº‹é¡¹.(ajaxæ–‡ä»¶ä¸Šä¼ çš„ä»£ç å·²ä¸Šä¼ è‡³github, è¯·æˆ³è¿™é‡Œé¢„è§ˆæ•ˆæœ: <a href="http://louiszhai.github.io/res/ajaxUpload.html">ajax æ–‡ä»¶ä¸Šä¼  demo | louis</a>)</p>
<p>1) ä¸ºäº†ä¸Šä¼ æ–‡ä»¶, æˆ‘ä»¬å¾—å…ˆé€‰ä¸­ä¸€ä¸ªæ–‡ä»¶. ä¸€ä¸ªtypeä¸ºfileçš„inputæ¡†å°±å¤Ÿäº†.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"input"</span> <span class="attr">type</span>=<span class="string">"file"</span>&gt;</span></div></pre></td></tr></table></figure>
<p>2) ç„¶åç”¨FormDataå¯¹è±¡åŒ…è£¹ğŸ“¦é€‰ä¸­çš„æ–‡ä»¶.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> input = <span class="built_in">document</span>.getElementById(<span class="string">"input"</span>),</div><div class="line">    formData = <span class="keyword">new</span> FormData();</div><div class="line">formData.append(<span class="string">"file"</span>,input.files[<span class="number">0</span>]);<span class="comment">//keyå¯ä»¥éšæ„å®šä¹‰,åªè¦åå°èƒ½ç†è§£å°±è¡Œ</span></div></pre></td></tr></table></figure>
<p>3) å®šä¹‰ä¸Šä¼ çš„URL, ä»¥åŠæ–¹æ³•. githubä¸Šæˆ‘æ­å»ºäº†ä¸€ä¸ª <a href="https://github.com/Louiszhai/node-webserver" target="_blank" rel="external">node-webserver</a>, æ ¹æ®éœ€è¦å¯ä»¥è‡ªè¡Œå…‹éš†ä¸‹æ¥npm startåä¾¿å¯è°ƒè¯•æœ¬ç¯‡ä»£ç .</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> url = <span class="string">"http://localhost:10108/test"</span>,</div><div class="line">    method = <span class="string">"POST"</span>;</div></pre></td></tr></table></figure>
<h4 id="jsæ–‡ä»¶ä¸Šä¼ "><a href="#jsæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="jsæ–‡ä»¶ä¸Šä¼ "></a>jsæ–‡ä»¶ä¸Šä¼ </h4><p>4.1) å°è£…ä¸€ä¸ªç”¨äºå‘é€ajaxè¯·æ±‚çš„æ–¹æ³•.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">url, method, data</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> xhr = <span class="literal">null</span>;</div><div class="line">  <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest) &#123;</div><div class="line">    xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.ActiveXObject) &#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"Msxml2.XMLHTTP"</span>);</div><div class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">      <span class="keyword">try</span> &#123;</div><div class="line">        xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);</div><div class="line">      &#125; <span class="keyword">catch</span> (e) &#123; </div><div class="line">        alert(<span class="string">"æ‚¨çš„æµè§ˆå™¨æš‚ä¸æ”¯æŒAjax!"</span>);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  xhr.onerror = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(e);</div><div class="line">  &#125;</div><div class="line">  xhr.open(method, url);</div><div class="line">  <span class="keyword">try</span>&#123;</div><div class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      xhr.send(data);</div><div class="line">    &#125;);</div><div class="line">  &#125;<span class="keyword">catch</span>(e)&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'error:'</span>,e);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> xhr;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>4.2) ä¸Šä¼ æ–‡ä»¶å¹¶ç»‘å®šäº‹ä»¶.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xhr = ajax(url, method, formData);</div><div class="line">xhr.upload.onprogress = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"upload progress:"</span>, e.loaded/e.total*<span class="number">100</span> + <span class="string">"%"</span>);</div><div class="line">&#125;;</div><div class="line">xhr.upload.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"upload onload."</span>);</div><div class="line">&#125;;</div><div class="line">xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"onload."</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šä¼ ç»“æœå¦‚ä¸‹æ‰€ç¤º:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax17.png" alt="js file upload"></p>
<h4 id="fetchä¸Šä¼ "><a href="#fetchä¸Šä¼ " class="headerlink" title="fetchä¸Šä¼ "></a>fetchä¸Šä¼ </h4><p>5) fetchåªè¦å‘é€ä¸€ä¸ªpostè¯·æ±‚, å¹¶ä¸”bodyå±æ€§è®¾ç½®ä¸ºformDataå³å¯. é—æ†¾çš„æ˜¯, fetchæ— æ³•è·Ÿè¸ªä¸Šä¼ çš„è¿›åº¦ä¿¡æ¯.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">fetch(url, &#123;</div><div class="line">  <span class="attr">method</span>: method,</div><div class="line">  <span class="attr">body</span>: formData</div><div class="line">  &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(res);</div><div class="line">  &#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(e);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="jqueryæ–‡ä»¶ä¸Šä¼ "><a href="#jqueryæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="jqueryæ–‡ä»¶ä¸Šä¼ "></a>jqueryæ–‡ä»¶ä¸Šä¼ </h4><p>jqæä¾›äº†å„å¼å„æ ·çš„ä¸Šä¼ æ’ä»¶, å…¶åŸç†éƒ½æ˜¯åˆ©ç”¨jqè‡ªèº«çš„ajaxæ–¹æ³•.</p>
<p>6) jqçš„ajaxæä¾›äº†xhrå±æ€§ç”¨äºè‡ªå®šä¹‰å„ç§äº‹ä»¶.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">$.ajax(&#123;</div><div class="line">  <span class="attr">type</span>: method,</div><div class="line">  <span class="attr">url</span>: url,</div><div class="line">  <span class="attr">data</span>: formData,</div><div class="line">  <span class="attr">processData</span> : <span class="literal">false</span>,</div><div class="line">  <span class="attr">contentType</span> : <span class="literal">false</span> ,<span class="comment">//å¿…é¡»falseæ‰ä¼šè‡ªåŠ¨åŠ ä¸Šæ­£ç¡®çš„Content-Type</span></div><div class="line">  xhr: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> xhr = $.ajaxSettings.xhr();<span class="comment">//å®é™…ä¸Šå°±æ˜¯return new window.XMLHttpRequest()å¯¹è±¡</span></div><div class="line">    <span class="keyword">if</span>(xhr.upload) &#123;</div><div class="line">      xhr.upload.addEventListener(<span class="string">"progress"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"jq upload progress:"</span>, e.loaded/e.total*<span class="number">100</span> + <span class="string">"%"</span>);</div><div class="line">      &#125;, <span class="literal">false</span>);</div><div class="line">      xhr.upload.addEventListener(<span class="string">"load"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"jq upload onload."</span>);</div><div class="line">      &#125;);</div><div class="line">      xhr.addEventListener(<span class="string">"load"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"jq onload."</span>);</div><div class="line">      &#125;);</div><div class="line">      <span class="keyword">return</span> xhr;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>jqä¸Šä¼ ç»“æœå¦‚ä¸‹æ‰€ç¤º:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax18.png" alt="jq file upload"></p>
<p>æœ‰å…³jq ajaxæ›´å¤šçš„api, è¯·å‚è€ƒä¸­æ–‡æ–‡æ¡£ <a href="http://www.jquery123.com/jQuery.ajax/" target="_blank" rel="external">jQuery.ajax() | jQuery API ä¸­æ–‡æ–‡æ¡£</a> .</p>
<h4 id="angularæ–‡ä»¶ä¸Šä¼ "><a href="#angularæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="angularæ–‡ä»¶ä¸Šä¼ "></a>angularæ–‡ä»¶ä¸Šä¼ </h4><p>7.1) angularæä¾›äº†$httpæ–¹æ³•ç”¨äºå‘é€httpè¯·æ±‚, è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªpromiseå¯¹è±¡.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$http(&#123;</div><div class="line">  <span class="attr">method</span>: method,</div><div class="line">  <span class="attr">url</span>: url,</div><div class="line">  <span class="attr">data</span>: formData,</div><div class="line">&#125;).success(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(res);</div><div class="line">&#125;).error(<span class="function"><span class="keyword">function</span>(<span class="params">err, status</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(err);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>angularæ–‡ä»¶ä¸Šä¼ çš„ä»£ç å·²ä¸Šä¼ è‡³github, è¯·æˆ³è¿™é‡Œé¢„è§ˆæ•ˆæœ: <a href="http://louiszhai.github.io/res/angularUpload.html">angular æ–‡ä»¶ä¸Šä¼  demo | louis</a>.</p>
<p>ä½ç‰ˆæœ¬angularä¸­æ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½å¹¶ä¸å®Œæ•´,  ç›´åˆ°angular1.5.5æ‰åœ¨$httpä¸­åŠ å…¥äº†eventHandlerå’ŒuploadEventHandlersç­‰æ–¹æ³•, ä½¿å¾—å®ƒæ”¯æŒä¸Šä¼ è¿›åº¦ä¿¡æ¯. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">$http(&#123;</div><div class="line">  <span class="attr">method</span>: method,</div><div class="line">  <span class="attr">url</span>: url,</div><div class="line">  <span class="attr">eventHandlers</span>: &#123;</div><div class="line">    <span class="attr">progress</span>: <span class="function"><span class="keyword">function</span>(<span class="params">c</span>) </span>&#123;<span class="comment">//ä¸‹è½½è¿›åº¦</span></div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'Progress -&gt; '</span> + c);</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">uploadEventHandlers</span>: &#123;</div><div class="line">    <span class="attr">progress</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;<span class="comment">//ä¸Šä¼ è¿›åº¦</span></div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'UploadProgress -&gt; '</span> + e);</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">data</span>: formData,</div><div class="line">&#125;).success(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(res);</div><div class="line">&#125;).error(<span class="function"><span class="keyword">function</span>(<span class="params">err, status</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(err);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>angular1.5.5ä»¥ä¸‹ä½ç‰ˆæœ¬ä¸­, è¯·å‚è€ƒæˆç†Ÿçš„å®ç°æ–¹æ¡ˆ <a href="https://github.com/nervgh/angular-file-upload" target="_blank" rel="external">angular-file-upload</a> ä»¥åŠå®ƒæä¾›çš„demo <a href="http://nervgh.github.io/pages/angular-file-upload/examples/simple/" target="_blank" rel="external">Simple example</a> .</p>
<h3 id="ajaxè¯·æ±‚äºŒè¿›åˆ¶æ–‡ä»¶"><a href="#ajaxè¯·æ±‚äºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="ajaxè¯·æ±‚äºŒè¿›åˆ¶æ–‡ä»¶"></a>ajaxè¯·æ±‚äºŒè¿›åˆ¶æ–‡ä»¶</h3><h4 id="FileReader"><a href="#FileReader" class="headerlink" title="FileReader"></a>FileReader</h4><p>å¤„ç†äºŒè¿›åˆ¶æ–‡ä»¶ä¸»è¦ä½¿ç”¨çš„æ˜¯H5çš„FileReader.</p>
<p>PCæ”¯æŒæ€§å¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th style="text-align:center">IE</th>
<th style="text-align:center">Edge</th>
<th style="text-align:center">Firefox</th>
<th style="text-align:center">Chrome</th>
<th style="text-align:center">Safari</th>
<th style="text-align:center">Opera</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">12</td>
<td style="text-align:center">3.6</td>
<td style="text-align:center">6</td>
<td style="text-align:center">6</td>
<td style="text-align:center">11.5</td>
</tr>
</tbody>
</table>
<p>Mobileæ”¯æŒæ€§å¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th style="text-align:center">IOS Safari</th>
<th style="text-align:center">Opera Mini</th>
<th style="text-align:center">Android Browser</th>
<th style="text-align:center">Chrome/Android</th>
<th style="text-align:center">UC/Android</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">7.1</td>
<td style="text-align:center">-</td>
<td style="text-align:center">4</td>
<td style="text-align:center">53</td>
<td style="text-align:center">11</td>
</tr>
</tbody>
</table>
<p>ä»¥ä¸‹æ˜¯å…¶API:</p>
<table>
<thead>
<tr>
<th style="text-align:center">å±æ€§/æ–¹æ³•åç§°</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong><em>error</em></strong></td>
<td style="text-align:left">è¡¨ç¤ºè¯»å–æ–‡ä»¶æœŸé—´å‘ç”Ÿçš„é”™è¯¯.</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>readyState</em></strong></td>
<td style="text-align:left">è¡¨ç¤ºè¯»å–æ–‡ä»¶çš„çŠ¶æ€.é»˜è®¤æœ‰ä¸‰ä¸ªå€¼:0è¡¨ç¤ºæ–‡ä»¶è¿˜æ²¡æœ‰åŠ è½½;1è¡¨ç¤ºæ–‡ä»¶æ­£åœ¨è¯»å–;2è¡¨ç¤ºæ–‡ä»¶è¯»å–å®Œæˆ.</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>result</em></strong></td>
<td style="text-align:left">è¯»å–çš„æ–‡ä»¶å†…å®¹.</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>abort()</em></strong></td>
<td style="text-align:left">å–æ¶ˆæ–‡ä»¶è¯»å–æ“ä½œ, æ­¤æ—¶<code>readyState</code>å±æ€§å°†ç½®ä¸º2.</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>readAsArrayBuffer()</em></strong></td>
<td style="text-align:left">è¯»å–æ–‡ä»¶(æˆ–blobå¯¹è±¡)ä¸ºç±»å‹åŒ–æ•°ç»„(<a href="http://blog.csdn.net/lichwei1983/article/details/43893025" target="_blank" rel="external">ArrayBuffer</a>),  ç±»å‹åŒ–æ•°ç»„å…è®¸å¼€å‘è€…ä»¥æ•°ç»„ä¸‹æ ‡çš„æ–¹å¼, ç›´æ¥æ“ä½œå†…å­˜, ç”±äºæ•°æ®ä»¥äºŒè¿›åˆ¶å½¢å¼ä¼ é€’, æ•ˆç‡éå¸¸é«˜.</td>
</tr>
<tr>
<td style="text-align:center"><em><del>readAsBinaryString()</del></em></td>
<td style="text-align:left">è¯»å–æ–‡ä»¶(æˆ–blobå¯¹è±¡)ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸², è¯¥æ–¹æ³•å·²ç§»å‡ºæ ‡å‡†api, è¯·è°¨æ…ä½¿ç”¨.</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>readAsDataURL()</em></strong></td>
<td style="text-align:left">è¯»å–æ–‡ä»¶(æˆ–blobå¯¹è±¡)ä¸ºbase64ç¼–ç çš„URLå­—ç¬¦ä¸², ä¸window.URL.createObjectURLæ–¹æ³•æ•ˆæœç±»ä¼¼.</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>readAsText()</em></strong></td>
<td style="text-align:left">è¯»å–æ–‡ä»¶(æˆ–blobå¯¹è±¡)ä¸ºæ–‡æœ¬å­—ç¬¦ä¸².</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>onload()</em></strong></td>
<td style="text-align:left">æ–‡ä»¶è¯»å–å®Œæˆæ—¶çš„äº‹ä»¶å›è°ƒ, é»˜è®¤ä¼ å…¥eventäº‹ä»¶å¯¹è±¡. è¯¥å›è°ƒå†…, å¯é€šè¿‡this.result æˆ– event.target.resultè·å–è¯»å–çš„æ–‡ä»¶å†…å®¹.</td>
</tr>
</tbody>
</table>
<h4 id="ajaxè¯·æ±‚äºŒè¿›åˆ¶å›¾ç‰‡å¹¶é¢„è§ˆ"><a href="#ajaxè¯·æ±‚äºŒè¿›åˆ¶å›¾ç‰‡å¹¶é¢„è§ˆ" class="headerlink" title="ajaxè¯·æ±‚äºŒè¿›åˆ¶å›¾ç‰‡å¹¶é¢„è§ˆ"></a>ajaxè¯·æ±‚äºŒè¿›åˆ¶å›¾ç‰‡å¹¶é¢„è§ˆ</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest(),</div><div class="line">    url = <span class="string">"http://louiszhai.github.io/docImages/ajax01.png"</span>;</div><div class="line">xhr.open(<span class="string">"GET"</span>, url);</div><div class="line">xhr.responseType = <span class="string">"blob"</span>;</div><div class="line">xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">this</span>.status == <span class="number">200</span>)&#123;</div><div class="line">    <span class="keyword">var</span> blob = <span class="keyword">this</span>.response;</div><div class="line">    <span class="keyword">var</span> img = <span class="built_in">document</span>.createElement(<span class="string">"img"</span>);</div><div class="line">    <span class="comment">//æ–¹æ¡ˆä¸€</span></div><div class="line">    img.src = <span class="built_in">window</span>.URL.createObjectURL(blob);<span class="comment">//è¿™é‡Œblobä¾ç„¶å æ®ç€å†…å­˜</span></div><div class="line">    img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="built_in">window</span>.URL.revokeObjectURL(img.src);<span class="comment">//é‡Šæ”¾å†…å­˜</span></div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//æ–¹æ¡ˆäºŒ</span></div><div class="line">    <span class="comment">/*var reader = new FileReader();</span></div><div class="line">    reader.readAsDataURL(blob);//FileReaderå°†è¿”å›base64ç¼–ç çš„data-uriå¯¹è±¡</div><div class="line">    reader.onload = function()&#123;</div><div class="line">      img.src = this.result;</div><div class="line">    &#125;*/</div><div class="line">    <span class="comment">//æ–¹æ¡ˆä¸‰</span></div><div class="line">    <span class="comment">//img.src = url;//æœ€ç®€å•æ–¹æ³•</span></div><div class="line">    <span class="built_in">document</span>.body.appendChild(img);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">xhr.send();</div></pre></td></tr></table></figure>
<h4 id="ajaxè¯·æ±‚äºŒè¿›åˆ¶æ–‡æœ¬å¹¶å±•ç¤º"><a href="#ajaxè¯·æ±‚äºŒè¿›åˆ¶æ–‡æœ¬å¹¶å±•ç¤º" class="headerlink" title="ajaxè¯·æ±‚äºŒè¿›åˆ¶æ–‡æœ¬å¹¶å±•ç¤º"></a>ajaxè¯·æ±‚äºŒè¿›åˆ¶æ–‡æœ¬å¹¶å±•ç¤º</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">xhr.open(<span class="string">"GET"</span>,<span class="string">"http://localhost:8080/Information/download.jsp?data=node-fetch.js"</span>);</div><div class="line">xhr.responseType = <span class="string">"blob"</span>;</div><div class="line">xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">this</span>.status == <span class="number">200</span>)&#123;</div><div class="line">    <span class="keyword">var</span> blob = <span class="keyword">this</span>.response;</div><div class="line">    <span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</div><div class="line">    reader.readAsBinaryString(blob);<span class="comment">//è¯¥æ–¹æ³•å·²è¢«ç§»å‡ºæ ‡å‡†api,å»ºè®®ä½¿ç”¨reader.readAsText(blob);</span></div><div class="line">    reader.onload=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="built_in">document</span>.body.innerHTML = <span class="string">"&lt;div&gt;"</span> + <span class="keyword">this</span>.result + <span class="string">"&lt;/div&gt;"</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">xhr.send();</div></pre></td></tr></table></figure>
<p>æœ‰å…³äºŒè¿›åˆ¶æ–‡ä»¶çš„è¯»å–, è¯·ç§»æ­¥è¿™ç¯‡åšå®¢ <a href="http://www.cnblogs.com/jscode/archive/2013/04/27/3572239.html" target="_blank" rel="external">HTML5æ–°ç‰¹æ€§ä¹‹æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ•°æ®çš„æ“ä½œ</a> .</p>
<h3 id="å¦‚ä½•ç­‰å¾…å¤šä¸ªajaxè¯·æ±‚å®Œæˆ"><a href="#å¦‚ä½•ç­‰å¾…å¤šä¸ªajaxè¯·æ±‚å®Œæˆ" class="headerlink" title="å¦‚ä½•ç­‰å¾…å¤šä¸ªajaxè¯·æ±‚å®Œæˆ"></a>å¦‚ä½•ç­‰å¾…å¤šä¸ªajaxè¯·æ±‚å®Œæˆ</h3><p>åŸç”Ÿjså¯ä»¥ä½¿ç”¨ES6æ–°å¢çš„Promise. ES6çš„PromiseåŸºäº <a href="https://promisesaplus.com/" target="_blank" rel="external">Promises/A+</a> è§„èŒƒ(è¯¥éƒ¨åˆ† <a href="http://louiszhai.github.io/2016/10/19/fetch/">Fetchå…¥é—¨æŒ‡å—</a> ä¸€æ–‡ä¹Ÿæœ‰æåŠ).</p>
<p>è¿™é‡Œå…ˆæä¾›ä¸€ä¸ªè§£æresponsesçš„å‡½æ•°.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">todo</span>(<span class="params">responses</span>)</span>&#123;</div><div class="line">  responses.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;</div><div class="line">    response.json().then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(res);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åŸç”Ÿjsä½¿ç”¨ <code>Promise.all</code> æ–¹æ³•. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p1 = fetch(<span class="string">"http://localhost:10108/test1"</span>),</div><div class="line">    p2 = fetch(<span class="string">"http://localhost:10108/test2"</span>);</div><div class="line"><span class="built_in">Promise</span>.all([p1, p2]).then(<span class="function"><span class="keyword">function</span>(<span class="params">responses</span>)</span>&#123;</div><div class="line">  todo(responses);</div><div class="line">  <span class="comment">//TODO do somethings</span></div><div class="line">&#125;);</div><div class="line"><span class="comment">//"test1"</span></div><div class="line"><span class="comment">//"test2"</span></div></pre></td></tr></table></figure>
<p>jqueryå¯ä»¥ä½¿ç”¨$.whenæ–¹æ³•. è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªDeferredå¯¹è±¡ä½œä¸ºå‚æ•°, åªæœ‰å…¨éƒ¨æˆåŠŸæ‰è°ƒç”¨resolvedçŠ¶æ€çš„å›è°ƒå‡½æ•°, ä½†åªè¦å…¶ä¸­æœ‰ä¸€ä¸ªå¤±è´¥ï¼Œå°±è°ƒç”¨rejectedçŠ¶æ€çš„å›è°ƒå‡½æ•°. å…¶å®, jqçš„Deferredæ˜¯åŸºäº Promises/Aè§„èŒƒå®ç°, ä½†å¹¶éå®Œå…¨éµå¾ª. (ä¼ é€é—¨: <a href="http://www.css88.com/archives/4750/comment-page-1" target="_blank" rel="external">jQuery ä¸­çš„ Deferred å’Œ Promises (2)</a> ).</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p1 = $.ajax(<span class="string">"http://localhost:10108/test1"</span>),</div><div class="line">    p2 = $.ajax(<span class="string">"http://localhost:10108/test2"</span>);</div><div class="line">$.when(p1, p2).then(<span class="function"><span class="keyword">function</span>(<span class="params">res1, res2</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(res1);<span class="comment">//["test1", "success", Object]</span></div><div class="line">  <span class="built_in">console</span>.log(res2);<span class="comment">//["test2", "success", Object]</span></div><div class="line">  <span class="comment">//TODO do somethings</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å¦‚ä¸Š, $.whené»˜è®¤è¿”å›ä¸€ä¸ªjqXHRå¯¹è±¡, å¯ä»¥ç›´æ¥è¿›è¡Œé“¾å¼è°ƒç”¨. thenæ–¹æ³•çš„å›è°ƒä¸­é»˜è®¤ä¼ å…¥ç›¸åº”çš„è¯·æ±‚ç»“æœ, æ¯ä¸ªè¯·æ±‚ç»“æœçš„éƒ½æ˜¯æ•°ç»„, æ•°ç»„ä¸­ä¾æ¬¡æ˜¯responseText, è¯·æ±‚çŠ¶æ€, è¯·æ±‚çš„jqXHRå¯¹è±¡.</p>
<p>angularä¸­å¯ä»¥å€ŸåŠ© <code>$q.all()</code> æ¥å®ç°. åˆ«å¿˜äº†, <code>$q</code> éœ€è¦åœ¨controllerä¸­æ³¨å…¥. æ­¤å¤–, <code>$q</code> ç›¸å…³è®²è§£å¯å‚è€ƒ <a href="https://code.angularjs.org/1.2.6/docs/api/ng.$q" target="_blank" rel="external">AngularJS: ng.$q</a> æˆ– <a href="https://segmentfault.com/a/1190000000402555" target="_blank" rel="external">Angular $q serviceå­¦ä¹ ç¬”è®°</a> .</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p1 = fetch(<span class="string">"http://localhost:10108/test1"</span>),</div><div class="line">    p2 = fetch(<span class="string">"http://localhost:10108/test2"</span>);</div><div class="line">$q.all([p1, p2]).then(<span class="function"><span class="keyword">function</span>(<span class="params">responses</span>)</span>&#123;</div><div class="line">  todo(responses);</div><div class="line">  <span class="comment">//TODO do somethings</span></div><div class="line">&#125;);</div><div class="line"><span class="comment">//"test1"</span></div><div class="line"><span class="comment">//"test2"</span></div></pre></td></tr></table></figure>
<p><code>$q.all()</code> å®é™…ä¸Šå°±æ˜¯å¯¹ <code>Promise.all</code> çš„å°è£….</p>
<h3 id="ajaxä¸historyçš„å…¼å®¹"><a href="#ajaxä¸historyçš„å…¼å®¹" class="headerlink" title="ajaxä¸historyçš„å…¼å®¹"></a>ajaxä¸historyçš„å…¼å®¹</h3><p>ajaxçš„ä¸€å¤§ç—›ç‚¹å°±æ˜¯æ— æ³•æ”¯æŒæµè§ˆå™¨å‰è¿›å’Œåé€€æ“ä½œ. å› æ­¤æ—©æœŸçš„Gmail é‡‡ç”¨ iframe, æ¥æ¨¡æ‹Ÿajaxçš„å‰è¿›å’Œåé€€.</p>
<p>å¦‚ä»Š, H5æ™®åŠ, pjaxå¤§è¡Œå…¶é“. pajax å°±æ˜¯ ajax+history.pushState ç»„åˆçš„ä¸€ç§æŠ€æœ¯. ä½¿ç”¨å®ƒä¾¿å¯ä»¥æ— åˆ·æ–°é€šè¿‡æµè§ˆå™¨å‰è¿›å’Œåé€€æ¥æ”¹å˜é¡µé¢å†…å®¹.</p>
<p>å…ˆçœ‹ä¸‹å…¼å®¹æ€§.</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">IE</th>
<th style="text-align:center">Edge</th>
<th style="text-align:center">Firefox</th>
<th style="text-align:center">Chrome</th>
<th style="text-align:center">Safari</th>
<th style="text-align:center">Opera</th>
<th style="text-align:center">iOS Safari</th>
<th style="text-align:center">Android Browser</th>
<th style="text-align:center">Chrome for Android</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">pushState/replaceState</td>
<td style="text-align:center">10</td>
<td style="text-align:center">12</td>
<td style="text-align:center">4</td>
<td style="text-align:center">5</td>
<td style="text-align:center">6</td>
<td style="text-align:center">11.5</td>
<td style="text-align:center">7.1</td>
<td style="text-align:center">4.3</td>
<td style="text-align:center">53</td>
</tr>
<tr>
<td style="text-align:center">history.state</td>
<td style="text-align:center">10</td>
<td style="text-align:center"></td>
<td style="text-align:center">4</td>
<td style="text-align:center">18</td>
<td style="text-align:center">6</td>
<td style="text-align:center">11.5</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>å¯è§IE8,9å¹¶ä¸èƒ½ä½¿ç”¨ H5çš„history. éœ€è¦ä½¿ç”¨å«ç‰‡ <a href="https://github.com/devote/HTML5-History-API" target="_blank" rel="external">HTML5 History API expansion for browsers not supporting pushState, replaceState</a> .</p>
<h4 id="pjax"><a href="#pjax" class="headerlink" title="pjax"></a>pjax</h4><p>pjaxç®€å•æ˜“ç”¨, ä»…éœ€è¦å¦‚ä¸‹ä¸‰ä¸ªapi:</p>
<ul>
<li>history.pushState(obj, title, url) è¡¨ç¤ºå¾€é¡µé¢historyæœ«å°¾æ–°å¢ä¸€ä¸ªå†å²é¡¹(history entry), æ­¤æ—¶history.lengthä¼š+1.</li>
<li>history.replaceState(obj, title, url) è¡¨ç¤ºæ›¿æ¢å½“å‰å†å²é¡¹ä¸ºæ–°çš„å†å²é¡¹. æ­¤æ—¶history.lengthä¿æŒä¸å˜.</li>
<li>window.onpopstate ä»…åœ¨æµè§ˆå™¨å‰è¿›å’Œåé€€æ—¶è§¦å‘(history.go(1), history.back() åŠlocation.href=â€xxxâ€ å‡ä¼šè§¦å‘), æ­¤æ—¶å¯åœ¨history.stateä¸­æ‹¿åˆ°åˆšåˆšå¡è¿›å»çš„state, å³objå¯¹è±¡(å…¶ä»–æ•°æ®ç±»å‹äº¦å¯).</li>
</ul>
<p>æˆ‘ä»¬æ³¨æ„åˆ°, é¦–æ¬¡è¿›å…¥ä¸€ä¸ªé¡µé¢, æ­¤æ—¶ <code>history.length</code> å€¼ä¸º1, <code>history.state</code> ä¸ºç©º. å¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax19.png" alt="history.state"></p>
<p>1) ä¸ºäº†åœ¨onpopstateäº‹ä»¶å›è°ƒä¸­æ¯æ¬¡éƒ½èƒ½æ‹¿åˆ° <code>history.state</code> , æ­¤æ—¶éœ€è¦åœ¨é¡µé¢è½½å…¥å®Œæˆå, è‡ªåŠ¨æ›¿æ¢ä¸‹å½“å‰url.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">history.replaceState(<span class="string">"init"</span>, title, <span class="string">"xxx.html?state=0"</span>);</div></pre></td></tr></table></figure>
<p>2) æ¯æ¬¡å‘é€ajaxè¯·æ±‚æ—¶, åœ¨è¯·æ±‚å®Œæˆå, è°ƒç”¨å¦‚ä¸‹, ä»è€Œå®ç°æµè§ˆå™¨historyå¾€å‰è¿›.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">history.pushState(<span class="string">"ajaxè¯·æ±‚ç›¸å…³å‚æ•°"</span>, title, <span class="string">"xxx.html?state=æ ‡è¯†ç¬¦"</span>);</div></pre></td></tr></table></figure>
<p>3) æµè§ˆå™¨å‰è¿›å’Œåé€€æ—¶, <code>popstate</code> äº‹ä»¶ä¼šè‡ªåŠ¨è§¦å‘, æ­¤æ—¶æˆ‘ä»¬æ‰‹åŠ¨å–å‡º <code>history.state</code> , æ„å»ºå‚æ•°å¹¶é‡æ–°å‘é€ajaxè¯·æ±‚æˆ–è€…ç›´æ¥å–ç”¨stateå€¼, ä»è€Œå®ç°æ— åˆ·æ–°è¿˜åŸé¡µé¢.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"popstate"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> currentState = history.state;</div><div class="line">	<span class="comment">//TODO æ‹¼æ¥ajaxè¯·æ±‚å‚æ•°å¹¶é‡æ–°å‘é€ajaxè¯·æ±‚, ä»è€Œå›åˆ°å†å²é¡µé¢</span></div><div class="line">  	<span class="comment">//TODO æˆ–è€…ä»stateä¸­æ‹¿åˆ°å…³é”®å€¼ç›´æ¥è¿˜åŸå†å²é¡µé¢</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p> <code>popstate</code> äº‹ä»¶è§¦å‘æ—¶, é»˜è®¤ä¼šä¼ å…¥ <code>PopStateEvent</code> äº‹ä»¶å¯¹è±¡. è¯¥å¯¹è±¡å…·æœ‰å¦‚ä¸‹å±æ€§.</p>
<p><img src="http://louiszhai.github.io/docImages/ajax20.png" alt="PopStateEvent"></p>
<p>å¦‚æœ‰ä¸æ‡‚, æ›´è¯¦ç»†è®²è§£è¯·ç§»æ­¥ : <a href="http://www.zhangxinxu.com/wordpress/2013/06/html5-history-api-pushstate-replacestate-ajax/" target="_blank" rel="external">ajaxä¸HTML5 history pushState/replaceStateå®ä¾‹ Â« å¼ é‘«æ—­-é‘«ç©ºé—´-é‘«ç”Ÿæ´»</a> .</p>
<h3 id="ajaxç¼“å­˜å¤„ç†"><a href="#ajaxç¼“å­˜å¤„ç†" class="headerlink" title="ajaxç¼“å­˜å¤„ç†"></a>ajaxç¼“å­˜å¤„ç†</h3><p>jsä¸­çš„httpç¼“å­˜æ²¡æœ‰å¼€å…³, å—åˆ¶äºæµè§ˆå™¨httpç¼“å­˜ç­–ç•¥. åŸç”Ÿxhrè¯·æ±‚ä¸­, å¯é€šè¿‡å¦‚ä¸‹è®¾ç½®å…³é—­ç¼“å­˜.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">xhr.setRequestHeader(<span class="string">"If-Modified-Since"</span>,<span class="string">"0"</span>);</div><div class="line">xhr.setRequestHeader(<span class="string">"Cache-Control"</span>,<span class="string">"no-cache"</span>);</div><div class="line"><span class="comment">//æˆ–è€… URL å‚æ•°ååŠ ä¸Š  "?timestamp=" + new Date().getTime()</span></div></pre></td></tr></table></figure>
<p>jqueryçš„httpç¼“å­˜æ˜¯å¦å¼€å¯å¯é€šè¿‡åœ¨settingsä¸­æŒ‡å®šcache.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$.ajax(&#123;</div><div class="line">  <span class="attr">url</span> : <span class="string">'url'</span>,</div><div class="line">  <span class="attr">dataType</span> : <span class="string">"xml"</span>,</div><div class="line">  <span class="attr">cache</span>: <span class="literal">true</span>,<span class="comment">//trueè¡¨ç¤ºç¼“å­˜å¼€å¯, falseè¡¨ç¤ºç¼“å­˜ä¸å¼€å¯</span></div><div class="line">  success : <span class="function"><span class="keyword">function</span>(<span class="params">xml, status</span>)</span>&#123;    </div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>åŒæ—¶jqueryè¿˜å¯ä»¥å…¨å±€è®¾ç½®æ˜¯å¦ç¼“å­˜. å¦‚ä¸‹å°†å…¨å±€å…³é—­ajaxç¼“å­˜.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$.ajaxSetup(&#123;<span class="attr">cache</span>:<span class="literal">false</span>&#125;);</div></pre></td></tr></table></figure>
<p>é™¤æ­¤ä¹‹å¤–, è°ƒè¯•è¿‡ç¨‹ä¸­å‡ºç°çš„æµè§ˆå™¨ç¼“å­˜å°¤ä¸ºå¯æ¶. å»ºè®®å¼€å¯éšç§æµè§ˆå™¨æˆ–è€…å‹¾é€‰â˜‘ï¸æ§åˆ¶å°çš„ <code>Disable cache</code> é€‰é¡¹. (è¿™é‡Œä»¥Chromeä¸¾ä¾‹, å…¶ä»–æµè§ˆå™¨ç±»ä¼¼)</p>
<p><img src="http://louiszhai.github.io/docImages/ajax21.png" alt="PopStateEvent"></p>
<h3 id="ajaxçš„é”™è¯¯å¤„ç†"><a href="#ajaxçš„é”™è¯¯å¤„ç†" class="headerlink" title="ajaxçš„é”™è¯¯å¤„ç†"></a>ajaxçš„é”™è¯¯å¤„ç†</h3><p>å‰é¢å·²ç»æè¿‡, é€šå¸¸åªè¦æ˜¯ajaxè¯·æ±‚æ”¶åˆ°äº†httpçŠ¶æ€ç , ä¾¿ä¸ä¼šè¿›å…¥åˆ°é”™è¯¯æ•è·é‡Œ.(Chromeä¸­407å“åº”å¤´é™¤å¤–)</p>
<p>å®é™…ä¸Š, <code>$.ajax</code> æ–¹æ³•ç•¥æœ‰åŒºåˆ«, jqueryçš„ajaxæ–¹æ³•è¿˜ä¼šåœ¨ç±»å‹è§£æå‡ºé”™æ—¶è§¦å‘errorå›è°ƒ. æœ€å¸¸è§çš„ä¾¿æ˜¯: dataTypeè®¾ç½®ä¸ºjson, ä½†æ˜¯è¿”å›çš„dataå¹¶éjsonæ ¼å¼, æ­¤æ—¶ <code>$.ajax</code> çš„errorå›è°ƒä¾¿ä¼šè§¦å‘.</p>
<h3 id="ajaxè°ƒè¯•æŠ€å·§"><a href="#ajaxè°ƒè¯•æŠ€å·§" class="headerlink" title="ajaxè°ƒè¯•æŠ€å·§"></a>ajaxè°ƒè¯•æŠ€å·§</h3><p>æœ‰å…³è°ƒè¯•, å¦‚æœæ¥å£åªæ˜¯åšå°éƒ¨åˆ†ä¿®æ”¹. é‚£ä¹ˆå¯ä»¥ä½¿ç”¨charles(Mac) æˆ–è€…fiddler(Windows), åšä»£ç†, å°†è¯·æ±‚çš„èµ„æºæ›¿æ¢ä¸ºæœ¬åœ°æ–‡ä»¶, æˆ–è€…ä½¿ç”¨å…¶æ–­ç‚¹åŠŸèƒ½, ç›´æ¥ç¼–è¾‘response.</p>
<p>å¦‚æœæ˜¯æ–°å¢æ¥å£çš„è°ƒè¯•, å¯ä»¥æœ¬åœ°æ­å»ºnodeæœåŠ¡. åˆ©ç”¨hostsæ–‡ä»¶é…ç½®dns + nginxå°†httpè¯·æ±‚è½¬å‘åˆ°æœ¬åœ°nodeæœåŠ¡å™¨. ç®€æ˜“çš„nodeè°ƒè¯•æœåŠ¡å™¨å¯å‚è€ƒæˆ‘çš„ <a href="https://github.com/Louiszhai/node-webserver" target="_blank" rel="external">node-webserver</a> . å¦‚ä¸‹ä¸¾ä¸€ä¸ªæ —å­ğŸŒ°:</p>
<h4 id="hosts-nginx-node-webserver"><a href="#hosts-nginx-node-webserver" class="headerlink" title="hosts+nginx+node-webserver"></a>hosts+nginx+node-webserver</h4><p>å‡è®¾æˆ‘ä»¬è¦è°ƒè¯•çš„æ˜¯ www.test.com çš„GETæ¥å£. ä»¥ä¸‹æ‰€æœ‰æ­¥éª¤ä»¥Macä¸ºä¾‹, å…¶ä»–ç³»ç»Ÿ, è¯·è‡ªè¡Œæœç´¢ğŸ”æ–‡ä»¶è·¯å¾„.</p>
<p>1) hostsé…ç½®.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/hosts</div><div class="line"><span class="comment">#æ–°å¢ä¸€è¡Œ 127.0.0.1 www.test.com</span></div></pre></td></tr></table></figure>
<p>2) nginx é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">brew install nginx <span class="comment">#å®‰è£…</span></div><div class="line"><span class="comment">#å®‰è£…æˆåŠŸåè¿›å…¥ç›®æ ‡ç›®å½•</span></div><div class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/etc/nginx/</div><div class="line"><span class="built_in">cd</span> servers <span class="comment">#é»˜è®¤é…ç½®å…¥å£ä¸ºnginx.conf.åŒæ—¶serversç›®å½•ä¸‹*.confæ–‡ä»¶å·²è‡ªåŠ¨åŠ å…¥åˆ°é…ç½®æ–‡ä»¶åˆ—è¡¨ä¸­</span></div><div class="line">vim test.conf</div><div class="line"><span class="comment">#ç²˜è´´å¦‚ä¸‹å†…å®¹</span></div><div class="line">server &#123;</div><div class="line">  listen       80;</div><div class="line">  server_name  www.test.com;</div><div class="line">  index index.html;</div><div class="line">  error_page   500 502 503 504  /50x.html;</div><div class="line">  location = /50x.html &#123;</div><div class="line">  	root   html;</div><div class="line">  &#125;</div><div class="line">  location / &#123;</div><div class="line">    proxy_pass http://localhost:10108/;</div><div class="line">    proxy_redirect off;</div><div class="line">    proxy_set_header Host <span class="variable">$host</span>;</div><div class="line">    proxy_set_header        X-Read-IP       <span class="variable">$remote_addr</span>;</div><div class="line">    proxy_set_header        X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">#:wqä¿å­˜å¹¶é€€å‡º</span></div><div class="line"><span class="comment">#å¯åŠ¨nginx</span></div><div class="line">sudo nginx <span class="_">-s</span> reload <span class="comment">#å¦‚æœå¯åŠ¨äº†åªéœ€é‡å¯å³å¯</span></div><div class="line">sudo nginx <span class="comment">#å¦‚æœæ²¡æœ‰å¯åŠ¨,ä¾¿å¯åŠ¨ä¹‹</span></div></pre></td></tr></table></figure>
<p>3) node-webServer é…ç½®</p>
<p>å‚è€ƒ <a href="https://github.com/Louiszhai/node-webserver" target="_blank" rel="external">node-webserver</a> . å¯åŠ¨æœåŠ¡å‰åªéœ€æ›´æ”¹index.js, åœ¨ç¬¬9è¡Œåæ’å…¥å¦‚ä¸‹å†…å®¹:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">'get': &#123;</div><div class="line">  '/': &#123;</div><div class="line">  	getKey : 'Welcome to Simple Node  WebServer!'</div><div class="line">  &#125;,</div><div class="line">  'æ¥å£api': 'ä½ çš„responseå†…å®¹'//æ’å…¥çš„ä»£ç                                </div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<p>å¦‚éœ€åœ¨nginxä¸­é…ç½®CORS, è¯·çœ‹è¿™é‡Œ: <a href="http://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;mid=2247484408&amp;idx=1&amp;sn=5c64dd43ff2060e1c4a22d93e4e887c9&amp;scene=1&amp;srcid=0901vPdwJR0crm8vJmjboYzI#rd" target="_blank" rel="external">Nginxé€šè¿‡CORSå®ç°è·¨åŸŸ</a>.</p>
<h4 id="ç¼–ç é—®é¢˜"><a href="#ç¼–ç é—®é¢˜" class="headerlink" title="ç¼–ç é—®é¢˜"></a>ç¼–ç é—®é¢˜</h4><p>XMLHttpRequest è¿”å›çš„æ•°æ®é»˜è®¤çš„å­—ç¬¦ç¼–ç æ˜¯utf-8, postæ–¹æ³•æäº¤æ•°æ®é»˜è®¤çš„å­—ç¬¦ç¼–ç ä¹Ÿæ˜¯utf-8. è‹¥é¡µé¢ç¼–ç ä¸ºgbkç­‰ä¸­æ–‡ç¼–ç , é‚£ä¹ˆå°±ä¼šäº§ç”Ÿä¹±ç .</p>
<h3 id="åç«¯æ¥å£æµ‹è¯•æŠ€å·§"><a href="#åç«¯æ¥å£æµ‹è¯•æŠ€å·§" class="headerlink" title="åç«¯æ¥å£æµ‹è¯•æŠ€å·§"></a>åç«¯æ¥å£æµ‹è¯•æŠ€å·§</h3><p>é€šå¸¸, å¦‚æœåç«¯æ¥å£å¼€å‘OKäº†, å‰ç«¯åŒå­¦éœ€è¦é€šè¿‡ä¸€äº›æ‰‹æ®µæ¥ç¡®è®¤æ¥å£æ˜¯èƒ½æ­£å¸¸è®¿é—®çš„.</p>
<h4 id="ä½¿ç”¨å‘½ä»¤æµ‹è¯•OPTIONSè¯·æ±‚"><a href="#ä½¿ç”¨å‘½ä»¤æµ‹è¯•OPTIONSè¯·æ±‚" class="headerlink" title="ä½¿ç”¨å‘½ä»¤æµ‹è¯•OPTIONSè¯·æ±‚"></a>ä½¿ç”¨å‘½ä»¤æµ‹è¯•OPTIONSè¯·æ±‚</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">curl -I -X OPTIONS -H <span class="string">"Origin: http://example.com"</span> http://localhost:10108/</div><div class="line"><span class="comment"># response</span></div><div class="line">HTTP/1.1 200 OK</div><div class="line">X-Powered-By: Express</div><div class="line">Content-Type: text/json;charset=UTF-8</div><div class="line">Access-Control-Allow-Credentials: <span class="literal">true</span></div><div class="line">Access-Control-Allow-Headers: x-requested-with,Content-Type</div><div class="line">Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS</div><div class="line">Access-Control-Allow-Origin: http://example.com</div><div class="line">Access-Control-Max-Age: 3600</div><div class="line">Server: Node WebServer</div><div class="line">Website: https://github.com/Louiszhai/node-webserver</div><div class="line">Date: Fri, 21 Oct 2016 09:00:40 GMT</div><div class="line">Connection: keep-alive</div><div class="line">Transfer-Encoding: chunked</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, httpçŠ¶æ€ç ä¸º200, è¡¨ç¤ºå…è®¸OPTIONSè¯·æ±‚.</p>
<p>GET, POST è¯·æ±‚ä¸GETç±»ä¼¼, å…¶ä»–è¯·æ±‚äº¦ç„¶.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">curl -I -X GET -H <span class="string">"Origin: http://example.com"</span> http://localhost:10108/</div><div class="line"><span class="comment">#HTTP/1.1 200 OK</span></div><div class="line">curl -I -X POST -H <span class="string">"Origin: http://example.com"</span> http://localhost:10108/<span class="built_in">test</span></div><div class="line"><span class="comment">#HTTP/1.1 200 OK</span></div></pre></td></tr></table></figure>
<h4 id="postman"><a href="#postman" class="headerlink" title="postman"></a>postman</h4><p>é™¤æ­¤ä¹‹å¤–, æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡chromeçš„postmanæ‰©å±•è¿›è¡Œæµ‹è¯•. è¯·çœ‹postmanç´ æ´çš„ç•Œé¢:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax26.png" alt=""></p>
<p>postmanæ”¯æŒæ‰€æœ‰ç±»å‹çš„httpè¯·æ±‚, ç”±äºå…¶å‘chromeç”³è¯·äº†cookieè®¿é—®æƒé™åŠæ‰€æœ‰http(s)ç½‘ç«™çš„è®¿é—®æƒé™. å› æ­¤å¯ä»¥æ”¾å¿ƒä½¿ç”¨å®ƒè¿›è¡Œå„ç§ç½‘ç«™apiçš„æµ‹è¯•.</p>
<p>åŒæ—¶, å¼ºçƒˆå»ºè®®é˜…è¯»æœ¬æ–‡çš„ä½ å‡çº§postmançš„ä½¿ç”¨æŠ€å·§, è¿™é‡Œæœ‰ç¯‡: <a href="https://segmentfault.com/a/1190000005055899" target="_blank" rel="external">åŸºäºPostmançš„APIè‡ªåŠ¨åŒ–æµ‹è¯•</a> , æ‹¿èµ°ä¸è°¢.</p>
<h3 id="ajaxç§»åŠ¨ç«¯å…¼å®¹æ€§"><a href="#ajaxç§»åŠ¨ç«¯å…¼å®¹æ€§" class="headerlink" title="ajaxç§»åŠ¨ç«¯å…¼å®¹æ€§"></a>ajaxç§»åŠ¨ç«¯å…¼å®¹æ€§</h3><p>ç§»åŠ¨ç«¯çš„æ”¯æŒæ€§æ¯”è¾ƒå¼±, ä½¿ç”¨éœ€è°¨æ…. çœ‹è¡¨.</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">IOS Safari</th>
<th style="text-align:center">Opera Mini</th>
<th style="text-align:center">Android Browser</th>
<th style="text-align:center">Android Chrome</th>
<th style="text-align:center">Android UC</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">XMLHttpRequest</td>
<td style="text-align:center">8.4</td>
<td style="text-align:center">-</td>
<td style="text-align:center">4.4.4</td>
<td style="text-align:center">53</td>
<td style="text-align:center">11(part)</td>
</tr>
<tr>
<td style="text-align:center">fetch</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">52</td>
<td style="text-align:center">53</td>
<td style="text-align:center">-</td>
</tr>
</tbody>
</table>
<p>æœ¬ç¯‡ä¸ºajaxè€Œç”Ÿ, é€šç¯‡ä»‹ç» XMLHTTPRequest ç›¸å…³çš„çŸ¥è¯†, åŠ›æ±‚ç®€æ˜, æœ¬æ¬²ä¸ºæ¢³ç†çŸ¥è¯†, ä¸ºè¯»è€…ç­”ç–‘è§£æƒ‘, ä½†å› æœ¬äººç†è§£æ‰€é™, éš¾å…æœ‰æ‰€å±€é™, å¸Œæœ›æ­£åœ¨é˜…è¯»çš„ä½ å–å…¶ç²¾åå»å…¶ç³Ÿç²•. è°¢è°¢.</p>
<hr>
<p>æœ¬æ–‡å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/11/02/ajax/">http://louiszhai.github.io/2016/11/02/ajax/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="https://xhr.spec.whatwg.org/" target="_blank" rel="external">XMLHttpRequest Standard</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2012/09/xmlhttprequest_level_2.html" target="_blank" rel="external">XMLHttpRequest Level 2 ä½¿ç”¨æŒ‡å— - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a></li>
<li><a href="https://segmentfault.com/a/1190000004322487" target="_blank" rel="external">ä½ çœŸçš„ä¼šä½¿ç”¨XMLHttpRequestå—ï¼Ÿ - WEBå‰ç«¯è·¯ä¸Šè¸©è¿‡çš„å‘å„¿ - SegmentFault</a></li>
<li><a href="http://www.zhangxinxu.com/wordpress/2013/06/html5-history-api-pushstate-replacestate-ajax/" target="_blank" rel="external">ajaxä¸HTML5 history pushState/replaceStateå®ä¾‹ Â« å¼ é‘«æ—­-é‘«ç©ºé—´-é‘«ç”Ÿæ´»</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="external">è·¨åŸŸèµ„æºå…±äº« CORS è¯¦è§£ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a></li>
<li><a href="http://www.jquery123.com/jQuery.ajax/" target="_blank" rel="external">jQuery.ajax() | jQuery API ä¸­æ–‡æ–‡æ¡£ -- jQuery ä¸­æ–‡ç½‘</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      ajax XMLHttpRequest xhr fetch XDomainRequest jquery.ajax overrideMimeType CORS FileReader postman angular withCredentials setRequestHeader getAllResponseHeaders upload ajaxä¸historyçš„å…¼å®¹ ajaxè·¨åŸŸè¯·æ±‚ ajaxæ–‡ä»¶ä¸Šä¼  ajaxç¼“å­˜å¤„ç† ajaxé”™è¯¯å¤„ç† ajaxè°ƒè¯•æŠ€å·§ pjax ajaxè¯·æ±‚äºŒè¿›åˆ¶ å¤šä¸ªajaxè¯·æ±‚ options xhrä¸€çº§ xhräºŒçº§ axios
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://louiszhai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Fetchè¿›é˜¶æŒ‡å—</title>
    <link href="http://louiszhai.github.io/2016/11/02/fetch/"/>
    <id>http://louiszhai.github.io/2016/11/02/fetch/</id>
    <published>2016-11-02T04:48:08.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>Fetch æ˜¯ webå¼‚æ­¥é€šä¿¡çš„æœªæ¥. ä»chrome42, Firefox39, Opera29, EdgeHTML14(å¹¶éEdgeç‰ˆæœ¬)èµ·, fetchå°±å·²ç»è¢«æ”¯æŒäº†. å…¶ä¸­chrome42~45ç‰ˆæœ¬, fetchå¯¹ä¸­æ–‡æ”¯æŒæœ‰é—®é¢˜, å»ºè®®ä»chrome46èµ·ä½¿ç”¨fetch. ä¼ é€é—¨: <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=511289" target="_blank" rel="external">fetchä¸­æ–‡ä¹±ç </a> .</p>
<a id="more"></a>
<h3 id="Fetch"><a href="#Fetch" class="headerlink" title="Fetch"></a>Fetch</h3><p>å…ˆè¿‡ä¸€éFetchåŸç”Ÿæ”¯æŒç‡.</p>
<p><img src="http://louiszhai.github.io/docImages/ajax07.png" alt=""><br><img src="http://louiszhai.github.io/docImages/ajax08.png" alt=""></p>
<p>å¯è§è¦æƒ³åœ¨IE8/9/10/11ä¸­ä½¿ç”¨fetchè¿˜æ˜¯æœ‰äº›çŠ¯éš¾çš„,æ¯•ç«Ÿå®ƒè¿ Promise éƒ½ä¸æ”¯æŒ, æ›´åˆ«è¯´fetchäº†. åˆ«æ€¥, è¿™é‡Œæœ‰polyfill(å«ç‰‡). </p>
<ul>
<li>es5 çš„ polyfill â€” <a href="https://github.com/es-shims/es5-shim" target="_blank" rel="external"><code>es5-shim, es5-sham</code></a> .</li>
<li>Promise çš„ polyfill â€” <a href="https://github.com/jakearchibald/es6-promise" target="_blank" rel="external"><code>es6-promise</code></a> .</li>
<li>fetch çš„ polyfill â€” <a href="https://github.com/camsong/fetch-ie8" target="_blank" rel="external"><code>fetch-ie8</code></a> .</li>
</ul>
<p>ç”±äºIE8åŸºäºES3, IE9æ”¯æŒå¤§éƒ¨åˆ†ES5, IE11æ”¯æŒå°‘é‡ES5, å…¶ä¸­åªæœ‰IE10å¯¹ES5æ”¯æŒæ¯”è¾ƒå®Œæ•´. å› æ­¤IE8+æµè§ˆå™¨, å»ºè®®ä¾æ¬¡è£…è½½ä¸Šè¿°å«ç‰‡.</p>
<h4 id="å°è¯•ä¸€ä¸ªfetch"><a href="#å°è¯•ä¸€ä¸ªfetch" class="headerlink" title="å°è¯•ä¸€ä¸ªfetch"></a>å°è¯•ä¸€ä¸ªfetch</h4><p>å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„fetch.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> word = <span class="string">'123'</span>,</div><div class="line">    url = <span class="string">'https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd='</span>+word+<span class="string">'&amp;json=1&amp;p=3'</span>;</div><div class="line">fetch(url,&#123;<span class="attr">mode</span>: <span class="string">"no-cors"</span>&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> response;</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(data);</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"Oops, error"</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>fetchæ‰§è¡Œåè¿”å›ä¸€ä¸ª <code>Promise</code> å¯¹è±¡, æ‰§è¡ŒæˆåŠŸå, æˆåŠŸæ‰“å°å‡º <code>Response</code> å¯¹è±¡.</p>
<p><img src="http://louiszhai.github.io/docImages/ajax11.png" alt="response headers"></p>
<p>è¯¥fetchå¯ä»¥åœ¨ä»»ä½•åŸŸåçš„ç½‘ç«™ç›´æ¥è¿è¡Œ, ä¸”èƒ½æ­£å¸¸è¿”å›ç™¾åº¦æœç´¢çš„å»ºè®®è¯æ¡. ä»¥ä¸‹æ˜¯å¸¸è§„è¾“å…¥æ—¶çš„æ˜¯ç•Œé¢æˆªå›¾.</p>
<p><img src="http://louiszhai.github.io/docImages/ajax09.png" alt="response headers"></p>
<p>ä»¥ä¸‹æ˜¯åˆšæ‰fetchåˆ°çš„éƒ¨åˆ†æ•°æ®. å…¶ä¸­key name ä¸ºâ€sâ€çš„å­—æ®µçš„valueå°±æ˜¯ä»¥ä¸Šçš„å»ºè®®è¯æ¡.(ç”±äºæœ‰é«˜äº®è¯æ¡â€12306â€, æœ€åä¸€æ¡æ•°æ®â€12366â€è¢«é¡¶ä¸‹å»äº†, æ•…ä¸Šé¢æˆªå›¾ä¸Šçœ‹ä¸åˆ°)</p>
<p><img src="http://louiszhai.github.io/docImages/ajax10.png" alt="response headers"></p>
<p>çœ‹å®Œæ —å­è¿‡å, å°±è¦åŠ¨çœŸæ ¼äº†. ä¸‹é¢å°±æ¥æ‰’ä¸‹ Fetch.</p>
<h4 id="Promiseç‰¹æ€§"><a href="#Promiseç‰¹æ€§" class="headerlink" title="Promiseç‰¹æ€§"></a>Promiseç‰¹æ€§</h4><p>fetchæ–¹æ³•è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡, æ ¹æ® <code>Promise Api</code> çš„ç‰¹æ€§, fetchå¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨thenæ–¹æ³•å°†å„ä¸ªå¤„ç†é€»è¾‘ä¸²èµ·æ¥, ä½¿ç”¨ Promise.resolve() æˆ– Promise.reject() æ–¹æ³•å°†åˆ†åˆ«è¿”ä¼šè‚¯å®šç»“æœçš„Promiseæˆ–å¦å®šç»“æœçš„Promise, ä»è€Œè°ƒç”¨ä¸‹ä¸€ä¸ªthen æˆ–è€… catch. ä¸€ä½†thenä¸­çš„è¯­å¥å‡ºç°é”™è¯¯, ä¹Ÿå°†è·³åˆ°catchä¸­.</p>
<p>Promiseè‹¥æœ‰ç–‘é—®, è¯·é˜…è¯» <a href="https://www.promisejs.org/" target="_blank" rel="external">Promises</a> .</p>
<p>â‘  æˆ‘ä»¬ä¸å¦¨åœ¨ <a href="https://sp0.baidu.com" target="_blank" rel="external">https://sp0.baidu.com</a> åŸŸåçš„ç½‘é¡µæ§åˆ¶å°è¿è¡Œä»¥ä¸‹ä»£ç .</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> word = <span class="string">'123'</span>,</div><div class="line">    url = <span class="string">'https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd='</span>+word+<span class="string">'&amp;json=1&amp;p=3'</span>;</div><div class="line">fetch(url).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'ç¬¬ä¸€æ¬¡è¿›å…¥then...'</span>);</div><div class="line">  <span class="keyword">if</span>(response.status&gt;=<span class="number">200</span> &amp;&amp; response.status&lt;<span class="number">300</span>)&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Content-Type: '</span> + response.headers.get(<span class="string">'Content-Type'</span>));</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Date: '</span> + response.headers.get(<span class="string">'Date'</span>));</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'status: '</span> + response.status);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'statusText: '</span> + response.statusText);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'type: '</span> + response.type);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'url: '</span> + response.url);</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(response);</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(response.statusText));</div><div class="line">  &#125;</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'ç¬¬äºŒæ¬¡è¿›å…¥then...'</span>);</div><div class="line">  <span class="built_in">console</span>.log(data);</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'æŠ›å‡ºçš„é”™è¯¯å¦‚ä¸‹:'</span>);</div><div class="line">  <span class="built_in">console</span>.log(e);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è¿è¡Œæˆªå›¾å¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax12.png" alt="fetch then"></p>
<p>â‘¡ æˆ‘ä»¬ä¸å¦¨åœ¨é <a href="https://sp0.baidu.com" target="_blank" rel="external">https://sp0.baidu.com</a> åŸŸåçš„ç½‘é¡µæ§åˆ¶å°å†æ¬¡è¿è¡Œä»¥ä¸Šä»£ç .(åˆ«å¿˜äº†ç»™fetchçš„ç¬¬äºŒå‚æ•°ä¼ é€’{mode: â€œno-corsâ€})</p>
<p>è¿è¡Œæˆªå›¾å¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax13.png" alt="fetch catch"></p>
<p>ç”±äºç¬¬ä¸€æ¬¡è¿›å…¥thenåˆ†æ”¯å, è¿”å›äº†å¦å®šç»“æœçš„ Promise.reject å¯¹è±¡. å› æ­¤ä»£ç è¿›å…¥åˆ°catchåˆ†æ”¯, æŠ›å‡ºäº†é”™è¯¯. æ­¤æ—¶, ä¸Šè¿° <code>response.type</code> ä¸º <code>opaque</code> .</p>
<h4 id="response-type"><a href="#response-type" class="headerlink" title="response type"></a>response type</h4><p>ä¸€ä¸ªfetchè¯·æ±‚çš„å“åº”ç±»å‹(response.type)ä¸ºå¦‚ä¸‹ä¸‰ç§ä¹‹ä¸€:</p>
<ul>
<li>basic</li>
<li>cors</li>
<li>opaque</li>
</ul>
<p>å¦‚ä¸Šæƒ…æ™¯â‘ , åŒåŸŸä¸‹, å“åº”ç±»å‹ä¸º â€œbasicâ€.</p>
<p>å¦‚ä¸Šæƒ…æ™¯â‘¡ä¸­, è·¨åŸŸä¸‹, æœåŠ¡å™¨æ²¡æœ‰è¿”å›CORSå“åº”å¤´, å“åº”ç±»å‹ä¸º â€œopaqueâ€. æ­¤æ—¶æˆ‘ä»¬å‡ ä¹ä¸èƒ½æŸ¥çœ‹ä»»ä½•æœ‰ä»·å€¼çš„ä¿¡æ¯, æ¯”å¦‚ä¸èƒ½æŸ¥çœ‹response, status, urlç­‰ç­‰ç­‰ç­‰.</p>
<p><img src="http://louiszhai.github.io/docImages/ajax14.png" alt="fetch type"></p>
<p>åŒæ ·æ˜¯è·¨åŸŸä¸‹, å¦‚æœæœåŠ¡å™¨è¿”å›äº†CORSå“åº”å¤´, é‚£ä¹ˆå“åº”ç±»å‹å°†ä¸º â€œcorsâ€. æ­¤æ—¶å“åº”å¤´ä¸­é™¤ <code>Cache-Control</code> , <code>Content-Language</code> , <code>Content-Type</code> , <code>Expores</code> , <code>Last-Modified</code> å’Œ <code>Progma</code> ä¹‹å¤–çš„å­—æ®µéƒ½ä¸å¯è§.</p>
<p>æ³¨æ„: æ— è®ºæ˜¯åŒåŸŸè¿˜æ˜¯è·¨åŸŸ, ä»¥ä¸Š fetch è¯·æ±‚éƒ½åˆ°è¾¾äº†æœåŠ¡å™¨.</p>
<h4 id="mode"><a href="#mode" class="headerlink" title="mode"></a>mode</h4><p>fetchå¯ä»¥è®¾ç½®ä¸åŒçš„æ¨¡å¼ä½¿å¾—è¯·æ±‚æœ‰æ•ˆ. æ¨¡å¼å¯åœ¨fetchæ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°å¯¹è±¡ä¸­å®šä¹‰.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fetch(url, &#123;<span class="attr">mode</span>: <span class="string">'cors'</span>&#125;);</div></pre></td></tr></table></figure>
<p>å¯å®šä¹‰çš„æ¨¡å¼å¦‚ä¸‹:</p>
<ul>
<li>same-origin: è¡¨ç¤ºåŒåŸŸä¸‹å¯è¯·æ±‚æˆåŠŸ; åä¹‹, æµè§ˆå™¨å°†æ‹’ç»å‘é€æœ¬æ¬¡fetch, åŒæ—¶æŠ›å‡ºé”™è¯¯ â€œTypeError: Failed to fetch(â€¦)â€.</li>
<li>cors: è¡¨ç¤ºåŒåŸŸå’Œå¸¦æœ‰CORSå“åº”å¤´çš„è·¨åŸŸä¸‹å¯è¯·æ±‚æˆåŠŸ. å…¶ä»–è¯·æ±‚å°†è¢«æ‹’ç».</li>
<li>cors-with-forced-preflight: è¡¨ç¤ºåœ¨å‘å‡ºè¯·æ±‚å‰, å°†æ‰§è¡Œpreflightæ£€æŸ¥.</li>
<li>no-cors: å¸¸ç”¨äºè·¨åŸŸè¯·æ±‚ä¸å¸¦CORSå“åº”å¤´åœºæ™¯, æ­¤æ—¶å“åº”ç±»å‹ä¸º â€œopaqueâ€.</li>
</ul>
<p>é™¤æ­¤ä¹‹å¤–, è¿˜æœ‰ä¸¤ç§ä¸å¤ªå¸¸ç”¨çš„modeç±»å‹, åˆ†åˆ«æ˜¯ <code>navigate</code> , <code>websocket</code> , å®ƒä»¬æ˜¯ <a href="https://html.spec.whatwg.org/multipage/" target="_blank" rel="external">HTMLæ ‡å‡†</a> ä¸­ç‰¹æ®Šçš„å€¼, è¿™é‡Œä¸åšè¯¦ç»†ä»‹ç».</p>
<h4 id="header"><a href="#header" class="headerlink" title="header"></a>header</h4><p>fetchè·å–httpå“åº”å¤´éå¸¸easy. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fetch(url).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123; </div><div class="line">    <span class="built_in">console</span>.log(response.headers.get(<span class="string">'Content-Type'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è®¾ç½®httpè¯·æ±‚å¤´ä¹Ÿä¸€æ ·ç®€å•.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> headers = <span class="keyword">new</span> Headers();</div><div class="line">headers.append(<span class="string">"Content-Type"</span>, <span class="string">"text/html"</span>);</div><div class="line">fetch(url,&#123;</div><div class="line">  <span class="attr">headers</span>: headers</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>headerçš„å†…å®¹ä¹Ÿæ˜¯å¯ä»¥è¢«æ£€ç´¢çš„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> header = <span class="keyword">new</span> Headers(&#123;</div><div class="line">  <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span></div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(header.has(<span class="string">"Content-Type"</span>)); <span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(header.has(<span class="string">"Content-Length"</span>)); <span class="comment">//false</span></div></pre></td></tr></table></figure>
<h4 id="post"><a href="#post" class="headerlink" title="post"></a>post</h4><p>åœ¨fetchä¸­å‘é€postè¯·æ±‚, åŒæ ·å¯ä»¥åœ¨fetchæ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°å¯¹è±¡ä¸­è®¾ç½®.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> headers = <span class="keyword">new</span> Headers();</div><div class="line">headers.append(<span class="string">"Content-Type"</span>, <span class="string">"application/json;charset=UTF-8"</span>);</div><div class="line">fetch(url, &#123;</div><div class="line">  <span class="attr">method</span>: <span class="string">'post'</span>,</div><div class="line">  <span class="attr">headers</span>: headers,</div><div class="line">  <span class="attr">body</span>: <span class="built_in">JSON</span>.stringify(&#123;</div><div class="line">    <span class="attr">date</span>: <span class="string">'2016-10-08'</span>,</div><div class="line">    <span class="attr">time</span>: <span class="string">'15:16:00'</span></div><div class="line">  &#125;)</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="credentials"><a href="#credentials" class="headerlink" title="credentials"></a>credentials</h4><p>è·¨åŸŸè¯·æ±‚ä¸­éœ€è¦å¸¦æœ‰cookieæ—¶, å¯åœ¨fetchæ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°å¯¹è±¡ä¸­æ·»åŠ credentialså±æ€§, å¹¶å°†å€¼è®¾ç½®ä¸ºâ€includeâ€.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fetch(url,&#123;</div><div class="line">  <span class="attr">credentials</span>: <span class="string">'include'</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>é™¤æ­¤ä¹‹å¤–, credentials è¿˜å¯ä»¥å–ä»¥ä¸‹å€¼:</p>
<ul>
<li>omit: ç¼ºçœå€¼, é»˜è®¤ä¸ºè¯¥å€¼.</li>
<li>same-origin: åŒæº, è¡¨ç¤ºåŒåŸŸè¯·æ±‚æ‰å‘é€cookie.</li>
</ul>
<h4 id="catch"><a href="#catch" class="headerlink" title="catch"></a>catch</h4><p>åŒ XMLHttpRequest ä¸€æ ·, æ— è®ºæœåŠ¡å™¨è¿”å›ä»€ä¹ˆæ ·çš„çŠ¶æ€ç (chromeä¸­é™¤407ä¹‹å¤–çš„å…¶ä»–çŠ¶æ€ç ), å®ƒä»¬éƒ½ä¸ä¼šè¿›å…¥åˆ°é”™è¯¯æ•è·é‡Œ. ä¹Ÿå°±æ˜¯è¯´, æ­¤æ—¶, XMLHttpRequest å®ä¾‹ä¸ä¼šè§¦å‘ <code>onerror</code> äº‹ä»¶å›è°ƒ, fetch ä¸ä¼šè§¦å‘ reject. <strong>é€šå¸¸åªåœ¨ç½‘ç»œå‡ºç°é—®é¢˜æ—¶æˆ–è€…ERR_CONNECTION_RESETæ—¶, å®ƒä»¬æ‰ä¼šè¿›å…¥åˆ°ç›¸åº”çš„é”™è¯¯æ•è·é‡Œ.</strong> (å…¶ä¸­, è¯·æ±‚è¿”å›çŠ¶æ€ç ä¸º407æ—¶, chromeæµè§ˆå™¨ä¼šè§¦å‘onerroræˆ–è€…rejectæ‰fetch.)</p>
<h4 id="cache"><a href="#cache" class="headerlink" title="cache"></a>cache</h4><p>cacheè¡¨ç¤ºå¦‚ä½•å¤„ç†ç¼“å­˜, éµå®ˆhttpè§„èŒƒ, æ‹¥æœ‰å¦‚ä¸‹å‡ ç§å€¼:</p>
<ul>
<li>default: è¡¨ç¤ºfetchè¯·æ±‚ä¹‹å‰å°†æ£€æŸ¥ä¸‹httpçš„ç¼“å­˜.</li>
<li>no-store: è¡¨ç¤ºfetchè¯·æ±‚å°†å®Œå…¨å¿½ç•¥httpç¼“å­˜çš„å­˜åœ¨. è¿™æ„å‘³ç€è¯·æ±‚ä¹‹å‰å°†ä¸å†æ£€æŸ¥ä¸‹httpçš„ç¼“å­˜, æ‹¿åˆ°å“åº”å, å®ƒä¹Ÿä¸ä¼šæ›´æ–°httpç¼“å­˜.</li>
<li>no-cache: å¦‚æœå­˜åœ¨ç¼“å­˜, é‚£ä¹ˆfetchå°†å‘é€ä¸€ä¸ªæ¡ä»¶æŸ¥è¯¢requestå’Œä¸€ä¸ªæ­£å¸¸çš„request, æ‹¿åˆ°å“åº”å, å®ƒä¼šæ›´æ–°httpç¼“å­˜.</li>
<li>reload: è¡¨ç¤ºfetchè¯·æ±‚ä¹‹å‰å°†å¿½ç•¥httpç¼“å­˜çš„å­˜åœ¨, ä½†æ˜¯è¯·æ±‚æ‹¿åˆ°å“åº”å, å®ƒå°†ä¸»åŠ¨æ›´æ–°httpç¼“å­˜.</li>
<li>force-cache: è¡¨ç¤ºfetchè¯·æ±‚ä¸é¡¾ä¸€åˆ‡çš„ä¾èµ–ç¼“å­˜, å³ä½¿ç¼“å­˜è¿‡æœŸäº†, å®ƒä¾ç„¶ä»ç¼“å­˜ä¸­è¯»å–. é™¤éæ²¡æœ‰ä»»ä½•ç¼“å­˜, é‚£ä¹ˆå®ƒå°†å‘é€ä¸€ä¸ªæ­£å¸¸çš„request.</li>
<li>only-if-cached: è¡¨ç¤ºfetchè¯·æ±‚ä¸é¡¾ä¸€åˆ‡çš„ä¾èµ–ç¼“å­˜, å³ä½¿ç¼“å­˜è¿‡æœŸäº†, å®ƒä¾ç„¶ä»ç¼“å­˜ä¸­è¯»å–. å¦‚æœæ²¡æœ‰ç¼“å­˜, å®ƒå°†æŠ›å‡ºç½‘ç»œé”™è¯¯(è¯¥è®¾ç½®åªåœ¨modeä¸ºâ€same-originâ€æ—¶æœ‰æ•ˆ).</li>
</ul>
<p>å¦‚æœfetchè¯·æ±‚çš„headeré‡ŒåŒ…å« <code>If-Modified-Since</code>, <code>If-None-Match</code>, <code>If-Unmodified-Since</code>, <code>If-Match</code>, æˆ–è€… <code>If-Range</code> ä¹‹ä¸€, ä¸”cacheçš„å€¼ä¸º <code>default</code> , é‚£ä¹ˆfetchå°†è‡ªåŠ¨æŠŠ cacheçš„å€¼è®¾ç½®ä¸º <code>&quot;no-store&quot;</code> .</p>
<h4 id="async-await"><a href="#async-await" class="headerlink" title="async/await"></a>async/await</h4><h5 id="ä¸ºä»€ä¹ˆæ˜¯async-await"><a href="#ä¸ºä»€ä¹ˆæ˜¯async-await" class="headerlink" title="ä¸ºä»€ä¹ˆæ˜¯async/await"></a>ä¸ºä»€ä¹ˆæ˜¯async/await</h5><p>å›è°ƒæ·±æ¸Šä¸€ç›´æ˜¯jserçš„ä¸€å—å¿ƒç—…, è™½ç„¶ES6æä¾›äº† Promise, å°†åµŒå¥—å¹³é“º, ä½†ä½¿ç”¨èµ·æ¥ä¾ç„¶ä¸ä¾¿. </p>
<p>è¦è¯´ES6ä¹Ÿæä¾›äº†generator/yield, å®ƒå°†ä¸€ä¸ªå‡½æ•°æ‰§è¡Œæš‚åœ, ä¿å­˜ä¸Šä¸‹æ–‡, å†æ¬¡è°ƒç”¨æ—¶æ¢å¤å½“æ—¶çš„çŠ¶æ€.(å­¦ä¹ å¯å‚è€ƒ <a href="http://www.ruanyifeng.com/blog/2015/04/generator.html" target="_blank" rel="external">Generator å‡½æ•°çš„å«ä¹‰ä¸ç”¨æ³• - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a>) æ— è®ºå¦‚ä½•, æ€»æ„Ÿè§‰åˆ«æ‰­. å¦‚ä¸‹æ‘˜è‡ªæ¨åº“çš„ä¸€å¼ å›¾.</p>
<p><img src="http://louiszhai.github.io/docImages/ajax22.png" alt=""></p>
<p>æˆ‘ä»¬ä¸éš¾çœ‹å‡ºå…¶ä¸­çš„å·®è·, callbackç®€å•ç²—æš´, å±‚å±‚å›è°ƒ, å›è°ƒè¶Šæ·±å…¥, è¶Šä¸å®¹æ˜“æ‹æ¸…æ¥šé€»è¾‘. Promise å°†å¼‚æ­¥æ“ä½œè§„èŒƒåŒ–.ä½¿ç”¨thenè¿æ¥, ä½¿ç”¨catchæ•è·é”™è¯¯, å ªç§°å®Œç¾, ç¾ä¸­ä¸è¶³çš„æ˜¯, thenå’Œcatchä¸­ä¼ é€’çš„ä¾ç„¶æ˜¯å›è°ƒå‡½æ•°, ä¸å¿ƒç›®ä¸­çš„åŒæ­¥ä»£ç ä¸æ˜¯ä¸€ä¸ªå¥—è·¯.</p>
<p>ä¸ºæ­¤, ES7 æä¾›äº†æ›´æ ‡å‡†çš„è§£å†³æ–¹æ¡ˆ â€” async/await. async/await å‡ ä¹æ²¡æœ‰å¼•å…¥æ–°çš„è¯­æ³•, è¡¨é¢ä¸Šçœ‹èµ·æ¥, å®ƒå°±å’Œalertä¸€æ ·æ˜“ç”¨,  è™½ç„¶å®ƒå°šå¤„äºES7çš„è‰æ¡ˆä¸­, ä¸è¿‡è¿™å¹¶ä¸å½±å“æˆ‘ä»¬æå‰ä½¿ç”¨å®ƒ.</p>
<h5 id="async-awaitè¯­æ³•"><a href="#async-awaitè¯­æ³•" class="headerlink" title="async/awaitè¯­æ³•"></a>async/awaitè¯­æ³•</h5><p>async ç”¨äºå£°æ˜ä¸€ä¸ªå¼‚æ­¥å‡½æ•°, è¯¥å‡½æ•°éœ€è¿”å›ä¸€ä¸ª Promise å¯¹è±¡. è€Œ await é€šå¸¸åæ¥ä¸€ä¸ª Promiseå¯¹è±¡, éœ€ç­‰å¾…è¯¥ Promise å¯¹è±¡çš„ resolve() æ–¹æ³•æ‰§è¡Œå¹¶ä¸”è¿”å›å€¼åæ‰èƒ½ç»§ç»­æ‰§è¡Œ. (å¦‚æœawaitåæ¥çš„æ˜¯å…¶ä»–å¯¹è±¡, ä¾¿ä¼šç«‹å³æ‰§è¡Œ)</p>
<p>å› æ­¤, async/await å¤©ç”Ÿå¯ç”¨äºå¤„ç† fetchè¯·æ±‚(æ¯«æ— è¿å’Œæ„Ÿ). å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> word = <span class="string">'123'</span>,</div><div class="line">    url = <span class="string">'https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd='</span>+word+<span class="string">'&amp;json=1&amp;p=3'</span>;</div><div class="line"><span class="function">(<span class="params"><span class="keyword">async</span> (</span>)=&gt;</span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> fetch(url, &#123;<span class="attr">mode</span>: <span class="string">'no-cors'</span>&#125;);<span class="comment">//ç­‰å¾…fetchè¢«resolve()åæ‰èƒ½ç»§ç»­æ‰§è¡Œ</span></div><div class="line">    <span class="built_in">console</span>.log(res);</div><div class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</div><div class="line">    <span class="built_in">console</span>.log(e);</div><div class="line">  &#125;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure>
<p>è‡ªç„¶, async/await ä¹Ÿå¯å¤„ç† Promise å¯¹è±¡.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> wait = <span class="function"><span class="keyword">function</span>(<span class="params">ts</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</div><div class="line">    setTimeout(resolve,ts,<span class="string">'Copy that!'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> wait(<span class="number">1000</span>);<span class="comment">//â‘  ç­‰å¾…1såè¿”å›ç»“æœ</span></div><div class="line">    <span class="built_in">console</span>.log(res);</div><div class="line">    res = <span class="keyword">await</span> wait(<span class="number">1000</span>);<span class="comment">//â‘¡ é‡å¤æ‰§è¡Œä¸€æ¬¡</span></div><div class="line">    <span class="built_in">console</span>.log(res);</div><div class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</div><div class="line">    <span class="built_in">console</span>.log(e);</div><div class="line">  &#125;</div><div class="line">&#125;)();</div><div class="line"><span class="comment">//"Copy that!"</span></div></pre></td></tr></table></figure>
<p>å¯è§ä½¿ç”¨awaitå, å¯ä»¥ç›´æ¥å¾—åˆ°è¿”å›å€¼, ä¸å¿…å†™ <code>.then(callback)</code> , ä¹Ÿä¸å¿…å†™ <code>.catch(error)</code> äº†, æ›´å¯ä»¥ä½¿ç”¨ <code>try catch</code> æ ‡å‡†è¯­æ³•æ•è·é”™è¯¯.</p>
<p>ç”±äºawaité‡‡ç”¨çš„æ˜¯åŒæ­¥çš„å†™æ³•, çœ‹èµ·æ¥å®ƒå°±å’Œalertå‡½æ•°ä¸€æ ·, å¯ä»¥è‡ªåŠ¨é˜»å¡ä¸Šä¸‹æ–‡. å› æ­¤å®ƒå¯ä»¥é‡å¤æ‰§è¡Œå¤šæ¬¡, å°±åƒä¸Šè¿°ä»£ç â‘¡ä¸€æ ·.</p>
<p>å¯ä»¥çœ‹åˆ°, await/async åŒæ­¥é˜»å¡å¼çš„å†™æ³•è§£å†³äº†å®Œå…¨ä½¿ç”¨ Promise çš„ä¸€å¤§ç—›ç‚¹â€”â€”ä¸åŒPromiseä¹‹é—´å…±äº«æ•°æ®é—®é¢˜. Promise éœ€è¦è®¾ç½®ä¸Šå±‚å˜é‡ä»è€Œå®ç°æ•°æ®å…±äº«, è€Œ await/async å°±ä¸å­˜åœ¨è¿™æ ·çš„é—®é¢˜, åªéœ€è¦åƒå†™alertä¸€æ ·ä¹¦å†™å°±å¯ä»¥äº†.</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯, <strong>await åªèƒ½ç”¨äº async å£°æ˜çš„å‡½æ•°ä¸Šä¸‹æ–‡ä¸­</strong>. å¦‚ä¸‹ forEach ä¸­, æ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨awaitçš„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> array = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</div><div class="line"><span class="function">(<span class="params"><span class="keyword">async</span> (</span>)=&gt;</span>&#123;</div><div class="line">  array.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(item);</div><div class="line">    <span class="keyword">await</span> wait(<span class="number">1000</span>);<span class="comment">//è¿™æ˜¯é”™è¯¯çš„å†™æ³•</span></div><div class="line">  &#125;);</div><div class="line">&#125;)();</div><div class="line"><span class="comment">//å› awaitåªèƒ½ç”¨äº async å£°æ˜çš„å‡½æ•°ä¸Šä¸‹æ–‡ä¸­, æ•…ä¸èƒ½å†™åœ¨forEachå†….ä¸‹é¢æˆ‘ä»¬æ¥çœ‹æ­£ç¡®çš„å†™æ³•</span></div><div class="line">(<span class="keyword">async</span> ()=&gt;&#123;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>,len=array.length;i&lt;len;i++)&#123;</div><div class="line">    <span class="built_in">console</span>.log(array[i]);</div><div class="line">    <span class="keyword">await</span> wait(<span class="number">1000</span>);</div><div class="line">  &#125;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure>
<h5 id="å¦‚ä½•è¯•è¿è¡Œasync-await"><a href="#å¦‚ä½•è¯•è¿è¡Œasync-await" class="headerlink" title="å¦‚ä½•è¯•è¿è¡Œasync/await"></a>å¦‚ä½•è¯•è¿è¡Œasync/await</h5><p>é‰´äºç›®å‰åªæœ‰Edgeæ”¯æŒ async/await, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€è¿è¡Œæˆ‘ä»¬çš„ä»£ç .</p>
<ol>
<li><p>éšç€node7.0çš„å‘å¸ƒ, nodeä¸­å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ç›´æ¥è¿è¡Œ:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">node --harmony-async-await test.js</div></pre></td></tr></table></figure>
</li>
<li><p>babelåœ¨çº¿ç¼–è¯‘å¹¶è¿è¡Œ <a href="https://babeljs.io/repl/#?babili=false&amp;evaluate=true&amp;lineWrap=false&amp;presets=es2015%2Creact%2Cstage-2&amp;code=" target="_blank" rel="external">Babel Â· The compiler for writing next generation JavaScript</a> .</p>
</li>
<li><p>æœ¬åœ°ä½¿ç”¨babelç¼–è¯‘es6æˆ–æ›´é«˜ç‰ˆæœ¬es.</p>
<p>1) å®‰è£….</p>
<p>ç”±äºBabel5é»˜è®¤è‡ªå¸¦å„ç§è½¬æ¢æ’ä»¶, ä¸éœ€è¦æ‰‹åŠ¨å®‰è£…. ç„¶è€Œä»Babel6å¼€å§‹, æ’ä»¶éœ€è¦æ‰‹åŠ¨ä¸‹è½½, å› æ­¤ä»¥ä¸‹å®‰è£…babelåéœ€è¦å†é¡ºä¾¿å®‰è£…ä¸¤ä¸ªæ’ä»¶.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">npm i babel-cli -g	<span class="comment"># babelå·²æ›´åä¸ºbabel-cli</span></div><div class="line">npm install babel-preset-es2015 --save-dev</div><div class="line">npm install babel-preset-stage-0 --save-dev</div></pre></td></tr></table></figure>
<p>2) ä¹¦å†™.babelrcé…ç½®æ–‡ä»¶.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"presets"</span>: [</div><div class="line">        <span class="string">"es2015"</span>,</div><div class="line">        <span class="string">"stage-0"</span></div><div class="line">    ],</div><div class="line">    <span class="attr">"plugins"</span>: []</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>3) å¦‚æœä¸é…ç½®.babelrc. ä¹Ÿå¯åœ¨å‘½ä»¤è¡Œæ˜¾å¼æŒ‡å®šæ’ä»¶.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">babel es6.js -o es5.js --presets es2015 stage-0 <span class="comment"># æŒ‡å®šä½¿ç”¨æ’ä»¶es2015å’Œstage-0ç¼–è¯‘js</span></div></pre></td></tr></table></figure>
<p>4) ç¼–è¯‘.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">babel es6.js -o es5.js  <span class="comment"># ç¼–è¯‘æºæ–‡ä»¶es6.js,è¾“å‡ºä¸ºes5.js,ç¼–è¯‘è§„åˆ™åœ¨ä¸Šè¿°.babelrcä¸­æŒ‡å®š</span></div><div class="line">babel es6.js --out-file es5.js <span class="comment"># æˆ–è€…å°†-oå†™å…¨ä¸º--out-fileä¹Ÿè¡Œ</span></div><div class="line">bable es6.js <span class="comment"># å¦‚æœä¸æŒ‡å®šè¾“å‡ºæ–‡ä»¶è·¯å¾„,babelä¼šå°†ç¼–è¯‘ç”Ÿæˆçš„æ–‡æœ¬æ ‡å‡†è¾“å‡ºåˆ°æ§åˆ¶å°</span></div></pre></td></tr></table></figure>
<p>5) å®æ—¶ç¼–è¯‘</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">babel es6.js -w -o es5.js <span class="comment"># å®æ—¶watch es6.jsçš„å˜åŒ–,ä¸€æ—¦æ”¹å˜å°±é‡æ–°ç¼–è¯‘</span></div><div class="line">babel es6.js -watch -o es5.js <span class="comment"># -wä¹Ÿå¯å†™å…¨ä¸º--watch</span></div></pre></td></tr></table></figure>
<p>6) ç¼–è¯‘ç›®å½•è¾“å‡ºåˆ°å…¶ä»–ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">babel src <span class="_">-d</span> build <span class="comment"># ç¼–è¯‘srcç›®å½•ä¸‹æ‰€æœ‰js,å¹¶è¾“å‡ºåˆ°buildç›®å½•</span></div><div class="line">babel src --out-dir build <span class="comment"># -dä¹Ÿå¯å†™å…¨ä¸º--out-dir</span></div></pre></td></tr></table></figure>
<p>7) ç¼–è¯‘ç›®å½•è¾“å‡ºåˆ°å•ä¸ªæ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">babel src -o es5.js <span class="comment"># ç¼–è¯‘srcç›®å½•æ‰€æœ‰js,åˆå¹¶è¾“å‡ºä¸ºes5.js</span></div></pre></td></tr></table></figure>
<p>8) æƒ³è¦ç›´æ¥è¿è¡Œes6.js, å¯ä½¿ç”¨babel-node.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm i babel-node -g <span class="comment"># å…¨å±€å®‰è£…babel-node</span></div><div class="line">babel-node es6.js <span class="comment"># ç›´æ¥è¿è¡Œjsæ–‡ä»¶</span></div></pre></td></tr></table></figure>
<p>9) å¦‚éœ€åœ¨ä»£ç ä¸­ä½¿ç”¨fetch, ä¸”ä½¿ç”¨babel-nodeè¿è¡Œ, éœ€å¼•å…¥ <code>node-fetch</code> æ¨¡å—.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm i node-fetch --save-dev</div></pre></td></tr></table></figure>
<p>ç„¶ååœ¨es6.jsä¸­require <code>node-fetch</code> æ¨¡å—.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fetch = <span class="built_in">require</span>(<span class="string">'node-fetch'</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>æœ¬åœ°ä½¿ç”¨traceurç¼–è¯‘es6æˆ–æ›´é«˜ç‰ˆæœ¬es.è¯·å‚è€ƒ <a href="http://www.codesec.net/view/450316.html" target="_blank" rel="external">åœ¨é¡¹ç›®å¼€å‘ä¸­ä¼˜é›…åœ°ä½¿ç”¨ES6ï¼šTraceur &amp; Babel</a> .</p>
</li>
</ol>
<h3 id="å¦‚ä½•å¼¥è¡¥Fetchçš„ä¸è¶³"><a href="#å¦‚ä½•å¼¥è¡¥Fetchçš„ä¸è¶³" class="headerlink" title="å¦‚ä½•å¼¥è¡¥Fetchçš„ä¸è¶³"></a>å¦‚ä½•å¼¥è¡¥Fetchçš„ä¸è¶³</h3><p>fetchåŸºäºPromise, Promiseå—é™, fetchä¹Ÿéš¾å¹¸å…. ES6çš„PromiseåŸºäº <a href="https://promisesaplus.com/" target="_blank" rel="external">Promises/A+</a> è§„èŒƒ (å¯¹è§„èŒƒæ„Ÿå…´è¶£çš„åŒå­¦å¯é€‰è¯» <a href="http://www.cnblogs.com/fsjohnhuang/p/4135149.html" target="_blank" rel="external">å‰–ææºç ç†è§£Promises/Aè§„èŒƒ</a> ), å®ƒåªæä¾›æç®€çš„api, æ²¡æœ‰ timeout æœºåˆ¶, æ²¡æœ‰ progress æç¤º, æ²¡æœ‰ deferred å¤„ç† (è¿™ä¸ªå¯ä»¥è¢«async/awaitæ›¿ä»£).</p>
<h4 id="fetch-jsonp"><a href="#fetch-jsonp" class="headerlink" title="fetch-jsonp"></a>fetch-jsonp</h4><p>é™¤æ­¤ä¹‹å¤–, fetchè¿˜ä¸æ”¯æŒjsonpè¯·æ±‚. ä¸è¿‡åŠæ³•æ€»æ¯”é—®é¢˜å¤š, ä¸‡èƒ½çš„å¼€æºä½œè€…æä¾›äº† <a href="https://github.com/camsong/fetch-jsonp" target="_blank" rel="external"><code>fetch-jsonp</code></a> åº“, è§£å†³äº†è¿™ä¸ªé—®é¢˜. </p>
<p><code>fetch-jsonp</code> ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•. å¦‚ä¸‹æ˜¯å®‰è£…:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install fetch-jsonp --save-dev</div></pre></td></tr></table></figure>
<p>å¦‚ä¸‹æ˜¯ä½¿ç”¨:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">fetchJsonp(url, &#123;</div><div class="line">  <span class="attr">timeout</span>: <span class="number">3000</span>,</div><div class="line">  <span class="attr">jsonpCallback</span>: <span class="string">'callback'</span></div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(response.json());</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(e)</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="abort"><a href="#abort" class="headerlink" title="abort"></a>abort</h4><p>ç”±äºPromiseçš„é™åˆ¶, fetch å¹¶ä¸æ”¯æŒåŸç”Ÿçš„abortæœºåˆ¶, ä½†è¿™å¹¶ä¸å¦¨ç¢æˆ‘ä»¬ä½¿ç”¨ Promise.race() å®ç°ä¸€ä¸ª.</p>
<blockquote>
<p>Promise.race(iterable) æ–¹æ³•è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡, åªè¦ iterable ä¸­ä»»æ„ä¸€ä¸ªPromise è¢« resolve æˆ–è€… reject å, å¤–éƒ¨çš„Promise å°±ä¼šä»¥ç›¸åŒçš„å€¼è¢« resolve æˆ–è€… reject.</p>
</blockquote>
<p>æ”¯æŒæ€§: ä» chrome33, Firefox29, Safari7.1, Opera20, EdgeHTML12(å¹¶éEdgeç‰ˆæœ¬) èµ·, Promiseå°±è¢«å®Œæ•´çš„æ”¯æŒ. Promise.race()ä¹Ÿéšä¹‹å¯ç”¨. ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹å®ç°.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _fetch = (<span class="function"><span class="keyword">function</span>(<span class="params">fetch</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">url,options</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> abort = <span class="literal">null</span>;</div><div class="line">    <span class="keyword">var</span> abort_promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</div><div class="line">      abort = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        reject(<span class="string">'abort.'</span>);</div><div class="line">        <span class="built_in">console</span>.info(<span class="string">'abort done.'</span>);</div><div class="line">      &#125;;</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">var</span> promise = <span class="built_in">Promise</span>.race([</div><div class="line">      fetch(url,options),</div><div class="line">      abort_promise</div><div class="line">    ]);</div><div class="line">    promise.abort = abort;</div><div class="line">    <span class="keyword">return</span> promise;</div><div class="line">  &#125;;</div><div class="line">&#125;)(fetch);</div></pre></td></tr></table></figure>
<p>ç„¶å, ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•æµ‹è¯•æ–°çš„fetch.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = _fetch(<span class="string">'https://www.baidu.com'</span>,&#123;<span class="attr">mode</span>:<span class="string">'no-cors'</span>&#125;);</div><div class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'response:'</span>, res);</div><div class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'error:'</span>, e);</div><div class="line">&#125;);</div><div class="line">p.abort();</div><div class="line"><span class="comment">//"abort done."</span></div><div class="line"><span class="comment">//"error: abort."</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, fetchè¯·æ±‚å, ç«‹å³è°ƒç”¨abortæ–¹æ³•, è¯¥promiseè¢«æ‹’ç», ç¬¦åˆé¢„æœŸ. ç»†å¿ƒçš„åŒå­¦å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†, â€œp.abort();â€ è¯¥è¯­å¥æˆ‘æ˜¯å•ç‹¬å†™ä¸€è¡Œçš„, æ²¡æœ‰é“¾å¼å†™åœ¨thenæ–¹æ³•ä¹‹å. ä¸ºä»€ä¹ˆè¿™ä¹ˆå¹²å‘¢? è¿™æ˜¯å› ä¸ºthenæ–¹æ³•è°ƒç”¨å, è¿”å›çš„æ˜¯æ–°çš„promiseå¯¹è±¡. è¯¥å¯¹è±¡ä¸å…·æœ‰abortæ–¹æ³•, å› æ­¤ä½¿ç”¨æ—¶è¦æ³¨æ„ç»•å¼€è¿™ä¸ªå‘.</p>
<h4 id="timeout"><a href="#timeout" class="headerlink" title="timeout"></a>timeout</h4><p>åŒä¸Š, ç”±äºPromiseçš„é™åˆ¶, fetch å¹¶ä¸æ”¯æŒåŸç”Ÿçš„timeoutæœºåˆ¶, ä½†è¿™å¹¶ä¸å¦¨ç¢æˆ‘ä»¬ä½¿ç”¨ Promise.race() å®ç°ä¸€ä¸ª.</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€æ˜“çš„ç‰ˆæœ¬.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">timer</span>(<span class="params">t</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span>=&gt;</span>setTimeout(resolve, t))</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'timeout'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> p = fetch(<span class="string">'https://www.baidu.com'</span>,&#123;<span class="attr">mode</span>:<span class="string">'no-cors'</span>&#125;);</div><div class="line"><span class="built_in">Promise</span>.race([p, timer(<span class="number">1000</span>)]);</div><div class="line"><span class="comment">//"timeout"</span></div></pre></td></tr></table></figure>
<p>å®é™…ä¸Š, æ— è®ºè¶…æ—¶æ—¶é—´è®¾ç½®ä¸ºå¤šé•¿, æ§åˆ¶å°éƒ½å°†è¾“å‡ºlog â€œtimeoutâ€. è¿™æ˜¯å› ä¸º, å³ä½¿fetchæ‰§è¡ŒæˆåŠŸ, å¤–éƒ¨çš„promiseæ‰§è¡Œå®Œæ¯•, æ­¤æ—¶ setTimeout æ‰€åœ¨çš„é‚£ä¸ªpromiseä¹Ÿä¸ä¼šreject.</p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç±»ä¼¼xhrç‰ˆæœ¬çš„timeout.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _fetch = (<span class="function"><span class="keyword">function</span>(<span class="params">fetch</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">url,options</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> abort = <span class="literal">null</span>,</div><div class="line">        timeout = <span class="number">0</span>;</div><div class="line">    <span class="keyword">var</span> abort_promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</div><div class="line">      abort = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        reject(<span class="string">'timeout.'</span>);</div><div class="line">        <span class="built_in">console</span>.info(<span class="string">'abort done.'</span>);</div><div class="line">      &#125;;</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">var</span> promise = <span class="built_in">Promise</span>.race([</div><div class="line">      fetch(url,options),</div><div class="line">      abort_promise</div><div class="line">    ]);</div><div class="line">    promise.abort = abort;</div><div class="line">    <span class="built_in">Object</span>.defineProperty(promise, <span class="string">'timeout'</span>,&#123;</div><div class="line">      <span class="attr">set</span>: <span class="function"><span class="keyword">function</span>(<span class="params">ts</span>)</span>&#123;</div><div class="line">        <span class="keyword">if</span>((ts=+ts))&#123;</div><div class="line">          timeout = ts;</div><div class="line">          setTimeout(abort,ts);</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> timeout;</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">return</span> promise;</div><div class="line">  &#125;;</div><div class="line">&#125;)(fetch);</div></pre></td></tr></table></figure>
<p>ç„¶å, ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•æµ‹è¯•æ–°çš„fetch.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = _fetch(<span class="string">'https://www.baidu.com'</span>,&#123;<span class="attr">mode</span>:<span class="string">'no-cors'</span>&#125;);</div><div class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'response:'</span>, res);</div><div class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'error:'</span>, e);</div><div class="line">&#125;);</div><div class="line">p.timeout = <span class="number">1</span>;</div><div class="line"><span class="comment">//"abort done."</span></div><div class="line"><span class="comment">//"error: timeout."</span></div></pre></td></tr></table></figure>
<h4 id="progress"><a href="#progress" class="headerlink" title="progress"></a>progress</h4><p>xhrçš„ onprogress è®©æˆ‘ä»¬å¯ä»¥æŒæ§ä¸‹è½½è¿›åº¦, fetchæ˜¾ç„¶æ²¡æœ‰æä¾›åŸç”Ÿapi åšç±»ä¼¼çš„äº‹æƒ…. ä¸è¿‡ Fetchä¸­çš„<code>Response.body</code> ä¸­å®ç°äº†<code>getReader()</code>æ–¹æ³•ç”¨äºè¯»å–åŸå§‹å­—èŠ‚æµ, è¯¥å­—èŠ‚æµå¯ä»¥å¾ªç¯è¯»å–, ç›´åˆ°bodyä¸‹è½½å®Œæˆ. å› æ­¤æˆ‘ä»¬å®Œå…¨å¯ä»¥æ¨¡æ‹Ÿfetchçš„progress.</p>
<p>ä»¥ä¸‹æ˜¯ stackoverflow ä¸Šçš„ä¸€æ®µä»£ç , ç”¨äºæ¨¡æ‹Ÿfetchçš„progressäº‹ä»¶. ä¸ºäº†æ–¹ä¾¿æµ‹è¯•, è¯·æ±‚urlå·²æ”¹ä¸ºæœ¬åœ°æœåŠ¡.(åŸæ–‡è¯·æˆ³ <a href="http://stackoverflow.com/questions/35711724/progress-indicators-for-fetch" target="_blank" rel="external">javascript - Progress indicators for fetch? - Stack Overflow</a>)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">consume</span>(<span class="params">reader</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> total = <span class="number">0</span></div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">pump</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      reader.read().then(<span class="function">(<span class="params">&#123;done, value&#125;</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">if</span> (done) &#123;</div><div class="line">          resolve();</div><div class="line">          <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        total += value.byteLength;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">`received <span class="subst">$&#123;value.byteLength&#125;</span> bytes (<span class="subst">$&#123;total&#125;</span> bytes in total)`</span>);</div><div class="line">        pump();</div><div class="line">      &#125;).catch(reject)</div><div class="line">    &#125;</div><div class="line">    pump();</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line">fetch(<span class="string">'http://localhost:10101/notification/'</span>,&#123;<span class="attr">mode</span>:<span class="string">'no-cors'</span>&#125;)</div><div class="line">  .then(<span class="function"><span class="params">res</span> =&gt;</span> consume(res.body.getReader()))</div><div class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"consumed the entire body without keeping the whole thing in memory!"</span>))</div><div class="line">  .catch(<span class="function"><span class="params">e</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"something went wrong: "</span> + e));</div></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯æ—¥å¿—æˆªå›¾:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax15.png" alt=""></p>
<p>åˆšå¥½githubä¸Šæœ‰ä¸ªfetch progressçš„demo, æ„Ÿå…´è¶£çš„å°ä¼™ä¼´è¯·å‚çœ‹è¿™é‡Œ: <a href="https://labs.jxck.io/fetch/progress.html" target="_blank" rel="external">Fetch Progress DEMO</a> .</p>
<p>æˆ‘ä»¬ä¸å¦¨æ¥å¯¹æ¯”ä¸‹, ä½¿ç”¨xhrçš„onprogressäº‹ä»¶å›è°ƒ, è¾“å‡ºå¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/ajax16.png" alt=""></p>
<p>æˆ‘è¯•ç€é€‚å½“å¢åŠ å“åº”bodyçš„size, å‘ç°xhrçš„onprogressäº‹ä»¶å›è°ƒä¾ç„¶åªæ‰§è¡Œä¸¤æ¬¡. é€šè¿‡å¤šæ¬¡æµ‹è¯•å‘ç°å…¶æ‰§è¡Œé¢‘ç‡æ¯”è¾ƒä½, è¿œä¸åŠfetch progress.</p>
<hr>
<p>æœ¬é—®å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/10/19/fetch/">http://louiszhai.github.io/2016/10/19/fetch/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="https://fetch.spec.whatwg.org/#forbidden-header-name" target="_blank" rel="external">Fetch Standard</a></li>
<li><a href="https://segmentfault.com/a/1190000003810652" target="_blank" rel="external">ä¼ ç»Ÿ Ajax å·²æ­»ï¼ŒFetch æ°¸ç”Ÿ - ä¼šå½± - SegmentFault</a></li>
<li><a href="https://cnodejs.org/topic/5640b80d3a6aa72c5e0030b6" target="_blank" rel="external">ä½“éªŒå¼‚æ­¥çš„ç»ˆæè§£å†³æ–¹æ¡ˆ-ES7çš„Async/Await - CNodeæŠ€æœ¯ç¤¾åŒº</a></li>
<li><a href="https://tc39.github.io/ecma262/#sec-promise-constructor" target="_blank" rel="external">ES6-Promise</a></li>
<li><a href="http://www.tuicool.com/articles/QZBJ7zJ" target="_blank" rel="external">è¯‘-JavaScript Fetch API - æ¨é…·</a></li>
<li><a href="http://imweb.io/topic/57c6ea35808fd2fb204eef63" target="_blank" rel="external">è®©fetchä¹Ÿå¯ä»¥timeout - è…¾è®¯Webå‰ç«¯ IMWeb å›¢é˜Ÿç¤¾åŒº | blog | å›¢é˜Ÿåšå®¢</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      fetch async await mode promise progress abort
    
    </summary>
    
    
      <category term="javascript" scheme="http://louiszhai.github.io/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>å…¨é¢è§£è¯»Mathå¯¹è±¡åŠä½è¿ç®—</title>
    <link href="http://louiszhai.github.io/2016/07/01/Math/"/>
    <id>http://louiszhai.github.io/2016/07/01/Math/</id>
    <published>2016-06-30T23:57:48.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>æˆªè‡³ES5, JavaScript ä¸­å†…ç½®(build-in)æ„é€ å™¨/å¯¹è±¡å…±æœ‰13ä¸ª, å…¶ä¸­9ä¸ªæ˜¯æ„é€ å™¨(Number,Boolean, String, Object, Function, Array, RegExp, Error, Date), Global ä¸èƒ½ç›´æ¥è®¿é—®, Argumentsä»…åœ¨å‡½æ•°è°ƒç”¨æ—¶ç”±JSå¼•æ“åˆ›å»º, è€Œ Math, JSON æ˜¯ä»¥å¯¹è±¡å½¢å¼å­˜åœ¨çš„, æœ¬ç¯‡å°†å¸¦ä½ èµ°è¿› JS å†…ç½®å¯¹è±¡-Mathä»¥åŠä¸ä¹‹æ¯æ¯ç›¸å…³çš„ä½è¿ç®—, ä¸€æ¢ç©¶ç«Ÿ.</p>
<a id="more"></a>
<h3 id="ä¸ºä»€ä¹ˆMathè¿™ä¹ˆè®¾è®¡"><a href="#ä¸ºä»€ä¹ˆMathè¿™ä¹ˆè®¾è®¡" class="headerlink" title="ä¸ºä»€ä¹ˆMathè¿™ä¹ˆè®¾è®¡"></a>ä¸ºä»€ä¹ˆMathè¿™ä¹ˆè®¾è®¡</h3><p>ä¼—æ‰€å‘¨çŸ¥, å¦‚æœéœ€è¦ä½¿ç”¨jsè¿›è¡Œä¸€äº›å¸¸è§„çš„æ•°å­¦è¿ç®—, æ˜¯ä¸€ä»¶ååˆ†éº»çƒ¦çš„äº‹æƒ…. ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜, ECMAScript åœ¨1.1ç‰ˆæœ¬ä¸­ä¾¿å¼•å…¥äº† Math. Math ä¹‹æ‰€ä»¥è¢«è®¾è®¡æˆä¸€ä¸ªå¯¹è±¡, è€Œä¸æ˜¯æ„é€ å™¨, æ˜¯å› ä¸ºå¯¹è±¡ä¸­çš„æ–¹æ³•æˆ–å±æ€§å¯ä»¥ä½œä¸ºé™æ€æ–¹æ³•æˆ–å¸¸é‡ç›´æ¥è¢«è°ƒç”¨, æ–¹ä¾¿ä½¿ç”¨, åŒæ—¶, Math ä¹Ÿæ²¡æœ‰åˆ›å»ºå®ä¾‹çš„å¿…è¦.</p>
<h3 id="Mathä¸­çš„å±æ€§"><a href="#Mathä¸­çš„å±æ€§" class="headerlink" title="Mathä¸­çš„å±æ€§"></a>Mathä¸­çš„å±æ€§</h3><table>
<thead>
<tr>
<th style="text-align:center">å±æ€§å</th>
<th style="text-align:center">æè¿°</th>
<th style="text-align:center">å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Math.E</td>
<td style="text-align:center">æ¬§æ‹‰å¸¸æ•°ï¼Œä¹Ÿæ˜¯è‡ªç„¶å¯¹æ•°çš„åº•æ•°</td>
<td style="text-align:center">çº¦2.718</td>
</tr>
<tr>
<td style="text-align:center">Math.LN2</td>
<td style="text-align:center">2çš„è‡ªç„¶å¯¹æ•°</td>
<td style="text-align:center">çº¦0.693</td>
</tr>
<tr>
<td style="text-align:center">Math.LN10</td>
<td style="text-align:center">10çš„è‡ªç„¶å¯¹æ•°</td>
<td style="text-align:center">çº¦2.303</td>
</tr>
<tr>
<td style="text-align:center">Math.LOG2E</td>
<td style="text-align:center">ä»¥2ä¸ºåº•Eçš„å¯¹æ•°</td>
<td style="text-align:center">çº¦1.443</td>
</tr>
<tr>
<td style="text-align:center">Math.LOG10E</td>
<td style="text-align:center">ä»¥10ä¸ºåº•Eçš„å¯¹æ•°</td>
<td style="text-align:center">çº¦0.434</td>
</tr>
<tr>
<td style="text-align:center">Math.PI</td>
<td style="text-align:center">åœ†å‘¨ç‡</td>
<td style="text-align:center">çº¦3.14</td>
</tr>
<tr>
<td style="text-align:center">Math.SQRT1_2</td>
<td style="text-align:center">1/2çš„å¹³æ–¹æ ¹</td>
<td style="text-align:center">çº¦0.707</td>
</tr>
<tr>
<td style="text-align:center">Math.SQRT2</td>
<td style="text-align:center">2çš„å¹³æ–¹æ ¹</td>
<td style="text-align:center">çº¦1.414</td>
</tr>
</tbody>
</table>
<h3 id="Mathä¸­çš„æ–¹æ³•"><a href="#Mathä¸­çš„æ–¹æ³•" class="headerlink" title="Mathä¸­çš„æ–¹æ³•"></a>Mathä¸­çš„æ–¹æ³•</h3><p>Mathå¯¹è±¡æœ¬å°±æœ‰å¾ˆå¤šç”¨äºè¿ç®—çš„æ–¹æ³•, å€¼å¾—å…³æ³¨çš„æ˜¯, ES6 è§„èŒƒåˆå¯¹Mathå¯¹è±¡åšäº†ä¸€äº›æ‰©å±•, å¢åŠ äº†ä¸€ç³»åˆ—ä¾¿æ·çš„æ–¹æ³•. è€Œè¿™äº›æ–¹æ³•å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±».</p>
<h4 id="ä¸‰è§’å‡½æ•°"><a href="#ä¸‰è§’å‡½æ•°" class="headerlink" title="ä¸‰è§’å‡½æ•°"></a>ä¸‰è§’å‡½æ•°</h4><table>
<thead>
<tr>
<th style="text-align:center">æ–¹æ³•å</th>
<th style="text-align:center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Math.sin(x)</td>
<td style="text-align:center">è¿”å›xçš„æ­£å¼¦å€¼</td>
</tr>
<tr>
<td style="text-align:center">Math.sinh(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›xçš„åŒæ›²æ­£å¼¦å€¼</td>
</tr>
<tr>
<td style="text-align:center">Math.cos(x)</td>
<td style="text-align:center">è¿”å›xçš„ä½™å¼¦å€¼</td>
</tr>
<tr>
<td style="text-align:center">Math.cosh(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›xçš„åŒæ›²ä½™å¼¦å€¼</td>
</tr>
<tr>
<td style="text-align:center">Math.tan(x)</td>
<td style="text-align:center">è¿”å›xçš„æ­£åˆ‡å€¼</td>
</tr>
<tr>
<td style="text-align:center">Math.tanh(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›xçš„åŒæ›²æ­£åˆ‡å€¼</td>
</tr>
<tr>
<td style="text-align:center">Math.asin(x)</td>
<td style="text-align:center">è¿”å›xçš„åæ­£å¼¦å€¼</td>
</tr>
<tr>
<td style="text-align:center">Math.asinh(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›xçš„ååŒæ›²æ­£å¼¦å€¼</td>
</tr>
<tr>
<td style="text-align:center">Math.acos(x)</td>
<td style="text-align:center">è¿”å›xçš„åä½™å¼¦å€¼</td>
</tr>
<tr>
<td style="text-align:center">Math.atan(x)</td>
<td style="text-align:center">è¿”å›xçš„åæ­£åˆ‡å€¼</td>
</tr>
<tr>
<td style="text-align:center">Math.atan2(x, y)</td>
<td style="text-align:center">è¿”å› y/x çš„åæ­£åˆ‡å€¼</td>
</tr>
<tr>
<td style="text-align:center">Math.atanh(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å› x çš„ååŒæ›²æ­£åˆ‡å€¼</td>
</tr>
</tbody>
</table>
<h4 id="æ•°å­¦è¿ç®—æ–¹æ³•"><a href="#æ•°å­¦è¿ç®—æ–¹æ³•" class="headerlink" title="æ•°å­¦è¿ç®—æ–¹æ³•"></a>æ•°å­¦è¿ç®—æ–¹æ³•</h4><table>
<thead>
<tr>
<th style="text-align:center">æ–¹æ³•å</th>
<th style="text-align:center">æè¿°</th>
<th style="text-align:center">ä¾‹å­</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Math.sqrt(x)</td>
<td style="text-align:center">è¿”å›xçš„å¹³æ–¹æ ¹</td>
<td style="text-align:center">Math.sqrt(9);//3</td>
</tr>
<tr>
<td style="text-align:center">Math.exp(x)</td>
<td style="text-align:center">è¿”å›æ¬§æ‹‰å¸¸æ•°(e)çš„xæ¬¡å¹‚</td>
<td style="text-align:center">Math.exp(1);//çº¦2.718</td>
</tr>
<tr>
<td style="text-align:center">Math.pow(x,y)</td>
<td style="text-align:center">è¿”å›xçš„yæ¬¡å¹‚, å¦‚æœyæœªåˆå§‹åŒ–, åˆ™è¿”å›x</td>
<td style="text-align:center">Math.pow(2, 3);//8</td>
</tr>
<tr>
<td style="text-align:center">Math.expm1(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›æ¬§æ‹‰å¸¸æ•°(e)çš„xæ¬¡å¹‚å‡å»1çš„å€¼</td>
<td style="text-align:center">Math.exp(1);//çº¦1.718</td>
</tr>
<tr>
<td style="text-align:center">Math.log(x)</td>
<td style="text-align:center">è¿”å›xçš„è‡ªç„¶å¯¹æ•°</td>
<td style="text-align:center">Math.log(1);//0</td>
</tr>
<tr>
<td style="text-align:center">Math.log1p(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›x+1åçš„è‡ªç„¶å¯¹æ•°</td>
<td style="text-align:center">Math.log1p(0);//0</td>
</tr>
<tr>
<td style="text-align:center">Math.log2(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›xä»¥2ä¸ºåº•çš„å¯¹æ•°</td>
<td style="text-align:center">Math.log2(8);//3</td>
</tr>
<tr>
<td style="text-align:center">Math.log10(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›xä»¥10ä¸ºåº•çš„å¯¹æ•°</td>
<td style="text-align:center">Math.log10(100);//2</td>
</tr>
<tr>
<td style="text-align:center">Math.cbrt(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›xçš„ç«‹æ–¹æ ¹</td>
<td style="text-align:center">Math.cbrt(8);//çº¦2</td>
</tr>
<tr>
<td style="text-align:center">Math.clz32()  ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›ä¸€ä¸ªæ•°å­—åœ¨è½¬æ¢æˆ 32ä½æ— ç¬¦å·æ•´å‹æ•°å­—çš„äºŒè¿›åˆ¶å½¢å¼å, å¼€å¤´çš„ 0 çš„ä¸ªæ•°</td>
<td style="text-align:center">Math.clz32(2);//30</td>
</tr>
<tr>
<td style="text-align:center">Math.hypot(x,y,z) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›æ‰€æœ‰å‚æ•°çš„å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹</td>
<td style="text-align:center">Math.hypot(3,4);//5</td>
</tr>
<tr>
<td style="text-align:center">Math.imul(x,y) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›ä¸¤ä¸ªå‚æ•°çš„ç±»Cçš„32ä½æ•´æ•°ä¹˜æ³•è¿ç®—çš„è¿ç®—ç»“æœ</td>
<td style="text-align:center">Math.imul(0xffffffff, 5);//-5</td>
</tr>
</tbody>
</table>
<h4 id="æ•°å€¼è¿ç®—æ–¹æ³•"><a href="#æ•°å€¼è¿ç®—æ–¹æ³•" class="headerlink" title="æ•°å€¼è¿ç®—æ–¹æ³•"></a>æ•°å€¼è¿ç®—æ–¹æ³•</h4><table>
<thead>
<tr>
<th style="text-align:center">æ–¹æ³•å</th>
<th style="text-align:center">æè¿°</th>
<th style="text-align:center">ä¾‹å­</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Math.abs(x)</td>
<td style="text-align:center">è¿”å›xçš„ç»å¯¹å€¼</td>
<td style="text-align:center">Math.abs(-5);//5</td>
</tr>
<tr>
<td style="text-align:center">Math.floor(x)</td>
<td style="text-align:center">è¿”å›å°äºxçš„æœ€å¤§æ•´æ•°</td>
<td style="text-align:center">Math.floor(8.2);//8</td>
</tr>
<tr>
<td style="text-align:center">Math.ceil(x)</td>
<td style="text-align:center">è¿”å›å¤§äºxçš„æœ€å°æ•´æ•°</td>
<td style="text-align:center">Math.ceil(8.2);//9</td>
</tr>
<tr>
<td style="text-align:center">Math.trunc(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›xçš„æ•´æ•°éƒ¨åˆ†</td>
<td style="text-align:center">Math.trunc(1.23);//1</td>
</tr>
<tr>
<td style="text-align:center">Math.fround(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›ç¦»å®ƒæœ€è¿‘çš„<a href="https://en.wikipedia.org/wiki/Single-precision_floating-point_format" target="_blank" rel="external">å•ç²¾åº¦æµ®ç‚¹æ•°</a>å½¢å¼çš„æ•°å­—</td>
<td style="text-align:center">Math.fround(1.1);//1.100000023841858</td>
</tr>
<tr>
<td style="text-align:center">Math.min(x,y,z)</td>
<td style="text-align:center">è¿”å›å¤šä¸ªæ•°ä¸­çš„æœ€å°å€¼</td>
<td style="text-align:center">Math.min(3,1,5);//1</td>
</tr>
<tr>
<td style="text-align:center">Math.max(x,y,z)</td>
<td style="text-align:center">è¿”å›å¤šä¸ªæ•°ä¸­çš„æœ€å¤§å€¼</td>
<td style="text-align:center">Math.max(3,1,5);//5</td>
</tr>
<tr>
<td style="text-align:center">Math.round(x)</td>
<td style="text-align:center">è¿”å›å››èˆäº”å…¥åçš„æ•´æ•°</td>
<td style="text-align:center">Math.round(8.2);//8</td>
</tr>
<tr>
<td style="text-align:center">Math.random()</td>
<td style="text-align:center">è¿”å›0åˆ°1ä¹‹é—´çš„ä¼ªéšæœºæ•°</td>
<td style="text-align:center">Math.random();</td>
</tr>
<tr>
<td style="text-align:center">Math.sign(x) ES6æ–°å¢</td>
<td style="text-align:center">è¿”å›ä¸€ä¸ªæ•°çš„ç¬¦å·( 5ç§è¿”å›å€¼, åˆ†åˆ«æ˜¯ 1, -1, 0, -0, NaN. ä»£è¡¨çš„å„æ˜¯æ­£æ•°, è´Ÿæ•°, æ­£é›¶, è´Ÿé›¶, NaN)</td>
<td style="text-align:center">Math.sign(-5);//-1</td>
</tr>
</tbody>
</table>
<h4 id="é™„-Numberç±»å‹çš„æ•°å€¼è¿ç®—æ–¹æ³•"><a href="#é™„-Numberç±»å‹çš„æ•°å€¼è¿ç®—æ–¹æ³•" class="headerlink" title="é™„:Numberç±»å‹çš„æ•°å€¼è¿ç®—æ–¹æ³•"></a>é™„:Numberç±»å‹çš„æ•°å€¼è¿ç®—æ–¹æ³•</h4><p>Number.prototypeä¸­æœ‰ä¸€ä¸ªæ–¹æ³•å«åštoFixed(), ç”¨äºå°†æ•°å€¼è£…æ¢ä¸ºæŒ‡å®šå°æ•°ä½æ•°çš„å½¢å¼. </p>
<ul>
<li>æ²¡æœ‰å‚æ•°æˆ–è€…å‚æ•°ä¸ºé›¶çš„æƒ…å†µä¸‹, toFixed() æ–¹æ³•è¿”å›è¯¥æ•°å€¼çš„å››èˆäº”å…¥åçš„æ•´æ•°å½¢å¼, ç­‰åŒäº Math.round(x);</li>
<li>å…¶ä»–æƒ…å†µä¸‹, è¿”å›è¯¥æ•°çš„æŒ‡å®šå°æ•°ä½æ•°çš„å››èˆäº”å…¥åçš„ç»“æœ.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> num = <span class="number">1234.56789</span>;</div><div class="line"><span class="built_in">console</span>.log(num.toFixed(),num.toFixed(<span class="number">0</span>));<span class="comment">//1235,1235</span></div><div class="line"><span class="built_in">console</span>.log(num.toFixed(<span class="number">1</span>));<span class="comment">//1234.6</span></div><div class="line"><span class="built_in">console</span>.log(<span class="number">-1.235</span>.toFixed(<span class="number">2</span>));<span class="comment">//-1.24</span></div></pre></td></tr></table></figure>
<h3 id="Mathæ–¹æ³•çš„ä¸€äº›è§„å¾‹"><a href="#Mathæ–¹æ³•çš„ä¸€äº›è§„å¾‹" class="headerlink" title="Mathæ–¹æ³•çš„ä¸€äº›è§„å¾‹"></a>Mathæ–¹æ³•çš„ä¸€äº›è§„å¾‹</h3><p>ä»¥ä¸Š, æ•°å€¼è¿ç®—ä¸­, å­˜åœ¨å¦‚ä¸‹è§„å¾‹:</p>
<ol>
<li>Math.trunc(x) æ–¹æ³•å½“ â‘  xä¸ºæ­£æ•°æ—¶, è¿ç®—ç»“æœåŒ Math.floor(x); â‘¡ xä¸ºè´Ÿæ•°æ—¶, è¿ç®—ç»“æœåŒ Math.ceil(x). å®é™…ä¸Š, å®ƒå®Œå…¨å¯ä»¥ç”±ä½è¿ç®—æ›¿ä»£, ä¸”è¿ç®—é€Ÿåº¦æ›´å¿«, å¦‚ 2.5&amp;-1 æˆ– 2.5|0 æˆ– ~~2.5 æˆ– 2.5^0 , å®ƒä»¬çš„è¿ç®—ç»“æœéƒ½ä¸º2; å¦‚ -2.5&amp;-1 æˆ– -2.5|0 æˆ– ~~-2.5 æˆ– -2.5^0 , å®ƒä»¬çš„è¿ç®—ç»“æœéƒ½ä¸º-2;</li>
<li>Math.min(x,y,z) ä¸ Math.max(x,y,z) æ–¹æ³•ç”±äºå¯æ¥æ— é™ä¸ªå‚æ•°, å¯ç”¨äºæ±‚æ•°ç»„å…ƒç´ çš„æœ€å°æœ€å¤§å€¼. å¦‚: <code>Math.max.apply(null,[5,3,8,9]); // 9</code> . ä½†æ˜¯Math.min ä¸ä¼ å‚æ•°è¿”å› <code>Infinity</code>, Math.max ä¸ä¼ å‚æ•°è¿”å› <code>-Infinity</code> .</li>
<li>ç¨å¾®åˆ©ç”¨ Math.random() æ–¹æ³•çš„ç‰¹æ€§, å°±å¯ä»¥ç”Ÿæˆä»»æ„èŒƒå›´çš„æ•°å­—. å¦‚: ç”Ÿæˆ10åˆ°80ä¹‹é—´çš„éšæœºæ•°, ~~(Math.random()*70 + 10);// è¿”å›10~80ä¹‹é—´çš„éšæœºæ•°, åŒ…å«10ä¸åŒ…å«80</li>
</ol>
<p>é™¤å»ä¸Šè¿°æ–¹æ³•, Mathä½œä¸ºå¯¹è±¡, ç»§æ‰¿äº†æ¥ä¹‹Objectå¯¹è±¡çš„æ–¹æ³•. å…¶ä¸­ä¸€äº›å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.valueOf();<span class="comment">//è¿”å›Mathå¯¹è±¡æœ¬èº«</span></div><div class="line">+<span class="built_in">Math</span>; <span class="comment">//NaN, è¯•å›¾è½¬æ¢æˆæ•°å­—,ç”±äºä¸èƒ½è½¬æ¢ä¸ºæ•°å­—,è¿”å›NaN</span></div><div class="line"><span class="built_in">Math</span>.toString();<span class="comment">//"[object Math]"</span></div></pre></td></tr></table></figure>
<h3 id="ä½è¿ç®—"><a href="#ä½è¿ç®—" class="headerlink" title="ä½è¿ç®—"></a>ä½è¿ç®—</h3><p>Mathå¯¹è±¡æä¾›çš„æ–¹æ³•ç§ç±»ç¹å¤š, ä¸”è¦†ç›–é¢éå¸¸å…¨é¢, åŸºæœ¬ä¸Šèƒ½å¤Ÿæ»¡è¶³æ—¥å¸¸å¼€å‘æ‰€éœ€. ä½†åŒæ—¶æˆ‘ä»¬ä¹Ÿéƒ½çŸ¥é“, ä½¿ç”¨Mathå¯¹è±¡çš„æ–¹æ³•è¿›è¡Œæ•°å€¼è¿ç®—æ—¶, jsä»£ç ç»è¿‡è§£é‡Šç¼–è¯‘, æœ€ç»ˆä¼šä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¿›è¡Œè¿ç®—. è¿™ç§è¿ç®—æ–¹å¼æ•ˆç‡è¾ƒä½, é‚£ä¹ˆèƒ½ä¸èƒ½è¿›ä¸€æ­¥æé«˜è¿ç®—çš„æ•ˆç‡çš„å‘¢? å¦‚æœæˆ‘ä»¬ä½¿ç”¨ä½è¿ç®—å°±å¯. è¿™æ˜¯å› ä¸ºä½è¿ç®—æœ¬å°±æ˜¯ç›´æ¥è¿›è¡ŒäºŒè¿›åˆ¶è¿ç®—.</p>
<h4 id="æ•°å€¼çš„äºŒè¿›åˆ¶å€¼"><a href="#æ•°å€¼çš„äºŒè¿›åˆ¶å€¼" class="headerlink" title="æ•°å€¼çš„äºŒè¿›åˆ¶å€¼"></a>æ•°å€¼çš„äºŒè¿›åˆ¶å€¼</h4><p>ç”±äºä½è¿ç®—æ˜¯åŸºäºäºŒè¿›åˆ¶çš„, å› æ­¤æˆ‘ä»¬éœ€è¦å…ˆè·å–æ•°å€¼çš„äºŒè¿›åˆ¶å€¼. å®é™…ä¸Š, toString æ–¹æ³•å·²ç»å¸®æˆ‘ä»¬åšå¥½äº†ä¸€éƒ¨åˆ†å·¥ä½œ, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ­£æ•´æ•°å¯é€šè¿‡toStringè·å–</span></div><div class="line"><span class="number">12.</span>.toString(<span class="number">2</span>);<span class="comment">//1100</span></div><div class="line"><span class="comment">//è´Ÿæ•´æ•°é—®é¢˜å°±æ¥äº†</span></div><div class="line">(<span class="number">-12</span>).toString(<span class="number">2</span>);<span class="comment">//-1100</span></div></pre></td></tr></table></figure>
<p>å·²çŸ¥: è´Ÿæ•°åœ¨è®¡ç®—æœºå†…éƒ¨æ˜¯é‡‡ç”¨è¡¥ç è¡¨ç¤ºçš„. ä¾‹å¦‚ -1, 1çš„åŸç æ˜¯ 0000 0001, é‚£ä¹ˆ1çš„åç æ˜¯ 1111 1110, è¡¥ç æ˜¯ 1111 1111.</p>
<p>æ•…: è´Ÿæ•°çš„åè¿›åˆ¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ—¶,ç¬¦å·ä½ä¸å˜,å…¶å®ƒä½å–åå+1. å³: <strong><code>-xçš„äºŒè¿›åˆ¶ = xçš„äºŒè¿›åˆ¶å–å+1</code></strong> . ç”±æŒ‰ä½å–åå¯å€ŸåŠ©^è¿ç®—ç¬¦, æ•…è´Ÿæ•´æ•°çš„äºŒè¿›åˆ¶å¯ä»¥å€ŸåŠ©ä¸‹é¢è¿™ä¸ªå‡½æ•°æ¥è·å–:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getBinary</span>(<span class="params">num</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> s = (-num).toString(<span class="number">2</span>),</div><div class="line">      array = [].map.call(s,<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> v^<span class="number">1</span>;</div><div class="line">      &#125;);</div><div class="line">  array.reduceRight(<span class="function"><span class="keyword">function</span>(<span class="params">previousValue, value, index, array</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> v = previousValue ^ value;</div><div class="line">    array[index] = v;</div><div class="line">    <span class="keyword">return</span> +!v;</div><div class="line">  &#125;,<span class="number">1</span>);</div><div class="line">  <span class="keyword">return</span> array.join(<span class="string">''</span>);</div><div class="line">&#125;</div><div class="line">getBinary(<span class="number">-12</span>);<span class="comment">//0100, å‰é¢æœªè¡¥å…¨çš„éƒ¨åˆ†å…¨éƒ¨ä¸º1</span></div></pre></td></tr></table></figure>
<p>ç„¶å, å¤šè¯•å‡ æ¬¡å°±ä¼šå‘ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">getBinary(<span class="number">-1</span>) == <span class="number">1.</span>.toString(<span class="number">2</span>); <span class="comment">//true</span></div><div class="line">getBinary(<span class="number">-2</span>) == <span class="number">2.</span>.toString(<span class="number">2</span>); <span class="comment">//true</span></div><div class="line">getBinary(<span class="number">-4</span>) == <span class="number">4.</span>.toString(<span class="number">2</span>); <span class="comment">//true</span></div><div class="line">getBinary(<span class="number">-8</span>) == <span class="number">8.</span>.toString(<span class="number">2</span>); <span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>è¿™è¡¨æ˜:</p>
<ul>
<li><strong>2çš„æ•´æ•°æ¬¡æ–¹çš„å€¼ä¸å®ƒçš„ç›¸å¯¹æ•°, ä»–ä»¬åé¢çœŸæ­£æœ‰æ•ˆçš„é‚£å‡ ä½éƒ½ç›¸åŒ</strong>.</li>
</ul>
<p>åŒæ ·, è´Ÿæ•°çš„äºŒè¿›åˆ¶è½¬åè¿›åˆ¶æ—¶, ç¬¦å·ä½ä¸å˜, å…¶ä»–ä½å–åå+1. å¯å‚è€ƒ:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">translateBinary2Decimal</span>(<span class="params">binaryString</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> array = [].map.call(binaryString,<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> v^<span class="number">1</span>;</div><div class="line">  &#125;);</div><div class="line">  array.reduceRight(<span class="function"><span class="keyword">function</span>(<span class="params">previousValue, value, index, array</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> v = previousValue ^ value;</div><div class="line">    array[index] = v;</div><div class="line">    <span class="keyword">return</span> +!v;</div><div class="line">  &#125;,<span class="number">1</span>);</div><div class="line">  <span class="keyword">return</span> <span class="built_in">parseInt</span>(array.join(<span class="string">''</span>),<span class="number">2</span>);</div><div class="line">&#125;</div><div class="line">translateBinary2Decimal(getBinary(<span class="number">-12</span>));<span class="comment">//12</span></div></pre></td></tr></table></figure>
<p>ç”±ä¸Š, äºŒè¿›åˆ¶è½¬åè¿›åˆ¶å’Œåè¿›åˆ¶è½¬äºŒè¿›åˆ¶çš„å‡½æ•°, å¤§éƒ¨åˆ†éƒ½å¯ä»¥å…±ç”¨, å› æ­¤ä¸‹é¢æä¾›ä¸€ä¸ªç»Ÿä¸€çš„å‡½æ•°è§£å†³å®ƒä»¬çš„äº’è½¬é—®é¢˜:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">translateBinary</span>(<span class="params">item</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> s = <span class="literal">null</span>,</div><div class="line">      array = <span class="literal">null</span>,</div><div class="line">      type = <span class="keyword">typeof</span> item,</div><div class="line">      symbol = !<span class="regexp">/^-/</span>.test(item+<span class="string">''</span>);</div><div class="line">  <span class="keyword">switch</span>(type)&#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">"number"</span>: </div><div class="line">      s = <span class="built_in">Math</span>.abs(item).toString(<span class="number">2</span>);</div><div class="line">      <span class="keyword">if</span>(symbol)&#123;</div><div class="line">        <span class="keyword">return</span> s;</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> <span class="string">"string"</span>:</div><div class="line">      <span class="keyword">if</span>(symbol)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">parseInt</span>(item,<span class="number">2</span>);</div><div class="line">      &#125;</div><div class="line">      s = item.substring(<span class="number">1</span>);</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//æŒ‰ä½å–å</span></div><div class="line">  array = [].map.call(s,<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> v^<span class="number">1</span>;</div><div class="line">  &#125;);</div><div class="line">  <span class="comment">//+1</span></div><div class="line">  array.reduceRight(<span class="function"><span class="keyword">function</span>(<span class="params">previousValue, value, index, array</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> v = (previousValue + value)==<span class="number">2</span>;</div><div class="line">    array[index] = previousValue ^ value;</div><div class="line">    <span class="keyword">return</span> +v;</div><div class="line">  &#125;,<span class="number">1</span>);</div><div class="line">  s = array.join(<span class="string">''</span>);</div><div class="line">  <span class="keyword">return</span> type==<span class="string">"number"</span>?<span class="string">'-'</span>+s:-<span class="built_in">parseInt</span>(s,<span class="number">2</span>);</div><div class="line">&#125;</div><div class="line">translateBinary(<span class="number">-12</span>);<span class="comment">//"-0100"</span></div><div class="line">translateBinary(<span class="string">'-0100'</span>);<span class="comment">//-12</span></div></pre></td></tr></table></figure>
<h4 id="å¸¸ç”¨çš„äºŒè¿›åˆ¶æ•°"><a href="#å¸¸ç”¨çš„äºŒè¿›åˆ¶æ•°" class="headerlink" title="å¸¸ç”¨çš„äºŒè¿›åˆ¶æ•°"></a>å¸¸ç”¨çš„äºŒè¿›åˆ¶æ•°</h4><table>
<thead>
<tr>
<th style="text-align:center">äºŒè¿›åˆ¶æ•°</th>
<th style="text-align:center">äºŒè¿›åˆ¶å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0xAAAAAAAA</td>
<td style="text-align:center">10101010101010101010101010101010</td>
</tr>
<tr>
<td style="text-align:center">0x55555555</td>
<td style="text-align:center">01010101010101010101010101010101</td>
</tr>
<tr>
<td style="text-align:center">0xCCCCCCCC</td>
<td style="text-align:center">11001100110011001100110011001100</td>
</tr>
<tr>
<td style="text-align:center">0x33333333</td>
<td style="text-align:center">00110011001100110011001100110011</td>
</tr>
<tr>
<td style="text-align:center">0xF0F0F0F0</td>
<td style="text-align:center">11110000111100001111000011110000</td>
</tr>
<tr>
<td style="text-align:center">0x0F0F0F0F</td>
<td style="text-align:center">00001111000011110000111100001111</td>
</tr>
<tr>
<td style="text-align:center">0xFF00FF00</td>
<td style="text-align:center">11111111000000001111111100000000</td>
</tr>
<tr>
<td style="text-align:center">0x00FF00FF</td>
<td style="text-align:center">00000000111111110000000011111111</td>
</tr>
<tr>
<td style="text-align:center">0xFFFF0000</td>
<td style="text-align:center">11111111111111110000000000000000</td>
</tr>
<tr>
<td style="text-align:center">0x0000FFFF</td>
<td style="text-align:center">00000000000000001111111111111111</td>
</tr>
</tbody>
</table>
<p>ç°åœ¨ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šè¿°æ–¹æ³•æ¥éªŒè¯ä¸‹å¸¸ç”¨çš„äºŒè¿›åˆ¶å€¼å¯¹ä¸å¯¹. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">translateBinary(<span class="number">0xAAAAAAAA</span>);<span class="comment">//"10101010101010101010101010101010"</span></div></pre></td></tr></table></figure>
<h4 id="æŒ‰ä½ä¸-amp"><a href="#æŒ‰ä½ä¸-amp" class="headerlink" title="æŒ‰ä½ä¸(&amp;)"></a>æŒ‰ä½ä¸(&amp;)</h4><p>&amp;è¿ç®—ç¬¦ç”¨äºè¿æ¥ä¸¤ä¸ªæ•°, è¿æ¥çš„ä¸¤ä¸ªæ•°å®ƒä»¬äºŒè¿›åˆ¶è¡¥ç å½¢å¼çš„å€¼æ¯ä½éƒ½å°†å‚ä¸è¿ç®—, åªæœ‰ç›¸å¯¹åº”çš„ä½ä¸Šéƒ½ä¸º1æ—¶, è¯¥ä½çš„è¿ç®—æ‰è¿”å›1. æ¯”å¦‚ 3 å’Œ 9 è¿›è¡ŒæŒ‰ä½ä¸è¿ç®—, ä»¥ä¸‹æ˜¯è¿ç®—è¿‡ç¨‹:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="code">	0011	//3çš„äºŒè¿›åˆ¶è¡¥ç å½¢å¼</span></div><div class="line"><span class="section">&amp;	1001	//9çš„äºŒè¿›åˆ¶è¡¥ç å½¢å¼</span></div><div class="line">--------------------</div><div class="line"><span class="code">	0001	//1,ç›¸åŒä½æ•°ä¾æ¬¡è¿ç®—,é™¤æœ€åä¸€ä½éƒ½æ˜¯1,è¿”å›1ä»¥å¤–, å…¶å®ƒä½æ•°ç”±äºä¸åŒæ—¶ä¸º1éƒ½è¿”å›0</span></div></pre></td></tr></table></figure>
<p>ç”±ä¸Š, 3&amp;9çš„è¿ç®—ç»“æœä¸º1. å®é™…ä¸Š, ç”±äºæŒ‰ä½ä¸(&amp;)è¿ç®—åŒä½ä¸Šè¿”å›1çš„è¦æ±‚è¾ƒä¸ºä¸¥è‹›, å› æ­¤, å®ƒæ˜¯ä¸€ç§è¶‹å‘å‡å°æœ€å¤§å€¼çš„è¿ç®—.(æ— è®ºæœ€å¤§å€¼æ˜¯æ­£æ•°è¿˜æ˜¯è´Ÿæ•°, å‚ä¸æŒ‰ä½ä¸è¿ç®—å, è¯¥æ•°æ€»æ˜¯è¶‹å‘å‡å°‘äºŒè¿›åˆ¶å€¼ä½ä¸Š1çš„æ•°é‡, å› æ­¤æ€»æ˜¯æœ‰å€¼å‡å°çš„è¶‹åŠ¿. ) å¯¹äºæŒ‰ä½ä¸(&amp;)è¿ç®—, æ»¡è¶³å¦‚ä¸‹è§„å¾‹:</p>
<ol>
<li><strong>æ•°å€¼ä¸è‡ªèº«(æˆ–è€…-1)æŒ‰ä½ä¸è¿ç®—è¿”å›æ•°å€¼è‡ªèº«</strong>.</li>
<li><strong>2çš„æ•´æ•°æ¬¡æ–¹çš„å€¼ä¸å®ƒçš„ç›¸å¯¹æ•°æŒ‰ä½ä¸è¿ç®—è¿”å›å®ƒè‡ªèº«</strong>.</li>
<li><strong>ä»»æ„æ•´æ•°ä¸0è¿›è¡ŒæŒ‰ä½ä¸è¿ç®—, éƒ½å°†ä¼šè¿”å›0</strong>.</li>
<li><strong>ä»»æ„æ•´æ•°ä¸1è¿›è¡ŒæŒ‰ä½ä¸è¿ç®—, éƒ½åªæœ‰0 æˆ–1 ä¸¤ä¸ªè¿”å›å€¼</strong>.</li>
<li><strong>æŒ‰ä½ä¸è¿ç®—çš„ç»“æœä¸å¤§äºä¸¤æ•°ä¸­çš„æœ€å¤§å€¼</strong>.</li>
</ol>
<p>ç”±å…¬å¼1, æˆ‘ä»¬å¯ä»¥å¯¹éæ•´æ•°å–æ•´. å³ <code>x&amp;x === x&amp;-1 === Math.trunc(x)</code> å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="number">5.2</span>&amp;<span class="number">5.2</span>);<span class="comment">//5</span></div><div class="line"><span class="built_in">console</span>.log(<span class="number">-5.2</span>&amp;<span class="number">-1</span>);<span class="comment">//-5</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.trunc(<span class="number">-5.2</span>)===(<span class="number">-5.2</span>&amp;<span class="number">-1</span>));<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>ç”±å…¬å¼4, æˆ‘ä»¬å¯ä»¥ç”±æ­¤åˆ¤æ–­æ•°å€¼æ˜¯å¦ä¸ºå¥‡æ•°. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(<span class="number">1</span> &amp; x)&#123;<span class="comment">//å¦‚æœxä¸ºå¥‡æ•°,å®ƒçš„äºŒè¿›åˆ¶è¡¥ç å½¢å¼æœ€åä¸€ä½å¿…ç„¶æ˜¯1,åŒ1è¿›è¡ŒæŒ‰ä½ä¸è¿ç®—å,å°†è¿”å›1,è€Œ1åˆä¼šéšå¼è½¬æ¢ä¸ºtrue</span></div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"xä¸ºå¥‡æ•°"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="æŒ‰ä½æˆ–"><a href="#æŒ‰ä½æˆ–" class="headerlink" title="æŒ‰ä½æˆ–(|)"></a>æŒ‰ä½æˆ–(|)</h4><p>|ä¸åŒäº&amp;, |è¿ç®—ç¬¦è¿æ¥çš„ä¸¤ä¸ªæ•°, åªè¦å…¶äºŒè¿›åˆ¶è¡¥ç å½¢å¼çš„å„ä½ä¸Šæœ‰ä¸€ä¸ªä¸º1, è¯¥ä½çš„è¿ç®—å°±è¿”å›1, å¦åˆ™è¿”å›0. æ¯”å¦‚ 3 å’Œ 12 è¿›è¡ŒæŒ‰ä½æˆ–è¿ç®—, ä»¥ä¸‹æ˜¯è¿ç®—è¿‡ç¨‹:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="code">	0011	//3çš„äºŒè¿›åˆ¶è¡¥ç å½¢å¼</span></div><div class="line"><span class="section">|	1100	//12çš„äºŒè¿›åˆ¶è¡¥ç å½¢å¼</span></div><div class="line">--------------------</div><div class="line"><span class="code">	1111	//15, ç›¸åŒä½æ•°ä¾æ¬¡è¿ç®—,é‡1è¿”å›1,æ•…æœ€ç»ˆç»“æœä¸º4ä¸ª1.</span></div></pre></td></tr></table></figure>
<p>ç”±ä¸Š, 3|12çš„è¿ç®—ç»“æœä¸º15. å®é™…ä¸Š, ç”±äºæŒ‰ä½ä¸(&amp;)è¿ç®—åŒä½ä¸Šè¿”å›0çš„è¦æ±‚è¾ƒä¸ºä¸¥è‹›, å› æ­¤, å®ƒæ˜¯ä¸€ç§è¶‹å‘å¢å¤§æœ€å°å€¼çš„è¿ç®—. å¯¹äºæŒ‰ä½æˆ–(|)è¿ç®—, æ»¡è¶³å¦‚ä¸‹è§„å¾‹: </p>
<ol>
<li><strong>æ•°å€¼ä¸è‡ªèº«æŒ‰ä½æˆ–è¿ç®—è¿”å›æ•°å€¼è‡ªèº«</strong>.</li>
<li><strong>2çš„æ•´æ•°æ¬¡æ–¹çš„å€¼ä¸å®ƒçš„ç›¸å¯¹æ•°æŒ‰ä½æˆ–è¿ç®—è¿”å›å®ƒçš„ç›¸å¯¹æ•°</strong>.</li>
<li><strong>ä»»æ„æ•´æ•°ä¸0è¿›è¡ŒæŒ‰ä½æˆ–è¿ç®—, éƒ½å°†ä¼šè¿”å›å®ƒæœ¬èº«</strong>.</li>
<li><strong>ä»»æ„æ•´æ•°ä¸-1è¿›è¡ŒæŒ‰ä½æˆ–è¿ç®—, éƒ½å°†è¿”å›-1</strong>.</li>
<li><strong>æŒ‰ä½æˆ–è¿ç®—çš„ç»“æœä¸å°äºä¸¤æ•°ä¸­çš„æœ€å°å€¼</strong>.</li>
</ol>
<p>ç¨å¾®åˆ©ç”¨å…¬å¼1, æˆ‘ä»¬ä¾¿å¯ä»¥å°†éæ•´æ•°å–æ•´.   å³ <strong><code>x|0 === Math.trunc(x)</code></strong> å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="number">5.2</span>|<span class="number">0</span>);<span class="comment">//5</span></div><div class="line"><span class="built_in">console</span>.log(<span class="number">-5.2</span>|<span class="number">0</span>);<span class="comment">//-5</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.trunc(<span class="number">-5.2</span>)===(<span class="number">-5.2</span>|<span class="number">0</span>));<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆ 5.2|0 è¿ç®—åä¼šè¿”å›5å‘¢? è¿™æ˜¯å› ä¸ºæµ®ç‚¹æ•°å¹¶ä¸æ”¯æŒä½è¿ç®—, è¿ç®—å‰, 5.2ä¼šè½¬æ¢ä¸ºæ•´æ•°5å†å’Œ0è¿›è¡Œä½è¿ç®—, æ•…, æœ€ç»ˆè¿”å›5.</p>
<h4 id="æŒ‰ä½é"><a href="#æŒ‰ä½é" class="headerlink" title="æŒ‰ä½é(~)"></a>æŒ‰ä½é(~)</h4><p>~è¿ç®—ç¬¦, è¿”å›æ•°å€¼äºŒè¿›åˆ¶è¡¥ç å½¢å¼çš„åç . ä»€ä¹ˆæ„æ€å‘¢, å°±æ˜¯è¯´ä¸€ä¸ªæ•°å€¼äºŒè¿›åˆ¶è¡¥ç å½¢å¼ä¸­çš„æ¯ä¸€ä½éƒ½å°†å–å, å¦‚æœè¯¥ä½ä¸º1, å–åä¸º0, å¦‚æœè¯¥ä½ä¸º0, å–åä¸º1. æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ç†è§£ä¸‹:</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">~	<span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0011</span>	<span class="comment">//3çš„32ä½äºŒè¿›åˆ¶è¡¥ç å½¢å¼</span></div><div class="line">--------------------------------------------</div><div class="line">	<span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1100</span>	<span class="comment">//æŒ‰ä½å–ååä¸ºè´Ÿæ•°(æœ€é«˜ä½(ç¬¬ä¸€ä½)è¡¨ç¤ºæ­£è´Ÿ,1ä»£è¡¨è´Ÿ,0ä»£è¡¨æ­£)</span></div><div class="line">--------------------------------------------</div><div class="line">	<span class="number">1000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0011</span>	<span class="comment">//è´Ÿæ•°çš„äºŒè¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶æ—¶,ç¬¦å·ä½ä¸å˜,å…¶å®ƒä½å–å(å+1)</span></div><div class="line">	<span class="number">1000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0100</span> <span class="comment">// +1</span></div><div class="line">--------------------------------------------</div><div class="line">                                      <span class="number">-4</span>	 <span class="comment">//æœ€ç»ˆè¿ç®—ç»“æœä¸º-4</span></div></pre></td></tr></table></figure>
<p>å®é™…ä¸Š, æŒ‰ä½é(~)æ“ä½œä¸éœ€è¦è¿™ä¹ˆå…´å¸ˆåŠ¨ä¼—åœ°å»è®¡ç®—, å®ƒæœ‰ä¸”ä»…æœ‰ä¸€æ¡è¿ç®—è§„å¾‹:</p>
<ul>
<li><strong>æŒ‰ä½éæ“ä½œä¸€ä¸ªæ•°å€¼, ç­‰åŒäºè¿™ä¸ªæ•°å€¼åŠ 1ç„¶åç¬¦å·æ”¹å˜. å³: <code>~x === -x-1</code></strong>.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">~<span class="number">5</span> ==&gt; <span class="number">-5</span><span class="number">-1</span> === <span class="number">-6</span>;</div><div class="line">~<span class="number">-2016</span> ==&gt; <span class="number">2016</span><span class="number">-1</span> === <span class="number">2015</span>;</div></pre></td></tr></table></figure>
<p>ç”±ä¸Šè¿°å…¬å¼å¯æ¨å‡º: <strong><code>~~x === -(-x-1)-1 === x</code></strong>. ç”±äºä½è¿ç®—æ‘ˆé™¤å°æ•°éƒ¨åˆ†çš„ç‰¹æ€§, è¿ç»­ä¸¤æ¬¡æŒ‰ä½éä¹Ÿå¯ç”¨äºå°†éæ•´æ•°å–æ•´. å³, <strong><code>~~x === Math.trunc(x)</code></strong> å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(~~<span class="number">5.2</span>);<span class="comment">//5</span></div><div class="line"><span class="built_in">console</span>.log(~~<span class="number">-5.2</span>);<span class="comment">//-5</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.trunc(<span class="number">-5.2</span>)===(~~<span class="number">-5.2</span>));<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>æŒ‰ä½é(~)è¿ç®—ç¬¦åªèƒ½ç”¨æ¥æ±‚æ•°å€¼çš„åç , å¹¶ä¸”è¿˜ä¸èƒ½è¾“å‡ºåç çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸². æˆ‘ä»¬æ¥ç¨å¾®æ‰©å±•ä¸‹, ä½¿å®ƒå˜å¾—æ›´æ˜“ç”¨.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">waveExtend</span>(<span class="params">item</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> s = <span class="keyword">typeof</span> item == <span class="string">'number'</span> &amp;&amp; translateBinary(~item);</div><div class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> s == <span class="string">'string'</span>?s:[].map.call(item,<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> v===<span class="string">'-'</span>?v:v^<span class="number">1</span>;</div><div class="line">  &#125;).join(<span class="string">''</span>).replace(<span class="regexp">/^-?/</span>,<span class="function"><span class="keyword">function</span>(<span class="params">m</span>)</span>&#123;<span class="keyword">return</span> m==<span class="string">''</span>?<span class="string">'-'</span>:<span class="string">''</span>&#125;);</div><div class="line">&#125;</div><div class="line">waveExtend(<span class="number">-8</span>);<span class="comment">//111 -8åç ,æ­£æ•°çœç•¥çš„ä½å…¨éƒ¨ä¸º0</span></div><div class="line">waveExtend(<span class="number">12</span>);<span class="comment">//-0011 12çš„åç ,è´Ÿæ•°çœç•¥çš„ä½å…¨éƒ¨ä¸º1</span></div></pre></td></tr></table></figure>
<p>å®é™…ä¸Š, æŒ‰ä½é(~)è¿ç®—ç¬¦è¦æ±‚å…¶è¿ç®—æ•°ä¸ºæ•´å‹, å¦‚æœè¿ç®—æ•°ä¸æ˜¯æ•´å‹, å®ƒå°†å’Œå…¶ä»–ä½è¿ç®—ç¬¦ä¸€æ ·å°è¯•å°†å…¶è½¬æ¢ä¸º32ä½æ•´å‹, å¦‚æœæ— æ³•è½¬æ¢, å°±è¿”å›NaN. é‚£ä¹ˆ~NaNç­‰äºå¤šå°‘å‘¢?</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(~<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;alert(<span class="number">20</span>);&#125;());<span class="comment">//å…ˆalert(20),ç„¶åè¾“å‡º-1</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šè¯­å¥æ„åœ¨æ‰“å°ä¸€ä¸ªè‡ªæ‰§è¡Œå‡½æ•°çš„æŒ‰ä½éè¿ç®—ç»“æœ. è€Œè¯¥è‡ªæ‰§è¡Œå‡½æ•°åˆæ²¡æœ‰æ˜¾å¼æŒ‡å®šè¿”å›å€¼, é»˜è®¤å°†è¿”å›undefined. å› æ­¤å®ƒå®é™…ä¸Šæ˜¯åœ¨è¾“å‡º~undefinedçš„å€¼. è€Œundefinedå€¼ä¸èƒ½è½¬æ¢æˆæ•´å‹, é€šè¿‡æµ‹è¯•, è¿ç®—ç»“æœä¸º-1(å³~NaN === -1). æˆ‘ä»¬ä¸å¦¨æ¥çœ‹çœ‹ä¸‹æ¥æµ‹è¯•, ä»¥ä¾¿åŠ æ·±ç†è§£.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(~<span class="string">'abc'</span>);<span class="comment">//-1</span></div><div class="line"><span class="built_in">console</span>.log(~[]);<span class="comment">//-1</span></div><div class="line"><span class="built_in">console</span>.log(~&#123;&#125;);<span class="comment">//-1</span></div><div class="line"><span class="built_in">console</span>.log(~<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;);<span class="comment">//-1</span></div><div class="line"><span class="built_in">console</span>.log(~<span class="regexp">/\d/</span>);<span class="comment">//-1</span></div><div class="line"><span class="built_in">console</span>.log(~<span class="literal">Infinity</span>);<span class="comment">//-1</span></div><div class="line"><span class="built_in">console</span>.log(~<span class="literal">null</span>);<span class="comment">//-1</span></div><div class="line"><span class="built_in">console</span>.log(~<span class="literal">undefined</span>);<span class="comment">//-1</span></div><div class="line"><span class="built_in">console</span>.log(~<span class="literal">NaN</span>);<span class="comment">//-1</span></div></pre></td></tr></table></figure>
<h4 id="æŒ‰ä½å¼‚æˆ–"><a href="#æŒ‰ä½å¼‚æˆ–" class="headerlink" title="æŒ‰ä½å¼‚æˆ–(^)"></a>æŒ‰ä½å¼‚æˆ–(^)</h4><p>^è¿ç®—ç¬¦è¿æ¥çš„ä¸¤ä¸ªæ•°, å®ƒä»¬äºŒè¿›åˆ¶è¡¥ç å½¢å¼çš„å€¼æ¯ä½å‚ä¸è¿ç®—, åªæœ‰ç›¸å¯¹åº”çš„æ¯ä½å€¼ä¸åŒ, æ‰è¿”å›1, å¦åˆ™è¿”å›0.<br>(ç›¸åŒåˆ™æ¶ˆå», æœ‰äº›ç±»ä¼¼ä¸¤ä¸¤æ¶ˆå¤±çš„æ¶ˆæ¶ˆä¹). å¦‚ä¸‹:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="code">	0011	//3çš„äºŒè¿›åˆ¶è¡¥ç å½¢å¼</span></div><div class="line"><span class="section">^	1000	//8çš„äºŒè¿›åˆ¶è¡¥ç å½¢å¼</span></div><div class="line">--------------------</div><div class="line"><span class="code">	1011	//11, ç›¸åŒä½æ•°ä¾æ¬¡è¿ç®—, å€¼ä¸åŒçš„è¿”å›1</span></div></pre></td></tr></table></figure>
<p>å¯¹äºæŒ‰ä½å¼‚æˆ–(^)æ“ä½œ, æ»¡è¶³å¦‚ä¸‹è§„å¾‹:</p>
<ol>
<li><strong>ç”±äºæŒ‰ä½å¼‚æˆ–ä½è¿ç®—çš„ç‰¹æ®Šæ€§, æ•°å€¼ä¸è‡ªèº«æŒ‰ä½å¼‚æˆ–è¿ç®—è¿”å›0</strong>. å¦‚: <code>8^8=0</code> , å…¬å¼ä¸º <code>a^a=0</code> .</li>
<li><strong>ä»»æ„æ•´æ•°ä¸0è¿›è¡ŒæŒ‰ä½å¼‚æˆ–è¿ç®—, éƒ½å°†ä¼šè¿”å›å®ƒæœ¬èº«</strong>. å¦‚: <code>0^-98=-98</code> , å…¬å¼ä¸º <code>0^a=a</code>.</li>
<li><strong>ä»»æ„æ•´æ•°xä¸1(2çš„0æ¬¡æ–¹)è¿›è¡ŒæŒ‰ä½å¼‚æˆ–è¿ç®—, è‹¥å®ƒä¸ºå¥‡æ•°, åˆ™è¿”å› <code>x-1</code>, è‹¥å®ƒä¸ºå¶æ•°, åˆ™è¿”å› <code>x+1</code> </strong>. å¦‚: <code>1^-9=-10</code> , <code>1^100=101</code>  . å…¬å¼ä¸º <code>1^å¥‡=å¥‡-1</code> , <code>1^å¶=å¶+1</code> ; æ¨è€Œå¹¿ä¹‹, <strong>ä»»æ„æ•´æ•°xä¸2çš„næ¬¡æ–¹è¿›è¡ŒæŒ‰ä½å¼‚æˆ–è¿ç®—, è‹¥å®ƒçš„äºŒè¿›åˆ¶è¡¥ç å½¢å¼çš„å€’æ•°ç¬¬n+1ä½æ˜¯1, åˆ™è¿”å› <code>x-2çš„næ¬¡æ–¹</code>, åä¹‹è‹¥ä¸º0, åˆ™è¿”å› <code>x+2çš„næ¬¡æ–¹</code> </strong>.</li>
<li><strong>ä»»æ„æ•´æ•°xä¸-1(è´Ÿ2çš„1æ¬¡æ–¹+1)è¿›è¡ŒæŒ‰ä½å¼‚æˆ–è¿ç®—, åˆ™å°†è¿”å› <code>-x-1</code>, ç›¸å½“äº~xè¿ç®— </strong>. å¦‚: <code>-1^100=-101</code> , <code>-1^-9=8</code> . å…¬å¼ä¸º <code>-1^x=-x-1=~x</code> .</li>
<li><strong>ä»»æ„æ•´æ•°è¿ç»­æŒ‰ä½å¼‚æˆ–ä¸¤æ¬¡ç›¸åŒçš„æ•°å€¼, è¿”å›å®ƒæœ¬èº«</strong>. å¦‚: <code>3^8^8=3</code> , å…¬å¼ä¸º <code>a^b^b=a</code> æˆ– <code>a^b^a=b</code> .</li>
<li><strong>æŒ‰ä½å¼‚æˆ–æ»¡è¶³æ“ä½œæ•°ä¸è¿ç®—ç»“æœ3ä¸ªæ•°å€¼ä¹‹é—´çš„äº¤æ¢å¾‹: æŒ‰ä½å¼‚æˆ–çš„ä¸¤ä¸ªæ•°å€¼, ä»¥åŠä»–ä»¬è¿ç®—çš„ç»“æœ, å…±ä¸‰ä¸ªæ•°å€¼å¯ä»¥ä¸¤ä¸¤å¼‚æˆ–å¾—åˆ°å¦å¤–ä¸€ä¸ªæ•°å€¼</strong> . å¦‚: <code>3^9=10</code> , <code>3^10=9</code> , <code>9^10=3</code> ; å…¬å¼ä¸º <code>a^b=c</code> , <code>a^c=b</code> , <code>b^c=a</code> .</li>
</ol>
<p>ä»¥ä¸Šå…¬å¼ä¸­, 1, 2, 3å’Œ4éƒ½æ˜¯ç”±æŒ‰ä½å¼‚æˆ–è¿ç®—ç‰¹æ€§æ¨å‡ºçš„, å…¬å¼5å¯ç”±å…¬å¼1å’Œ2æ¨å‡º, å…¬å¼6å¯ç”±å…¬å¼5æ¨å‡º.</p>
<p>ç”±äºæŒ‰ä½å¼‚æˆ–è¿ç®—çš„è¿™ç§å¯äº¤æ¢çš„æ€§è´¨, æˆ‘ä»¬å¯ç”¨å®ƒè¾…åŠ©äº¤æ¢ä¸¤ä¸ªæ•´æ•°çš„å€¼. å¦‚ä¸‹, å‡è®¾è¿™ä¸¤ä¸ªå€¼ä¸ºaå’Œb:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a=<span class="number">1</span>,b=<span class="number">2</span>;</div><div class="line"><span class="comment">//å¸¸è§„æ–¹æ³•</span></div><div class="line"><span class="keyword">var</span> tmp = a;</div><div class="line">a=b;</div><div class="line">b=tmp;</div><div class="line"><span class="built_in">console</span>.log(a,b);<span class="comment">//2 1</span></div><div class="line"></div><div class="line"><span class="comment">//ä½¿ç”¨æŒ‰ä½å¼‚æˆ–~çš„æ–¹æ³•</span></div><div class="line">a=a^b;	<span class="comment">//å‡è®¾a,bçš„åŸå§‹å€¼åˆ†åˆ«ä¸ºa0,b0</span></div><div class="line">b=a^b;	<span class="comment">//ç­‰ä»·äº b=a0^b0^b0 ==&gt; b=a0</span></div><div class="line">a=a^b;	<span class="comment">//ç­‰ä»·äº a=a0^b0^a0 ==&gt; a=b0</span></div><div class="line"><span class="built_in">console</span>.log(a,b);<span class="comment">//2 1</span></div><div class="line"><span class="comment">//ä»¥ä¸Šå¯ç®€å†™ä¸º</span></div><div class="line">a^=b;b^=a;a^=b;</div></pre></td></tr></table></figure>
<h4 id="ä½è¿ç®—å°ç»“"><a href="#ä½è¿ç®—å°ç»“" class="headerlink" title="ä½è¿ç®—å°ç»“"></a>ä½è¿ç®—å°ç»“</h4><p>ç”±ä¸Šå¯ä»¥çœ‹å‡º:</p>
<ul>
<li>ç”±äºè¿æ¥ä¸¤ä¸ªæ•°å€¼çš„ä½è¿ç®—å‡æ˜¯å¯¹ç›¸åŒçš„ä½è¿›è¡Œæ¯”è¾ƒæ“ä½œ, æ•…è¿ç®—æ•°å€¼çš„å…ˆåä½ç½®å¹¶ä¸é‡è¦, è¿™äº›ä½è¿ç®—(&amp; | ^)æ»¡è¶³äº¤æ¢å¾‹. å³: <code>aæ“ä½œç¬¦b === bæ“ä½œç¬¦a</code>.</li>
<li>ä½è¿ç®—ä¸­, æ•°å­—0å’Œ1éƒ½æ¯”è¾ƒç‰¹æ®Š. è®°ä½å®ƒä»¬çš„è§„å¾‹, å¸¸å¯ç®€åŒ–è¿ç®—.</li>
<li>ä½è¿ç®—(&amp;|~^)å¯ç”¨äºå–æ•´, åŒ Math.trunc().</li>
</ul>
<h4 id="æœ‰ç¬¦å·å·¦ç§»-lt-lt"><a href="#æœ‰ç¬¦å·å·¦ç§»-lt-lt" class="headerlink" title="æœ‰ç¬¦å·å·¦ç§»(&lt;&lt;)"></a>æœ‰ç¬¦å·å·¦ç§»(&lt;&lt;)</h4><p>&lt;&lt;è¿ç®—ç¬¦, è¡¨ç¤ºå°†æ•°å€¼çš„32ä½äºŒè¿›åˆ¶è¡¥ç å½¢å¼çš„é™¤ç¬¦å·ä½ä¹‹å¤–çš„å…¶ä»–ä½éƒ½å¾€å·¦ç§»åŠ¨è‹¥å¹²ä½æ•°. å½“xä¸ºæ•´æ•°æ—¶, æœ‰: <code>x&lt;&lt;n === x*Math.pow(2,n)</code> å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="number">1</span>&lt;&lt;<span class="number">3</span>);<span class="comment">//8</span></div><div class="line"><span class="built_in">console</span>.log(<span class="number">100</span>&lt;&lt;<span class="number">4</span>);<span class="comment">//1600</span></div></pre></td></tr></table></figure>
<p>å¦‚æ­¤, Math.pow(2,n) ä¾¿å¯ç®€å†™ä¸º 1&lt;&lt;n.</p>
<h5 id="è¿ç®—ç¬¦ä¹‹ä¸€ä¸ºNaN"><a href="#è¿ç®—ç¬¦ä¹‹ä¸€ä¸ºNaN" class="headerlink" title="è¿ç®—ç¬¦ä¹‹ä¸€ä¸ºNaN"></a>è¿ç®—ç¬¦ä¹‹ä¸€ä¸ºNaN</h5><p>å¯¹äºè¡¨è¾¾å¼ <code>x&lt;&lt;n</code> , <strong>å½“è¿ç®—æ•°xæ— æ³•è¢«è½¬æ¢ä¸ºæ•´æ•°æ—¶ï¼Œè¿ç®—ç»“æœä¸º0.</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(&#123;&#125;&lt;&lt;<span class="number">3</span>);<span class="comment">//0</span></div><div class="line"><span class="built_in">console</span>.log(<span class="literal">NaN</span>&lt;&lt;<span class="number">2</span>);<span class="comment">//0</span></div></pre></td></tr></table></figure>
<p><strong>å½“è¿ç®—æ•°næ— æ³•è¢«è½¬æ¢ä¸ºæ•´æ•°æ—¶ï¼Œè¿ç®—ç»“æœä¸ºx.</strong> ç›¸å½“äº <code>x&lt;&lt;0</code> .</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="number">2</span>&lt;&lt;<span class="literal">NaN</span>);<span class="comment">//2</span></div></pre></td></tr></table></figure>
<p><strong>å½“è¿ç®—æ•°xå’Œnå‡æ— æ³•è¢«è½¬æ¢ä¸ºæ•´æ•°æ—¶ï¼Œè¿ç®—ç»“æœä¸º0.</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="literal">NaN</span>&lt;&lt;<span class="literal">NaN</span>);<span class="comment">//0</span></div></pre></td></tr></table></figure>
<h4 id="æœ‰ç¬¦å·å³ç§»-gt-gt"><a href="#æœ‰ç¬¦å·å³ç§»-gt-gt" class="headerlink" title="æœ‰ç¬¦å·å³ç§»(&gt;&gt;)"></a>æœ‰ç¬¦å·å³ç§»(&gt;&gt;)</h4><p>>&gt;è¿ç®—ç¬¦, é™¤äº†æ–¹å‘å‘å³, å…¶ä»–åŒ&lt;&lt;è¿ç®—ç¬¦. å½“xä¸ºæ•´æ•°æ—¶, æœ‰: <code>x&gt;&gt;n === x*Math.pow(2,-n)</code> . å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="number">-5</span>&gt;&gt;<span class="number">2</span>);<span class="comment">//-2</span></div><div class="line"><span class="built_in">console</span>.log(<span class="number">-7</span>&gt;&gt;<span class="number">3</span>);<span class="comment">//-1</span></div></pre></td></tr></table></figure>
<p>å³ç§»è´Ÿæ•´æ•°æ—¶, è¿”å›å€¼æœ€å¤§ä¸º-1.</p>
<p>å³ç§»æ­£æ•´æ•°æ—¶, è¿”å›å€¼æœ€å°ä¸º0.</p>
<p>å…¶ä»–è§„å¾‹è¯·å‚è€ƒ æœ‰ç¬¦å·å·¦ç§»æ—¶è¿ç®—ç¬¦ä¹‹ä¸€ä¸ºNaNçš„åœºæ™¯.</p>
<h4 id="æ— ç¬¦å·å³ç§»-gt-gt-gt"><a href="#æ— ç¬¦å·å³ç§»-gt-gt-gt" class="headerlink" title="æ— ç¬¦å·å³ç§»(&gt;&gt;&gt;)"></a>æ— ç¬¦å·å³ç§»(&gt;&gt;&gt;)</h4><p>>&gt;&gt;è¿ç®—ç¬¦, è¡¨ç¤ºè¿åŒç¬¦å·ä¹Ÿä¸€èµ·å³ç§». </p>
<p>æ³¨æ„:æ— ç¬¦å·å³ç§»(&gt;&gt;&gt;)ä¼šæŠŠè´Ÿæ•°çš„äºŒè¿›åˆ¶ç å½“æˆæ­£æ•°çš„äºŒè¿›åˆ¶ç . å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="number">-8</span>&gt;&gt;&gt;<span class="number">5</span>);<span class="comment">//134217727</span></div><div class="line"><span class="built_in">console</span>.log(<span class="number">-1</span>&gt;&gt;&gt;<span class="number">0</span>);<span class="comment">//4294967295</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, è™½ç„¶-1æ²¡æœ‰å‘ç”Ÿå‘å³ä½ç§», ä½†æ˜¯-1çš„äºŒè¿›åˆ¶ç , å·²ç»å˜æˆäº†æ­£æ•°çš„äºŒè¿›åˆ¶ç . æˆ‘ä»¬æ¥å›é¡¾ä¸‹è¿™ä¸ªè¿‡ç¨‹.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">translateAry(<span class="number">-1</span>);<span class="comment">//-1,è¡¥å…¨-1çš„äºŒè¿›åˆ¶ç è‡³32ä½: 11111111111111111111111111111111</span></div><div class="line">translateAry(<span class="string">'11111111111111111111111111111111'</span>);<span class="comment">//4294967295</span></div></pre></td></tr></table></figure>
<p>å¯è§, -1çš„äºŒè¿›åˆ¶åŸç æœ¬å°±æ˜¯32ä¸ª1, å°†è¿™32ä¸ª1å½“æ­£æ•°çš„äºŒè¿›åˆ¶å¤„ç†, ç›´æ¥è¿˜åŸæˆåè¿›åˆ¶, åˆšå¥½å°±æ˜¯ 4294967295.</p>
<p>ç”±æ­¤, ä½¿ç”¨ &gt;&gt;&gt;è¿ç®—ç¬¦, å³ä½¿æ˜¯å³ç§»0ä½, å¯¹äºè´Ÿæ•°è€Œè¨€ä¹Ÿæ˜¯ç¿»å¤©è¦†åœ°çš„å˜åŒ–. ä½†æ˜¯å¯¹äºæ­£æ•°å´æ²¡æœ‰æ”¹å˜. åˆ©ç”¨è¿™ä¸ªç‰¹æ€§, å¯ä»¥åˆ¤æ–­æ•°å€¼çš„æ­£è´Ÿ. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSymbol</span>(<span class="params">num</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> num === (num&gt;&gt;&gt;<span class="number">0</span>)?<span class="string">"æ­£æ•°"</span>:<span class="string">"è´Ÿæ•°"</span>;</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(getSymbol(<span class="number">-100</span>), getSymbol(<span class="number">123</span>));<span class="comment">//è´Ÿæ•° æ­£æ•°</span></div></pre></td></tr></table></figure>
<p>å…¶ä»–è§„å¾‹è¯·å‚è€ƒ æœ‰ç¬¦å·å·¦ç§»æ—¶è¿ç®—ç¬¦ä¹‹ä¸€ä¸ºNaNçš„åœºæ™¯.</p>
<h4 id="è¿ç®—ç¬¦ä¼˜å…ˆçº§"><a href="#è¿ç®—ç¬¦ä¼˜å…ˆçº§" class="headerlink" title="è¿ç®—ç¬¦ä¼˜å…ˆçº§"></a>è¿ç®—ç¬¦ä¼˜å…ˆçº§</h4><p>ä½¿ç”¨è¿ç®—ç¬¦, å¦‚æœä¸çŸ¥é“å®ƒä»¬çš„è¿ç®—ä¼˜å…ˆçº§. å°±åƒé©¾é©¶æ³•æ‹‰åˆ©å´åˆ†ä¸æ¸…æ¥šæ²¹é—¨å’Œåˆ¹è½¦ä¸€æ ·ææ€–. å› æ­¤æˆ‘ä¸ºæ‚¨å‡†å¤‡äº†å¸¸ç”¨è¿ç®—ç¬¦çš„è¿ç®—ä¼˜å…ˆçº§è¡¨. è¯·å¯¹å·å…¥åº§.</p>
<table>
<thead>
<tr>
<th style="text-align:center">ä¼˜å…ˆçº§</th>
<th style="text-align:center">è¿ç®—ç¬¦</th>
<th style="text-align:center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">åç½®++ , åç½®â€“ , [] , () æˆ– .</td>
<td style="text-align:center">åç½®++,åç½®â€“,æ•°ç»„ä¸‹æ ‡,æ‹¬å· æˆ– å±æ€§é€‰æ‹©</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">- , å‰ç½®++ , å‰ç½®â€“ , ! æˆ– ~</td>
<td style="text-align:center">è´Ÿå·,å‰ç½®++,å‰ç½®â€“, é€»è¾‘é æˆ– æŒ‰ä½é</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">* , / æˆ– %</td>
<td style="text-align:center">ä¹˜ , é™¤ æˆ– å–æ¨¡</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">+ æˆ– -</td>
<td style="text-align:center">åŠ  æˆ– å‡</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">&lt;&lt; æˆ– &gt;&gt;</td>
<td style="text-align:center">å·¦ç§» æˆ– å³ç§»</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">> , &gt;= , &lt; æˆ– &lt;=</td>
<td style="text-align:center">å¤§äº, å¤§äºç­‰äº, å°äº æˆ– å°äºç­‰äº</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">== æˆ– !=</td>
<td style="text-align:center">ç­‰äº æˆ– ä¸ç­‰äº</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">&amp;</td>
<td style="text-align:center">æŒ‰ä½ä¸</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">^</td>
<td style="text-align:center">æŒ‰ä½å¼‚æˆ–</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">æˆ–</td>
<td style="text-align:center">æŒ‰ä½æˆ–</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">&amp;&amp;</td>
<td style="text-align:center">é€»è¾‘ä¸</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center">é€»è¾‘æˆ–</td>
<td style="text-align:center">é€»è¾‘æˆ–</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td style="text-align:center">?:</td>
<td style="text-align:center">æ¡ä»¶è¿ç®—ç¬¦</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">=,/=,*=,%=,+=,-=,&lt;&lt;=,&gt;&gt;=,&amp;=,^=,æŒ‰ä½æˆ–åèµ‹å€¼</td>
<td style="text-align:center">å„ç§è¿ç®—åèµ‹å€¼</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td style="text-align:center">,</td>
<td style="text-align:center">é€—å·</td>
</tr>
</tbody>
</table>
<p>å¯ä»¥çœ‹åˆ°, â‘  é™¤äº†æŒ‰ä½é(~)ä»¥å¤–, å…¶ä»–çš„ä½è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§éƒ½æ˜¯ä½äº+-è¿ç®—ç¬¦çš„; â‘¡ æŒ‰ä½ä¸(&amp;), æŒ‰ä½å¼‚æˆ–(^) æˆ– æŒ‰ä½æˆ–(|) çš„è¿ç®—ä¼˜å…ˆçº§å‡ä½äºæ¯”è¾ƒè¿ç®—ç¬¦(&gt;,&lt;,=ç­‰); â‘¢ä½è¿ç®—ç¬¦ä¸­æŒ‰ä½æˆ–(|)ä¼˜å…ˆçº§æœ€ä½.</p>
<h3 id="ç»¼åˆè¿ç”¨"><a href="#ç»¼åˆè¿ç”¨" class="headerlink" title="ç»¼åˆè¿ç”¨"></a>ç»¼åˆè¿ç”¨</h3><h4 id="è®¡ç®—ç»å¯¹å€¼"><a href="#è®¡ç®—ç»å¯¹å€¼" class="headerlink" title="è®¡ç®—ç»å¯¹å€¼"></a>è®¡ç®—ç»å¯¹å€¼</h4><p>ä½¿ç”¨æœ‰ç¬¦å·å³ç§»(&gt;&gt;)è¿ç®—ç¬¦, ä»¥åŠæŒ‰ä½å¼‚æˆ–(^)è¿ç®—ç¬¦, æˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ª Math.absæ–¹æ³•. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">abs</span>(<span class="params">num</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> x = num&gt;&gt;<span class="number">31</span>,	<span class="comment">//ä¿ç•™32äºŒè¿›åˆ¶ä¸­çš„ç¬¦å·ä½,æ ¹æ®numçš„æ­£è´Ÿæ€§åˆ†åˆ«è¿”å›0æˆ–-1</span></div><div class="line">      y = num^x;	<span class="comment">//è¿”å›æ­£æ•°,ä¸”åˆ©ç”¨æŒ‰ä½å¼‚æˆ–ä¸­çš„å…¬å¼2,è‹¥numä¸ºæ­£æ•°,num^0åˆ™è¿”å›numæœ¬èº«;è‹¥numä¸ºè´Ÿæ•°,åˆ™ç›¸å½“äºnum^-1,åˆ©ç”¨å…¬å¼4, æ­¤æ—¶è¿”å›-num-1</span></div><div class="line">  <span class="keyword">return</span> y-x;		<span class="comment">//è‹¥numä¸ºæ­£æ•°,åˆ™è¿”å›num-0å³num;è‹¥numä¸ºè´Ÿæ•°åˆ™è¿”å›-num-1-(-1)å³|num|</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="æ¯”è¾ƒä¸¤æ•°æ˜¯å¦ç¬¦å·ç›¸åŒ"><a href="#æ¯”è¾ƒä¸¤æ•°æ˜¯å¦ç¬¦å·ç›¸åŒ" class="headerlink" title="æ¯”è¾ƒä¸¤æ•°æ˜¯å¦ç¬¦å·ç›¸åŒ"></a>æ¯”è¾ƒä¸¤æ•°æ˜¯å¦ç¬¦å·ç›¸åŒ</h4><p>é€šå¸¸, æ¯”è¾ƒä¸¤ä¸ªæ•°æ˜¯å¦ç¬¦å·ç›¸åŒ, æˆ‘ä»¬ä½¿ç”¨x*y&gt;0 æ¥åˆ¤æ–­å³å¯. ä½†å¦‚æœåˆ©ç”¨æŒ‰ä½å¼‚æˆ–(^), è¿ç®—é€Ÿåº¦å°†æ›´å¿«.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="number">-17</span> ^ <span class="number">9</span> &gt; <span class="number">0</span>);<span class="comment">//false</span></div></pre></td></tr></table></figure>
<h4 id="å¯¹2çš„næ¬¡æ–¹å–æ¨¡-nä¸ºæ­£æ•´æ•°"><a href="#å¯¹2çš„næ¬¡æ–¹å–æ¨¡-nä¸ºæ­£æ•´æ•°" class="headerlink" title="å¯¹2çš„næ¬¡æ–¹å–æ¨¡(nä¸ºæ­£æ•´æ•°)"></a>å¯¹2çš„næ¬¡æ–¹å–æ¨¡(nä¸ºæ­£æ•´æ•°)</h4><p>æ¯”å¦‚ 123%8, å®é™…ä¸Šå°±æ˜¯æ±‚ä¸€ä¸ªä½™æ•°, å¹¶ä¸”è¿™ä¸ªä½™æ•°è¿˜ä¸å¤§äº8, æœ€å¤§ä¸º7. ç„¶åå‰©ä¸‹çš„å°±æ˜¯æ¯”è¾ƒäºŒè¿›åˆ¶å€¼é‡Œ, 123ä¸7æœ‰å‡ æˆç›¸ä¼¼äº†. ä¾¿ä¸éš¾æ¨å‡ºå…¬å¼: <code>x%(1&lt;&lt;n)==x&amp;(1&lt;&lt;n)-1</code> . </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="number">123</span>%<span class="number">8</span>);<span class="comment">//3</span></div><div class="line"><span class="built_in">console</span>.log(<span class="number">123</span>&amp;(<span class="number">1</span>&lt;&lt;<span class="number">3</span>)<span class="number">-1</span>);<span class="comment">//3 , ä¸ºä»€ä¹ˆ-1æ—¶ä¸ç”¨æ‹¬å·æ‹¬èµ·æ¥, è¿™æ˜¯å› ä¸º-ä¼˜å…ˆçº§é«˜äº&amp;</span></div></pre></td></tr></table></figure>
<h4 id="ç»Ÿè®¡æ­£æ•°äºŒè¿›åˆ¶å€¼ä¸­1çš„ä¸ªæ•°"><a href="#ç»Ÿè®¡æ­£æ•°äºŒè¿›åˆ¶å€¼ä¸­1çš„ä¸ªæ•°" class="headerlink" title="ç»Ÿè®¡æ­£æ•°äºŒè¿›åˆ¶å€¼ä¸­1çš„ä¸ªæ•°"></a>ç»Ÿè®¡æ­£æ•°äºŒè¿›åˆ¶å€¼ä¸­1çš„ä¸ªæ•°</h4><p>ä¸å¦¨å…ˆåˆ¤æ–­nçš„å¥‡å¶æ€§, ä¸ºå¥‡æ•°æ—¶è®¡æ•°å™¨å¢åŠ 1, ç„¶åå°†nå³ç§»ä¸€ä½, é‡å¤ä¸Šé¢æ­¥éª¤, ç›´åˆ°é€’å½’é€€å‡º.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTotalForOne</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">  	<span class="keyword">return</span> n?(n&amp;<span class="number">1</span>)+<span class="built_in">arguments</span>.callee(n&gt;&gt;<span class="number">1</span>):<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">getTotalForOne(<span class="number">9</span>);<span class="comment">//2</span></div></pre></td></tr></table></figure>
<h4 id="å®ç°åŠ æ³•è¿ç®—"><a href="#å®ç°åŠ æ³•è¿ç®—" class="headerlink" title="å®ç°åŠ æ³•è¿ç®—"></a>å®ç°åŠ æ³•è¿ç®—</h4><p>åŠ æ³•è¿ç®—, ä»äºŒè¿›åˆ¶å€¼çš„è§’åº¦çœ‹, æœ‰ â‘ åŒä½ç›¸åŠ  å’Œ â‘¡é‡2è¿›1 ä¸¤ç§è¿ç®—(å®é™…ä¸Š, åè¿›åˆ¶è¿ç®—ä¹Ÿæ˜¯ä¸€æ ·, åŒä½ç›¸åŠ , é‡10è¿›1). </p>
<p>é¦–å…ˆæˆ‘ä»¬çœ‹çœ‹ç¬¬â‘ ç§, åŒä½ç›¸åŠ , ä¸è€ƒè™‘â‘¡é‡2è¿›1.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> + <span class="number">1</span> = <span class="number">0</span></div><div class="line"><span class="number">1</span> + <span class="number">0</span> = <span class="number">1</span></div><div class="line"><span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></div><div class="line"><span class="number">0</span> + <span class="number">0</span> = <span class="number">0</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šè¿ç®—è¿‡ç¨‹æœ‰æ²¡æœ‰å¾ˆç†Ÿæ‚‰. æ˜¯ä¸æ˜¯å’ŒæŒ‰ä½å¼‚æˆ–(^)è¿ç®—æœ‰ç€æƒŠäººçš„ç›¸ä¼¼. å¦‚:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> ^ <span class="number">1</span> = <span class="number">0</span></div><div class="line"><span class="number">1</span> ^ <span class="number">0</span> = <span class="number">1</span></div><div class="line"><span class="number">0</span> ^ <span class="number">1</span> = <span class="number">1</span></div><div class="line"><span class="number">0</span> ^ <span class="number">0</span> = <span class="number">0</span></div></pre></td></tr></table></figure>
<p>å› æ­¤â‘ åŒä½ç›¸åŠ çš„è¿ç®—, å®Œå…¨å¯ç”±æŒ‰ä½å¼‚æˆ–(^)ä»£æ›¿, å³: x^y.</p>
<p>é‚£ä¹ˆâ‘¡é‡2è¿›1 åº”è¯¥æ€ä¹ˆå®ç°å‘¢? å®é™…ä¸Š, éä½ç§»ä½è¿ç®—ä¸­, åªæœ‰æŒ‰ä½ä¸(&amp;)æ‰èƒ½æ»¡è¶³é‡2çš„åœºæ™¯, ä¸”åªæœ‰æœ‰ç¬¦å·å·¦ç§»(&lt;&lt;)èƒ½æ»¡è¶³è¿›1çš„åœºæ™¯.</p>
<p>ç°åœ¨èŒƒå›´ç¼©å°äº†, å°±çœ‹&amp;å’Œ&lt;&lt;è¿ç®—ç¬¦èƒ½ä¸èƒ½çœŸæ­£æ»¡è¶³éœ€è¦äº†. å€¼å¾—é«˜å…´çš„æ˜¯, æŒ‰ä½ä¸(&amp;)åªæœ‰åœ¨åŒä½éƒ½æ˜¯1çš„æƒ…å†µä¸‹æ‰è¿”å›1, å…¶ä»–æƒ…å†µå‡è¿”å›0. å¦‚æœå¯¹å…¶è¿ç®—ç»“æœå†åšå·¦ç§»ä¸€ä½çš„è¿ç®—, å³: (x&amp;y)&lt;&lt;1. åˆšå¥½æ»¡è¶³äº†â‘¡é‡2è¿›1çš„åœºæ™¯.</p>
<p>å› ä¸ºæˆ‘ä»¬æ˜¯å°†â‘ åŒä½ç›¸åŠ å’Œâ‘¡é‡2è¿›1çš„ä¸¤ç§è¿ç®—åˆ†å¼€è¿›è¡Œ. é‚£ä¹ˆæœ€ç»ˆçš„åŠ æ³•è¿ç®—ç»“æœåº”è¯¥è¿˜è¦åšä¸€æ¬¡åŠ æ³•. å¦‚ä¸‹:</p>
<p>æœ€ç»ˆå…¬å¼: <code>x + y = x^y + (x&amp;y)&lt;&lt;1</code> </p>
<p>è¿™ä¸ªå…¬å¼å¹¶ä¸å®Œç¾, å› ä¸ºå®ƒè¿˜æ˜¯ä½¿ç”¨äº†åŠ æ³•, æ¨å¯¼å…¬å¼æ€ä¹ˆèƒ½ç›´æ¥ä½¿ç”¨æ¨å¯¼ç»“æœå‘¢? å¤ªå¯æ€•äº†, å°±ä¸æ€•æ‰å…¥é€’å½’æ·±æ¸Šå—? ä¸‹é¢æˆ‘ä»¬å°±æ¥ç»•è¿‡è¿™ä¸ªå‘. è€Œç»•è¿‡è¿™ä¸ªå‘æœ‰ä¸€ä¸ªå‰æ, é‚£å°±æ˜¯åªè¦ x^y æˆ– (x&amp;y)&lt;&lt;1ä¸­æœ‰ä¸€ä¸ªå€¼ä¸º0å°±è¡Œäº†, è¿™æ ·ä¾¿ä¸ç”¨è¿›è¡ŒåŠ æ³•è¿ç®—äº†. è®²äº†è¿™ä¹ˆå¤š, ä¸å¦‚çœ‹ä»£ç .</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> _x = x^y,</div><div class="line">      _y = (x&amp;y)&lt;&lt;<span class="number">1</span>;</div><div class="line">  <span class="keyword">return</span> !_x &amp;&amp; _y || !_y &amp;&amp; _x || <span class="built_in">arguments</span>.callee(_x,_y);</div><div class="line">&#125;</div><div class="line">add(<span class="number">12345678</span>,<span class="number">87654321</span>);<span class="comment">//999999999</span></div><div class="line">add(<span class="number">9527</span>,<span class="number">-12</span>);<span class="comment">//9515</span></div></pre></td></tr></table></figure>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æœ€åè¡¥å……ä¸€ç‚¹: ä½è¿ç®—ä¸€èˆ¬åªé€‚ç”¨ [-2^31, 2^31-1] (å³ -2147483648~2147483647) ä»¥å†…çš„æ­£è´Ÿæ•°. è¶…è¿‡è¿™ä¸ªèŒƒå›´, è®¡ç®—å°†å¯èƒ½å‡ºç°é”™è¯¯. å¦‚ä¸‹: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="number">1</span>&lt;&lt;<span class="number">31</span>);<span class="comment">//-2147483648</span></div></pre></td></tr></table></figure>
<p>ç”±äºæ•°å€¼(2^31)è¶…è¿‡äº†31ä½(åŠ ä¸Šä¿ç•™çš„ä¸€ä¸ªç¬¦å·ä½,å…±32ä½), æ•…è®¡ç®—å‡ºé”™, äºæ˜¯æŒ‰ç…§è´Ÿæ•°çš„æ–¹å¼è§£é‡ŠäºŒè¿›åˆ¶çš„å€¼äº†.è¯´å¥½çš„ä¸æ”¹å˜ç¬¦å·å‘¢!!!</p>
<p>æœ¬æ–‡å•°å—¦å‡ åƒå­—, å°±ä¸ºäº†è¯´æ¸…æ¥šä¸¤ä¸ªäº‹å„¿. â‘  Mathå¯¹è±¡ä¸­, æ¯”è¾ƒå¸¸ç”¨çš„å°±æ˜¯æ•°å€¼è¿ç®—æ–¹æ³•, ä¸å¦¨å¤šçœ‹çœ‹, å…¶ä»–çš„çŸ¥é“æœ‰è¿™ä¸ªapiå°±è¡Œäº†. â‘¡ ä½è¿ç®—ä¸­, åˆ™éœ€è¦åŸºæœ¬äº†è§£æ¯ç§ä½è¿ç®—ç¬¦çš„è¿ç®—æ–¹å¼, å¦‚æœèƒ½æ³¨æ„è¿ç®—ä¸­ 0å’Œ1ç­‰ç‰¹æ®Šæ•°å€¼ çš„ä¸€äº›å¦™ç”¨å°±æ›´å¥½äº†. æ— è®ºå¦‚ä½•, æœ¬æ–‡ä¸å¯èƒ½é¢é¢ä¿±åˆ°. å¦‚æœæ‚¨å¯¹è´Ÿæ•°çš„ä½è¿ç®—ä¸ç”šç†è§£, å»ºè®®å»è¡¥ä¸‹è®¡ç®—æœºçš„è¡¥ç . å¸Œæœ›èƒ½å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©.</p>
<h3 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h3><ol>
<li><code>ç›¸åæ•°</code> : åªæœ‰ç¬¦å·ä¸åŒçš„ä¸¤ä¸ªæ•°, æˆ‘ä»¬å°±è¯´å…¶ä¸­ä¸€ä¸ªæ˜¯å¦ä¸€ä¸ªçš„ç›¸åæ•°.</li>
<li><code>è¡¥ç </code>: åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­, æ•°å€¼ä¸€å¾‹ç”¨è¡¥ç æ¥è¡¨ç¤ºå’Œå­˜å‚¨, ä¸”æ­£æ•°çš„åŸç å’Œè¡¥ç ç›¸åŒ, è´Ÿæ•°çš„è¡¥ç ç­‰äºå…¶åŸç æŒ‰ä½å–åå†åŠ 1.</li>
</ol>
<hr>
<p>æœ¬é—®å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹, å¦‚æœæ‚¨æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/07/01/Math/">http://louiszhai.github.io/2016/07/01/Math/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Math" target="_blank" rel="external">Math - JavaScript | MDN</a></li>
<li><a href="http://www.cnblogs.com/xljzlw/p/4231354.html?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">jsä¸­ä½è¿ç®—çš„è¿ç”¨ - é‚£æ—¶å€™çš„æˆ‘ - åšå®¢å›­</a></li>
<li><a href="http://blog.csdn.net/yunyu5120/article/details/6692072" target="_blank" rel="external">ç¼–ç¨‹æŠ€å·§â€“ä½è¿ç®—çš„å·§å¦™è¿ç”¨</a></li>
<li><a href="http://www.jb51.net/article/32130.htm" target="_blank" rel="external">cè¯­è¨€ä¸­ç”¨ä½è¿ç®—å®ç°åŠ æ³•æŠ€å·§ä»‹ç»_C è¯­è¨€_è„šæœ¬ä¹‹å®¶</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      Math floor ~ ~ abs random ceil ä½è¿ç®— &amp; | ^ &lt;&lt; &gt;&gt; &gt;&gt;&gt; æŒ‰ä½ä¸ æŒ‰ä½æˆ– æŒ‰ä½é æŒ‰ä½å¼‚æˆ– æœ‰ç¬¦å·å·¦ç§» æœ‰ç¬¦å·å³ç§» æ— ç¬¦å·å³ç§»
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://louiszhai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>æ­£åˆ™è¡¨è¾¾å¼å‰ç«¯ä½¿ç”¨æ‰‹å†Œ</title>
    <link href="http://louiszhai.github.io/2016/06/13/regexp/"/>
    <id>http://louiszhai.github.io/2016/06/13/regexp/</id>
    <published>2016-06-13T00:24:55.000Z</published>
    <updated>2017-02-26T02:28:04.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>ä½ æœ‰æ²¡æœ‰åœ¨æœç´¢æ–‡æœ¬çš„æ—¶å€™ç»å°½è„‘æ±, è¯•äº†ä¸€ä¸ªåˆä¸€ä¸ªè¡¨è¾¾å¼, è¿˜æ˜¯ä¸è¡Œ.</p>
<p>ä½ æœ‰æ²¡æœ‰åœ¨è¡¨å•éªŒè¯çš„æ—¶å€™, åªæ˜¯åšåšæ ·å­(åªè¦ä¸ä¸ºç©ºå°±å¥½), ç„¶åçƒ§é¦™æ‹œä½›, è™”è¯šç¥ˆç¥·, åƒä¸‡ä¸è¦å‡ºé”™.</p>
<p>ä½ æœ‰æ²¡æœ‰åœ¨ä½¿ç”¨sed å’Œ grep å‘½ä»¤çš„æ—¶å€™, æ„Ÿè§‰è«åå…¶å¦™, æ˜æ˜åº”è¯¥æ”¯æŒçš„å…ƒå­—ç¬¦, å´å°±æ˜¯åŒ¹é…ä¸åˆ°.</p>
<p>ç”šè‡³, ä½ å‹æ ¹æ²¡é‡åˆ°è¿‡ä¸Šè¿°æƒ…å†µ, ä½ åªæ˜¯ä¸€éåˆä¸€éçš„è°ƒç”¨ replace è€Œå·² (æŠŠéæœç´¢æ–‡æœ¬å…¨éƒ¨æ›¿æ¢ä¸ºç©º, ç„¶åå°±åªå‰©æœç´¢æ–‡æœ¬äº†), é¢å¯¹åˆ«äººå®¶çš„ç®€æ´é«˜æ•ˆçš„è¯­å¥, ä½ åªèƒ½åœ¨å¿ƒä¸­å‘å–Š, replace å¤§æ³•å¥½.</p>
<p>ä¸ºä»€ä¹ˆè¦å­¦æ­£åˆ™è¡¨è¾¾å¼. æœ‰ä½ç½‘å‹è¿™ä¹ˆè¯´: æ±Ÿæ¹–ä¼ è¯´é‡Œ, ç¨‹åºå‘˜çš„æ­£åˆ™è¡¨è¾¾å¼å’ŒåŒ»ç”Ÿçš„å¤„æ–¹, é“å£«çš„é¬¼ç¬¦é½å, æ›°: æ™®é€šäººçœ‹ä¸æ‡‚çš„ä¸‰ä»¶ç¥å™¨. è¿™ä¸ªä¼ è¯´è‡³å°‘å‘æˆ‘ä»¬é€éœ²äº†ä¸¤ç‚¹ä¿¡æ¯: ä¸€æ˜¯æ­£åˆ™è¡¨è¾¾å¼å¾ˆç‰›, èƒ½å’ŒåŒ»ç”Ÿçš„å¤„æ–¹, é“å£«çš„é¬¼ç¬¦é½å, å¹¶è¢«å¤§å®¶æèµ·, å¯è§å…¶æ±Ÿæ¹–åœ°ä½. äºŒæ˜¯æ­£åˆ™è¡¨è¾¾å¼å¾ˆéš¾, è¿™ä¹Ÿä»ä¾§é¢è¯´æ˜äº†, å¦‚æœä½ å¯ä»¥ç†Ÿç»ƒçš„æŒæ¡å¹¶åº”ç”¨å®ƒ, åœ¨è£…é€¼çš„è·¯ä¸Š, ä½ å°†å¦‚æ—¥ä¸­å¤© (åˆ«é—®æˆ‘ä¸­å¤©æ˜¯è°â€¦â€¦) !</p>
<a id="more"></a>
<p>æ˜¾ç„¶, æœ‰å…³æ­£åˆ™è¡¨è¾¾çš„ä»‹ç», æ— é¡»æˆ‘å¤šè¨€. è¿™é‡Œå°±å€ŸåŠ© Jeffrey Friedl çš„ã€Šç²¾é€šæ­£åˆ™è¡¨è¾¾å¼ã€‹ä¸€ä¹¦çš„åºè¨€æ­£å¼æŠ›ä¸ªç –.</p>
<blockquote>
<p>â€‹    â€œå¦‚æœç½—åˆ—è®¡ç®—æœºè½¯ä»¶é¢†åŸŸçš„ä¼Ÿå¤§å‘æ˜, æˆ‘ç›¸ä¿¡ç»å¯¹ä¸ä¼šè¶…è¿‡äºŒåé¡¹, åœ¨è¿™ä¸ªåå•å½“ä¸­, å½“ç„¶åº”è¯¥åŒ…æ‹¬åˆ†ç»„äº¤æ¢ç½‘ç»œ, Web, Lisp, å“ˆå¸Œç®—æ³•, UNIX, ç¼–è¯‘æŠ€æœ¯, å…³ç³»æ¨¡å‹, é¢å‘å¯¹è±¡, XMLè¿™äº›å¤§åé¼é¼çš„å®¶ä¼™, è€Œæ­£åˆ™è¡¨è¾¾å¼ä¹Ÿç»å¯¹ä¸åº”è¯¥è¢«æ¼æ‰. </p>
<p>â€‹     å¯¹å¾ˆå¤šå®é™…å·¥ä½œè€Œè¨€, æ­£åˆ™è¡¨è¾¾å¼ç®€ç›´æ˜¯çµä¸¹å¦™è¯, èƒ½å¤Ÿæˆç™¾å€çš„æé«˜å¼€å‘æ•ˆç‡å’Œç¨‹åºè´¨é‡, æ­£åˆ™è¡¨è¾¾å¼åœ¨ç”Ÿç‰©ä¿¡æ¯å­¦å’Œäººç±»åŸºå› å›¾è°±çš„ç ”ç©¶ä¸­æ‰€å‘æŒ¥çš„å…³é”®ä½œç”¨, æ›´æ˜¯è¢«ä¼ ä¸ºä½³è¯. CSDNçš„åˆ›å§‹äººè’‹æ¶›å…ˆç”Ÿåœ¨æ—©å¹´å¼€å‘ä¸“ä¸šè½¯ä»¶äº§å“æ—¶, å°±æ›¾ç»ä½“éªŒè¿‡è¿™ä¸€å·¥å…·çš„å·¨å¤§å¨åŠ›, å¹¶ä¸”ä¸€ç›´å°è±¡æ·±åˆ».â€</p>
</blockquote>
<p>å› æ­¤, æˆ‘ä»¬æ²¡æœ‰ç†ç”±ä¸å»äº†è§£æ­£åˆ™è¡¨è¾¾å¼, ç”šè‡³æ˜¯ç†Ÿç»ƒæŒæ¡å¹¶è¿ç”¨å®ƒ.</p>
<p>æœ¬æ–‡ä»¥æ­£åˆ™åŸºç¡€è¯­æ³•å¼€ç¯‡, ç»“åˆå…·ä½“å®ä¾‹, é€æ­¥è®²è§£æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åŸç†. ä»£ç å®ä¾‹ä½¿ç”¨è¯­è¨€åŒ…æ‹¬ js, php, python, java(å› æœ‰äº›åŒ¹é…æ¨¡å¼, jså¹¶æœªæ”¯æŒ, éœ€è¦å€ŸåŠ©å…¶ä»–è¯­è¨€è®²è§£). å†…å®¹åŒ…æ‹¬åˆé˜¶æŠ€èƒ½å’Œé«˜é˜¶æŠ€èƒ½, é€‚åˆæ–°æ‰‹å­¦ä¹ å’Œè¿›é˜¶. æœ¬æ–‡åŠ›æ±‚ç®€å•é€šä¿—æ˜“æ‡‚, åŒæ—¶ä¸ºæ±‚å…¨é¢, æ¶‰åŠçŸ¥è¯†è¾ƒå¤š, å…±è®¡12kå­—, ç¯‡å¹…è¾ƒé•¿, è¯·è€å¿ƒé˜…è¯», å¦‚æœ‰é˜…è¯»éšœç¢è¯·åŠæ—¶<a href="#respond">è”ç³»æˆ‘</a>.</p>
<h3 id="å›é¡¾å†å²"><a href="#å›é¡¾å†å²" class="headerlink" title="å›é¡¾å†å²"></a>å›é¡¾å†å²</h3><p>è¦è®ºæ­£åˆ™è¡¨è¾¾å¼çš„æ¸Šæº, æœ€æ—©å¯ä»¥è¿½æº¯è‡³å¯¹äººç±»ç¥ç»ç³»ç»Ÿå¦‚ä½•å·¥ä½œçš„æ—©æœŸç ”ç©¶. Warren McCulloch å’Œ Walter Pitts è¿™ä¸¤ä½ç¥ç»å¤§å’– (ç¥ç»ç”Ÿç†å­¦å®¶) ç ”ç©¶å‡ºä¸€ç§æ•°å­¦æ–¹å¼æ¥æè¿°è¿™äº›ç¥ç»ç½‘ç»œ.</p>
<p>1956 å¹´, ä¸€ä½å« Stephen Kleene çš„æ•°å­¦å®¶åœ¨ McCulloch å’Œ Pitts æ—©æœŸå·¥ä½œçš„åŸºç¡€ä¸Š, å‘è¡¨äº†ä¸€ç¯‡æ ‡é¢˜ä¸ºâ€ç¥ç»ç½‘äº‹ä»¶çš„è¡¨ç¤ºæ³•â€çš„è®ºæ–‡, å¼•å…¥äº†æ­£åˆ™è¡¨è¾¾å¼çš„æ¦‚å¿µ.</p>
<p>éšå, å‘ç°å¯ä»¥å°†è¿™ä¸€å·¥ä½œåº”ç”¨äºä½¿ç”¨ Ken Thompson çš„è®¡ç®—æœç´¢ç®—æ³•çš„ä¸€äº›æ—©æœŸç ”ç©¶ä¸­. è€Œ Ken Thompson åˆæ˜¯ Unix çš„ä¸»è¦å‘æ˜äºº. å› æ­¤åŠä¸ªä¸–çºªä»¥å‰çš„Unix ä¸­çš„ qed ç¼–è¾‘å™¨(1966 qedç¼–è¾‘å™¨é—®ä¸–) æˆäº†ç¬¬ä¸€ä¸ªä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„åº”ç”¨ç¨‹åº.</p>
<p>è‡³æ­¤ä¹‹å, æ­£åˆ™è¡¨è¾¾å¼æˆä¸ºå®¶å–»æˆ·æ™“çš„æ–‡æœ¬å¤„ç†å·¥å…·, å‡ ä¹å„å¤§ç¼–ç¨‹è¯­è¨€éƒ½ä»¥æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ä½œä¸ºå–ç‚¹, å½“ç„¶ JavaScript ä¹Ÿä¸ä¾‹å¤–.</p>
<h3 id="æ­£åˆ™è¡¨è¾¾å¼çš„å®šä¹‰"><a href="#æ­£åˆ™è¡¨è¾¾å¼çš„å®šä¹‰" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼çš„å®šä¹‰"></a>æ­£åˆ™è¡¨è¾¾å¼çš„å®šä¹‰</h3><p>æ­£åˆ™è¡¨è¾¾å¼æ˜¯ç”±æ™®é€šå­—ç¬¦å’Œç‰¹æ®Šå­—ç¬¦(ä¹Ÿå«å…ƒå­—ç¬¦æˆ–é™å®šç¬¦)ç»„æˆçš„æ–‡å­—æ¨¡æ¿. å¦‚ä¸‹ä¾¿æ˜¯ç®€å•çš„åŒ¹é…è¿ç»­æ•°å­—çš„æ­£åˆ™è¡¨è¾¾å¼:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="regexp">/[0-9]+/</span></div><div class="line"><span class="regexp">/\d+/</span></div></pre></td></tr></table></figure>
<p>â€œ\dâ€ å°±æ˜¯å…ƒå­—ç¬¦, è€Œ â€œ+â€ åˆ™æ˜¯é™å®šç¬¦.</p>
<h4 id="å…ƒå­—ç¬¦"><a href="#å…ƒå­—ç¬¦" class="headerlink" title="å…ƒå­—ç¬¦"></a>å…ƒå­—ç¬¦</h4><table>
<thead>
<tr>
<th style="text-align:center">å…ƒå­—ç¬¦</th>
<th style="text-align:center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">.</td>
<td style="text-align:center">åŒ¹é…é™¤æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦</td>
</tr>
<tr>
<td style="text-align:center">\d</td>
<td style="text-align:center">åŒ¹é…æ•°å­—, ç­‰ä»·äºå­—ç¬¦ç»„[0-9]</td>
</tr>
<tr>
<td style="text-align:center">\w</td>
<td style="text-align:center">åŒ¹é…å­—æ¯, æ•°å­—, ä¸‹åˆ’çº¿æˆ–æ±‰å­—</td>
</tr>
<tr>
<td style="text-align:center">\s</td>
<td style="text-align:center">åŒ¹é…ä»»æ„çš„ç©ºç™½ç¬¦(åŒ…æ‹¬åˆ¶è¡¨ç¬¦,ç©ºæ ¼,æ¢è¡Œç­‰)</td>
</tr>
<tr>
<td style="text-align:center">\b</td>
<td style="text-align:center">åŒ¹é…å•è¯å¼€å§‹æˆ–ç»“æŸçš„ä½ç½®</td>
</tr>
<tr>
<td style="text-align:center">^</td>
<td style="text-align:center">åŒ¹é…è¡Œé¦–</td>
</tr>
<tr>
<td style="text-align:center">$</td>
<td style="text-align:center">åŒ¹é…è¡Œå°¾</td>
</tr>
</tbody>
</table>
<h4 id="åä¹‰å…ƒå­—ç¬¦"><a href="#åä¹‰å…ƒå­—ç¬¦" class="headerlink" title="åä¹‰å…ƒå­—ç¬¦"></a>åä¹‰å…ƒå­—ç¬¦</h4><table>
<thead>
<tr>
<th style="text-align:center">å…ƒå­—ç¬¦</th>
<th style="text-align:center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">\D</td>
<td style="text-align:center">åŒ¹é…éæ•°å­—çš„ä»»æ„å­—ç¬¦, ç­‰ä»·äº[^0-9]</td>
</tr>
<tr>
<td style="text-align:center">\W</td>
<td style="text-align:center">åŒ¹é…é™¤å­—æ¯,æ•°å­—,ä¸‹åˆ’çº¿æˆ–æ±‰å­—ä¹‹å¤–çš„ä»»æ„å­—ç¬¦</td>
</tr>
<tr>
<td style="text-align:center">\S</td>
<td style="text-align:center">åŒ¹é…éç©ºç™½çš„ä»»æ„å­—ç¬¦</td>
</tr>
<tr>
<td style="text-align:center">\B</td>
<td style="text-align:center">åŒ¹é…éå•è¯å¼€å§‹æˆ–ç»“æŸçš„ä½ç½®</td>
</tr>
<tr>
<td style="text-align:center">[^x]</td>
<td style="text-align:center">åŒ¹é…é™¤xä»¥å¤–çš„ä»»æ„å­—ç¬¦</td>
</tr>
</tbody>
</table>
<p>å¯ä»¥çœ‹å‡ºæ­£åˆ™è¡¨è¾¾å¼ä¸¥æ ¼åŒºåˆ†å¤§å°å†™.</p>
<h4 id="é‡å¤é™å®šç¬¦"><a href="#é‡å¤é™å®šç¬¦" class="headerlink" title="é‡å¤é™å®šç¬¦"></a>é‡å¤é™å®šç¬¦</h4><p>é™å®šç¬¦å…±æœ‰6ä¸ª, å‡è®¾é‡å¤æ¬¡æ•°ä¸ºxæ¬¡, é‚£ä¹ˆå°†æœ‰å¦‚ä¸‹è§„åˆ™:</p>
<table>
<thead>
<tr>
<th style="text-align:center">é™å®šç¬¦</th>
<th style="text-align:center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">*</td>
<td style="text-align:center">x&gt;=0</td>
</tr>
<tr>
<td style="text-align:center">+</td>
<td style="text-align:center">x&gt;=1</td>
</tr>
<tr>
<td style="text-align:center">?</td>
<td style="text-align:center">x=0 or x=1</td>
</tr>
<tr>
<td style="text-align:center">{n}</td>
<td style="text-align:center">x=n</td>
</tr>
<tr>
<td style="text-align:center">{n,}</td>
<td style="text-align:center">x&gt;=n</td>
</tr>
<tr>
<td style="text-align:center">{n,m}</td>
<td style="text-align:center">n&lt;=x&lt;=m</td>
</tr>
</tbody>
</table>
<h4 id="å­—ç¬¦ç»„"><a href="#å­—ç¬¦ç»„" class="headerlink" title="å­—ç¬¦ç»„"></a>å­—ç¬¦ç»„</h4><p>[â€¦] åŒ¹é…ä¸­æ‹¬å·å†…å­—ç¬¦ä¹‹ä¸€. å¦‚: [xyz]  åŒ¹é…å­—ç¬¦ x, y æˆ– z. å¦‚æœä¸­æ‹¬å·ä¸­åŒ…å«å…ƒå­—ç¬¦, åˆ™å…ƒå­—ç¬¦é™çº§ä¸ºæ™®é€šå­—ç¬¦, ä¸å†å…·æœ‰å…ƒå­—ç¬¦çš„åŠŸèƒ½, å¦‚ [+.?] åŒ¹é… åŠ å·, ç‚¹å·æˆ–é—®å·.</p>
<h4 id="æ’é™¤æ€§å­—ç¬¦ç»„"><a href="#æ’é™¤æ€§å­—ç¬¦ç»„" class="headerlink" title="æ’é™¤æ€§å­—ç¬¦ç»„"></a>æ’é™¤æ€§å­—ç¬¦ç»„</h4><p>[^â€¦] åŒ¹é…ä»»ä½•æœªåˆ—å‡ºçš„å­—ç¬¦,. å¦‚:  [^x]  åŒ¹é…é™¤xä»¥å¤–çš„ä»»æ„å­—ç¬¦.</p>
<h4 id="å¤šé€‰ç»“æ„"><a href="#å¤šé€‰ç»“æ„" class="headerlink" title="å¤šé€‰ç»“æ„"></a>å¤šé€‰ç»“æ„</h4><p>| å°±æ˜¯æˆ–çš„æ„æ€, è¡¨ç¤ºä¸¤è€…ä¸­çš„ä¸€ä¸ª. å¦‚: a|b åŒ¹é…aæˆ–è€…bå­—ç¬¦.</p>
<h4 id="æ‹¬å·"><a href="#æ‹¬å·" class="headerlink" title="æ‹¬å·"></a>æ‹¬å·</h4><p>æ‹¬å· å¸¸ç”¨æ¥ç•Œå®šé‡å¤é™å®šç¬¦çš„èŒƒå›´, ä»¥åŠå°†å­—ç¬¦<strong>åˆ†ç»„</strong>. å¦‚: (ab)+ å¯ä»¥åŒ¹é…abab..ç­‰, å…¶ä¸­ ab ä¾¿æ˜¯ä¸€ä¸ªåˆ†ç»„.</p>
<h4 id="è½¬ä¹‰å­—ç¬¦"><a href="#è½¬ä¹‰å­—ç¬¦" class="headerlink" title="è½¬ä¹‰å­—ç¬¦"></a>è½¬ä¹‰å­—ç¬¦</h4><p>\ å³è½¬ä¹‰å­—ç¬¦, é€šå¸¸ <strong>\ * + ? | { [ ( ) ] }^ $ . # å’Œ ç©ºç™½</strong> è¿™äº›å­—ç¬¦éƒ½éœ€è¦è½¬ä¹‰.</p>
<h4 id="æ“ä½œç¬¦çš„è¿ç®—ä¼˜å…ˆçº§"><a href="#æ“ä½œç¬¦çš„è¿ç®—ä¼˜å…ˆçº§" class="headerlink" title="æ“ä½œç¬¦çš„è¿ç®—ä¼˜å…ˆçº§"></a>æ“ä½œç¬¦çš„è¿ç®—ä¼˜å…ˆçº§</h4><ol>
<li>\ è½¬ä¹‰ç¬¦</li>
<li>(), (?:), (?=), [] åœ†æ‹¬å·æˆ–æ–¹æ‹¬å·</li>
<li>*, +, ?, {n}, {n,}, {n,m} é™å®šç¬¦</li>
<li>^, $ ä½ç½®</li>
<li>| â€œæˆ–â€ æ“ä½œ</li>
</ol>
<h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸‹ä¸Šé¢çš„çŸ¥è¯†ç‚¹, å†™ä¸€ä¸ªåŒ¹é…æ‰‹æœºå·ç çš„æ­£åˆ™è¡¨è¾¾å¼, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(\+<span class="number">86</span>)?<span class="number">1</span>\d&#123;<span class="number">10</span>&#125;</div></pre></td></tr></table></figure>
<p>â‘  â€œ\+86â€ åŒ¹é…æ–‡æœ¬ â€œ+86â€, åé¢æ¥å…ƒå­—ç¬¦é—®å·, è¡¨ç¤ºå¯åŒ¹é…1æ¬¡æˆ–0æ¬¡, åˆèµ·æ¥è¡¨ç¤º â€œ(\+86)?â€ åŒ¹é… â€œ+86â€ æˆ–è€… â€œâ€.</p>
<p>â‘¡ æ™®é€šå­—ç¬¦â€1â€ åŒ¹é…æ–‡æœ¬ â€œ1â€.</p>
<p>â‘¢ å…ƒå­—ç¬¦ â€œ\dâ€ åŒ¹é…æ•°å­—0åˆ°9, åŒºé—´é‡è¯ â€œ{10}â€ è¡¨ç¤ºåŒ¹é… 10 æ¬¡, åˆèµ·æ¥è¡¨ç¤º â€œ\d{10}â€ åŒ¹é…è¿ç»­çš„10ä¸ªæ•°å­—.</p>
<p>ä»¥ä¸Š, åŒ¹é…ç»“æœå¦‚ä¸‹:</p>
<p><img src="http://louiszhai.github.io/docImages/regexp01.png" alt=""></p>
<h3 id="ä¿®é¥°ç¬¦"><a href="#ä¿®é¥°ç¬¦" class="headerlink" title="ä¿®é¥°ç¬¦"></a>ä¿®é¥°ç¬¦</h3><p>javaScriptä¸­æ­£åˆ™è¡¨è¾¾å¼é»˜è®¤æœ‰å¦‚ä¸‹äº”ç§ä¿®é¥°ç¬¦:</p>
<ul>
<li>g (å…¨æ–‡æŸ¥æ‰¾), å¦‚ä¸Šè¿°æˆªå›¾, å®é™…ä¸Šå°±å¼€å¯äº†å…¨æ–‡æŸ¥æ‰¾æ¨¡å¼.</li>
<li>i (å¿½ç•¥å¤§å°å†™æŸ¥æ‰¾)</li>
<li>m (å¤šè¡ŒæŸ¥æ‰¾)</li>
<li>y (ES6æ–°å¢çš„ç²˜è¿ä¿®é¥°ç¬¦)</li>
<li>u (ES6æ–°å¢)</li>
</ul>
<h3 id="å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼"><a href="#å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼"></a>å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼</h3><ol>
<li>æ±‰å­—: ^[\u4e00-\u9fa5]{0,}$</li>
<li>Email: ^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$</li>
<li>URL: ^https?://([\w-]+.)+[\w-]+(/[\w-./?%&amp;=]*)?$</li>
<li>æ‰‹æœºå·ç : ^1\d{10}$</li>
<li>èº«ä»½è¯å·: ^(\d{15}|\d{17}(\d|X))$</li>
<li>ä¸­å›½é‚®æ”¿ç¼–ç : [1-9]\d{5}(?!\d) (é‚®æ”¿ç¼–ç ä¸º6ä½æ•°å­—)</li>
</ol>
<h4 id="å¯†ç éªŒè¯"><a href="#å¯†ç éªŒè¯" class="headerlink" title="å¯†ç éªŒè¯"></a>å¯†ç éªŒè¯</h4><p>å¯†ç éªŒè¯æ˜¯å¸¸è§çš„éœ€æ±‚, ä¸€èˆ¬æ¥è¯´, å¸¸è§„å¯†ç å¤§è‡´ä¼šæ»¡è¶³è§„å¾‹: 6-16ä½, æ•°å­—, å­—æ¯, å­—ç¬¦è‡³å°‘åŒ…å«ä¸¤ç§, åŒæ—¶ä¸èƒ½åŒ…å«ä¸­æ–‡å’Œç©ºæ ¼. å¦‚ä¸‹ä¾¿æ˜¯å¸¸è§„å¯†ç éªŒè¯çš„æ­£åˆ™æè¿°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/(?!^[0-9]+$)(?!^[A-z]+$)(?!^[^A-z0-9]+$)^[^\s\u4e00-\u9fa5]&#123;6,16&#125;$/</span>;</div></pre></td></tr></table></figure>
<h3 id="æ­£åˆ™çš„å‡ å¤§å®¶æ—"><a href="#æ­£åˆ™çš„å‡ å¤§å®¶æ—" class="headerlink" title="æ­£åˆ™çš„å‡ å¤§å®¶æ—"></a>æ­£åˆ™çš„å‡ å¤§å®¶æ—</h3><h4 id="æ­£åˆ™è¡¨è¾¾å¼åˆ†ç±»"><a href="#æ­£åˆ™è¡¨è¾¾å¼åˆ†ç±»" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼åˆ†ç±»"></a>æ­£åˆ™è¡¨è¾¾å¼åˆ†ç±»</h4><p>åœ¨ linux å’Œ osx ä¸‹, å¸¸è§çš„æ­£åˆ™è¡¨è¾¾å¼, è‡³å°‘æœ‰ä»¥ä¸‹ä¸‰ç§: </p>
<ul>
<li>åŸºæœ¬çš„æ­£åˆ™è¡¨è¾¾å¼( Basic Regular Expression åˆå« Basic RegEx  ç®€ç§° <strong>BREs</strong> )</li>
<li>æ‰©å±•çš„æ­£åˆ™è¡¨è¾¾å¼( Extended Regular Expression åˆå« Extended RegEx ç®€ç§° <strong>EREs</strong> )</li>
<li>Perl çš„æ­£åˆ™è¡¨è¾¾å¼( Perl Regular Expression åˆå« Perl RegEx ç®€ç§° <strong>PREs</strong> )</li>
</ul>
<h4 id="æ­£åˆ™è¡¨è¾¾å¼æ¯”è¾ƒ"><a href="#æ­£åˆ™è¡¨è¾¾å¼æ¯”è¾ƒ" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼æ¯”è¾ƒ"></a>æ­£åˆ™è¡¨è¾¾å¼æ¯”è¾ƒ</h4><table>
<thead>
<tr>
<th>å­—ç¬¦</th>
<th>è¯´æ˜</th>
<th>Basic RegEx</th>
<th>Extended RegEx</th>
<th>python RegEx</th>
<th>Perl regEx</th>
</tr>
</thead>
<tbody>
<tr>
<td>è½¬ä¹‰</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>^</td>
<td>åŒ¹é…è¡Œé¦–ï¼Œä¾‹å¦‚â€™^dogâ€™åŒ¹é…ä»¥å­—ç¬¦ä¸²dogå¼€å¤´çš„è¡Œï¼ˆæ³¨æ„ï¼šawk æŒ‡ä»¤ä¸­ï¼Œâ€™^â€™åˆ™æ˜¯åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹ï¼‰</td>
<td>^</td>
<td>^</td>
<td>^</td>
<td>^</td>
</tr>
<tr>
<td>$</td>
<td>åŒ¹é…è¡Œå°¾ï¼Œä¾‹å¦‚ï¼šâ€™^ã€dog\$â€™ åŒ¹é…ä»¥å­—ç¬¦ä¸² dog ä¸ºç»“å°¾çš„è¡Œï¼ˆæ³¨æ„ï¼šawk æŒ‡ä»¤ä¸­ï¼Œâ€™$â€™åˆ™æ˜¯åŒ¹é…å­—ç¬¦ä¸²çš„ç»“å°¾ï¼‰</td>
<td>$</td>
<td>$</td>
<td>$</td>
<td>$</td>
</tr>
<tr>
<td>^$</td>
<td>åŒ¹é…ç©ºè¡Œ</td>
<td>^$</td>
<td>^$</td>
<td>^$</td>
<td>^$</td>
</tr>
<tr>
<td>^string$</td>
<td>åŒ¹é…è¡Œï¼Œä¾‹å¦‚ï¼šâ€™^dog$â€™åŒ¹é…åªå«ä¸€ä¸ªå­—ç¬¦ä¸² dog çš„è¡Œ</td>
<td>^string$</td>
<td>^string$</td>
<td>^string$</td>
<td>^string$</td>
</tr>
<tr>
<td>\&lt;</td>
<td>åŒ¹é…å•è¯ï¼Œä¾‹å¦‚ï¼šâ€™\&lt;frogâ€™ ï¼ˆç­‰ä»·äºâ€™\bfrogâ€™ï¼‰ï¼ŒåŒ¹é…ä»¥ frog å¼€å¤´çš„å•è¯</td>
<td>\&lt;</td>
<td>\&lt;</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆä½†å¯ä»¥ä½¿ç”¨\bæ¥åŒ¹é…å•è¯ï¼Œä¾‹å¦‚ï¼šâ€™\bfrogâ€™ï¼‰</td>
</tr>
<tr>
<td>></td>
<td>åŒ¹é…å•è¯ï¼Œä¾‹å¦‚ï¼šâ€™frog>â€˜ï¼ˆç­‰ä»·äºâ€™frog\b â€˜ï¼‰ï¼ŒåŒ¹é…ä»¥ frog ç»“å°¾çš„å•è¯</td>
<td>></td>
<td>></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆä½†å¯ä»¥ä½¿ç”¨\bæ¥åŒ¹é…å•è¯ï¼Œä¾‹å¦‚ï¼šâ€™frog\bâ€™ï¼‰</td>
</tr>
<tr>
<td>\<x></x></td>
<td>åŒ¹é…ä¸€ä¸ªå•è¯æˆ–è€…ä¸€ä¸ªç‰¹å®šå­—ç¬¦ï¼Œä¾‹å¦‚ï¼šâ€™\<frog\>â€˜ï¼ˆç­‰ä»·äºâ€™\bfrog\bâ€™ï¼‰ã€â€™\<g\>â€˜</g\></frog\></td>
<td>\<x></x></td>
<td>\<x></x></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆä½†å¯ä»¥ä½¿ç”¨\bæ¥åŒ¹é…å•è¯ï¼Œä¾‹å¦‚ï¼šâ€™\bfrog\bâ€™</td>
</tr>
<tr>
<td>()</td>
<td>åŒ¹é…è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼šä¸æ”¯æŒâ€™ï¼ˆfrogï¼‰â€™</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆä½†å¯ä»¥ä½¿ç”¨ï¼Œå¦‚ï¼šdog</td>
<td>()</td>
<td>()</td>
<td>()</td>
</tr>
<tr>
<td></td>
<td>åŒ¹é…è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼šä¸æ”¯æŒâ€™ï¼ˆfrogï¼‰â€™</td>
<td></td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ())</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ())</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ())</td>
</tr>
<tr>
<td>ï¼Ÿ</td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ 0 æ¬¡æˆ– 1 æ¬¡ï¼ˆç­‰ä»·äº{0,1}ï¼‰ï¼Œä¾‹å¦‚ï¼šwhere(is)?èƒ½åŒ¹é…â€whereâ€ ä»¥åŠâ€whereisâ€</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ\?)</td>
<td>ï¼Ÿ</td>
<td>ï¼Ÿ</td>
<td>ï¼Ÿ</td>
</tr>
<tr>
<td>\?</td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ 0 æ¬¡æˆ– 1 æ¬¡ï¼ˆç­‰ä»·äºâ€™{0,1}â€˜ï¼‰ï¼Œä¾‹å¦‚ï¼šâ€™whereis\? â€˜èƒ½åŒ¹é… â€œwhereâ€ä»¥åŠâ€whereisâ€</td>
<td>\?</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ?)</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ?)</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ?)</td>
</tr>
<tr>
<td>?</td>
<td>å½“è¯¥å­—ç¬¦ç´§è·Ÿåœ¨ä»»ä½•ä¸€ä¸ªå…¶ä»–é™åˆ¶ç¬¦ï¼ˆ*, +, ?, {n},{n,}, {n,m}ï¼‰ åé¢æ—¶ï¼ŒåŒ¹é…æ¨¡å¼æ˜¯éè´ªå©ªçš„ã€‚éè´ªå©ªæ¨¡å¼å°½å¯èƒ½å°‘çš„åŒ¹é…æ‰€æœç´¢çš„å­—ç¬¦ä¸²ï¼Œè€Œé»˜è®¤çš„è´ªå©ªæ¨¡å¼åˆ™å°½å¯èƒ½å¤šçš„åŒ¹é…æ‰€æœç´¢çš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå­—ç¬¦ä¸² â€œooooâ€ï¼Œâ€™o+?â€™ å°†åŒ¹é…å•ä¸ªâ€oâ€ï¼Œè€Œ â€˜o+â€™ å°†åŒ¹é…æ‰€æœ‰ â€˜oâ€™</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
</tr>
<tr>
<td>.</td>
<td>åŒ¹é…é™¤æ¢è¡Œç¬¦ï¼ˆâ€™\nâ€™ï¼‰ä¹‹å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ï¼ˆæ³¨æ„ï¼šawk æŒ‡ä»¤ä¸­çš„å¥ç‚¹èƒ½åŒ¹é…æ¢è¡Œç¬¦ï¼‰</td>
<td>.</td>
<td>.ï¼ˆå¦‚æœè¦åŒ¹é…åŒ…æ‹¬â€œ\nâ€åœ¨å†…çš„ä»»ä½•ä¸€ä¸ªå­—ç¬¦ï¼Œè¯·ä½¿ç”¨: [\s\S]</td>
<td>.</td>
<td>.ï¼ˆå¦‚æœè¦åŒ¹é…åŒ…æ‹¬â€œ\nâ€åœ¨å†…çš„ä»»ä½•ä¸€ä¸ªå­—ç¬¦ï¼Œè¯·ä½¿ç”¨ï¼šâ€™ [.\n] â€˜</td>
</tr>
<tr>
<td>*</td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ 0 æ¬¡æˆ–å¤šæ¬¡ï¼ˆç­‰ä»·äº{0, }ï¼‰ï¼Œä¾‹å¦‚ï¼šzo* èƒ½åŒ¹é… â€œzâ€ä»¥åŠ â€œzooâ€</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>+</td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ 1 æ¬¡æˆ–å¤šæ¬¡ï¼ˆç­‰ä»·äºâ€™{1, }â€˜ï¼‰ï¼Œä¾‹å¦‚ï¼šâ€™whereis+ â€˜èƒ½åŒ¹é… â€œwhereisâ€ä»¥åŠâ€whereisisâ€</td>
<td>+</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ+)</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ+)</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ+)</td>
</tr>
<tr>
<td>+</td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ 1 æ¬¡æˆ–å¤šæ¬¡ï¼ˆç­‰ä»·äº{1, }ï¼‰ï¼Œä¾‹å¦‚ï¼šzo+èƒ½åŒ¹é… â€œzoâ€ä»¥åŠ â€œzooâ€ï¼Œä½†ä¸èƒ½åŒ¹é… â€œzâ€</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ\+)</td>
<td>+</td>
<td>+</td>
<td>+</td>
</tr>
<tr>
<td>{n}</td>
<td>n å¿…é¡»æ˜¯ä¸€ä¸ª 0 æˆ–è€…æ­£æ•´æ•°ï¼ŒåŒ¹é…å­è¡¨è¾¾å¼ n æ¬¡ï¼Œä¾‹å¦‚ï¼šzo{2}èƒ½åŒ¹é…</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ\{n\})</td>
<td>{n}</td>
<td>{n}</td>
<td>{n}</td>
</tr>
<tr>
<td>{n,}</td>
<td>â€œzoozâ€ï¼Œä½†ä¸èƒ½åŒ¹é… â€œBobâ€n å¿…é¡»æ˜¯ä¸€ä¸ª 0 æˆ–è€…æ­£æ•´æ•°ï¼ŒåŒ¹é…å­è¡¨è¾¾å¼å¤§äºç­‰äº næ¬¡ï¼Œä¾‹å¦‚ï¼šgo{2,}</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ\{n,\})</td>
<td>{n,}</td>
<td>{n,}</td>
<td>{n,}</td>
</tr>
<tr>
<td>{n,m}</td>
<td>èƒ½åŒ¹é… â€œgoodâ€ï¼Œä½†ä¸èƒ½åŒ¹é… godm å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­ n &lt;= mï¼Œæœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ ï¼Œä¾‹å¦‚ï¼šo{1,3}å°†é…â€foooooodâ€ ä¸­çš„å‰ä¸‰ä¸ª oï¼ˆè¯·æ³¨æ„åœ¨é€—å·å’Œä¸¤ä¸ªæ•°ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ï¼‰</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒ\{n,m\})</td>
<td>{n,m}</td>
<td>{n,m}</td>
<td>{n,m}</td>
</tr>
<tr>
<td>x l y</td>
<td>åŒ¹é… x æˆ– y</td>
<td><strong>ä¸æ”¯æŒ</strong>ï¼ˆåŒx \l y</td>
<td>x l y</td>
<td>x l y</td>
<td>x l y</td>
</tr>
<tr>
<td>[0-9]</td>
<td>åŒ¹é…ä» 0 åˆ° 9 ä¸­çš„ä»»æ„ä¸€ä¸ªæ•°å­—å­—ç¬¦ï¼ˆæ³¨æ„ï¼šè¦å†™æˆé€’å¢ï¼‰</td>
<td>[0-9]</td>
<td>[0-9]</td>
<td>[0-9]</td>
<td>[0-9]</td>
</tr>
<tr>
<td>[xyz]</td>
<td>å­—ç¬¦é›†åˆï¼ŒåŒ¹é…æ‰€åŒ…å«çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚ï¼šâ€™[abc]â€™å¯ä»¥åŒ¹é…â€layâ€ ä¸­çš„ â€˜aâ€™ï¼ˆæ³¨æ„ï¼šå¦‚æœå…ƒå­—ç¬¦ï¼Œä¾‹å¦‚ï¼š. *ç­‰ï¼Œå®ƒä»¬è¢«æ”¾åœ¨[ ]ä¸­ï¼Œé‚£ä¹ˆå®ƒä»¬å°†å˜æˆä¸€ä¸ªæ™®é€šå­—ç¬¦ï¼‰</td>
<td>[xyz]</td>
<td>[xyz]</td>
<td>[xyz]</td>
<td>[xyz]</td>
</tr>
<tr>
<td>[^xyz]</td>
<td>è´Ÿå€¼å­—ç¬¦é›†åˆï¼ŒåŒ¹é…æœªåŒ…å«çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼ˆæ³¨æ„ï¼šä¸åŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰ï¼Œä¾‹å¦‚ï¼šâ€™[^abc]â€™ å¯ä»¥åŒ¹é… â€œLayâ€ ä¸­çš„â€™Lâ€™ï¼ˆæ³¨æ„ï¼š[^xyz]åœ¨awk æŒ‡ä»¤ä¸­åˆ™æ˜¯åŒ¹é…æœªåŒ…å«çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦+æ¢è¡Œç¬¦ï¼‰</td>
<td>[^xyz]</td>
<td>[^xyz]</td>
<td>[^xyz]</td>
<td>[^xyz]</td>
</tr>
<tr>
<td>[A-Za-z]</td>
<td>åŒ¹é…å¤§å†™å­—æ¯æˆ–è€…å°å†™å­—æ¯ä¸­çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼ˆæ³¨æ„ï¼šè¦å†™æˆé€’å¢ï¼‰</td>
<td>[A-Za-z]</td>
<td>[A-Za-z]</td>
<td>[A-Za-z]</td>
<td>[A-Za-z]</td>
</tr>
<tr>
<td>[^A-Za-z]</td>
<td>åŒ¹é…é™¤äº†å¤§å†™ä¸å°å†™å­—æ¯ä¹‹å¤–çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼ˆæ³¨æ„ï¼šå†™æˆé€’å¢ï¼‰</td>
<td>[^A-Za-z]</td>
<td>[^A-Za-z]</td>
<td>[^A-Za-z]</td>
<td>[^A-Za-z]</td>
</tr>
<tr>
<td>\d</td>
<td>åŒ¹é…ä» 0 åˆ° 9 ä¸­çš„ä»»æ„ä¸€ä¸ªæ•°å­—å­—ç¬¦ï¼ˆç­‰ä»·äº [0-9]ï¼‰</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td>\d</td>
<td>\d</td>
</tr>
<tr>
<td>\D</td>
<td>åŒ¹é…éæ•°å­—å­—ç¬¦ï¼ˆç­‰ä»·äº [^0-9]ï¼‰</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td>\D</td>
<td>\D</td>
</tr>
<tr>
<td>\S</td>
<td>åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ï¼ˆç­‰ä»·äº[^\f\n\r\t\v]ï¼‰</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td>\S</td>
<td>\S</td>
</tr>
<tr>
<td>\s</td>
<td>åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ï¼ˆç­‰ä»·äº[ \f\n\r\t\v]ï¼‰</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td>\s</td>
<td>\s</td>
</tr>
<tr>
<td>\W</td>
<td>åŒ¹é…ä»»ä½•éå•è¯å­—ç¬¦ (ç­‰ä»·äº[^A-Za-z0-9_])</td>
<td>\W</td>
<td>\W</td>
<td>\W</td>
<td>\W</td>
</tr>
<tr>
<td>\w</td>
<td>åŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿çš„ä»»ä½•å•è¯å­—ç¬¦ï¼ˆç­‰ä»·äº[A-Za-z0-9_]ï¼‰</td>
<td>\w</td>
<td>\w</td>
<td>\w</td>
<td>\w</td>
</tr>
<tr>
<td>\B</td>
<td>åŒ¹é…éå•è¯è¾¹ç•Œï¼Œä¾‹å¦‚ï¼šâ€™er\Bâ€™ èƒ½åŒ¹é… â€œverbâ€ ä¸­çš„â€™erâ€™ï¼Œä½†ä¸èƒ½åŒ¹é…â€neverâ€ ä¸­çš„â€™erâ€™</td>
<td>\B</td>
<td>\B</td>
<td>\B</td>
<td>\B</td>
</tr>
<tr>
<td>\b</td>
<td>åŒ¹é…ä¸€ä¸ªå•è¯è¾¹ç•Œï¼Œä¹Ÿå°±æ˜¯æŒ‡å•è¯å’Œç©ºæ ¼é—´çš„ä½ç½®ï¼Œä¾‹å¦‚ï¼š â€˜er\bâ€™ å¯ä»¥åŒ¹é…â€neverâ€ ä¸­çš„ â€˜erâ€™ï¼Œä½†ä¸èƒ½åŒ¹é… â€œverbâ€ ä¸­çš„â€™erâ€™</td>
<td>\b</td>
<td>\b</td>
<td>\b</td>
<td>\b</td>
</tr>
<tr>
<td>\t</td>
<td>åŒ¹é…ä¸€ä¸ªæ¨ªå‘åˆ¶è¡¨ç¬¦ï¼ˆç­‰ä»·äº \x09å’Œ \cIï¼‰</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td>\t</td>
<td>\t</td>
</tr>
<tr>
<td>\v</td>
<td>åŒ¹é…ä¸€ä¸ªå‚ç›´åˆ¶è¡¨ç¬¦ï¼ˆç­‰ä»·äº \x0bå’Œ \cKï¼‰</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td>\v</td>
<td>\v</td>
</tr>
<tr>
<td>\n</td>
<td>åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ï¼ˆç­‰ä»·äº \x0a å’Œ\cJï¼‰</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td>\n</td>
<td>\n</td>
</tr>
<tr>
<td>\f</td>
<td>åŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦ï¼ˆç­‰ä»·äº\x0c å’Œ\cLï¼‰</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td>\f</td>
<td>\f</td>
</tr>
<tr>
<td>\r</td>
<td>åŒ¹é…ä¸€ä¸ªå›è½¦ç¬¦ï¼ˆç­‰ä»·äº \x0d å’Œ\cMï¼‰</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td>\r</td>
<td>\r</td>
</tr>
<tr>
<td>\</td>
<td>åŒ¹é…è½¬ä¹‰å­—ç¬¦æœ¬èº«â€\â€</td>
<td>\</td>
<td>\</td>
<td>\</td>
<td>\</td>
</tr>
<tr>
<td>\cx</td>
<td>åŒ¹é…ç”± x æŒ‡æ˜çš„æ§åˆ¶å­—ç¬¦ï¼Œä¾‹å¦‚ï¼š\cMåŒ¹é…ä¸€ä¸ªControl-M æˆ–å›è½¦ç¬¦ï¼Œx çš„å€¼å¿…é¡»ä¸ºA-Z æˆ– a-z ä¹‹ä¸€ï¼Œå¦åˆ™ï¼Œå°† c è§†ä¸ºä¸€ä¸ªåŸä¹‰çš„ â€˜câ€™ å­—ç¬¦</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td></td>
<td>\cx</td>
</tr>
<tr>
<td>\xn</td>
<td>åŒ¹é… nï¼Œå…¶ä¸­ n ä¸ºåå…­è¿›åˆ¶è½¬ä¹‰å€¼ã€‚åå…­è¿›åˆ¶è½¬ä¹‰å€¼å¿…é¡»ä¸ºç¡®å®šçš„ä¸¤ä¸ªæ•°å­—é•¿ï¼Œä¾‹å¦‚ï¼šâ€™\x41â€™ åŒ¹é… â€œAâ€ã€‚â€™\x041â€™ åˆ™ç­‰ä»·äºâ€™\x04â€™ &amp; â€œ1â€ã€‚æ­£åˆ™è¡¨è¾¾å¼ä¸­å¯ä»¥ä½¿ç”¨ ASCII ç¼–ç </td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td></td>
<td>\xn</td>
</tr>
<tr>
<td>\num</td>
<td>åŒ¹é… numï¼Œå…¶ä¸­ numæ˜¯ä¸€ä¸ªæ­£æ•´æ•°ã€‚è¡¨ç¤ºå¯¹æ‰€è·å–çš„åŒ¹é…çš„å¼•ç”¨</td>
<td><strong>ä¸æ”¯æŒ</strong></td>
<td>\num</td>
<td>\num</td>
<td></td>
</tr>
<tr>
<td>[:alnum:]</td>
<td>åŒ¹é…ä»»ä½•ä¸€ä¸ªå­—æ¯æˆ–æ•°å­—ï¼ˆ[A-Za-z0-9]ï¼‰ï¼Œä¾‹å¦‚ï¼šâ€™[[:alnum:]] â€˜</td>
<td>[:alnum:]</td>
<td>[:alnum:]</td>
<td>[:alnum:]</td>
<td>[:alnum:]</td>
</tr>
<tr>
<td>[:alpha:]</td>
<td>åŒ¹é…ä»»ä½•ä¸€ä¸ªå­—æ¯ï¼ˆ[Aï¼Zaï¼z]ï¼‰ï¼Œ ä¾‹å¦‚ï¼šâ€™ [[:alpha:]] â€˜</td>
<td>[:alpha:]</td>
<td>[:alpha:]</td>
<td>[:alpha:]</td>
<td>[:alpha:]</td>
</tr>
<tr>
<td>[:digit:]</td>
<td>åŒ¹é…ä»»ä½•ä¸€ä¸ªæ•°å­—ï¼ˆ[0-9]ï¼‰ï¼Œä¾‹å¦‚ï¼šâ€™[[:digit:]] â€˜</td>
<td>[:digit:]</td>
<td>[:digit:]</td>
<td>[:digit:]</td>
<td>[:digit:]</td>
</tr>
<tr>
<td>[:lower:]</td>
<td>åŒ¹é…ä»»ä½•ä¸€ä¸ªå°å†™å­—æ¯ï¼ˆ[a-z]ï¼‰ï¼Œ ä¾‹å¦‚ï¼šâ€™ [[:lower:]] â€˜</td>
<td>[:lower:]</td>
<td>[:lower:]</td>
<td>[:lower:]</td>
<td>[:lower:]</td>
</tr>
<tr>
<td>[:upper:]</td>
<td>åŒ¹é…ä»»ä½•ä¸€ä¸ªå¤§å†™å­—æ¯ï¼ˆ[A-Z]ï¼‰</td>
<td>[:upper:]</td>
<td>[:upper:]</td>
<td>[:upper:]</td>
<td>[:upper:]</td>
</tr>
<tr>
<td>[:space:]</td>
<td>ä»»ä½•ä¸€ä¸ªç©ºç™½å­—ç¬¦ï¼š æ”¯æŒåˆ¶è¡¨ç¬¦ã€ç©ºæ ¼ï¼Œä¾‹å¦‚ï¼šâ€™ [[:space:]] â€˜</td>
<td>[:space:]</td>
<td>[:space:]</td>
<td>[:space:]</td>
<td>[:space:]</td>
</tr>
<tr>
<td>[:blank:]</td>
<td>ç©ºæ ¼å’Œåˆ¶è¡¨ç¬¦ï¼ˆæ¨ªå‘å’Œçºµå‘ï¼‰ï¼Œä¾‹å¦‚ï¼šâ€™[[:blank:]]â€™Ã³â€™[\s\t\v]â€™</td>
<td>[:blank:]</td>
<td>[:blank:]</td>
<td>[:blank:]</td>
<td>[:blank:]</td>
</tr>
<tr>
<td>[:graph:]</td>
<td>ä»»ä½•ä¸€ä¸ªå¯ä»¥çœ‹å¾—è§çš„ä¸”å¯ä»¥æ‰“å°çš„å­—ç¬¦ï¼ˆæ³¨æ„ï¼šä¸åŒ…æ‹¬ç©ºæ ¼å’Œæ¢è¡Œç¬¦ç­‰ï¼‰ï¼Œä¾‹å¦‚ï¼šâ€™[[:graph:]] â€˜</td>
<td>[:graph:]</td>
<td>[:graph:]</td>
<td>[:graph:]</td>
<td>[:graph:]</td>
</tr>
<tr>
<td>[:print:]</td>
<td>ä»»ä½•ä¸€ä¸ªå¯ä»¥æ‰“å°çš„å­—ç¬¦ï¼ˆæ³¨æ„ï¼šä¸åŒ…æ‹¬ï¼š[:cntrl:]ã€å­—ç¬¦ä¸²ç»“æŸç¬¦â€™\0â€™ã€EOF æ–‡ä»¶ç»“æŸç¬¦ï¼ˆ-1ï¼‰ï¼Œ ä½†åŒ…æ‹¬ç©ºæ ¼ç¬¦å·ï¼‰ï¼Œä¾‹å¦‚ï¼šâ€™[[:print:]] â€˜</td>
<td>[:print:]</td>
<td>[:print:]</td>
<td>[:print:]</td>
<td>[:print:]</td>
</tr>
<tr>
<td>[:cntrl:]</td>
<td>ä»»ä½•ä¸€ä¸ªæ§åˆ¶å­—ç¬¦ï¼ˆASCII å­—ç¬¦é›†ä¸­çš„å‰ 32 ä¸ªå­—ç¬¦ï¼Œå³ï¼šç”¨åè¿›åˆ¶è¡¨ç¤ºä¸ºä» 0 åˆ°31ï¼Œä¾‹å¦‚ï¼šæ¢è¡Œç¬¦ã€åˆ¶è¡¨ç¬¦ç­‰ç­‰ï¼‰ï¼Œä¾‹å¦‚ï¼šâ€™ [[:cntrl:]]â€™</td>
<td>[:cntrl:]</td>
<td>[:cntrl:]</td>
<td>[:cntrl:]</td>
<td>[:cntrl:]</td>
</tr>
<tr>
<td>[:punct:]</td>
<td>ä»»ä½•ä¸€ä¸ªæ ‡ç‚¹ç¬¦å·ï¼ˆä¸åŒ…æ‹¬ï¼š[:alnum:]ã€[:cntrl:]ã€[:space:]è¿™äº›å­—ç¬¦é›†ï¼‰</td>
<td>[:punct:]</td>
<td>[:punct:]</td>
<td>[:punct:]</td>
<td>[:punct:]</td>
</tr>
<tr>
<td>[:xdigit:]</td>
<td>ä»»ä½•ä¸€ä¸ªåå…­è¿›åˆ¶æ•°ï¼ˆå³ï¼š0-9ï¼Œa-fï¼ŒA-Fï¼‰</td>
<td>[:xdigit:]</td>
<td>[:xdigit:]</td>
<td>[:xdigit:]</td>
<td>[:xdigit:]</td>
</tr>
</tbody>
</table>
<p><strong>æ³¨æ„</strong> </p>
<ul>
<li>jsä¸­æ”¯æŒçš„æ˜¯EREs.</li>
<li>å½“ä½¿ç”¨ BREs ( åŸºæœ¬æ­£åˆ™è¡¨è¾¾å¼ ) æ—¶ï¼Œå¿…é¡»åœ¨ä¸‹åˆ—è¿™äº›ç¬¦å·(?,+,|,{,},(,))å‰åŠ ä¸Šè½¬ä¹‰å­—ç¬¦ \ .</li>
<li>ä¸Šè¿°[[:xxxx:]] å½¢å¼çš„æ­£åˆ™è¡¨è¾¾å¼, æ˜¯phpä¸­å†…ç½®çš„é€šç”¨å­—ç¬¦ç°‡, jsä¸­å¹¶ä¸æ”¯æŒ.</li>
</ul>
<h3 id="linux-osxä¸‹å¸¸ç”¨å‘½ä»¤ä¸æ­£åˆ™è¡¨è¾¾å¼çš„å…³ç³»"><a href="#linux-osxä¸‹å¸¸ç”¨å‘½ä»¤ä¸æ­£åˆ™è¡¨è¾¾å¼çš„å…³ç³»" class="headerlink" title="linux/osxä¸‹å¸¸ç”¨å‘½ä»¤ä¸æ­£åˆ™è¡¨è¾¾å¼çš„å…³ç³»"></a>linux/osxä¸‹å¸¸ç”¨å‘½ä»¤ä¸æ­£åˆ™è¡¨è¾¾å¼çš„å…³ç³»</h3><p>æˆ‘æ›¾ç»å°è¯•åœ¨ grep å’Œ sed å‘½ä»¤ä¸­ä¹¦å†™æ­£åˆ™è¡¨è¾¾å¼, ç»å¸¸å‘ç°ä¸èƒ½ä½¿ç”¨å…ƒå­—ç¬¦, è€Œä¸”æœ‰æ—¶å€™éœ€è¦è½¬ä¹‰, æœ‰æ—¶å€™ä¸éœ€è¦è½¬ä¹‰, å§‹ç»ˆä¸èƒ½æ‘¸æ¸…å®ƒçš„è§„å¾‹. å¦‚æœæ°å¥½ä½ ä¹Ÿæœ‰åŒæ ·çš„å›°æƒ‘, é‚£ä¹ˆè¯·å¾€ä¸‹çœ‹, ç›¸ä¿¡åº”è¯¥èƒ½æœ‰æ‰€æ”¶è·.</p>
<h4 id="grep-egrep-sed-awk-æ­£åˆ™è¡¨è¾¾å¼ç‰¹ç‚¹"><a href="#grep-egrep-sed-awk-æ­£åˆ™è¡¨è¾¾å¼ç‰¹ç‚¹" class="headerlink" title="grep , egrep , sed , awk  æ­£åˆ™è¡¨è¾¾å¼ç‰¹ç‚¹"></a>grep , egrep , sed , awk  æ­£åˆ™è¡¨è¾¾å¼ç‰¹ç‚¹</h4><ol>
<li><p>grep æ”¯æŒï¼šBREsã€EREsã€PREs æ­£åˆ™è¡¨è¾¾å¼</p>
<p>grep æŒ‡ä»¤åä¸è·Ÿä»»ä½•å‚æ•°, åˆ™è¡¨ç¤ºè¦ä½¿ç”¨ â€œBREsâ€</p>
<p>grep æŒ‡ä»¤åè·Ÿ â€-Eâ€ å‚æ•°, åˆ™è¡¨ç¤ºè¦ä½¿ç”¨ â€œEREsâ€</p>
<p>grep æŒ‡ä»¤åè·Ÿ â€œ-Pâ€ å‚æ•°, åˆ™è¡¨ç¤ºè¦ä½¿ç”¨ â€œPREsâ€</p>
</li>
<li><p>egrep æ”¯æŒï¼šEREsã€PREs æ­£åˆ™è¡¨è¾¾å¼</p>
<p>egrep æŒ‡ä»¤åä¸è·Ÿä»»ä½•å‚æ•°, åˆ™è¡¨ç¤ºè¦ä½¿ç”¨ â€œEREsâ€</p>
<p>egrep æŒ‡ä»¤åè·Ÿ â€œ-Pâ€ å‚æ•°, åˆ™è¡¨ç¤ºè¦ä½¿ç”¨ â€œPREsâ€</p>
</li>
<li><p>sed æ”¯æŒ: BREsã€EREs</p>
<p>sed æŒ‡ä»¤é»˜è®¤æ˜¯ä½¿ç”¨ â€œBREsâ€</p>
<p>sed æŒ‡ä»¤åè·Ÿ â€œ-râ€ å‚æ•° , åˆ™è¡¨ç¤ºè¦ä½¿ç”¨â€œEREsâ€</p>
</li>
<li><p>awk æ”¯æŒ EREs, å¹¶ä¸”é»˜è®¤ä½¿ç”¨ â€œEREsâ€</p>
</li>
</ol>
<h3 id="æ­£åˆ™è¡¨è¾¾å¼åˆé˜¶æŠ€èƒ½"><a href="#æ­£åˆ™è¡¨è¾¾å¼åˆé˜¶æŠ€èƒ½" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼åˆé˜¶æŠ€èƒ½"></a>æ­£åˆ™è¡¨è¾¾å¼åˆé˜¶æŠ€èƒ½</h3><h4 id="è´ªå©ªæ¨¡å¼ä¸éè´ªå©ªæ¨¡å¼"><a href="#è´ªå©ªæ¨¡å¼ä¸éè´ªå©ªæ¨¡å¼" class="headerlink" title="è´ªå©ªæ¨¡å¼ä¸éè´ªå©ªæ¨¡å¼"></a>è´ªå©ªæ¨¡å¼ä¸éè´ªå©ªæ¨¡å¼</h4><p>é»˜è®¤æƒ…å†µä¸‹, æ‰€æœ‰çš„é™å®šè¯éƒ½æ˜¯è´ªå©ªæ¨¡å¼, è¡¨ç¤ºå°½å¯èƒ½å¤šçš„å»æ•è·å­—ç¬¦; è€Œåœ¨é™å®šè¯åå¢åŠ ?, åˆ™æ˜¯éè´ªå©ªæ¨¡å¼, è¡¨ç¤ºå°½å¯èƒ½å°‘çš„å»æ•è·å­—ç¬¦. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"aaab"</span>,</div><div class="line">    reg1 = <span class="regexp">/a+/</span>, <span class="comment">//è´ªå©ªæ¨¡å¼</span></div><div class="line">    reg2 = <span class="regexp">/a+?/</span>;<span class="comment">//éè´ªå©ªæ¨¡å¼</span></div><div class="line"><span class="built_in">console</span>.log(str.match(reg1)); <span class="comment">//["aaa"], ç”±äºæ˜¯è´ªå©ªæ¨¡å¼, æ•è·äº†æ‰€æœ‰çš„a</span></div><div class="line"><span class="built_in">console</span>.log(str.match(regs)); <span class="comment">//["a"], ç”±äºæ˜¯éè´ªå©ªæ¨¡å¼, åªæ•è·åˆ°ç¬¬ä¸€ä¸ªa</span></div></pre></td></tr></table></figure>
<p>å®é™…ä¸Š, éè´ªå©ªæ¨¡å¼éå¸¸æœ‰æ•ˆ, ç‰¹åˆ«æ˜¯å½“åŒ¹é…htmlæ ‡ç­¾æ—¶. æ¯”å¦‚åŒ¹é…ä¸€ä¸ªé…å¯¹å‡ºç°çš„div, æ–¹æ¡ˆä¸€å¯èƒ½ä¼šåŒ¹é…åˆ°å¾ˆå¤šçš„divæ ‡ç­¾å¯¹, è€Œæ–¹æ¡ˆäºŒåˆ™åªä¼šåŒ¹é…ä¸€ä¸ªdivæ ‡ç­¾å¯¹.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"&lt;div class='v1'&gt;&lt;div class='v2'&gt;test&lt;/div&gt;&lt;input type='text'/&gt;&lt;/div&gt;"</span>;</div><div class="line"><span class="keyword">var</span> reg1 = <span class="regexp">/&lt;div.*&lt;\/div&gt;/</span>; <span class="comment">//æ–¹æ¡ˆä¸€,è´ªå©ªåŒ¹é…</span></div><div class="line"><span class="keyword">var</span> reg2 = <span class="regexp">/&lt;div.*?&lt;\/div&gt;/</span>;<span class="comment">//æ–¹æ¡ˆäºŒ,éè´ªå©ªåŒ¹é…</span></div><div class="line"><span class="built_in">console</span>.log(str.match(reg1));<span class="comment">//"&lt;div class='v1'&gt;&lt;div class='v2'&gt;test&lt;/div&gt;&lt;input type='text'/&gt;&lt;/div&gt;"</span></div><div class="line"><span class="built_in">console</span>.log(str.match(reg2));<span class="comment">//"&lt;div class='v1'&gt;&lt;div class='v2'&gt;test&lt;/div&gt;"</span></div></pre></td></tr></table></figure>
<h5 id="åŒºé—´é‡è¯çš„éè´ªå©ªæ¨¡å¼"><a href="#åŒºé—´é‡è¯çš„éè´ªå©ªæ¨¡å¼" class="headerlink" title="åŒºé—´é‡è¯çš„éè´ªå©ªæ¨¡å¼"></a>åŒºé—´é‡è¯çš„éè´ªå©ªæ¨¡å¼</h5><p>ä¸€èˆ¬æƒ…å†µä¸‹, éè´ªå©ªæ¨¡å¼, æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯â€*?â€, æˆ– â€œ+?â€ è¿™ç§å½¢å¼, è¿˜æœ‰ä¸€ç§æ˜¯ â€œ{n,m}?â€.</p>
<p>åŒºé—´é‡è¯â€{n,m}â€ ä¹Ÿæ˜¯åŒ¹é…ä¼˜å…ˆ, è™½æœ‰åŒ¹é…æ¬¡æ•°ä¸Šé™, ä½†æ˜¯åœ¨åˆ°è¾¾ä¸Šé™ä¹‹å‰, å®ƒä¾ç„¶æ˜¯å°½å¯èƒ½å¤šçš„åŒ¹é…, è€Œâ€{n,m}?â€ åˆ™è¡¨ç¤ºåœ¨åŒºé—´èŒƒå›´å†…, å°½å¯èƒ½å°‘çš„åŒ¹é….</p>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯</strong>: </p>
<ul>
<li>èƒ½è¾¾åˆ°åŒæ ·åŒ¹é…ç»“æœçš„è´ªå©ªä¸éè´ªå©ªæ¨¡å¼, é€šå¸¸æ˜¯è´ªå©ªæ¨¡å¼çš„åŒ¹é…æ•ˆç‡è¾ƒé«˜.</li>
<li>æ‰€æœ‰çš„éè´ªå©ªæ¨¡å¼, éƒ½å¯ä»¥é€šè¿‡ä¿®æ”¹é‡è¯ä¿®é¥°çš„å­è¡¨è¾¾å¼, è½¬æ¢ä¸ºè´ªå©ªæ¨¡å¼.</li>
<li>è´ªå©ªæ¨¡å¼å¯ä»¥ä¸<code>å›ºåŒ–åˆ†ç»„</code>(åé¢ä¼šè®²åˆ°)ç»“åˆï¼Œæå‡åŒ¹é…æ•ˆç‡ï¼Œè€Œéè´ªå©ªæ¨¡å¼å´ä¸å¯ä»¥.</li>
</ul>
<h4 id="åˆ†ç»„"><a href="#åˆ†ç»„" class="headerlink" title="åˆ†ç»„"></a>åˆ†ç»„</h4><p>æ­£åˆ™çš„åˆ†ç»„ä¸»è¦é€šè¿‡å°æ‹¬å·æ¥å®ç°, æ‹¬å·åŒ…è£¹çš„å­è¡¨è¾¾å¼ä½œä¸ºä¸€ä¸ªåˆ†ç»„, æ‹¬å·åå¯ä»¥ç´§è·Ÿé™å®šè¯è¡¨ç¤ºé‡å¤æ¬¡æ•°. å¦‚ä¸‹, å°æ‹¬å·å†…åŒ…è£¹çš„abcä¾¿æ˜¯ä¸€ä¸ªåˆ†ç»„:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/(abc)+<span class="regexp">/.test("abc123") == true</span></div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆåˆ†ç»„æœ‰ä»€ä¹ˆç”¨å‘¢? ä¸€èˆ¬æ¥è¯´, åˆ†ç»„æ˜¯ä¸ºäº†æ–¹ä¾¿çš„è¡¨ç¤ºé‡å¤æ¬¡æ•°, é™¤æ­¤ä¹‹å¤–, è¿˜æœ‰ä¸€ä¸ªä½œç”¨å°±æ˜¯ç”¨äºæ•è·, è¯·å¾€ä¸‹çœ‹.</p>
<h4 id="æ•è·æ€§åˆ†ç»„"><a href="#æ•è·æ€§åˆ†ç»„" class="headerlink" title="æ•è·æ€§åˆ†ç»„"></a>æ•è·æ€§åˆ†ç»„</h4><p>æ•è·æ€§åˆ†ç»„, é€šå¸¸ç”±ä¸€å¯¹å°æ‹¬å·åŠ ä¸Šå­è¡¨è¾¾å¼ç»„æˆ. æ•è·æ€§åˆ†ç»„ä¼šåˆ›å»ºåå‘å¼•ç”¨, æ¯ä¸ªåå‘å¼•ç”¨éƒ½ç”±ä¸€ä¸ªç¼–å·æˆ–åç§°æ¥æ ‡è¯†, jsä¸­ä¸»è¦æ˜¯é€šè¿‡ <code>$+ç¼–å·</code> æˆ–è€… <code>\+ç¼–å·</code> è¡¨ç¤ºæ³•è¿›è¡Œå¼•ç”¨. å¦‚ä¸‹ä¾¿æ˜¯ä¸€ä¸ªæ•è·æ€§åˆ†ç»„çš„ä¾‹å­.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> color = <span class="string">"#808080"</span>;</div><div class="line"><span class="keyword">var</span> output = color.replace(<span class="regexp">/#(\d+)/</span>,<span class="string">"$1"</span>+<span class="string">"~~"</span>);<span class="comment">//è‡ªç„¶ä¹Ÿå¯ä»¥å†™æˆ "$1~~"</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">RegExp</span>.$<span class="number">1</span>);<span class="comment">//808080</span></div><div class="line"><span class="built_in">console</span>.log(output);<span class="comment">//808080~~</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, (\d+) è¡¨ç¤ºä¸€ä¸ªæ•è·æ€§åˆ†ç»„, <code>RegExp.$1</code> æŒ‡å‘è¯¥åˆ†ç»„æ•è·çš„å†…å®¹. <code>$+ç¼–å·</code> è¿™ç§å¼•ç”¨é€šå¸¸åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¹‹å¤–ä½¿ç”¨. <code>\+ç¼–å·</code> è¿™ç§å¼•ç”¨å´å¯ä»¥åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ä½¿ç”¨, å¯ç”¨äºåŒ¹é…ä¸åŒä½ç½®ç›¸åŒéƒ¨åˆ†çš„å­ä¸².</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> url = <span class="string">"www.google.google.com"</span>;</div><div class="line"><span class="keyword">var</span> re = <span class="regexp">/([a-z]+)\.\1/</span>;</div><div class="line"><span class="built_in">console</span>.log(url.replace(re,<span class="string">"$1"</span>));<span class="comment">//"www.google.com"</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, ç›¸åŒéƒ¨åˆ†çš„â€googleâ€å­—ç¬¦ä¸²åªè¢«æ›¿æ¢ä¸€æ¬¡.</p>
<h4 id="éæ•è·æ€§åˆ†ç»„"><a href="#éæ•è·æ€§åˆ†ç»„" class="headerlink" title="éæ•è·æ€§åˆ†ç»„"></a>éæ•è·æ€§åˆ†ç»„</h4><p>éæ•è·æ€§åˆ†ç»„, é€šå¸¸ç”±ä¸€å¯¹æ‹¬å·åŠ ä¸Šâ€?:â€åŠ ä¸Šå­è¡¨è¾¾å¼ç»„æˆ, éæ•è·æ€§åˆ†ç»„ä¸ä¼šåˆ›å»ºåå‘å¼•ç”¨, å°±å¥½åƒæ²¡æœ‰æ‹¬å·ä¸€æ ·. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> color = <span class="string">"#808080"</span>;</div><div class="line"><span class="keyword">var</span> output = color.replace(<span class="regexp">/#(?:\d+)/</span>,<span class="string">"$1"</span>+<span class="string">"~~"</span>);</div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">RegExp</span>.$<span class="number">1</span>);<span class="comment">//""</span></div><div class="line"><span class="built_in">console</span>.log(output);<span class="comment">//$1~~</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, (?:\d+) è¡¨ç¤ºä¸€ä¸ªéæ•è·æ€§åˆ†ç»„, ç”±äºåˆ†ç»„ä¸æ•è·ä»»ä½•å†…å®¹, æ‰€ä»¥, <code>RegExp.$1</code> å°±æŒ‡å‘äº†ç©ºå­—ç¬¦ä¸².</p>
<p>åŒæ—¶, ç”±äº<code>$1</code> çš„åå‘å¼•ç”¨ä¸å­˜åœ¨, å› æ­¤æœ€ç»ˆå®ƒè¢«å½“æˆäº†æ™®é€šå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢.</p>
<p>å®é™…ä¸Š, æ•è·æ€§åˆ†ç»„å’Œæ— æ•è·æ€§åˆ†ç»„åœ¨æœç´¢æ•ˆç‡æ–¹é¢ä¹Ÿæ²¡ä»€ä¹ˆä¸åŒ, æ²¡æœ‰å“ªä¸€ä¸ªæ¯”å¦ä¸€ä¸ªæ›´å¿«.</p>
<h4 id="å‘½ååˆ†ç»„"><a href="#å‘½ååˆ†ç»„" class="headerlink" title="å‘½ååˆ†ç»„"></a>å‘½ååˆ†ç»„</h4><p>è¯­æ³•: (?<name>â€¦)</name></p>
<p>å‘½ååˆ†ç»„ä¹Ÿæ˜¯æ•è·æ€§åˆ†ç»„,  å®ƒå°†åŒ¹é…çš„å­—ç¬¦ä¸²æ•è·åˆ°ä¸€ä¸ªç»„åç§°æˆ–ç¼–å·åç§°ä¸­, åœ¨è·å¾—åŒ¹é…ç»“æœå, å¯é€šè¿‡åˆ†ç»„åè¿›è¡Œè·å–. å¦‚ä¸‹æ˜¯ä¸€ä¸ªpythonçš„å‘½ååˆ†ç»„çš„ä¾‹å­.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">data = <span class="string">"#808080"</span></div><div class="line">regExp = <span class="string">r"#(?P&lt;one&gt;\d+)"</span></div><div class="line">replaceString = <span class="string">"\g&lt;one&gt;"</span> + <span class="string">"~~"</span></div><div class="line"><span class="keyword">print</span> re.sub(regExp,replaceString,data) <span class="comment"># 808080~~</span></div></pre></td></tr></table></figure>
<p>pythonçš„å‘½ååˆ†ç»„è¡¨è¾¾å¼ä¸æ ‡å‡†æ ¼å¼ç›¸æ¯”, åœ¨ ? åå¤šäº†ä¸€å¤§å†™çš„ P å­—ç¬¦, å¹¶ä¸”pythoné€šè¿‡â€œ\g&lt;å‘½å&gt;â€è¡¨ç¤ºæ³•è¿›è¡Œå¼•ç”¨. (å¦‚æœæ˜¯æ•è·æ€§åˆ†ç»„, pythoné€šè¿‡â€\g&lt;ç¼–å·&gt;â€è¡¨ç¤ºæ³•è¿›è¡Œå¼•ç”¨)</p>
<p>ä¸pythonä¸åŒçš„æ˜¯, javaScript ä¸­å¹¶ä¸æ”¯æŒå‘½ååˆ†ç»„.</p>
<h4 id="å›ºåŒ–åˆ†ç»„"><a href="#å›ºåŒ–åˆ†ç»„" class="headerlink" title="å›ºåŒ–åˆ†ç»„"></a>å›ºåŒ–åˆ†ç»„</h4><p>å›ºåŒ–åˆ†ç»„, åˆå«åŸå­ç»„.</p>
<p>è¯­æ³•: (?&gt;â€¦)</p>
<p>å¦‚ä¸Šæ‰€è¿°, æˆ‘ä»¬åœ¨ä½¿ç”¨éè´ªå©ªæ¨¡å¼æ—¶, åŒ¹é…è¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¿›è¡Œå¤šæ¬¡çš„å›æº¯, å›æº¯è¶Šå¤š, æ­£åˆ™è¡¨è¾¾å¼çš„è¿è¡Œæ•ˆç‡å°±è¶Šä½. è€Œå›ºåŒ–åˆ†ç»„å°±æ˜¯ç”¨æ¥å‡å°‘å›æº¯æ¬¡æ•°çš„.</p>
<p>å®é™…ä¸Š, å›ºåŒ–åˆ†ç»„(?&gt;â€¦)çš„åŒ¹é…ä¸æ­£å¸¸çš„åŒ¹é…å¹¶æ— åˆ†åˆ«, å®ƒå¹¶ä¸ä¼šæ”¹å˜åŒ¹é…ç»“æœ. å”¯ä¸€çš„ä¸åŒå°±æ˜¯: å›ºåŒ–åˆ†ç»„åŒ¹é…ç»“æŸæ—¶, å®ƒåŒ¹é…åˆ°çš„æ–‡æœ¬å·²ç»å›ºåŒ–ä¸ºä¸€ä¸ªå•å…ƒ, åªèƒ½ä½œä¸ºæ•´ä½“è€Œä¿ç•™æˆ–æ”¾å¼ƒ, æ‹¬å·å†…çš„å­è¡¨è¾¾å¼ä¸­æœªå°è¯•è¿‡çš„å¤‡ç”¨çŠ¶æ€éƒ½ä¼šè¢«æ”¾å¼ƒ, æ‰€ä»¥å›æº¯æ°¸è¿œä¹Ÿä¸èƒ½é€‰æ‹©å…¶ä¸­çš„çŠ¶æ€(å› æ­¤ä¸èƒ½å‚ä¸å›æº¯). ä¸‹é¢æˆ‘ä»¬æ¥é€šè¿‡ä¸€ä¸ªä¾‹å­æ›´å¥½åœ°ç†è§£å›ºåŒ–åˆ†ç»„.</p>
<p>å‡å¦‚è¦å¤„ç†ä¸€æ‰¹æ•°æ®, åŸæ ¼å¼ä¸º 123.456, å› ä¸ºæµ®ç‚¹æ•°æ˜¾ç¤ºé—®é¢˜, éƒ¨åˆ†æ•°æ®æ ¼å¼ä¼šå˜ä¸º123.456000000789è¿™ç§, ç°è¦æ±‚åªä¿ç•™å°æ•°ç‚¹å2~3ä½, ä½†æ˜¯æœ€åä¸€ä½ä¸èƒ½ä¸º0, é‚£ä¹ˆè¿™ä¸ªæ­£åˆ™æ€ä¹ˆå†™å‘¢?</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"123.456000000789"</span>;</div><div class="line">str = str.replace(<span class="regexp">/(\.\d\d[1-9]?)\d*/</span>,<span class="string">"$1"</span>); <span class="comment">//123.456</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šçš„æ­£åˆ™, å¯¹äºâ€123.456â€ è¿™ç§æ ¼å¼çš„æ•°æ®, å°†ç™½ç™½å¤„ç†ä¸€é. ä¸ºäº†æé«˜æ•ˆç‡, æˆ‘ä»¬å°†æ­£åˆ™æœ€åçš„ä¸€ä¸ªâ€*â€æ”¹ä¸ºâ€+â€. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"123.456"</span>;</div><div class="line">str = str.replace(<span class="regexp">/(\.\d\d[1-9]?)\d+/</span>,<span class="string">"$1"</span>); <span class="comment">//123.45</span></div></pre></td></tr></table></figure>
<p>æ­¤æ—¶, â€œ\d\d[1-9]?â€ å­è¡¨è¾¾å¼, åŒ¹é…æ˜¯ â€œ45â€, è€Œä¸æ˜¯ â€œ456â€, è¿™æ˜¯å› ä¸ºæ­£åˆ™æœ«å°¾ä½¿ç”¨äº†â€+â€, è¡¨ç¤ºæœ«å°¾è‡³å°‘è¦åŒ¹é…ä¸€ä¸ªæ•°å­—, å› æ­¤æœ«å°¾çš„å­è¡¨è¾¾å¼â€\d+â€ åŒ¹é…åˆ°äº† â€œ6â€. æ˜¾ç„¶ â€œ123.45â€ ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„åŒ¹é…ç»“æœ, é‚£æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšå‘¢? èƒ½å¦è®© â€œ[1-9]?â€ ä¸€æ—¦åŒ¹é…æˆåŠŸ, ä¾¿ä¸å†è¿›è¡Œå›æº¯, è¿™é‡Œå°±è¦ç”¨åˆ°æˆ‘ä»¬ä¸Šé¢è¯´çš„å›ºåŒ–åˆ†ç»„.</p>
<p>â€œ(\.\d\d(?&gt;[1-9]?))\d+â€ ä¾¿æ˜¯ä¸Šè¿°æ­£åˆ™çš„å›ºåŒ–åˆ†ç»„å½¢å¼. ç”±äºå­—ç¬¦ä¸² â€œ123.456â€ ä¸æ»¡è¶³è¯¥å›ºåŒ–åˆ†ç»„çš„æ­£åˆ™, æ‰€ä»¥, åŒ¹é…ä¼šå¤±è´¥, ç¬¦åˆæˆ‘ä»¬æœŸæœ›.</p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥åˆ†æä¸‹å›ºåŒ–åˆ†ç»„çš„æ­£åˆ™ (\.\d\d(?&gt;[1-9]?))\d+ ä¸ºä»€ä¹ˆåŒ¹é…ä¸åˆ°å­—ç¬¦ä¸²â€123.456â€.</p>
<p>å¾ˆæ˜æ˜¾, å¯¹äºä¸Šè¿°å›ºåŒ–åˆ†ç»„, åªå­˜åœ¨ä¸¤ç§åŒ¹é…ç»“æœ.</p>
<p>æƒ…å†µâ‘ : è‹¥ [1-9] åŒ¹é…å¤±è´¥, æ­£åˆ™ä¼šè¿”å› ? ç•™ä¸‹çš„å¤‡ç”¨çŠ¶æ€. ç„¶ååŒ¹é…è„±ç¦»å›ºåŒ–åˆ†ç»„, ç»§ç»­å‰è¿›åˆ°[\d+]. å½“æ§åˆ¶æƒç¦»å¼€å›ºåŒ–åˆ†ç»„æ—¶, æ²¡æœ‰å¤‡ç”¨çŠ¶æ€éœ€è¦æ”¾å¼ƒ(å› å›ºåŒ–åˆ†ç»„ä¸­æ ¹æœ¬æ²¡æœ‰åˆ›å»ºä»»ä½•å¤‡ç”¨çŠ¶æ€).</p>
<p>æƒ…å†µâ‘¡: è‹¥ [1-9] åŒ¹é…æˆåŠŸ, åŒ¹é…è„±ç¦»å›ºåŒ–åˆ†ç»„ä¹‹å,  ? ä¿å­˜çš„å¤‡ç”¨çŠ¶æ€ä»ç„¶å­˜åœ¨, ä½†æ˜¯, ç”±äºå®ƒå±äºå·²ç»ç»“æŸçš„å›ºåŒ–åˆ†ç»„, æ‰€ä»¥ä¼šè¢«æŠ›å¼ƒ.</p>
<p>å¯¹äºå­—ç¬¦ä¸² â€œ123.456â€, ç”±äº [1-9] èƒ½å¤ŸåŒ¹é…æˆåŠŸ, æ‰€ä»¥å®ƒç¬¦åˆæƒ…å†µâ‘¡. ä¸‹é¢æˆ‘ä»¬æ¥è¿˜åŸæƒ…å†µâ‘¡çš„æ‰§è¡Œç°åœº. </p>
<ol>
<li>åŒ¹é…æ‰€å¤„çš„çŠ¶æ€:  åŒ¹é…å·²ç»èµ°åˆ°äº† â€œ6â€ çš„ä½ç½®, åŒ¹é…å°†ç»§ç»­å‰è¿›;==&gt;</li>
<li>å­è¡¨è¾¾å¼ \d+ å‘ç°æ— æ³•åŒ¹é…, æ­£åˆ™å¼•æ“ä¾¿å°è¯•å›æº¯;==&gt;</li>
<li>æŸ¥çœ‹æ˜¯å¦å­˜åœ¨å¤‡ç”¨çŠ¶æ€ä»¥ä¾›å›æº¯?==&gt;</li>
<li>â€œ?â€ ä¿å­˜çš„å¤‡ç”¨çŠ¶æ€å±äºå·²ç»ç»“æŸçš„å›ºåŒ–åˆ†ç»„, æ‰€ä»¥è¯¥å¤‡ç”¨çŠ¶æ€ä¼šè¢«æ”¾å¼ƒ;==&gt;</li>
<li>æ­¤æ—¶å›ºåŒ–åˆ†ç»„åŒ¹é…åˆ°çš„ â€œ6â€, ä¾¿ä¸èƒ½ç”¨äºæ­£åˆ™å¼•æ“çš„å›æº¯;==&gt;</li>
<li>å°è¯•å›æº¯å¤±è´¥;==&gt;</li>
<li>æ­£åˆ™åŒ¹é…å¤±è´¥.==&gt;</li>
<li>æ–‡æœ¬ â€œ123.456â€ æ²¡æœ‰è¢«æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ä¸Š, ç¬¦åˆé¢„æœŸ.</li>
</ol>
<p>ç›¸åº”çš„æµç¨‹å›¾å¦‚ä¸‹:</p>
<style>

.fancy-ctn img[src$="regexp02.png"]{height:500px;width:396px;}

</style>

<p><img src="http://louiszhai.github.io/docImages/regexp02.png" alt="æ­£åˆ™è¡¨è¾¾å¼æµç¨‹å›¾"></p>
<p>é—æ†¾çš„æ˜¯, javaScript, java å’Œ pythonä¸­å¹¶ä¸æ”¯æŒå›ºåŒ–åˆ†ç»„çš„è¯­æ³•, ä¸è¿‡, å®ƒåœ¨phpå’Œ.NETä¸­è¡¨ç°è‰¯å¥½. ä¸‹é¢æä¾›äº†ä¸€ä¸ªphpç‰ˆçš„å›ºåŒ–åˆ†ç»„å½¢å¼çš„æ­£åˆ™è¡¨è¾¾å¼, ä»¥ä¾›å°è¯•.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$str = <span class="string">"123.456"</span>;</div><div class="line"><span class="keyword">echo</span> preg_replace(<span class="string">"/(\.\d\d(?&gt;[1-9]?))\d+/"</span>,<span class="string">"\\1"</span>,$str); <span class="comment">//å›ºåŒ–åˆ†ç»„</span></div></pre></td></tr></table></figure>
<p>ä¸ä»…å¦‚æ­¤, phpè¿˜æä¾›äº†å æœ‰é‡è¯ä¼˜å…ˆçš„è¯­æ³•. å¦‚ä¸‹:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$str = <span class="string">"123.456"</span>;</div><div class="line"><span class="keyword">echo</span> preg_replace(<span class="string">"/(\.\d\d[1-9]?+)\d+/"</span>,<span class="string">"\\1"</span>,$str); <span class="comment">//å æœ‰é‡è¯ä¼˜å…ˆ</span></div></pre></td></tr></table></figure>
<p>è™½ç„¶javaä¸æ”¯æŒå›ºåŒ–åˆ†ç»„çš„è¯­æ³•, ä½†javaä¹Ÿæä¾›äº†å æœ‰é‡è¯ä¼˜å…ˆçš„è¯­æ³•, åŒæ ·èƒ½å¤Ÿé¿å…æ­£åˆ™å›æº¯. å¦‚ä¸‹: </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">String str = <span class="string">"123.456"</span>;</div><div class="line">System.out.println(str.replaceAll(<span class="string">"(\\.\\d\\d[1-9]?+)\\d+"</span>, <span class="string">"$1"</span>));<span class="comment">// 123.456</span></div></pre></td></tr></table></figure>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯: javaä¸­ replaceAll æ–¹æ³•éœ€è¦è½¬ä¹‰åæ–œæ .</p>
<h3 id="æ­£åˆ™è¡¨è¾¾å¼é«˜é˜¶æŠ€èƒ½-é›¶å®½æ–­è¨€"><a href="#æ­£åˆ™è¡¨è¾¾å¼é«˜é˜¶æŠ€èƒ½-é›¶å®½æ–­è¨€" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼é«˜é˜¶æŠ€èƒ½-é›¶å®½æ–­è¨€"></a>æ­£åˆ™è¡¨è¾¾å¼é«˜é˜¶æŠ€èƒ½-é›¶å®½æ–­è¨€</h3><p>å¦‚æœè¯´æ­£åˆ™åˆ†ç»„æ˜¯å†™è½®çœ¼, é‚£ä¹ˆé›¶å®½æ–­è¨€å°±æ˜¯ä¸‡èŠ±ç­’å†™è½®çœ¼ç»ˆæå¥¥ä¹‰-é¡»ä½èƒ½ä¹(è¿™é‡Œå€Ÿç«å½±å¿æœ¯æ‰“ä¸ªæ¯”æ–¹). åˆç†åœ°ä½¿ç”¨é›¶å®½æ–­è¨€, èƒ½å¤Ÿèƒ½åˆ†ç»„ä¹‹ä¸èƒ½, æå¤§åœ°å¢å¼ºæ­£åˆ™åŒ¹é…èƒ½åŠ›, å®ƒç”šè‡³å¯ä»¥å¸®åŠ©ä½ åœ¨åŒ¹é…æ¡ä»¶éå¸¸æ¨¡ç³Šçš„æƒ…å†µä¸‹å¿«é€Ÿåœ°å®šä½æ–‡æœ¬.</p>
<p>é›¶å®½æ–­è¨€, åˆå«ç¯è§†. ç¯è§†åªè¿›è¡Œå­è¡¨è¾¾å¼çš„åŒ¹é…, åŒ¹é…åˆ°çš„å†…å®¹ä¸ä¿å­˜åˆ°æœ€ç»ˆçš„åŒ¹é…ç»“æœ, ç”±äºåŒ¹é…æ˜¯é›¶å®½åº¦çš„, æ•…æœ€ç»ˆåŒ¹é…åˆ°çš„åªæ˜¯ä¸€ä¸ªä½ç½®. </p>
<p>ç¯è§†æŒ‰ç…§æ–¹å‘åˆ’åˆ†, æœ‰é¡ºåºå’Œé€†åºä¸¤ç§(ä¹Ÿå«å‰ç»å’Œåç»), æŒ‰ç…§æ˜¯å¦åŒ¹é…æœ‰è‚¯å®šå’Œå¦å®šä¸¤ç§, ç»„åˆä¹‹, ä¾¿æœ‰4ç§ç¯è§†. 4ç§ç¯è§†å¹¶ä¸å¤æ‚, å¦‚ä¸‹ä¾¿æ˜¯å®ƒä»¬çš„æè¿°.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>å­—ç¬¦</strong></th>
<th><strong>æè¿°</strong></th>
<th><strong>ç¤ºä¾‹</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">(?:<em>pattern</em>)</td>
<td>éæ•è·æ€§åˆ†ç»„, åŒ¹é…patternçš„ä½ç½®, ä½†ä¸æ•è·åŒ¹é…ç»“æœ.ä¹Ÿå°±æ˜¯è¯´ä¸åˆ›å»ºåå‘å¼•ç”¨, å°±å¥½åƒæ²¡æœ‰æ‹¬å·ä¸€æ ·.</td>
<td>â€˜abcd(?:e)åŒ¹é…â€™abcde</td>
</tr>
<tr>
<td style="text-align:center">(?=<em>pattern</em>)</td>
<td><strong>é¡ºåºè‚¯å®šç¯è§†</strong>, åŒ¹é…åé¢æ˜¯pattern çš„ä½ç½®, ä¸æ•è·åŒ¹é…ç»“æœ.</td>
<td>â€˜Windows (?=2000)â€™åŒ¹é… â€œWindows2000â€ ä¸­çš„ â€œWindowsâ€; ä¸åŒ¹é… â€œWindows3.1â€ ä¸­çš„ â€œWindowsâ€</td>
</tr>
<tr>
<td style="text-align:center">(?!<em>pattern</em>)</td>
<td><strong>é¡ºåºå¦å®šç¯è§†</strong>, åŒ¹é…åé¢ä¸æ˜¯ pattern çš„ä½ç½®, ä¸æ•è·åŒ¹é…ç»“æœ.</td>
<td>â€˜Windows (?!2000)â€™åŒ¹é… â€œWindows3.1â€ ä¸­çš„ â€œWindowsâ€; ä¸åŒ¹é… â€œWindows2000â€ ä¸­çš„ â€œWindowsâ€</td>
</tr>
<tr>
<td style="text-align:center">(?&lt;=<em>pattern</em>)</td>
<td><strong>é€†åºè‚¯å®šç¯è§†</strong>, åŒ¹é…å‰é¢æ˜¯ pattern çš„ä½ç½®, ä¸æ•è·åŒ¹é…ç»“æœ.</td>
<td>â€˜(?&lt;=Office)2000â€™åŒ¹é… â€œ Office2000â€ ä¸­çš„ â€œ2000â€; ä¸åŒ¹é… â€œWindows2000â€ ä¸­çš„ â€œ2000â€</td>
</tr>
<tr>
<td style="text-align:center">(?&lt;!<em>pattern</em>)</td>
<td><strong>é€†åºå¦å®šç¯è§†</strong>, åŒ¹é…å‰é¢ä¸æ˜¯ pattern çš„ä½ç½®, ä¸æ•è·åŒ¹é…ç»“æœ.</td>
<td>â€˜(?&lt;!Office)2000â€™åŒ¹é… â€œ Windows2000â€ ä¸­çš„ â€œ2000â€; ä¸åŒ¹é… â€œ Office2000â€ ä¸­çš„ â€œ2000â€</td>
</tr>
</tbody>
</table>
<p>éæ•è·æ€§åˆ†ç»„ç”±äºç»“æ„ä¸ç¯è§†ç›¸ä¼¼, æ•…åˆ—åœ¨è¡¨ä¸­, ä»¥åšå¯¹æ¯”. ä»¥ä¸Š4ç§ç¯è§†ä¸­, ç›®å‰ javaScript ä¸­åªæ”¯æŒå‰ä¸¤ç§, ä¹Ÿå°±æ˜¯åªæ”¯æŒ <strong>é¡ºåºè‚¯å®šç¯è§†</strong> å’Œ <strong>é¡ºåºå¦å®šç¯è§†</strong>. ä¸‹é¢æˆ‘ä»¬é€šè¿‡å®ä¾‹æ¥å¸®åŠ©ç†è§£ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"123abc789"</span>,s;</div><div class="line"><span class="comment">//æ²¡æœ‰ä½¿ç”¨ç¯è§†,abcç›´æ¥è¢«æ›¿æ¢</span></div><div class="line">s = str.replace(<span class="regexp">/abc/</span>,<span class="number">456</span>);</div><div class="line"><span class="built_in">console</span>.log(s); <span class="comment">//123456789</span></div><div class="line"></div><div class="line"><span class="comment">//ä½¿ç”¨äº†é¡ºåºè‚¯å®šç¯è§†,æ•è·åˆ°äº†aå‰é¢çš„ä½ç½®,æ‰€ä»¥abcæ²¡æœ‰è¢«æ›¿æ¢,åªæ˜¯å°†3æ›¿æ¢æˆäº†3456</span></div><div class="line">s = str.replace(<span class="regexp">/3(?=abc)/</span>,<span class="number">3456</span>);</div><div class="line"><span class="built_in">console</span>.log(s); <span class="comment">//123456abc789</span></div><div class="line"></div><div class="line"><span class="comment">//ä½¿ç”¨äº†é¡ºåºå¦å®šç¯è§†,ç”±äº3åé¢è·Ÿç€abc,ä¸æ»¡æ„æ¡ä»¶,æ•…æ•è·å¤±è´¥,æ‰€ä»¥åŸå­—ç¬¦ä¸²æ²¡æœ‰è¢«æ›¿æ¢</span></div><div class="line">s = str.replace(<span class="regexp">/3(?!abc)/</span>,<span class="number">3456</span>);</div><div class="line"><span class="built_in">console</span>.log(s); <span class="comment">//123abc789</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢é€šè¿‡pythonæ¥æ¼”ç¤ºä¸‹ <strong>é€†åºè‚¯å®šç¯è§†</strong> å’Œ <strong>é€†åºå¦å®šç¯è§†</strong> çš„ç”¨æ³•.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">data = <span class="string">"123abc789"</span></div><div class="line"><span class="comment"># ä½¿ç”¨äº†é€†åºè‚¯å®šç¯è§†,æ›¿æ¢å·¦è¾¹ä¸º123çš„è¿ç»­çš„å°å†™è‹±æ–‡å­—æ¯,åŒ¹é…æˆåŠŸ,æ•…abcè¢«æ›¿æ¢ä¸º456</span></div><div class="line">regExp = <span class="string">r"(?&lt;=123)[a-z]+"</span></div><div class="line">replaceString = <span class="string">"456"</span></div><div class="line"><span class="keyword">print</span> re.sub(regExp,replaceString,data) <span class="comment"># 123456789</span></div><div class="line"></div><div class="line"><span class="comment"># ä½¿ç”¨äº†é€†åºå¦å®šç¯è§†,ç”±äºè‹±æ–‡å­—æ¯å·¦ä¾§ä¸èƒ½ä¸º123,æ•…å­è¡¨è¾¾å¼[a-z]+æ•è·åˆ°bc,æœ€ç»ˆbcè¢«æ›¿æ¢ä¸º456</span></div><div class="line">regExp = <span class="string">r"(?&lt;!123)[a-z]+"</span></div><div class="line">replaceString = <span class="string">"456"</span></div><div class="line"><span class="keyword">print</span> re.sub(regExp,replaceString,data) <span class="comment"># 123a456789</span></div></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯: python å’Œ perl è¯­è¨€ä¸­çš„ <strong>é€†åºç¯è§†</strong> çš„å­è¡¨è¾¾å¼åªèƒ½ä½¿ç”¨å®šé•¿çš„æ–‡æœ¬. æ¯”å¦‚å°†ä¸Šè¿° â€œ(?&lt;=123)â€ (é€†åºè‚¯å®šç¯è§†)å­è¡¨è¾¾å¼å†™æˆ â€œ(?&lt;=[0-9]+)â€, pythonè§£é‡Šå™¨å°†ä¼šæŠ¥é”™: â€œerror: look-behind requires fixed-width patternâ€.</p>
<h4 id="åœºæ™¯å›é¡¾"><a href="#åœºæ™¯å›é¡¾" class="headerlink" title="åœºæ™¯å›é¡¾"></a>åœºæ™¯å›é¡¾</h4><h5 id="è·å–htmlç‰‡æ®µ"><a href="#è·å–htmlç‰‡æ®µ" class="headerlink" title="è·å–htmlç‰‡æ®µ"></a>è·å–htmlç‰‡æ®µ</h5><p>å‡å¦‚ç°åœ¨, js é€šè¿‡ ajax è·å–åˆ°ä¸€æ®µ html ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var responseText = "<span class="tag">&lt;<span class="name">div</span> <span class="attr">data</span>=<span class="string">'dev.xxx.txt'</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">'dev.xxx.png'</span> /&gt;</span>";</div></pre></td></tr></table></figure>
<p>ç°æˆ‘ä»¬éœ€è¦æ›¿æ¢imgæ ‡ç­¾çš„src å±æ€§ä¸­çš„ â€œdevâ€å­—ç¬¦ä¸² ä¸º â€œtestâ€ å­—ç¬¦ä¸². </p>
<p>â‘  ç”±äºä¸Šè¿° responseText å­—ç¬¦ä¸²ä¸­åŒ…å«è‡³å°‘ä¸¤ä¸ªå­å­—ç¬¦ä¸² â€œdevâ€, æ˜¾ç„¶ä¸èƒ½ç›´æ¥ replace å­—ç¬¦ä¸² â€œdevâ€ä¸º â€œtestâ€. </p>
<p>â‘¡ åŒæ—¶ç”±äº js ä¸­ä¸æ”¯æŒé€†åºç¯è§†, æˆ‘ä»¬ä¹Ÿä¸èƒ½åœ¨æ­£åˆ™ä¸­åˆ¤æ–­å‰ç¼€ä¸º â€œsrc=â€™â€, ç„¶åå†æ›¿æ¢â€devâ€. </p>
<p>â‘¢ æˆ‘ä»¬æ³¨æ„åˆ° img æ ‡ç­¾çš„ src å±æ€§ä»¥ â€œ.pngâ€ ç»“å°¾, åŸºäºæ­¤, å°±å¯ä»¥ä½¿ç”¨é¡ºåºè‚¯å®šç¯è§†. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/dev(?=[^']*png)/</span>; <span class="comment">//ä¸ºäº†é˜²æ­¢åŒ¹é…åˆ°ç¬¬ä¸€ä¸ªdev, é€šé…ç¬¦å‰é¢éœ€è¦æ’é™¤å•å¼•å·æˆ–è€…æ˜¯å°–æ‹¬å·</span></div><div class="line"><span class="keyword">var</span> str = responseText.replace(reg,<span class="string">"test"</span>);</div><div class="line"><span class="built_in">console</span>.log(str);<span class="comment">//&lt;div data='dev.xxx'&gt;&lt;/div&gt;&lt;img src='test.xxx.png' /&gt;</span></div></pre></td></tr></table></figure>
<p>å½“ç„¶, ä»¥ä¸Šä¸æ­¢é¡ºåºè‚¯å®šç¯è§†ä¸€ç§è§£æ³•, æ•è·æ€§åˆ†ç»„åŒæ ·å¯ä»¥åšåˆ°. é‚£ä¹ˆç¯è§†é«˜çº§åœ¨å“ªé‡Œå‘¢? ç¯è§†é«˜çº§çš„åœ°æ–¹å°±åœ¨äºå®ƒé€šè¿‡ä¸€æ¬¡æ•è·å°±å¯ä»¥å®šä½åˆ°ä¸€ä¸ªä½ç½®, å¯¹äºå¤æ‚çš„æ–‡æœ¬æ›¿æ¢åœºæ™¯, å¸¸æœ‰å¥‡æ•ˆ, è€Œåˆ†ç»„åˆ™éœ€è¦æ›´å¤šçš„æ“ä½œ. è¯·å¾€ä¸‹çœ‹.</p>
<h5 id="åƒä½åˆ†å‰²ç¬¦"><a href="#åƒä½åˆ†å‰²ç¬¦" class="headerlink" title="åƒä½åˆ†å‰²ç¬¦"></a>åƒä½åˆ†å‰²ç¬¦</h5><blockquote>
<p>åƒä½åˆ†éš”ç¬¦, é¡¾åæ€ä¹‰, å°±æ˜¯æ•°å­—ä¸­çš„é€—å·. å‚è€ƒè¥¿æ–¹çš„ä¹ æƒ¯, æ•°å­—ä¹‹ä¸­åŠ å…¥ä¸€ä¸ªç¬¦å·, é¿å…å› æ•°å­—å¤ªé•¿éš¾ä»¥ç›´è§‚çš„çœ‹å‡ºå®ƒçš„å€¼. æ•…è€Œæ•°å­—ä¹‹ä¸­, æ¯éš”ä¸‰ä½æ·»åŠ ä¸€ä¸ªé€—å·, å³åƒä½åˆ†éš”ç¬¦.</p>
</blockquote>
<p>é‚£ä¹ˆæ€ä¹ˆå°†ä¸€ä¸²æ•°å­—è½¬åŒ–ä¸ºåƒä½åˆ†éš”ç¬¦å½¢å¼å‘¢?</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"1234567890"</span>;</div><div class="line">(+str).toLocaleString();<span class="comment">//"1,234,567,890"</span></div></pre></td></tr></table></figure>
<p>å¦‚ä¸Š, <code>toLocaleString()</code> è¿”å›å½“å‰å¯¹è±¡çš„â€æœ¬åœ°åŒ–â€å­—ç¬¦ä¸²å½¢å¼. </p>
<ul>
<li>å¦‚æœè¯¥å¯¹è±¡æ˜¯Numberç±»å‹, é‚£ä¹ˆå°†è¿”å›è¯¥æ•°å€¼çš„æŒ‰ç…§ç‰¹å®šç¬¦å·åˆ†å‰²çš„å­—ç¬¦ä¸²å½¢å¼.</li>
<li>å¦‚æœè¯¥å¯¹è±¡æ˜¯Arrayç±»å‹, é‚£ä¹ˆå…ˆå°†æ•°ç»„ä¸­çš„æ¯é¡¹è½¬åŒ–ä¸ºå­—ç¬¦ä¸², ç„¶åå°†è¿™äº›å­—ç¬¦ä¸²ä»¥æŒ‡å®šåˆ†éš”ç¬¦è¿æ¥èµ·æ¥å¹¶è¿”å›.</li>
</ul>
<p><code>toLocaleString</code> æ–¹æ³•ç‰¹æ®Š, æœ‰æœ¬åœ°åŒ–ç‰¹æ€§, å¯¹äºå¤©æœ, é»˜è®¤çš„åˆ†éš”ç¬¦æ˜¯è‹±æ–‡é€—å·. å› æ­¤ä½¿ç”¨å®ƒæ°å¥½å¯ä»¥å°†æ•°å€¼è½¬åŒ–ä¸ºåƒä½åˆ†éš”ç¬¦å½¢å¼çš„å­—ç¬¦ä¸². å¦‚æœè€ƒè™‘åˆ°å›½é™…åŒ–, ä»¥ä¸Šæ–¹æ³•å°±æœ‰å¯èƒ½ä¼šå¤±æ•ˆäº†.</p>
<p>æˆ‘ä»¬å°è¯•ä½¿ç”¨ç¯è§†æ¥å¤„ç†ä¸‹.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">thousand</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> str.replace(<span class="regexp">/(?!^)(?=([0-9]&#123;3&#125;)+$)/g</span>,<span class="string">','</span>);</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(thousand(str));<span class="comment">//"1,234,567,890"</span></div><div class="line"><span class="built_in">console</span>.log(thousand(<span class="string">"123456"</span>));<span class="comment">//"123,456"</span></div><div class="line"><span class="built_in">console</span>.log(thousand(<span class="string">"1234567879876543210"</span>));<span class="comment">//"1,234,567,879,876,543,210"</span></div></pre></td></tr></table></figure>
<p>ä¸Šè¿°ä½¿ç”¨åˆ°çš„æ­£åˆ™åˆ†ä¸ºä¸¤å—. <code>(?!^)</code> å’Œ <code>(?=([0-9]{3})+$)</code>. æˆ‘ä»¬å…ˆæ¥çœ‹åé¢çš„éƒ¨åˆ†, ç„¶åé€æ­¥åˆ†æä¹‹.</p>
<ol>
<li>â€œ[0-9]{3}â€ è¡¨ç¤ºè¿ç»­3ä½æ•°å­—.</li>
<li>â€œ([0-9]{3})+â€ è¡¨ç¤ºè¿ç»­3ä½æ•°å­—è‡³å°‘å‡ºç°ä¸€æ¬¡æˆ–æ›´å¤šæ¬¡.</li>
<li>â€œ([0-9]{3})+$â€ è¡¨ç¤ºè¿ç»­3çš„æ­£æ•´æ•°å€çš„æ•°å­—, ç›´åˆ°å­—ç¬¦ä¸²æœ«å°¾.</li>
<li>é‚£ä¹ˆ <code>(?=([0-9]{3})+$)</code> å°±è¡¨ç¤ºåŒ¹é…ä¸€ä¸ªé›¶å®½åº¦çš„ä½ç½®, å¹¶ä¸”ä»è¿™ä¸ªä½ç½®åˆ°å­—ç¬¦ä¸²æœ«å°¾, ä¸­é—´æ‹¥æœ‰3çš„æ­£æ•´æ•°å€çš„æ•°å­—.</li>
<li>æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨å…¨å±€åŒ¹é…g, è¡¨ç¤ºåŒ¹é…åˆ°ä¸€ä¸ªä½ç½®å, å®ƒä¼šç»§ç»­åŒ¹é…, ç›´è‡³åŒ¹é…ä¸åˆ°.</li>
<li>å°†è¿™ä¸ªä½ç½®æ›¿æ¢ä¸ºé€—å·, å®é™…ä¸Šå°±æ˜¯æ¯3ä½æ•°å­—æ·»åŠ ä¸€ä¸ªé€—å·.</li>
<li>å½“ç„¶å¯¹äºå­—ç¬¦ä¸²â€123456â€è¿™ç§åˆšå¥½æ‹¥æœ‰3çš„æ­£æ•´æ•°å€çš„æ•°å­—çš„, å½“ç„¶ä¸èƒ½åœ¨1å‰é¢æ·»åŠ é€—å·. é‚£ä¹ˆä½¿ç”¨ <code>(?!^)</code> å°±æŒ‡å®šäº†è¿™ä¸ªæ›¿æ¢çš„ä½ç½®ä¸èƒ½ä¸ºèµ·å§‹ä½ç½®.</li>
</ol>
<p>åƒä½åˆ†éš”ç¬¦å®ä¾‹, å±•ç¤ºäº†ç¯è§†çš„å¼ºå¤§, ä¸€æ­¥åˆ°ä½.</p>
<h3 id="æ­£åˆ™è¡¨è¾¾å¼åœ¨JSä¸­çš„åº”ç”¨"><a href="#æ­£åˆ™è¡¨è¾¾å¼åœ¨JSä¸­çš„åº”ç”¨" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼åœ¨JSä¸­çš„åº”ç”¨"></a>æ­£åˆ™è¡¨è¾¾å¼åœ¨JSä¸­çš„åº”ç”¨</h3><h4 id="ES6å¯¹æ­£åˆ™çš„æ‰©å±•"><a href="#ES6å¯¹æ­£åˆ™çš„æ‰©å±•" class="headerlink" title="ES6å¯¹æ­£åˆ™çš„æ‰©å±•"></a>ES6å¯¹æ­£åˆ™çš„æ‰©å±•</h4><p>ES6å¯¹æ­£åˆ™æ‰©å±•äº†åˆä¸¤ç§ä¿®é¥°ç¬¦(å…¶ä»–è¯­è¨€å¯èƒ½ä¸æ”¯æŒ):</p>
<ul>
<li>y (ç²˜è¿stickyä¿®é¥°ç¬¦), ä¸gç±»ä¼¼, ä¹Ÿæ˜¯å…¨å±€åŒ¹é…, å¹¶ä¸”ä¸‹ä¸€æ¬¡åŒ¹é…éƒ½æ˜¯ä»ä¸Šä¸€æ¬¡åŒ¹é…æˆåŠŸçš„ä¸‹ä¸€ä¸ªä½ç½®å¼€å§‹, ä¸åŒä¹‹å¤„åœ¨äº, gä¿®é¥°ç¬¦åªè¦å‰©ä½™ä½ç½®ä¸­å­˜åœ¨åŒ¹é…å³å¯, è€Œyä¿®é¥°ç¬¦ç¡®ä¿åŒ¹é…å¿…é¡»ä»å‰©ä½™çš„ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">"abc_ab_a"</span>;</div><div class="line"><span class="keyword">var</span> r1 = <span class="regexp">/[a-z]+/g</span>;</div><div class="line"><span class="keyword">var</span> r2 = <span class="regexp">/[a-z]+/y</span>;</div><div class="line"><span class="built_in">console</span>.log(r1.exec(s),r1.lastIndex); <span class="comment">// ["abc", index: 0, input: "abc_ab_a"] 3</span></div><div class="line"><span class="built_in">console</span>.log(r2.exec(s),r2.lastIndex); <span class="comment">// ["abc", index: 0, input: "abc_ab_a"] 3</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(r1.exec(s),r1.lastIndex); <span class="comment">// ["ab", index: 4, input: "abc_ab_a"] 6</span></div><div class="line"><span class="built_in">console</span>.log(r2.exec(s),r2.lastIndex); <span class="comment">// null 0</span></div></pre></td></tr></table></figure>
<p>å¦‚ä¸Š, ç”±äºç¬¬äºŒæ¬¡åŒ¹é…çš„å¼€å§‹ä½ç½®æ˜¯ä¸‹æ ‡3,  å¯¹åº”çš„å­—ç¬¦ä¸²æ˜¯ â€œ_â€, è€Œä½¿ç”¨yä¿®é¥°ç¬¦çš„æ­£åˆ™å¯¹è±¡r2, éœ€è¦ä»å‰©ä½™çš„ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹, æ‰€ä»¥åŒ¹é…å¤±è´¥, è¿”å›null.</p>
<p>æ­£åˆ™å¯¹è±¡çš„ sticky å±æ€§, è¡¨ç¤ºæ˜¯å¦è®¾ç½®äº†yä¿®é¥°ç¬¦. è¿™ç‚¹å°†ä¼šåœ¨åé¢è®²åˆ°.</p>
<ul>
<li>u ä¿®é¥°ç¬¦, æä¾›äº†å¯¹æ­£åˆ™è¡¨è¾¾å¼æ·»åŠ 4å­—èŠ‚ç ç‚¹çš„æ”¯æŒ. æ¯”å¦‚ â€œğŒ†â€ å­—ç¬¦æ˜¯ä¸€ä¸ª4å­—èŠ‚å­—ç¬¦, ç›´æ¥ä½¿ç”¨æ­£åˆ™åŒ¹é…å°†ä¼šå¤±è´¥, è€Œä½¿ç”¨uä¿®é¥°ç¬¦å, å°†ä¼šç­‰åˆ°æ­£ç¡®çš„ç»“æœ.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">"ğŒ†"</span>;</div><div class="line"><span class="built_in">console</span>.log(<span class="regexp">/^.$/</span>.test(s));<span class="comment">//false</span></div><div class="line"><span class="built_in">console</span>.log(<span class="regexp">/^.$/u</span>.test(s));<span class="comment">//true</span></div></pre></td></tr></table></figure>
<h5 id="UCS-2å­—èŠ‚ç "><a href="#UCS-2å­—èŠ‚ç " class="headerlink" title="UCS-2å­—èŠ‚ç "></a>UCS-2å­—èŠ‚ç </h5><p>æœ‰å…³å­—èŠ‚ç ç‚¹, ç¨å¾®æä¸‹. javaScript åªèƒ½å¤„ç†UCS-2ç¼–ç (jsäº1995å¹´5æœˆè¢«Brendan EichèŠ±è´¹10å¤©è®¾è®¡å‡ºæ¥, æ¯”1996å¹´7æœˆå‘å¸ƒçš„ç¼–ç è§„èŒƒUTF-16æ—©äº†ä¸€å¹´å¤š, å½“æ—¶åªæœ‰UCS-2å¯é€‰). ç”±äºUCS-2å…ˆå¤©ä¸è¶³, é€ æˆäº†æ‰€æœ‰å­—ç¬¦åœ¨jsä¸­éƒ½æ˜¯2ä¸ªå­—èŠ‚. å¦‚æœæ˜¯4ä¸ªå­—èŠ‚çš„å­—ç¬¦, å°†ä¼šé»˜è®¤è¢«å½“ä½œä¸¤ä¸ªåŒå­—èŠ‚å­—ç¬¦å¤„ç†. å› æ­¤ js çš„å­—ç¬¦å¤„ç†å‡½æ•°éƒ½ä¼šå—åˆ°é™åˆ¶, æ— æ³•è¿”å›æ­£ç¡®ç»“æœ. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">"ğŒ†"</span>;</div><div class="line"><span class="built_in">console</span>.log(s == <span class="string">"\uD834\uDF06"</span>);<span class="comment">//true ğŒ†ç›¸å½“äºUTF-16ä¸­çš„0xD834DF06</span></div><div class="line"><span class="built_in">console</span>.log(s.length);<span class="comment">//2 é•¿åº¦ä¸º2, è¡¨ç¤ºè¿™æ˜¯4å­—èŠ‚å­—ç¬¦</span></div></pre></td></tr></table></figure>
<p>å¹¸è¿çš„æ˜¯, ES6å¯ä»¥è‡ªåŠ¨è¯†åˆ«4å­—èŠ‚çš„å­—ç¬¦.å› æ­¤éå†å­—ç¬¦ä¸²å¯ä»¥ç›´æ¥ä½¿ç”¨for ofå¾ªç¯. åŒæ—¶, jsä¸­å¦‚æœç›´æ¥ä½¿ç”¨ç ç‚¹è¡¨ç¤ºUnicodeå­—ç¬¦, å¯¹äº4å­—èŠ‚å­—ç¬¦, ES5é‡Œæ˜¯æ²¡åŠæ³•è¯†åˆ«çš„. ä¸ºæ­¤ES6ä¿®å¤äº†è¿™ä¸ªé—®é¢˜, åªéœ€å°†ç ç‚¹æ”¾åœ¨å¤§æ‹¬å·å†…å³å¯.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(s === <span class="string">"\u1D306"</span>);<span class="comment">//false   ES5æ— æ³•è¯†åˆ«ğŒ†</span></div><div class="line"><span class="built_in">console</span>.log(s === <span class="string">"\u&#123;1D306&#125;"</span>);<span class="comment">//true  ES6å¯ä»¥å€ŸåŠ©å¤§æ‹¬å·è¯†åˆ«ğŒ†</span></div></pre></td></tr></table></figure>
<h5 id="é™„-ES6æ–°å¢çš„å¤„ç†4å­—èŠ‚ç çš„å‡½æ•°"><a href="#é™„-ES6æ–°å¢çš„å¤„ç†4å­—èŠ‚ç çš„å‡½æ•°" class="headerlink" title="é™„: ES6æ–°å¢çš„å¤„ç†4å­—èŠ‚ç çš„å‡½æ•°"></a>é™„: ES6æ–°å¢çš„å¤„ç†4å­—èŠ‚ç çš„å‡½æ•°</h5><ul>
<li><strong>String.fromCodePoint()</strong>ï¼šä»Unicodeç ç‚¹è¿”å›å¯¹åº”å­—ç¬¦</li>
<li><strong>String.prototype.codePointAt()</strong>ï¼šä»å­—ç¬¦è¿”å›å¯¹åº”çš„ç ç‚¹</li>
<li><strong>String.prototype.at()</strong>ï¼šè¿”å›å­—ç¬¦ä¸²ç»™å®šä½ç½®çš„å­—ç¬¦</li>
</ul>
<p>æœ‰å…³jsä¸­çš„unicodeå­—ç¬¦é›†, è¯·å‚è€ƒé˜®ä¸€å³°è€å¸ˆçš„ <a href="http://www.ruanyifeng.com/blog/2014/12/unicode.html" target="_blank" rel="external"><code>Unicodeä¸JavaScriptè¯¦è§£</code></a>.</p>
<p>ä»¥ä¸Šæ˜¯ES6å¯¹æ­£åˆ™çš„æ‰©å±•. å¦ä¸€ä¸ªæ–¹é¢, ä»æ–¹æ³•ä¸Šçœ‹, javaScript ä¸­ä¸æ­£åˆ™è¡¨è¾¾å¼æœ‰å…³çš„æ–¹æ³•æœ‰: </p>
<table>
<thead>
<tr>
<th>æ–¹æ³•å</th>
<th>compile</th>
<th>test</th>
<th>exec</th>
<th>match</th>
<th>search</th>
<th>replace</th>
<th>split</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ‰€å±å¯¹è±¡</td>
<td>RegExp</td>
<td>RegExp</td>
<td>RegExp</td>
<td>String</td>
<td>String</td>
<td>String</td>
<td>String</td>
</tr>
</tbody>
</table>
<p>ç”±ä¸Š, ä¸€å…±æœ‰7ä¸ªä¸jsç›¸å…³çš„æ–¹æ³•, è¿™äº›æ–¹æ³•åˆ†åˆ«æ¥è‡ªäº RegExp ä¸ String å¯¹è±¡. é¦–å…ˆæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹jsä¸­çš„æ­£åˆ™ç±» RegExp.</p>
<h4 id="RegExp"><a href="#RegExp" class="headerlink" title="RegExp"></a>RegExp</h4><p>RegExp å¯¹è±¡è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼, ä¸»è¦ç”¨äºå¯¹å­—ç¬¦ä¸²æ‰§è¡Œæ¨¡å¼åŒ¹é….</p>
<p>è¯­æ³•: new RegExp(pattern[, flags])</p>
<p>å‚æ•° <em>pattern</em> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸², æŒ‡å®šäº†æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²æˆ–å…¶ä»–çš„æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡.</p>
<p>å‚æ•° <em>flags</em> æ˜¯ä¸€ä¸ªå¯é€‰çš„å­—ç¬¦ä¸², åŒ…å«å±æ€§ â€œgâ€ã€â€iâ€ å’Œ â€œmâ€, åˆ†åˆ«ç”¨äºæŒ‡å®šå…¨å±€åŒ¹é…ã€åŒºåˆ†å¤§å°å†™çš„åŒ¹é…å’Œå¤šè¡ŒåŒ¹é…. å¦‚æœ<em>pattern</em> æ˜¯æ­£åˆ™è¡¨è¾¾å¼, è€Œä¸æ˜¯å­—ç¬¦ä¸², åˆ™å¿…é¡»çœç•¥è¯¥å‚æ•°.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> pattern = <span class="string">"[0-9]"</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(pattern,<span class="string">"g"</span>);</div><div class="line"><span class="comment">// ä¸Šè¿°åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡,å¯ä»¥ç”¨å¯¹è±¡å­—é¢é‡å½¢å¼ä»£æ›¿,ä¹Ÿæ¨èä¸‹é¢è¿™ç§</span></div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/[0-9]/g</span>;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, é€šè¿‡å¯¹è±¡å­—é¢é‡å’Œæ„é€ å‡½æ•°åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼, æœ‰ä¸ªå°æ’æ›².</p>
<p>â€œå¯¹äºæ­£åˆ™è¡¨è¾¾å¼çš„ç›´æ¥é‡, ECMAscript 3è§„å®šåœ¨æ¯æ¬¡å®ƒæ—¶éƒ½ä¼šè¿”å›åŒä¸€ä¸ªRegExpå¯¹è±¡, å› æ­¤ç”¨ç›´æ¥é‡åˆ›å»ºçš„æ­£åˆ™è¡¨è¾¾å¼çš„ä¼šå…±äº«ä¸€ä¸ªå®ä¾‹. ç›´åˆ°ECMAScript 5æ‰è§„å®šæ¯æ¬¡è¿”å›ä¸åŒçš„å®ä¾‹.â€</p>
<p>æ‰€ä»¥, ç°åœ¨æˆ‘ä»¬åŸºæœ¬ä¸ç”¨æ‹…å¿ƒè¿™ä¸ªé—®é¢˜, åªéœ€è¦æ³¨æ„åœ¨ä½ç‰ˆæœ¬çš„éIEæµè§ˆå™¨ä¸­å°½é‡ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºæ­£åˆ™(è¿™ç‚¹ä¸Š, IEä¸€ç›´éµå®ˆES5è§„å®š, å…¶ä»–æµè§ˆå™¨çš„ä½çº§ç‰ˆæœ¬éµå¾ªES3è§„å®š).</p>
<p>RegExp å®ä¾‹å¯¹è±¡åŒ…å«å¦‚ä¸‹å±æ€§:</p>
<table>
<thead>
<tr>
<th style="text-align:center">å®ä¾‹å±æ€§</th>
<th style="text-align:center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">global</td>
<td style="text-align:center">æ˜¯å¦åŒ…å«å…¨å±€æ ‡å¿—(true/false)</td>
</tr>
<tr>
<td style="text-align:center">ignoreCase</td>
<td style="text-align:center">æ˜¯å¦åŒ…å«åŒºåˆ†å¤§å°å†™æ ‡å¿—(true/false)</td>
</tr>
<tr>
<td style="text-align:center">multiline</td>
<td style="text-align:center">æ˜¯å¦åŒ…å«å¤šè¡Œæ ‡å¿—(true/false)</td>
</tr>
<tr>
<td style="text-align:center">source</td>
<td style="text-align:center">è¿”å›åˆ›å»ºRegExpå¯¹è±¡å®ä¾‹æ—¶æŒ‡å®šçš„è¡¨è¾¾å¼æ–‡æœ¬å­—ç¬¦ä¸²å½¢å¼</td>
</tr>
<tr>
<td style="text-align:center">lastIndex</td>
<td style="text-align:center">è¡¨ç¤ºåŸå­—ç¬¦ä¸²ä¸­åŒ¹é…çš„å­—ç¬¦ä¸²æœ«å°¾çš„åä¸€ä¸ªä½ç½®, é»˜è®¤ä¸º0</td>
</tr>
<tr>
<td style="text-align:center">flags(ES6)</td>
<td style="text-align:center">è¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦</td>
</tr>
<tr>
<td style="text-align:center">sticky(ES6)</td>
<td style="text-align:center">æ˜¯å¦è®¾ç½®äº†y(ç²˜è¿)ä¿®é¥°ç¬¦(true/false)</td>
</tr>
</tbody>
</table>
<h5 id="compile"><a href="#compile" class="headerlink" title="compile"></a>compile</h5><p>compile æ–¹æ³•ç”¨äºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ”¹å˜å’Œé‡æ–°ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼.</p>
<p>è¯­æ³•: compile(pattern[, flags])</p>
<p>å‚æ•°ä»‹ç»è¯·å‚è€ƒä¸Šè¿° RegExp æ„é€ å™¨. ç”¨æ³•å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"abc"</span>, <span class="string">"gi"</span>); </div><div class="line"><span class="keyword">var</span> reg2 = reg.compile(<span class="string">"new abc"</span>, <span class="string">"g"</span>);</div><div class="line"><span class="built_in">console</span>.log(reg);<span class="comment">// /new abc/g</span></div><div class="line"><span class="built_in">console</span>.log(reg2);<span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>å¯è§ compile æ–¹æ³•ä¼šæ”¹å˜åŸæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡, å¹¶é‡æ–°ç¼–è¯‘, è€Œä¸”å®ƒçš„è¿”å›å€¼ä¸ºç©º.</p>
<h5 id="test"><a href="#test" class="headerlink" title="test"></a>test</h5><p>test æ–¹æ³•ç”¨äºæ£€æµ‹ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…æŸä¸ªæ­£åˆ™è§„åˆ™, åªè¦æ˜¯å­—ç¬¦ä¸²ä¸­å«æœ‰ä¸æ­£åˆ™è§„åˆ™åŒ¹é…çš„æ–‡æœ¬, è¯¥æ–¹æ³•å°±è¿”å›true, å¦åˆ™è¿”å› false.</p>
<p>è¯­æ³•: test(string), ç”¨æ³•å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="regexp">/[0-9]+/</span>.test(<span class="string">"abc123"</span>));<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(<span class="regexp">/[0-9]+/</span>.test(<span class="string">"abc"</span>));<span class="comment">//false</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, å­—ç¬¦ä¸²â€abc123â€ åŒ…å«æ•°å­—, æ•… test æ–¹æ³•è¿”å› true; è€Œ å­—ç¬¦ä¸²â€abcâ€ ä¸åŒ…å«æ•°å­—, æ•…è¿”å› false.</p>
<p>å¦‚æœéœ€è¦ä½¿ç”¨ test æ–¹æ³•æµ‹è¯•å­—ç¬¦ä¸²æ˜¯å¦å®ŒæˆåŒ¹é…æŸä¸ªæ­£åˆ™è§„åˆ™, é‚£ä¹ˆå¯ä»¥åœ¨æ­£åˆ™è¡¨è¾¾å¼é‡Œå¢åŠ å¼€å§‹(^)å’Œç»“æŸ($)å…ƒå­—ç¬¦. å¦‚ä¸‹: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="regexp">/^[0-9]+$/</span>.test(<span class="string">"abc123"</span>));<span class="comment">//false</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š, ç”±äºå­—ç¬¦ä¸²â€abc123â€ å¹¶éä»¥æ•°å­—å¼€å§‹, ä¹Ÿå¹¶éä»¥æ•°å­—ç»“æŸ, æ•… test æ–¹æ³•è¿”å›false.</p>
<p>å®é™…ä¸Š, å¦‚æœæ­£åˆ™è¡¨è¾¾å¼å¸¦æœ‰å…¨å±€æ ‡å¿—(å¸¦æœ‰å‚æ•°g)æ—¶, test æ–¹æ³•è¿˜å—æ­£åˆ™å¯¹è±¡çš„lastIndexå±æ€§å½±å“,å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/[a-z]+/</span>;<span class="comment">//æ­£åˆ™ä¸å¸¦å…¨å±€æ ‡å¿—</span></div><div class="line"><span class="built_in">console</span>.log(reg.test(<span class="string">"abc"</span>));<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(reg.test(<span class="string">"de"</span>));<span class="comment">//true</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/[a-z]+/g</span>;<span class="comment">//æ­£åˆ™å¸¦æœ‰å…¨å±€æ ‡å¿—g</span></div><div class="line"><span class="built_in">console</span>.log(reg.test(<span class="string">"abc"</span>));<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(reg.lastIndex);<span class="comment">//3, ä¸‹æ¬¡è¿è¡Œtestæ—¶,å°†ä»ç´¢å¼•ä¸º3çš„ä½ç½®å¼€å§‹æŸ¥æ‰¾</span></div><div class="line"><span class="built_in">console</span>.log(reg.test(<span class="string">"de"</span>));<span class="comment">//false</span></div></pre></td></tr></table></figure>
<p>è¯¥å½±å“å°†åœ¨exec æ–¹æ³•è®²è§£ä¸­äºˆä»¥åˆ†æ.</p>
<h5 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h5><p>exec æ–¹æ³•ç”¨äºæ£€æµ‹å­—ç¬¦ä¸²å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…, å¦‚æœæ‰¾åˆ°äº†åŒ¹é…çš„æ–‡æœ¬, åˆ™è¿”å›ä¸€ä¸ªç»“æœæ•°ç»„, å¦åˆ™è¿”å›null.</p>
<p>è¯­æ³•: exec(string)</p>
<p>exec æ–¹æ³•è¿”å›çš„æ•°ç»„ä¸­åŒ…å«ä¸¤ä¸ªé¢å¤–çš„å±æ€§, index å’Œ input. å¹¶ä¸”è¯¥æ•°ç»„å…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹:</p>
<ul>
<li>ç¬¬ 0 ä¸ªé¡¹è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼æ•è·çš„æ–‡æœ¬</li>
<li>ç¬¬ 1~n é¡¹è¡¨ç¤ºç¬¬ 1~n ä¸ªåå‘å¼•ç”¨, ä¾æ¬¡æŒ‡å‘ç¬¬ 1~n ä¸ªåˆ†ç»„æ•è·çš„æ–‡æœ¬, å¯ä»¥ä½¿ç”¨RegExp.$ + â€œç¼–å·1~nâ€  ä¾æ¬¡è·å–åˆ†ç»„ä¸­çš„æ–‡æœ¬</li>
<li>index è¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²çš„åˆå§‹ä½ç½®</li>
<li>input è¡¨ç¤ºæ­£åœ¨æ£€ç´¢çš„å­—ç¬¦ä¸²</li>
</ul>
<p>æ— è®ºæ­£åˆ™è¡¨è¾¾å¼æœ‰æ— å…¨å±€æ ‡ç¤ºâ€gâ€, exec çš„è¡¨ç°éƒ½ç›¸åŒ. ä½†æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡çš„è¡¨ç°å´æœ‰äº›ä¸åŒ. ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†è¯´æ˜ä¸‹æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡çš„è¡¨ç°éƒ½æœ‰å“ªäº›ä¸åŒ.</p>
<p>å‡è®¾æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ä¸º reg , æ£€æµ‹çš„å­—ç¬¦ä¸º string , reg.exec(string) è¿”å›å€¼ä¸º array.</p>
<p>è‹¥ reg åŒ…å«å…¨å±€æ ‡ç¤ºâ€gâ€, é‚£ä¹ˆ reg.lastIndex å±æ€§è¡¨ç¤ºåŸå­—ç¬¦ä¸²ä¸­åŒ¹é…çš„å­—ç¬¦ä¸²æœ«å°¾çš„åä¸€ä¸ªä½ç½®, å³ä¸‹æ¬¡åŒ¹é…å¼€å§‹çš„ä½ç½®, æ­¤æ—¶ reg.lastIndex == array.index(åŒ¹é…å¼€å§‹çš„ä½ç½®) + array[0].length(åŒ¹é…å­—ç¬¦ä¸²çš„é•¿åº¦). å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/([a-z]+)/gi</span>,</div><div class="line">    string = <span class="string">"World Internet Conference"</span>;</div><div class="line"><span class="keyword">var</span> array = reg.exec(string);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["World", "World", index: 0, input: "World Internet Conference"]</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">RegExp</span>.$<span class="number">1</span>);<span class="comment">//World</span></div><div class="line"><span class="built_in">console</span>.log(reg.lastIndex);<span class="comment">//5, åˆšå¥½ç­‰äº array.index + array[0].length</span></div></pre></td></tr></table></figure>
<p>éšç€æ£€ç´¢ç»§ç»­, array.index çš„å€¼å°†å¾€åé€’å¢, ä¹Ÿå°±æ˜¯è¯´, reg.lastIndex çš„å€¼ä¹Ÿä¼šåŒæ­¥å¾€åé€’å¢. å› æ­¤, æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡åå¤è°ƒç”¨ exec æ–¹æ³•æ¥éå†å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„åŒ¹é…æ–‡æœ¬. ç›´åˆ° exec æ–¹æ³•å†ä¹ŸåŒ¹é…ä¸åˆ°æ–‡æœ¬æ—¶, å®ƒå°†è¿”å› null, å¹¶æŠŠ reg.lastIndex å±æ€§é‡ç½®ä¸º 0. </p>
<p>æ¥ç€ä¸Šè¿°ä¾‹å­, æˆ‘ä»¬ç»§ç»­æ‰§è¡Œä»£ç , çœ‹çœ‹ä¸Šé¢è¯´çš„å¯¹ä¸å¯¹, å¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">array = reg.exec(string);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["Internet", "Internet", index: 6, input: "World Internet Conference"]</span></div><div class="line"><span class="built_in">console</span>.log(reg.lastIndex);<span class="comment">//14</span></div><div class="line"></div><div class="line">array = reg.exec(string);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["Conference", "Conference", index: 15, input: "World Internet Conference"]</span></div><div class="line"><span class="built_in">console</span>.log(reg.lastIndex);<span class="comment">//25</span></div><div class="line"></div><div class="line">array = reg.exec(string);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//null</span></div><div class="line"><span class="built_in">console</span>.log(reg.lastIndex);<span class="comment">//0</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä»£ç ä¸­, éšç€åå¤è°ƒç”¨ exec æ–¹æ³•, reg.lastIndex å±æ€§æœ€ç»ˆè¢«é‡ç½®ä¸º 0.</p>
<p><strong>é—®é¢˜å›é¡¾</strong></p>
<p>åœ¨ test æ–¹æ³•çš„è®²è§£ä¸­, æˆ‘ä»¬ç•™ä¸‹äº†ä¸€ä¸ªé—®é¢˜. å¦‚æœæ­£åˆ™è¡¨è¾¾å¼å¸¦æœ‰å…¨å±€æ ‡å¿—g, ä»¥ä¸Š test æ–¹æ³•çš„æ‰§è¡Œç»“æœå°†å— reg.lastIndexå½±å“, ä¸ä»…å¦‚æ­¤, exec æ–¹æ³•ä¹Ÿä¸€æ ·. ç”±äº reg.lastIndex çš„å€¼å¹¶ä¸æ€»æ˜¯ä¸ºé›¶, å¹¶ä¸”å®ƒå†³å®šäº†ä¸‹æ¬¡åŒ¹é…å¼€å§‹çš„ä½ç½®, å¦‚æœåœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­å®Œæˆäº†ä¸€æ¬¡åŒ¹é…ä¹‹åè¦å¼€å§‹æ£€ç´¢æ–°çš„å­—ç¬¦ä¸², é‚£å°±å¿…é¡»è¦æ‰‹åŠ¨åœ°æŠŠ lastIndex å±æ€§é‡ç½®ä¸º 0. é¿å…å‡ºç°ä¸‹é¢è¿™ç§é”™è¯¯:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/[0-9]+/g</span>,</div><div class="line">    str1 = <span class="string">"123abc"</span>,</div><div class="line">    str2 = <span class="string">"123456"</span>;</div><div class="line">reg.exec(str1);</div><div class="line"><span class="built_in">console</span>.log(reg.lastIndex);<span class="comment">//3</span></div><div class="line"><span class="keyword">var</span> array = reg.exec(str2);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["456", index: 3, input: "123456"]</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä»£ç , æ­£ç¡®æ‰§è¡Œç»“æœåº”è¯¥æ˜¯ â€œ123456â€,  å› æ­¤å»ºè®®åœ¨ç¬¬äºŒæ¬¡æ‰§è¡Œ exec æ–¹æ³•å‰, å¢åŠ ä¸€å¥ â€œreg.lastIndex = 0;â€.</p>
<p>è‹¥ reg ä¸åŒ…å«å…¨å±€æ ‡ç¤ºâ€gâ€, é‚£ä¹ˆ exec æ–¹æ³•çš„æ‰§è¡Œç»“æœ(array)å°†ä¸ string.match(reg) æ–¹æ³•æ‰§è¡Œç»“æœå®Œå…¨ç›¸åŒ.</p>
<h4 id="String"><a href="#String" class="headerlink" title="String"></a>String</h4><p>match, search, replace, split æ–¹æ³•è¯·å‚è€ƒ <a href="http://louiszhai.github.io/2016/01/12/js.String/"><code>å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•</code></a> ä¸­çš„è®²è§£.</p>
<p>å¦‚ä¸‹å±•ç¤ºäº†ä½¿ç”¨æ•è·æ€§åˆ†ç»„å¤„ç†æ–‡æœ¬æ¨¡æ¿, æœ€ç»ˆç”Ÿæˆå®Œæ•´å­—ç¬¦ä¸²çš„è¿‡ç¨‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> tmp = <span class="string">"An $&#123;a&#125; a $&#123;b&#125; keeps the $&#123;c&#125; away"</span>;</div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="attr">a</span>:<span class="string">"apple"</span>,</div><div class="line">  <span class="attr">b</span>:<span class="string">"day"</span>,</div><div class="line">  <span class="attr">c</span>:<span class="string">"doctor"</span></div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tmpl</span>(<span class="params">t,o</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> t.replace(<span class="regexp">/\$&#123;(.)&#125;/g</span>,<span class="function"><span class="keyword">function</span>(<span class="params">m,p</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'m:'</span>+m+<span class="string">' p:'</span>+p);</div><div class="line">    <span class="keyword">return</span> o[p];</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line">tmpl(tmp,obj);</div></pre></td></tr></table></figure>
<p>ä¸Šè¿°åŠŸèƒ½ä½¿ç”¨ES6å¯è¿™ä¹ˆå®ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="attr">a</span>:<span class="string">"apple"</span>,</div><div class="line">  <span class="attr">b</span>:<span class="string">"day"</span>,</div><div class="line">  <span class="attr">c</span>:<span class="string">"doctor"</span></div><div class="line">&#125;;</div><div class="line"><span class="keyword">with</span>(obj)&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`An <span class="subst">$&#123;a&#125;</span> a <span class="subst">$&#123;b&#125;</span> keeps the <span class="subst">$&#123;c&#125;</span> away`</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="æ­£åˆ™è¡¨è¾¾å¼åœ¨H5ä¸­çš„åº”ç”¨"><a href="#æ­£åˆ™è¡¨è¾¾å¼åœ¨H5ä¸­çš„åº”ç”¨" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼åœ¨H5ä¸­çš„åº”ç”¨"></a>æ­£åˆ™è¡¨è¾¾å¼åœ¨H5ä¸­çš„åº”ç”¨</h3><p>H5ä¸­æ–°å¢äº† pattern å±æ€§, è§„å®šäº†ç”¨äºéªŒè¯è¾“å…¥å­—æ®µçš„æ¨¡å¼, patternçš„æ¨¡å¼åŒ¹é…æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼çš„ä¹¦å†™æ–¹å¼. é»˜è®¤ pattern å±æ€§æ˜¯å…¨éƒ¨åŒ¹é…, å³æ— è®ºæ­£åˆ™è¡¨è¾¾å¼ä¸­æœ‰æ—  â€œ^â€, â€œ$â€ å…ƒå­—ç¬¦, å®ƒéƒ½æ˜¯åŒ¹é…æ‰€æœ‰æ–‡æœ¬.</p>
<p>æ³¨: pattern é€‚ç”¨äºä»¥ä¸‹ input ç±»å‹ï¼štext, search, url, telephone, email ä»¥åŠ password. å¦‚æœéœ€è¦å–æ¶ˆè¡¨å•éªŒè¯, åœ¨formæ ‡ç­¾ä¸Šå¢åŠ  novalidate å±æ€§å³å¯.</p>
<h3 id="æ­£åˆ™å¼•æ“"><a href="#æ­£åˆ™å¼•æ“" class="headerlink" title="æ­£åˆ™å¼•æ“"></a>æ­£åˆ™å¼•æ“</h3><p>ç›®å‰æ­£åˆ™å¼•æ“æœ‰ä¸¤ç§, DFA å’Œ NFA, NFAåˆå¯ä»¥åˆ†ä¸ºä¼ ç»Ÿå‹NFAå’ŒPOSIX NFA.</p>
<ul>
<li>DFA Deterministic finite automaton ç¡®å®šå‹æœ‰ç©·è‡ªåŠ¨æœº</li>
<li>NFA Non-deterministic finite automatonã€€éç¡®å®šå‹æœ‰ç©·è‡ªåŠ¨æœº</li>
<li>Traditional NFA</li>
<li>POSIX NFA</li>
</ul>
<p>DFAå¼•æ“ä¸æ”¯æŒå›æº¯, åŒ¹é…å¿«é€Ÿ, å¹¶ä¸”ä¸æ”¯æŒæ•è·ç»„, å› æ­¤ä¹Ÿå°±ä¸æ”¯æŒåå‘å¼•ç”¨. ä¸Šè¿°awk, egrepå‘½ä»¤å‡æ”¯æŒ DFAå¼•æ“. </p>
<p>POSIX NFAä¸»è¦æŒ‡ç¬¦åˆPOSIXæ ‡å‡†çš„NFAå¼•æ“, åƒ javaScript, java, php, python, c#ç­‰è¯­è¨€å‡å®ç°äº†NFAå¼•æ“.</p>
<p>æœ‰å…³æ­£åˆ™è¡¨è¾¾å¼è¯¦ç»†çš„åŒ¹é…åŸç†, æš‚æ—¶æ²¡åœ¨ç½‘ä¸Šçœ‹åˆ°é€‚åˆçš„æ–‡ç« , å»ºè®®é€‰è¯» Jeffrey Friedl çš„ &lt;ç²¾é€šæ­£åˆ™è¡¨è¾¾å¼&gt;[ç¬¬ä¸‰ç‰ˆ] ä¸­ç¬¬4ç« -è¡¨è¾¾å¼çš„åŒ¹é…åŸç†(p143-p183), Jeffrey Friedl å¯¹æ­£åˆ™è¡¨è¾¾å¼æœ‰ç€æ·±åˆ»çš„ç†è§£, ç›¸ä¿¡ä»–èƒ½å¤Ÿå¸®åŠ©æ‚¨æ›´å¥½çš„å­¦ä¹ æ­£åˆ™.</p>
<p>æœ‰å…³NFAå¼•æ“çš„ç®€å•å®ç°, å¯ä»¥å‚è€ƒæ–‡ç«  <a href="http://www.cnblogs.com/catch/p/3722082.html" target="_blank" rel="external">åŸºäºÎµ-NFAçš„æ­£åˆ™è¡¨è¾¾å¼å¼•æ“ - twoon</a>.</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>åœ¨å­¦ä¹ æ­£åˆ™çš„åˆçº§é˜¶æ®µ, é‡åœ¨ç†è§£ â‘ è´ªå©ªä¸éè´ªå©ªæ¨¡å¼, â‘¡åˆ†ç»„, â‘¢æ•è·æ€§ä¸éæ•è·æ€§åˆ†ç»„, â‘£å‘½ååˆ†ç»„, â‘¤å›ºåŒ–åˆ†ç»„, ä½“ä¼šè®¾è®¡çš„ç²¾å¦™ä¹‹å¤„. è€Œé«˜çº§é˜¶æ®µ, ä¸»è¦åœ¨äºç†Ÿç»ƒè¿ç”¨â‘¥é›¶å®½æ–­è¨€(æˆ–ç¯è§†)è§£å†³é—®é¢˜, å¹¶ä¸”ç†Ÿæ‚‰æ­£åˆ™åŒ¹é…çš„åŸç†. </p>
<p>å®é™…ä¸Š, æ­£åˆ™åœ¨ javaScript ä¸­çš„åŠŸèƒ½ä¸ç®—å¼ºå¤§, js ä»…ä»…æ”¯æŒäº†â‘ è´ªå©ªä¸éè´ªå©ªæ¨¡å¼, â‘¡åˆ†ç»„, â‘¢æ•è·æ€§ä¸éæ•è·æ€§åˆ†ç»„ ä»¥åŠ â‘¥é›¶å®½æ–­è¨€ä¸­çš„é¡ºåºç¯è§†. å¦‚æœå†ç¨å¾®ç†Ÿæ‚‰äº› js ä¸­7ç§ä¸æ­£åˆ™æœ‰å…³çš„æ–¹æ³•(compile, test, exec, match, search, replace, split), é‚£ä¹ˆå¤„ç†æ–‡æœ¬æˆ–å­—ç¬¦ä¸²å°†æ¸¸åˆƒæœ‰ä½™.</p>
<p>æ­£åˆ™è¡¨è¾¾å¼, åœ¨æ–‡æœ¬å¤„ç†æ–¹é¢å¤©èµ‹å¼‚ç¦€, å®ƒçš„åŠŸèƒ½ååˆ†å¼ºå¤§, å¾ˆå¤šæ—¶å€™ç”šè‡³æ˜¯å”¯ä¸€è§£å†³æ–¹æ¡ˆ. æ­£åˆ™ä¸å±€é™äºjs, å½“ä¸‹çƒ­é—¨çš„ç¼–è¾‘å™¨(æ¯”å¦‚Sublime, Atom) ä»¥åŠ IDE(æ¯”å¦‚WebStorm, IntelliJ IDEA) éƒ½æ”¯æŒå®ƒ. æ‚¨ç”šè‡³å¯ä»¥åœ¨ä»»ä½•æ—¶å€™ä»»ä½•è¯­è¨€ä¸­, å°è¯•ä½¿ç”¨æ­£åˆ™è§£å†³é—®é¢˜, ä¹Ÿè®¸ä¹‹å‰ä¸èƒ½è§£å†³çš„é—®é¢˜, ç°åœ¨å¯ä»¥è½»æ¾çš„è§£å†³.</p>
<p>é™„å…¶ä»–è¯­è¨€æ­£åˆ™èµ„æ–™:</p>
<ul>
<li><a href="http://wiki.ubuntu.org.cn/Python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97" target="_blank" rel="external">Pythonæ­£åˆ™è¡¨è¾¾å¼æ“ä½œæŒ‡å—</a></li>
<li><a href="http://blog.csdn.net/allwefantasy/article/details/3136570/" target="_blank" rel="external">javaæ­£åˆ™è¡¨è¾¾å¼</a></li>
</ul>
<hr>
<p>æœ¬æ–‡å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡ç®€ä»‹: æœ¬æ–‡æ–­æ–­ç»­ç»­å†æ—¶ä¸¤ä¸ªæœˆè€Œæˆ, å…±è®¡12kå­—, ä¸ºæ±‚ç®€æ´å…¨é¢åœ°è¿˜åŸå‰ç«¯åœºæ™¯ä¸­æ­£åˆ™çš„ä½¿ç”¨è§„å¾‹, æœé›†äº†å¤§é‡æ­£åˆ™ç›¸å…³èµ„æ–™, å¹¶å‰”é™¤ä¸å°‘å†—ä½™å­—å¥, ç å­—ä¸æ˜“, å–œæ¬¢çš„è¯·ç‚¹ä¸ªèµğŸ‘æˆ–è€…æ”¶è—, æˆ‘å°†æŒç»­ä¿æŒæ›´æ–°.</p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/06/13/regular/">http://louiszhai.github.io/2016/06/13/regular/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li>Jeffrey Friedl çš„ &lt;ç²¾é€šæ­£åˆ™è¡¨è¾¾å¼&gt;[ç¬¬ä¸‰ç‰ˆ]</li>
<li><a href="http://blog.csdn.net/fdl19881/article/details/7800877" target="_blank" rel="external">linux shell æ­£åˆ™è¡¨è¾¾å¼(BREs,EREs,PREs)å·®å¼‚æ¯”è¾ƒ</a></li>
<li><a href="http://www.jb51.net/article/28035.htm" target="_blank" rel="external">æ­£åˆ™è¡¨è¾¾å¼ä¹‹æ•è·ç»„/éæ•è·ç»„ä»‹ç»_æ­£åˆ™è¡¨è¾¾å¼_è„šæœ¬ä¹‹å®¶</a></li>
<li><a href="http://www.cnblogs.com/kissdodog/archive/2013/04/22/3036649.html" target="_blank" rel="external">æ­£åˆ™è¡¨è¾¾å¼(ä¸€) â€“ å…ƒå­—ç¬¦ - é€†å¿ƒ - åšå®¢å›­</a></li>
<li><a href="http://blog.csdn.net/hguisu/article/details/8244560" target="_blank" rel="external">æ­£åˆ™è¡¨è¾¾å¼è¯¦è§£ - guisuï¼Œç¨‹åºäººç”Ÿã€‚ é€†æ°´è¡ŒèˆŸï¼Œä¸è¿›åˆ™é€€ã€‚ - åšå®¢é¢‘é“ - CSDN.NET</a></li>
<li><a href="http://www.cnblogs.com/taek/archive/2012/02/08/2342741.html" target="_blank" rel="external">æ­£åˆ™è¡¨è¾¾å¼ä¹‹å›ºåŒ–åˆ†ç»„ - taek - åšå®¢å›­</a></li>
<li><a href="http://www.jb51.net/article/31491.htm" target="_blank" rel="external">æ­£åˆ™è¡¨è¾¾å¼ä¹‹ è´ªå©ªä¸éè´ªå©ªæ¨¡å¼è¯¦è§£ï¼ˆæ¦‚è¿°ï¼‰_æ­£åˆ™è¡¨è¾¾å¼_è„šæœ¬ä¹‹å®¶</a></li>
<li><a href="http://blog.csdn.net/nebula1982/article/details/6659702" target="_blank" rel="external">JAVASCRIPT æ­£åˆ™è¡¨è¾¾å¼å­¦ä¹ â€“&gt;åŸºç¡€ä¸é›¶å®½æ–­è¨€ï¼ˆè½¬è‡ªå¸å¾’æ­£ç¾ï¼‰ - éšé£ä¹‹ç¾½ - åšå®¢é¢‘é“ - CSDN.NET</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2014/12/unicode.html" target="_blank" rel="external">Unicodeä¸JavaScriptè¯¦è§£ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      regexp æ­£åˆ™è¡¨è¾¾å¼ åå‘å¼•ç”¨ è´ªå©ªæ¨¡å¼ éè´ªå©ªæ¨¡å¼ å…ƒå­—ç¬¦ å­—ç¬¦ç»„ é™å®šç¬¦ æ“ä½œç¬¦ ES6æ‰©å±• å›ºåŒ–åˆ†ç»„ å æœ‰é‡è¯ä¼˜å…ˆ ç¯è§† é¡ºåºç¯è§† é€†åºç¯è§†
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>è¯¦è§£IE7ä»¥ä¸‹ç‹¬æœ‰çš„hasLayout</title>
    <link href="http://louiszhai.github.io/2016/03/31/css-hasLayout/"/>
    <id>http://louiszhai.github.io/2016/03/31/css-hasLayout/</id>
    <published>2016-03-31T05:57:56.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä»€ä¹ˆæ˜¯hasLayout"><a href="#ä»€ä¹ˆæ˜¯hasLayout" class="headerlink" title="ä»€ä¹ˆæ˜¯hasLayout"></a>ä»€ä¹ˆæ˜¯hasLayout</h3><blockquote>
<p>hasLayout property: Gets a value that indicates whether the object has layout.</p>
</blockquote>
<p><strong>hasLayout</strong> æ˜¯IEæ¸²æŸ“å¼•æ“çš„ä¸€ä¸ªå†…éƒ¨å®ç°. IEä¸­, ä¸€ä¸ªå…ƒç´ è¦ä¹ˆè‡ªå·±è®¡ç®—å¤§å°ç»„ç»‡å†…å®¹(è‡ªå·±æ¸²æŸ“), è¦ä¹ˆä¾èµ–çˆ¶å…ƒç´ æ¥è®¡ç®—å¤§å°å’Œç»„ç»‡å†…å®¹(ä¾èµ–ç¥–å…ˆå…ƒç´ æ¸²æŸ“). ä¸ºäº†åŒºåˆ†ä¸¤è€…, æ¸²æŸ“å¼•æ“é‡‡ç”¨äº† hasLayout å±æ€§, è¯¥å±æ€§å¯ä»¥è®¾ç½®ä¸º true æˆ– false. è‹¥ä¸€ä¸ªå…ƒç´ çš„ hasLayout å±æ€§å€¼ä¸º true æ—¶, è¿™ä¸ªå…ƒç´ ä¾¿æ‹¥æœ‰äº†ä¸€ä¸ªå¸ƒå±€(layout), è¯¥å…ƒç´ ä¾¿ä¸åœ¨ä¾èµ–æŸä¸ªç¥–å…ˆå…ƒç´ è¿›è¡Œæ¸²æŸ“, è€Œæ˜¯å®ƒè‡ªå·±å°±å»æ¸²æŸ“è‡ªå·±äº†, å®ƒä¼šè´Ÿè´£å¯¹è‡ªå·±å’Œå¯èƒ½çš„å­å­™å…ƒç´ è¿›è¡Œå°ºå¯¸è®¡ç®—å’Œå®šä½, è¿™æ„å‘³ç€è¿™ä¸ªå…ƒç´ éœ€è¦èŠ±æ›´å¤šçš„ä»£ä»·æ¥ç»´æŠ¤è‡ªèº«å’Œé‡Œé¢çš„å†…å®¹; ç›¸åçš„, è‹¥å…ƒç´ çš„ hasLayout å±æ€§å€¼ä¸º falseæ—¶, å®ƒä¼šç›´æ¥ä¾èµ–äºæŸä¸ªç¥–å…ˆå…ƒç´ æ¥å®Œæˆè¿™äº›å·¥ä½œ, æœ€ç»ˆé€ æˆå¾ˆå¤šçš„IE bugs.</p>
<a id="more"></a>
<h3 id="é»˜è®¤æƒ…å†µä¸‹hasLayout-trueçš„å…ƒç´ "><a href="#é»˜è®¤æƒ…å†µä¸‹hasLayout-trueçš„å…ƒç´ " class="headerlink" title="é»˜è®¤æƒ…å†µä¸‹hasLayout=trueçš„å…ƒç´ "></a>é»˜è®¤æƒ…å†µä¸‹hasLayout=trueçš„å…ƒç´ </h3><p>ä¸‹åˆ—å…ƒç´ é»˜è®¤æ‹¥æœ‰ layout:</p>
<ul>
<li>html body</li>
<li>table tr th td</li>
<li>img</li>
<li>hr</li>
<li>input button file select textarea fieldset</li>
<li>marquee</li>
<li>frameset frame iframe </li>
<li>objects applets embed</li>
</ul>
<h3 id="æ€ä¹ˆè§¦å‘åŠæ¸…é™¤-hasLayout"><a href="#æ€ä¹ˆè§¦å‘åŠæ¸…é™¤-hasLayout" class="headerlink" title="æ€ä¹ˆè§¦å‘åŠæ¸…é™¤ hasLayout"></a>æ€ä¹ˆè§¦å‘åŠæ¸…é™¤ hasLayout</h3><p>ä»¥ä¸‹cssæ ·å¼çš„è®¾ç½®, ä¼šè§¦å‘å…ƒç´ çš„ hasLayout:</p>
<ul>
<li><em>position: absolute</em>(IE5+)</li>
<li><em>float: left|right</em>(IE5+)</li>
<li><em>display: inline-block</em>(IE5+)</li>
<li><em>width|height: â€œautoâ€ä»¥å¤–çš„ä»»ä½•å€¼</em>(IE5+; åªå¯¹blockå…ƒç´ æœ‰æ•ˆ)</li>
<li><em>zoom: â€œnormalâ€ä»¥å¤–çš„ä»»ä½•å€¼</em>(IE5.5+; IEç§æœ‰å±æ€§)</li>
<li><em>writing-mode: tb-rl</em>(IE5+; IEç§æœ‰å±æ€§)</li>
<li><em>overflow: hidden|scroll|auto</em>(IE7; æ­¤å±æ€§åœ¨IE6åŠæ›´æ—©ç‰ˆæœ¬ä¸­ä¸èƒ½åº”ç”¨åœ¨æœªè§¦å‘hasLayoutçš„å…ƒç´ ä¸Š)</li>
<li><em>overflow-x|-y: hidden|scroll|auto</em>(IE7; æ­¤å±æ€§åœ¨IE6åŠæ›´æ—©ç‰ˆæœ¬ä¸­ä¸è§¦å‘hasLayout; æ­¤å±æ€§åœ¨CSS3ä¸­æ‰è·æ”¯æŒ)</li>
<li><em>position: fixed</em>(IE7)</li>
<li><em>min-width: ä»»ä½•å€¼</em>(IE7; å³ä½¿æ˜¯0)</li>
<li><em>max-width: â€œnoneâ€ä»¥å¤–çš„ä»»ä½•å€¼</em>(IE7)</li>
<li><em>min-height: ä»»ä½•å€¼</em>(IE7)</li>
<li><em>max-height: â€œnoneâ€ä»¥å¤–çš„ä»»ä½•å€¼</em>(IE7)</li>
<li><em>position: fixed</em>(IE7)</li>
</ul>
<p>ä»¥ä¸‹cssæ ·å¼çš„è®¾ç½®, ä¼šæ¸…é™¤å·²ç»è§¦å‘çš„ hasLayout:</p>
<ul>
<li><em>position: static</em>(IE5+)</li>
<li><em>float: none</em>(IE5+)</li>
<li><em>display: â€œinline-blockâ€ä»¥å¤–çš„ä»»ä½•å€¼</em>(IE5+)</li>
<li><em>width|height: â€œautoâ€</em>(IE5+; å¯¹inlineå…ƒç´ æ— æ•ˆ)</li>
<li><em>zoom: â€œnormalâ€</em>(IE5.5+; IEç§æœ‰å±æ€§)</li>
<li><em>writing-mode: ä»â€™tb-rlâ€™åˆ°â€™lr-tbâ€™</em>(IE5+; IEç§æœ‰å±æ€§)</li>
<li><em>max-width|max-height: â€œnoneâ€</em>(IE7)</li>
<li><em>overflow: visible</em>(IE7)</li>
</ul>
<h3 id="hasLayout-çš„å½±å“"><a href="#hasLayout-çš„å½±å“" class="headerlink" title="hasLayout çš„å½±å“"></a>hasLayout çš„å½±å“</h3><ol>
<li><strong>æµ®åŠ¨å…ƒç´ å¯ä»¥è¢« layout å…ƒç´ è‡ªåŠ¨åŒ…å«</strong>. ä¸€èˆ¬æƒ…å†µä¸‹, ç”±äºæµ®åŠ¨å…ƒç´ è„±ç¦»æ™®é€šæ–‡æ¡£æµä¼šé€ æˆçˆ¶å…ƒç´ çš„åå¡Œ. ä½†æ˜¯åœ¨IE6-7ä¸‹, é€šè¿‡è§¦å‘çˆ¶å…ƒç´ çš„ hasLayout, å¯ä»¥ä½¿å¾—çˆ¶å…ƒç´ è‡ªåŠ¨åŒ…å«æµ®åŠ¨çš„å­å…ƒç´ , ä»è€Œä¿®å¤åå¡Œé—®é¢˜. ä¸€èˆ¬æˆ‘ä»¬è®¾ç½®çˆ¶å…ƒç´ çš„ *height:1%; å³å¯, 1%å¹¶ä¸ä¼šæ”¹å˜å®é™…é«˜åº¦, åªæ˜¯è§¦å‘äº† hasLayout, è¯¥æ–¹æ³•è¢«ç§°ä¸ºéœè‰ç ´è§£(Holly hack), éœ€è¦æ³¨æ„çš„æ˜¯, å½“è¿™ä¸ªå…ƒç´ çš„ overflow å±æ€§è¢«è®¾ç½®ä¸º visible æ—¶, è¿™ä¸ªæ–¹æ³•å°±å¤±æ•ˆäº†.</li>
<li>æ­£å¸¸æƒ…å†µä¸‹, æµ®åŠ¨å…ƒç´ æ—è¾¹çš„å…ƒç´ , å…¶å†…å®¹åº”è¯¥ç¯ç»•è¯¥æµ®åŠ¨å…ƒç´ . å¦‚æœè¿™ä¸ªå…ƒç´ æ‹¥æœ‰ layout, é‚£ä¹ˆè¿™ä¸ªå…ƒç´ å°±ä¼šè¡¨ç°ä¸ºä¸€ä¸ªçŸ©å½¢, å…¶å†…å®¹ä¸ä¼šç¯ç»•æµ®åŠ¨å…ƒç´ .</li>
<li>IEç‹¬æœ‰çš„æ»¤é•œå±æ€§(filter) åªé€‚ç”¨äº layout å…ƒç´ , è‹¥ä¸€ä¸ªdiv è®¾ç½®äº†<strong>filter:alpha(opacity=90)</strong>, åˆæ²¡æœ‰è§¦å‘è¯¥div çš„ hasLayout, é‚£ä¹ˆé€æ˜çš„è®¾ç½®å°†æ— æ•ˆ.</li>
<li>hasLayout å½±å“å—çº§å…ƒç´ é¼ æ ‡çš„å“åº”åŒºåŸŸ, é€šå¸¸ hasLayout=falseæ—¶, åªæœ‰æ–‡å­—åŒºåŸŸæ‰æœ‰å“åº”, è€Œ hasLayout=true æ—¶, æ•´ä¸ªå—çº§å…ƒç´ éƒ½æ˜¯å¯ä»¥å“åº”çš„.</li>
</ol>
<h3 id="hasLayout-å¼•èµ·çš„bug"><a href="#hasLayout-å¼•èµ·çš„bug" class="headerlink" title="hasLayout å¼•èµ·çš„bug"></a>hasLayout å¼•èµ·çš„bug</h3><ol>
<li>IE6 åŠæ›´ä½ç‰ˆæœ¬çš„åŒç©ºç™½è¾¹æµ®åŠ¨ bug, ä¿®å¤æ–¹æ¡ˆ: display:inline;</li>
<li>IE5-6çš„ 3 åƒç´ åç§» bug, ä¿®å¤æ–¹æ¡ˆ: _height:1%;</li>
<li>IE6 çš„èº²èº²çŒ«(peek-a-boo) bug, ä¿®å¤æ–¹æ¡ˆ: _height:1%;</li>
<li>IE6-7è´Ÿmarginéšè—Bug, ä¿®å¤æ–¹æ¡ˆ: å»æ‰çˆ¶å…ƒç´ çš„hasLayout; æˆ–è€…èµ‹hasLayoutç»™å­å…ƒç´ , å¹¶æ·»åŠ position:relative;</li>
</ol>
<h3 id="æ€ä¹ˆæ£€æµ‹IEä¸‹çš„æŸä¸ªå…ƒç´ æ˜¯å¦æ‹¥æœ‰hasLayout"><a href="#æ€ä¹ˆæ£€æµ‹IEä¸‹çš„æŸä¸ªå…ƒç´ æ˜¯å¦æ‹¥æœ‰hasLayout" class="headerlink" title="æ€ä¹ˆæ£€æµ‹IEä¸‹çš„æŸä¸ªå…ƒç´ æ˜¯å¦æ‹¥æœ‰hasLayout"></a>æ€ä¹ˆæ£€æµ‹IEä¸‹çš„æŸä¸ªå…ƒç´ æ˜¯å¦æ‹¥æœ‰hasLayout</h3><p>åœ¨ IE Developer Toolbar ä¸‹, æ‹¥æœ‰ haslayoutçš„å…ƒç´ , é€šå¸¸æ˜¾ç¤ºä¸º â€œhaslayout = -1â€. ä¹Ÿå¯é€šè¿‡jsçš„æ–¹å¼æ£€æµ‹, å¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">"myDiv"</span>);</div><div class="line"><span class="built_in">console</span>.log(element.currentStyle.hasLayout);<span class="comment">//è¯¥æ–¹å¼åªèƒ½è·å–å€¼, è€Œä¸èƒ½è®¾ç½®</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸‹ä»£ç å¯ç”¨äºåœ¨IE6-7ä¸‹æµ‹è¯•æŸä¸ªå…ƒç´ æ˜¯å¦æ‹¥æœ‰hasLayout:</p>
<p>Code example: <a href="http://samples.msdn.microsoft.com/workshop/samples/author/dhtml/refs/hasLayout.htm" target="_blank" rel="external">http://samples.msdn.microsoft.com/workshop/samples/author/dhtml/refs/hasLayout.htm</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>hasLayout Property<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span> </div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>hasLayout Property<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>This example uses the <span class="tag">&lt;<span class="name">strong</span>&gt;</span>hasLayout<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> property of the <span class="tag">&lt;<span class="name">strong</span>&gt;</span>currentStyle<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> object to  </div><div class="line">    show that an element has layout when it is absolutely positioned, or when its height and/or width are specified.   </div><div class="line">    The <span class="tag">&lt;<span class="name">strong</span>&gt;</span>hasLayout<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> property returns <span class="tag">&lt;<span class="name">strong</span>&gt;</span>true<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> for an object that has layout, and  </div><div class="line">    <span class="tag">&lt;<span class="name">strong</span>&gt;</span>false<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> for an object that has no layout.<span class="tag">&lt;/<span class="name">p</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">fieldset</span> <span class="attr">style</span>=<span class="string">"width: 50%; text-align: center;"</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;<span class="name">legend</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>hasLayout<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> Property<span class="tag">&lt;/<span class="name">legend</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"text-align: left;"</span>&gt;</span><span class="tag">&lt;<span class="name">em</span>&gt;</span>Which DIV element has layout?<span class="tag">&lt;/<span class="name">em</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"oWidthSet"</span> <span class="attr">style</span>=<span class="string">"width: 100%; text-align: left;"</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>DIV<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> element A has its <span class="tag">&lt;<span class="name">strong</span>&gt;</span>width<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> set to <span class="tag">&lt;<span class="name">strong</span>&gt;</span>100%<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>.<span class="tag">&lt;/<span class="name">div</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"oNotSet"</span> <span class="attr">style</span>=<span class="string">"text-align: left;"</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>DIV<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> element B is not positioned, and neither its <span class="tag">&lt;<span class="name">strong</span>&gt;</span>height<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> nor <span class="tag">&lt;<span class="name">strong</span>&gt;</span>width<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> is set.<span class="tag">&lt;/<span class="name">div</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"document.getElementById('messageBox').textContent = document.getElementById('oWidthSet').currentStyle.hasLayout;"</span>&gt;</span>DIV Element A<span class="tag">&lt;/<span class="name">button</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"document.getElementById('messageBox').textContent = document.getElementById('oNotSet').currentStyle.hasLayout;"</span>&gt;</span>DIV Element B<span class="tag">&lt;/<span class="name">button</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"messageBox"</span> <span class="attr">style</span>=<span class="string">"padding-top: 1em; font-weight: bold;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>å¦å¤–, è‹¥ä¸€ä¸ªå…ƒç´ æ²¡æœ‰å¸ƒå±€(layout), é‚£ä¹ˆIEä¸‹ clientWidth/clientHeight æ€»æ˜¯è¿”å›0. åŸºäºè¿™ç‚¹, å¯ä»¥ä½¿ç”¨å¦ä¸€ç§jsçš„æ–¹æ³•æ£€æµ‹å…ƒç´ æ˜¯å¦æ‹¥æœ‰hasLayout, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(element.clientHeight==<span class="number">0</span>);<span class="comment">//ç­‰äºtrueåˆ™è¡¨ç¤ºè¯¥å…ƒç´ ä¸æ‹¥æœ‰hasLayout</span></div></pre></td></tr></table></figure>
<h3 id="éœ€è¦æ³¨æ„çš„æ˜¯"><a href="#éœ€è¦æ³¨æ„çš„æ˜¯" class="headerlink" title="éœ€è¦æ³¨æ„çš„æ˜¯"></a>éœ€è¦æ³¨æ„çš„æ˜¯</h3><ul>
<li>hasLayout åŠŸèƒ½åªå­˜åœ¨äºIE7åŠä½ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸Š, IE8ä¸­å·²åˆ é™¤ hasLayout åŠŸèƒ½.</li>
<li>hasLayout è§¦å‘å, æ²¡æœ‰åŠæ³•ç›´æ¥è®¾ç½® hasLayout=false, åªæœ‰å°†é‚£äº›è§¦å‘ hasLayout çš„ css å±æ€§å»é™¤, æ‰èƒ½æ¢å¤åŸæ ·.</li>
</ul>
<hr>
<p>æœ¬æ–‡å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/03/31/css-hasLayout/">http://louiszhai.github.io/2016/03/31/css-hasLayout/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="https://msdn.microsoft.com/library/ms530751(v=vs.85).aspx" target="_blank" rel="external">display property (Internet Explorer)</a></li>
<li><a href="http://blog.csdn.net/hedong37518585/article/details/6639263" target="_blank" rel="external">hasLayout ä»‹ç»ï¼Œä»¥åŠå…¶è§¦å‘æ¡ä»¶ - ä½•ä¸œç‹®å¼ - åšå®¢é¢‘é“ - CSDN.NET</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_50502064010135lr.html" target="_blank" rel="external">è®¤è¯†hasLayoutâ€”â€”IE6ã€7æµè§ˆå™¨css bugçš„ä¸€å¤§ç½ªæ¶æ ¹æº_ICER_JIN_æ–°æµªåšå®¢</a></li>
<li><a href="https://msdn.microsoft.com/zh-cn/data/ms530764" target="_blank" rel="external">hasLayout property (Internet Explorer)</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      css IE6 IE7 hasLayout
    
    </summary>
    
    
      <category term="css" scheme="http://louiszhai.github.io/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>ä½ ä¸çŸ¥é“çš„marginå±æ€§</title>
    <link href="http://louiszhai.github.io/2016/03/23/css-margin/"/>
    <id>http://louiszhai.github.io/2016/03/23/css-margin/</id>
    <published>2016-03-23T12:47:36.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>marginå±æ€§å¤„äºç›’å­æ¨¡å‹çš„æœ€å¤–å±‚, ç”¨ä»¥éš”å¼€å…¶ä»–å…ƒç´ , å®ƒå¯ä»¥ä¾æ¬¡è®¾ç½®4ä¸ªé•¿åº¦å€¼, åˆ†åˆ«è¡¨ç¤º â€œä¸Š å³ ä¸‹ å·¦â€ çš„é—´è·, å…¶ä¸­ç¬¬1ä¸ªå’Œç¬¬3ä¸ªå€¼ç›¸å¯¹åº”, ç¬¬2ä¸ªä¸ç¬¬4ä¸ªç›¸å¯¹åº”, å¦‚æœçœç•¥å‰è€…, åè€…å°†å–ä¸å‰è€…ç›¸åŒçš„æ•°å€¼. marginå±æ€§å…±å­˜åœ¨ä»¥ä¸‹ 4 ç§è¡¨ç¤ºæ–¹å¼:</p>
<ul>
<li>margin: 10px 1rem 1em 5%; å…± 4 ä¸ªæ•°å€¼, è¡¨ç¤ºä¾æ¬¡è®¾ç½® ä¸Š, å³, ä¸‹, å·¦çš„é—´è·;</li>
<li>margin: 10px 1rem 1em; å…± 3 ä¸ªæ•°å€¼, çœç•¥ç¬¬4ä¸ªå€¼, å·¦é—´è·å°†å–å³é—´è·çš„å€¼, è¡¨ç¤ºä¾æ¬¡è®¾ç½® ä¸Š, å·¦å³, ä¸‹çš„é—´è·;</li>
<li>margin: 10px 1rem; å…± 2 ä¸ªæ•°å€¼, çœç•¥ç¬¬3,4ä¸ªå€¼, å·¦é—´è·å°†å–å³é—´è·çš„å€¼, ä¸‹é—´è·å°†å–ä¸Šé—´è·çš„å€¼, è¡¨ç¤ºä¾æ¬¡è®¾ç½® ä¸Šä¸‹, å·¦å³çš„é—´è·;</li>
<li>margin: 10px; å…± 1 ä¸ªæ•°å€¼, åŒæ—¶çœç•¥ç¬¬2,3,4ä¸ªå€¼, è¡¨ç¤ºä¸Šä¸‹å·¦å³çš„é—´è·å‡ä¸º10px;</li>
</ul>
<p>è‹¥æ˜¯å—çº§å…ƒç´ , å€ŸåŠ© margin:0 auto; å³å¯å®ç°æ°´å¹³å±…ä¸­.</p>
<p>çœ‹åˆ°è¿™é‡Œ, ä½ å¯èƒ½ä¼šè§‰å¾—è¿™äº›ä½ éƒ½æ‡‚äº†, è¿™ä¸è¦ç´§, æ˜¾ç„¶æœ¬æ–‡ä¹Ÿä¸æ˜¯ä¸ºäº†ç§‘æ™®marginçš„åŸºç¡€è¯­æ³•, è¯·å¾€ä¸‹çœ‹.</p>
<a id="more"></a>
<h3 id="å‚ç›´å¤–è¾¹è·åˆå¹¶é—®é¢˜"><a href="#å‚ç›´å¤–è¾¹è·åˆå¹¶é—®é¢˜" class="headerlink" title="å‚ç›´å¤–è¾¹è·åˆå¹¶é—®é¢˜"></a>å‚ç›´å¤–è¾¹è·åˆå¹¶é—®é¢˜</h3><p>åˆ«è¢«ä¸Šé¢è¿™ä¸ªåè¯ç»™å“å€’äº†, ç®€å•åœ°è¯´, å¤–è¾¹è·åˆå¹¶æŒ‡çš„æ˜¯, å½“ä¸¤ä¸ªå‚ç›´å¤–è¾¹è·ç›¸é‡æ—¶, å®ƒä»¬å°†å½¢æˆä¸€ä¸ªå¤–è¾¹è·. åˆå¹¶åçš„å¤–è¾¹è·çš„é«˜åº¦ç­‰äºä¸¤ä¸ªå‘ç”Ÿåˆå¹¶çš„å¤–è¾¹è·çš„é«˜åº¦ä¸­çš„è¾ƒå¤§è€…. ä½ å¯ä»¥æŸ¥çœ‹<a href="http://www.w3school.com.cn/css/css_margin_collapsing.asp" target="_blank" rel="external">W3Shool CSSå¤–è¾¹è·åˆå¹¶</a>äº†è§£è¿™ä¸ªåŸºæœ¬çŸ¥è¯†.</p>
<p>å®é™…å·¥ä½œä¸­, å‚ç›´å¤–è¾¹è·åˆå¹¶é—®é¢˜å¸¸è§äºç¬¬ä¸€ä¸ªå­å…ƒç´ çš„margin-topä¼šé¡¶å¼€çˆ¶å…ƒç´ ä¸çˆ¶å…ƒç´ ç›¸é‚»å…ƒç´ çš„é—´è·, è€Œä¸”åªåœ¨æ ‡å‡†æµè§ˆå™¨ä¸‹(FirfFoxã€Chromeã€Operaã€Sarfi)äº§ç”Ÿé—®é¢˜, IEä¸‹åè€Œè¡¨ç°è‰¯å¥½.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></div><div class="line">  <span class="selector-class">.outer-box</span>&#123;</div><div class="line">  	<span class="attribute">margin-top</span>:<span class="number">15px</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="selector-class">.inner-box</span>&#123;</div><div class="line">  	<span class="attribute">margin-top</span>:<span class="number">30px</span>;</div><div class="line">  &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"outer-box"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner-box"</span>&gt;</span>1234567890<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>æ‰“å¼€æ§åˆ¶å°, ä½ ä¼šå‘ç°å†…éƒ¨divè·ç¦»é¡¶éƒ¨çš„è·ç¦»æ˜¯30px, è€Œä¸æ˜¯45px, è¿™æ˜¯å› ä¸ºå†…éƒ¨divä¸å¤–éƒ¨divçš„margin-topå±æ€§åšäº†åˆå¹¶, å–ä¸¤è€…ä¸­çš„æœ€å¤§å€¼, å³ 30px.</p>
<p>å¦‚æœæŒ‰ç…§CSSè§„èŒƒ, IEçš„â€œè‰¯å¥½è¡¨ç°â€å…¶å®æ˜¯ä¸€ä¸ªé”™è¯¯çš„è¡¨ç°, å› ä¸ºIEçš„hasLayoutæ¸²æŸ“å¯¼è‡´äº†è¿™ä¸ªâ€œè¡¨ç°è‰¯å¥½â€çš„å¤–è§‚. è€Œå…¶ä»–æ ‡å‡†æµè§ˆå™¨åˆ™ä¼šè¡¨ç°å‡ºâ€œæœ‰é—®é¢˜â€çš„å¤–è§‚. å¥½äº†, å¦‚æœä½ è¯»è¿‡äº†ä¸Šé¢W3Shcoolçš„CSSå¤–è¾¹è·åˆå¹¶çš„æ–‡ç« å, å°±å¾ˆå®¹æ˜“è®¨è®ºè¿™ä¸ªé—®é¢˜äº†. è¿™ä¸ªé—®é¢˜å‘ç”Ÿçš„åŸå› æ˜¯<strong>æ ¹æ®è§„èŒƒ, ä¸€ä¸ªç›’å­å¦‚æœæ²¡æœ‰ä¸Šè¡¥ç™½(padding-top)å’Œä¸Šè¾¹æ¡†(border-top), é‚£ä¹ˆè¿™ä¸ªç›’å­çš„ä¸Šè¾¹è·ä¼šå’Œå…¶å†…éƒ¨æ–‡æ¡£æµä¸­çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ çš„ä¸Šè¾¹è·é‡å </strong>.</p>
<p>åŸºäºæ­¤, è¯¥é—®é¢˜ä¾¿å¾ˆå¥½è§£å†³äº†, ç»™å¤–éƒ¨divè®¾ç½®ä¸€ä¸ªé€æ˜çš„1åƒç´ çš„border-topå³å¯.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.outer-box</span>&#123;</div><div class="line">  <span class="attribute">margin-top</span>:<span class="number">15px</span>;</div><div class="line">  <span class="attribute">border-top</span>:<span class="number">1px</span> solid transparent;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="marginæ˜¯å¦å¯¹å†…è”å…ƒç´ ç”Ÿæ•ˆ"><a href="#marginæ˜¯å¦å¯¹å†…è”å…ƒç´ ç”Ÿæ•ˆ" class="headerlink" title="marginæ˜¯å¦å¯¹å†…è”å…ƒç´ ç”Ÿæ•ˆ?"></a>marginæ˜¯å¦å¯¹å†…è”å…ƒç´ ç”Ÿæ•ˆ?</h3><p>marginä¹Ÿèƒ½ç”¨äºå†…è”å…ƒç´ , è¿™æ˜¯è§„èŒƒæ‰€å…è®¸çš„, ä½†æ˜¯margin-topå’Œmargin-bottomå¯¹å†…è”å…ƒç´ ï¼ˆå¯¹è¡Œï¼‰çš„é«˜åº¦æ²¡æœ‰å½±å“, å¹¶ä¸”ç”±äºè¾¹ç•Œæ•ˆæœ(marginæ•ˆæœ)æ˜¯é€æ˜çš„, ä»–ä¹Ÿæ²¡æœ‰ä»»ä½•çš„è§†è§‰å½±å“.</p>
<p>è¿™æ˜¯å› ä¸ºè¾¹ç•Œåº”ç”¨äºå†…è”å…ƒç´ æ—¶ä¸æ”¹å˜å…ƒç´ çš„è¡Œé«˜åº¦ï¼Œå¦‚æœä½ è¦æ”¹å˜å†…è”å…ƒç´ çš„è¡Œé«˜å³ç±»ä¼¼æ–‡æœ¬çš„è¡Œé—´è·, é‚£ä¹ˆä½ åªèƒ½ä½¿ç”¨è¿™ä¸‰ä¸ªå±æ€§: line-height, fong-size, vertical-align. è¯·è®°ä½, è¿™ä¸ªå½±å“å†…è”å…ƒç´ é«˜åº¦çš„æ˜¯line-heightè€Œä¸æ˜¯height, å› ä¸ºå†…è”å…ƒç´ æ˜¯ä¸€è¡Œè¡Œçš„, å®šä¸€ä¸ªheightçš„è¯, é‚£è¿™åˆ°åº•æ˜¯æ•´æ®µinlineå…ƒç´ çš„é«˜å‘¢? è¿˜æ˜¯inlineå…ƒç´ ä¸€è¡Œçš„é«˜å‘¢? è¿™éƒ½è¯´ä¸å‡†, æ‰€ä»¥ç»Ÿä¸€éƒ½ç»™æ¯è¡Œå®šä¸€ä¸ªé«˜, åªèƒ½æ˜¯line-heightäº†.</p>
<p><strong>margin-top/margin-bottomå¯¹å†…è”å…ƒç´ æ²¡æœ‰å®é™…æ•ˆæœ, ä¸è¿‡margin-left/margin-rightè¿˜æ˜¯èƒ½å¤Ÿå¯¹å†…è”å…ƒç´ äº§ç”Ÿå½±å“çš„</strong>. åº”ç”¨margin:10px 20px 30px 40px;, å·¦è¾¹è¿™ä¸ªcsså¦‚æœå†™åœ¨inlineå…ƒç´ ä¸Š, ä»–çš„æ•ˆæœå¤§è‡´æ˜¯, ä¸Šä¸‹æ— æ•ˆæœ, å·¦è¾¹ç¦»ä»–ç›¸é‚»å…ƒç´ æˆ–è€…æ–‡æœ¬è·ç¦»ä¸º40px, å³è¾¹ç¦»ä»–ç›¸é‚»å…ƒç´ æˆ–è€…æ–‡æœ¬è·ç¦»ä¸º20px.</p>
<h3 id="æœ‰å…³marginçš„å¸¸è§bug"><a href="#æœ‰å…³marginçš„å¸¸è§bug" class="headerlink" title="æœ‰å…³marginçš„å¸¸è§bug"></a>æœ‰å…³marginçš„å¸¸è§bug</h3><p>ä¸‹é¢ç½—åˆ—ä¸€ä¸‹å¸¸è§çš„æœ‰å…³marginçš„bug, å¯èƒ½ä¸å…¨, éå¸¸æ¬¢è¿äº¤æµæ¢è®¨, è¯·åœ¨<a href="#respond">å›å¤</a>ä¸­è¡¥å…….</p>
<h4 id="IE6ä¸­æµ®åŠ¨å…ƒç´ 3pxé—´éš”Bug"><a href="#IE6ä¸­æµ®åŠ¨å…ƒç´ 3pxé—´éš”Bug" class="headerlink" title="IE6ä¸­æµ®åŠ¨å…ƒç´ 3pxé—´éš”Bug"></a>IE6ä¸­æµ®åŠ¨å…ƒç´ 3pxé—´éš”Bug</h4><p>å‘ç”Ÿåœºæ™¯: å‘ç”Ÿåœ¨ä¸€ä¸ªå…ƒç´ æµ®åŠ¨ï¼Œç„¶åä¸€ä¸ªä¸æµ®åŠ¨çš„å…ƒç´ è‡ªç„¶ä¸Šæµ®ä¸ä¹‹é è¿‘ä¼šå‡ºç°çš„3pxçš„bug.<br>è§£å†³æ–¹æ³•: å³è¾¹å…ƒç´ ä¹Ÿä¸€èµ·æµ®åŠ¨; æˆ–è€…ä¸ºå³è¾¹å…ƒç´ æ·»åŠ IE6 Hack â€œ_margin-left:-3px;â€ ä»è€Œæ¶ˆé™¤3pxé—´è·.<br>åŸå› åˆ†æï¼šIE6æµè§ˆå™¨ç¼ºé™·Bug.</p>
<h4 id="inline-blockå…ƒç´ ä¹‹é—´ç©ºç™½Bug"><a href="#inline-blockå…ƒç´ ä¹‹é—´ç©ºç™½Bug" class="headerlink" title="inline-blockå…ƒç´ ä¹‹é—´ç©ºç™½Bug"></a>inline-blockå…ƒç´ ä¹‹é—´ç©ºç™½Bug</h4><p>å‘ç”Ÿåœºæ™¯: IE8+ã€Chromeã€Firefoxã€Safariç­‰æµè§ˆå™¨ä¸‹çš„æ•ˆæœ, ä¸¤ä¸ªinline-blockçš„å…ƒç´ ä¹‹é—´ä¼šå­˜åœ¨ä¸€å®šçš„ç©ºç™½é—´è·, ç©ºç™½é—´è·çš„å®½åº¦ä¸çˆ¶å…ƒç´ çš„font-sizeå¤§å°æœ‰å…³.</p>
<p>è§£å†³æ–¹æ³•: å¯ä»¥ä¸ºinline-blockå…ƒç´ è®¾ç½®ä¸ºè´Ÿçš„margin-left; æˆ–çˆ¶å…ƒç´ font-sizeè®¾ç½®ä¸º0, å­å…ƒç´ å†é‡æ–°è®¾ç½®å›æ¥, å¦‚éœ€å…¼å®¹æ‰€æœ‰æµè§ˆå™¨, è¯·å‚è€ƒ <a href="http://louiszhai.github.io/2016/03/27/css-inline-block/">inline-blockç©ºç™½é—´è·è§£å†³æ–¹æ¡ˆæ¢è®¨</a>.</p>
<p>åŸå› åˆ†æ: HTML ä¸­çš„æ¢è¡Œç¬¦ã€ç©ºæ ¼ç¬¦ã€åˆ¶è¡¨ç¬¦ç­‰åˆå¹¶ä¸ºç©ºç™½ç¬¦, å­—ä½“å¤§å°ä¸ä¸º 0 çš„æƒ…å†µä¸‹, ç©ºç™½ç¬¦è‡ªç„¶å æ®ä¸€å®šçš„å®½åº¦, å› æ­¤äº§ç”Ÿäº†å…ƒç´ é—´çš„ç©ºéš™.</p>
<h4 id="IE6-7è´Ÿmarginéšè—Bug"><a href="#IE6-7è´Ÿmarginéšè—Bug" class="headerlink" title="IE6/7è´Ÿmarginéšè—Bug"></a>IE6/7è´Ÿmarginéšè—Bug</h4><p>å‘ç”Ÿåœºæ™¯: å½“ç»™ä¸€ä¸ªæœ‰hasLayoutçš„çˆ¶å…ƒç´ å†…çš„éhasLayoutå…ƒç´ è®¾ç½®è´Ÿmarginæ—¶, è¶…å‡ºçˆ¶å…ƒç´ éƒ¨åˆ†ä¸å¯è§.<br>è§£å†³æ–¹æ³•: å»æ‰çˆ¶å…ƒç´ çš„hasLayout; æˆ–è€…èµ‹hasLayoutç»™å­å…ƒç´ ,å¹¶æ·»åŠ position:relative;<br>åŸç†åˆ†æ: IE6/7ç‹¬æœ‰çš„hasLayoutäº§ç”Ÿé—®é¢˜.</p>
<h4 id="IE6-7ä¸‹ul-olæ ‡è®°æ¶ˆå¤±bug"><a href="#IE6-7ä¸‹ul-olæ ‡è®°æ¶ˆå¤±bug" class="headerlink" title="IE6/7ä¸‹ul/olæ ‡è®°æ¶ˆå¤±bug"></a>IE6/7ä¸‹ul/olæ ‡è®°æ¶ˆå¤±bug</h4><p>å‘ç”Ÿåœºåˆ: å½“ul/olè§¦å‘äº†haslayoutå¹¶ä¸”æ˜¯åœ¨ul/olä¸Šå†™margin-left, å‰é¢é»˜è®¤çš„ul/olæ ‡è®°ä¼šæ¶ˆå¤±.<br>è§£å†³æ–¹æ³•: ç»™liè®¾ç½®margin-left, è€Œä¸æ˜¯ç»™ul/olè®¾ç½®margin-left.<br>åŸå› åˆ†æï¼šIE6/7æµè§ˆå™¨Bug.</p>
<h4 id="IE6-7ä¸‹marginä¸absoluteå…ƒç´ é‡å bug"><a href="#IE6-7ä¸‹marginä¸absoluteå…ƒç´ é‡å bug" class="headerlink" title="IE6/7ä¸‹marginä¸absoluteå…ƒç´ é‡å bug"></a>IE6/7ä¸‹marginä¸absoluteå…ƒç´ é‡å bug</h4><p>å‘ç”Ÿåœºæ™¯: åŒæ è‡ªé€‚åº”å¸ƒå±€ä¸­, å·¦ä¾§å…ƒç´ absoluteç»å¯¹å®šä½, å³ä¾§çš„marginæ’‘å¼€è·ç¦»å®šä½. åœ¨IE6/7ä¸‹å·¦ä¾§åº”ç”¨äº†absoluteå±æ€§çš„å—çº§å…ƒç´ ä¸å³è¾¹çš„è‡ªé€‚åº”çš„æ–‡å­—å†…å®¹é‡å .<br>è§£å†³æ–¹æ³•: æŠŠå·¦ä¾§å—çº§å…ƒç´ æ›´æ”¹ä¸ºå†…è”å…ƒç´ , æ¯”å¦‚æŠŠdivæ›´æ¢ä¸ºspan.<br>åŸå› åˆ†æ: è¿™æ˜¯ç”±äºIE6-7æµè§ˆå™¨å°†inlineæ°´å¹³æ ‡ç­¾å…ƒç´ å’Œblockæ°´å¹³çš„æ ‡ç­¾å…ƒç´ æ²¡æœ‰åŠ ä»¥åŒºåˆ†ä¸€è§†åŒä»æ¸²æŸ“äº†. å±äºIE6-7æµè§ˆå™¨æ¸²æŸ“Bug.</p>
<h4 id="IE6-7-8ä¸‹auto-marginå±…ä¸­bug"><a href="#IE6-7-8ä¸‹auto-marginå±…ä¸­bug" class="headerlink" title="IE6/7/8ä¸‹auto marginå±…ä¸­bug"></a>IE6/7/8ä¸‹auto marginå±…ä¸­bug</h4><p>å‘ç”Ÿåœºæ™¯: ç»™blockå…ƒç´ è®¾ç½®margin autoæ— æ³•å±…ä¸­<br>è§£å†³æ–¹æ³•: å‡ºç°è¿™ç§bugçš„åŸå› é€šå¸¸æ˜¯æ²¡æœ‰Doctype, ç„¶åè§¦å‘äº†ieçš„quirks mode, åŠ ä¸ŠDoctypeå£°æ˜å°±å¯ä»¥äº†. åœ¨ã€Šæ‰“è´¥IEçš„è‘µèŠ±å®å…¸ã€‹é‡Œç»™å‡ºçš„æ–¹æ³•æ˜¯ç»™blockå…ƒç´ æ·»åŠ ä¸€ä¸ªwidthèƒ½å¤Ÿè§£å†³, ä½†æ®æµ‹è¯•, åŠ withæ­¤ç§æ–¹æ³•æ˜¯æ— æ•ˆçš„, å¦‚æœæ²¡æœ‰Doctypeå³ä½¿ç»™å…ƒç´ æ·»åŠ widthä¹Ÿæ— æ³•è®©blockå…ƒç´ å±…ä¸­.<br>åŸå› åˆ†æ: ç¼ºå°‘Doctypeå£°æ˜.</p>
<h4 id="IE8ä¸‹input-button-submit-è®¾ç½®margin-0-autoæ— æ³•å±…ä¸­"><a href="#IE8ä¸‹input-button-submit-è®¾ç½®margin-0-autoæ— æ³•å±…ä¸­" class="headerlink" title="IE8ä¸‹input[button | submit] è®¾ç½®margin:0 autoæ— æ³•å±…ä¸­"></a>IE8ä¸‹input[button | submit] è®¾ç½®margin:0 autoæ— æ³•å±…ä¸­</h4><p>å‘ç”Ÿåœºæ™¯: ie8ä¸‹, å¦‚æœç»™åƒbuttonè¿™æ ·çš„æ ‡ç­¾ï¼ˆå¦‚button input[type=â€buttonâ€] input[type=â€submitâ€]ï¼‰è®¾ç½®{ display: block; margin:0 auto; }å¦‚æœä¸è®¾ç½®å®½åº¦çš„è¯æ— æ³•å±…ä¸­.<br>è§£å†³æ–¹æ³•: å¯ä»¥ç»™ä¸ºinputåŠ ä¸Šå®½åº¦.<br>åŸå› åˆ†æ: IE8æµè§ˆå™¨Bug.</p>
<h4 id="IE8ç™¾åˆ†æ¯”paddingå‚ç›´margin-bug"><a href="#IE8ç™¾åˆ†æ¯”paddingå‚ç›´margin-bug" class="headerlink" title="IE8ç™¾åˆ†æ¯”paddingå‚ç›´margin bug"></a>IE8ç™¾åˆ†æ¯”paddingå‚ç›´margin bug</h4><p>å‘ç”Ÿåœºæ™¯: å½“çˆ¶å…ƒç´ è®¾ç½®äº†ç™¾åˆ†æ¯”çš„padding, å­å…ƒç´ æœ‰å‚ç›´çš„marginçš„æ—¶å€™, å°±å¥½åƒçˆ¶å…ƒç´ è¢«è®¾ç½®äº†marginä¸€æ ·.<br>è§£å†³æ–¹æ³•: ç»™çˆ¶å…ƒç´ åŠ ä¸€ä¸ªoverflow:hidden/autoã€‚<br>åŸå› åˆ†æ: IE8æµè§ˆå™¨Bug.</p>
<hr>
<p>æœ¬æ–‡å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/03/23/css-margin/">http://louiszhai.github.io/2016/03/23/css-margin/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="http://www.hicss.net/do-not-tell-me-you-understand-margin/" target="_blank" rel="external">ä¸è¦å‘Šè¯‰æˆ‘ä½ æ‡‚margin</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      css margin margin-left margin-top margin-right margin-bottom
    
    </summary>
    
    
      <category term="css" scheme="http://louiszhai.github.io/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>16ç§æ–¹æ³•å®ç°æ°´å¹³å±…ä¸­å‚ç›´å±…ä¸­</title>
    <link href="http://louiszhai.github.io/2016/03/12/css-center/"/>
    <id>http://louiszhai.github.io/2016/03/12/css-center/</id>
    <published>2016-03-12T11:03:04.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>ç†Ÿæ‚‰æ°´å¹³å±…ä¸­å’Œå‚ç›´å±…ä¸­çš„æ–¹æ³•, ä¸ä¸ºåˆ«çš„, å°±ä¸ºç”¨çš„æ—¶å€™èƒ½å¤Ÿä¿¡æ‰‹æ‹ˆæ¥. ä¸‹é¢ç›´æ¥æ­¥å…¥æ­£é¢˜.</p>
<a id="more"></a>
<h3 id="æ°´å¹³å±…ä¸­"><a href="#æ°´å¹³å±…ä¸­" class="headerlink" title="æ°´å¹³å±…ä¸­"></a>æ°´å¹³å±…ä¸­</h3><p>1) è‹¥æ˜¯è¡Œå†…å…ƒç´ , ç»™å…¶çˆ¶å…ƒç´ è®¾ç½® text-align:center,å³å¯å®ç°è¡Œå†…å…ƒç´ æ°´å¹³å±…ä¸­.</p>
<p>2) è‹¥æ˜¯å—çº§å…ƒç´ , è¯¥å…ƒç´ è®¾ç½® margin:0 autoå³å¯.</p>
<p>3) è‹¥å­å…ƒç´ åŒ…å« float:left å±æ€§, ä¸ºäº†è®©å­å…ƒç´ æ°´å¹³å±…ä¸­, åˆ™å¯è®©çˆ¶å…ƒç´ å®½åº¦è®¾ç½®ä¸ºfit-content,å¹¶ä¸”é…åˆmargin, ä½œå¦‚ä¸‹è®¾ç½®:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.parent</span>&#123;</div><div class="line">  	<span class="attribute">width</span>: -moz-fit-content;</div><div class="line">	<span class="attribute">width</span>: -webkit-fit-content;</div><div class="line">	<span class="attribute">width</span>:fit-content;</div><div class="line">	<span class="attribute">margin</span>:<span class="number">0</span> auto;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>fit-contentæ˜¯CSS3ä¸­ç»™widthå±æ€§æ–°åŠ çš„ä¸€ä¸ªå±æ€§å€¼,å®ƒé…åˆmarginå¯ä»¥è½»æ¾å®ç°æ°´å¹³å±…ä¸­, ç›®å‰åªæ”¯æŒChrome å’Œ Firefoxæµè§ˆå™¨.</p>
<p>4) ä½¿ç”¨flexå¸ƒå±€, å¯ä»¥è½»æ¾çš„å®ç°æ°´å¹³å±…ä¸­, å­å…ƒç´ è®¾ç½®å¦‚ä¸‹:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.son</span>&#123;</div><div class="line">	<span class="attribute">display</span>: flex;</div><div class="line">	<span class="attribute">justify-content</span>: center;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>5) ä½¿ç”¨css3 ç›’æ¨¡å‹, çˆ¶å…ƒç´ display: box;box-pack: center;å¦‚ä¸‹è®¾ç½®:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.parent</span> &#123;</div><div class="line">	<span class="attribute">display</span>: -webkit-box;</div><div class="line">	<span class="attribute">-webkit-box-orient</span>: horizontal;</div><div class="line">	<span class="attribute">-webkit-box-pack</span>: center;</div><div class="line">	<span class="attribute">display</span>: -moz-box;</div><div class="line">	<span class="attribute">-moz-box-orient</span>: horizontal;</div><div class="line">	<span class="attribute">-moz-box-pack</span>: center;</div><div class="line">	<span class="attribute">display</span>: -o-box;</div><div class="line">  	<span class="attribute">-o-box-orient</span>: horizontal;</div><div class="line">  	<span class="attribute">-o-box-pack</span>: center;</div><div class="line">  	<span class="attribute">display</span>: -ms-box;</div><div class="line">  	<span class="attribute">-ms-box-orient</span>: horizontal;</div><div class="line">  	<span class="attribute">-ms-box-pack</span>: center;</div><div class="line">  	<span class="attribute">display</span>: box;</div><div class="line">  	<span class="attribute">box-orient</span>: horizontal;</div><div class="line">  	<span class="attribute">box-pack</span>: center;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>6) ä½¿ç”¨CSS3ä¸­æ–°å¢çš„transformå±æ€§, å­å…ƒç´ è®¾ç½®å¦‚ä¸‹:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.son</span>&#123;</div><div class="line">	<span class="attribute">position</span>:absolute;</div><div class="line">  	<span class="attribute">left</span>:<span class="number">50%</span>;</div><div class="line">  	<span class="attribute">transform</span>:<span class="built_in">translate</span>(-50%,0);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>7) ä½¿ç”¨ç»å¯¹å®šä½æ–¹å¼, ä»¥åŠè´Ÿå€¼çš„margin-left, å­å…ƒç´ è®¾ç½®å¦‚ä¸‹:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.son</span>&#123;</div><div class="line">	<span class="attribute">position</span>:absolute;</div><div class="line">	<span class="attribute">width</span>:å›ºå®š;</div><div class="line">    <span class="attribute">left</span>:<span class="number">50%</span>;</div><div class="line">    <span class="attribute">margin-left</span>:-<span class="number">0.5</span>å®½åº¦;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>8) ä½¿ç”¨ç»å¯¹å®šä½æ–¹å¼, ä»¥åŠleft:0;right:0;margin:0 auto; å­å…ƒç´ è®¾ç½®å¦‚ä¸‹:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.son</span>&#123;</div><div class="line">	<span class="attribute">position</span>:absolute;</div><div class="line">	<span class="attribute">width</span>:å›ºå®š;</div><div class="line">	<span class="attribute">left</span>:<span class="number">0</span>;</div><div class="line">	<span class="attribute">right</span>:<span class="number">0</span>;</div><div class="line">	<span class="attribute">margin</span>:<span class="number">0</span> auto;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å‚ç›´å±…ä¸­"><a href="#å‚ç›´å±…ä¸­" class="headerlink" title="å‚ç›´å±…ä¸­"></a>å‚ç›´å±…ä¸­</h3><h4 id="å•è¡Œæ–‡æœ¬"><a href="#å•è¡Œæ–‡æœ¬" class="headerlink" title="å•è¡Œæ–‡æœ¬"></a>å•è¡Œæ–‡æœ¬</h4><p>1) è‹¥å…ƒç´ æ˜¯å•è¡Œæ–‡æœ¬, åˆ™å¯è®¾ç½® line-height ç­‰äºçˆ¶å…ƒç´ é«˜åº¦</p>
<h4 id="è¡Œå†…å—çº§å…ƒç´ "><a href="#è¡Œå†…å—çº§å…ƒç´ " class="headerlink" title="è¡Œå†…å—çº§å…ƒç´ "></a>è¡Œå†…å—çº§å…ƒç´ </h4><p>2) è‹¥å…ƒç´ æ˜¯è¡Œå†…å—çº§å…ƒç´ , åŸºæœ¬æ€æƒ³æ˜¯ä½¿ç”¨display: inline-block, vertical-align: middleå’Œä¸€ä¸ªä¼ªå…ƒç´ è®©å†…å®¹å—å¤„äºå®¹å™¨ä¸­å¤®.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.parent</span><span class="selector-pseudo">::after</span>, <span class="selector-class">.son</span>&#123;</div><div class="line">	<span class="attribute">display</span>:inline-block;</div><div class="line">	<span class="attribute">vertical-align</span>:middle;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.parent</span><span class="selector-pseudo">::after</span>&#123;</div><div class="line">	<span class="attribute">content</span>:<span class="string">''</span>;</div><div class="line">	<span class="attribute">height</span>:<span class="number">100%</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ˜¯ä¸€ç§å¾ˆæµè¡Œçš„æ–¹æ³•, ä¹Ÿé€‚åº”IE7.</p>
<h4 id="å…ƒç´ é«˜åº¦ä¸å®š"><a href="#å…ƒç´ é«˜åº¦ä¸å®š" class="headerlink" title="å…ƒç´ é«˜åº¦ä¸å®š"></a>å…ƒç´ é«˜åº¦ä¸å®š</h4><p>3) å¯ç”¨ <strong>vertical-align</strong> å±æ€§, è€Œvertical-alignåªæœ‰åœ¨çˆ¶å±‚ä¸º td æˆ–è€… th æ—¶, æ‰ä¼šç”Ÿæ•ˆ, å¯¹äºå…¶ä»–å—çº§å…ƒç´ , ä¾‹å¦‚ divã€p ç­‰, é»˜è®¤æƒ…å†µæ˜¯ä¸æ”¯æŒçš„. ä¸ºäº†ä½¿ç”¨vertical-align, æˆ‘ä»¬éœ€è¦è®¾ç½®çˆ¶å…ƒç´ display:table, å­å…ƒç´  display:table-cell;vertical-align:middle;</p>
<p><strong>ä¼˜ç‚¹</strong></p>
<p>å…ƒç´ é«˜åº¦å¯ä»¥åŠ¨æ€æ”¹å˜, ä¸éœ€å†CSSä¸­å®šä¹‰, å¦‚æœçˆ¶å…ƒç´ æ²¡æœ‰è¶³å¤Ÿç©ºé—´æ—¶, è¯¥å…ƒç´ å†…å®¹ä¹Ÿä¸ä¼šè¢«æˆªæ–­.</p>
<p><strong>ç¼ºç‚¹</strong></p>
<p>IE6~7, ç”šè‡³IE8 betaä¸­æ— æ•ˆ.</p>
<p>4) å¯ç”¨ <strong>Flex</strong>, è¿™æ˜¯CSSå¸ƒå±€æœªæ¥çš„è¶‹åŠ¿. Flexboxæ˜¯CSS3æ–°å¢å±æ€§, è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†è§£å†³åƒå‚ç›´å±…ä¸­è¿™æ ·çš„å¸¸è§å¸ƒå±€é—®é¢˜. ç›¸å…³çš„æ–‡ç« å¦‚ã€Š<a href="http://coding.smashingmagazine.com/2013/05/22/centering-elements-with-flexbox/" target="_blank" rel="external">Centering Elements with Flexbox</a>ã€‹</p>
<p>çˆ¶å…ƒç´ åšå¦‚ä¸‹è®¾ç½®å³å¯ä¿è¯å­å…ƒç´ å‚ç›´å±…ä¸­:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.parent</span> &#123;</div><div class="line">  <span class="attribute">display</span>: flex;</div><div class="line">  <span class="attribute">align-items</span>: center;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ä¼˜ç‚¹</strong></p>
<ul>
<li>å†…å®¹å—çš„å®½é«˜ä»»æ„, ä¼˜é›…çš„æº¢å‡º.</li>
</ul>
<ul>
<li>å¯ç”¨äºæ›´å¤æ‚é«˜çº§çš„å¸ƒå±€æŠ€æœ¯ä¸­.</li>
</ul>
<p><strong>ç¼ºç‚¹</strong></p>
<ul>
<li>IE8/IE9ä¸æ”¯æŒ</li>
<li>éœ€è¦æµè§ˆå™¨å‚å•†å‰ç¼€</li>
<li>æ¸²æŸ“ä¸Šå¯èƒ½ä¼šæœ‰ä¸€äº›é—®é¢˜</li>
</ul>
<p>5) ä½¿ç”¨CSS3ç›’æ¨¡å‹</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.parent</span> &#123;</div><div class="line">  	<span class="attribute">display</span>: box;</div><div class="line">  	<span class="attribute">box-orient</span>: vertical;</div><div class="line">  	<span class="attribute">box-pack</span>: center;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ä¼˜ç‚¹</strong></p>
<p>å®ç°ç®€å•, æ‰©å±•æ€§å¼º</p>
<p><strong>ç¼ºç‚¹</strong></p>
<p>å…¼å®¹æ€§å·®, ä¸æ”¯æŒIE</p>
<p>6) å¯ç”¨ <strong>transform</strong> , è®¾ç½®çˆ¶å…ƒç´ ç›¸å¯¹å®šä½(position:relative), å­å…ƒç´ å¦‚ä¸‹cssæ ·å¼:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.son</span>&#123;</div><div class="line">	<span class="attribute">position</span>:absolute;</div><div class="line">	<span class="attribute">top</span>:<span class="number">50%</span>;</div><div class="line">	<span class="attribute">-webkit-transform</span>: <span class="built_in">translate</span>(-50%,-50%);  </div><div class="line">	<span class="attribute">-ms-transform</span>: <span class="built_in">translate</span>(-50%,-50%);</div><div class="line">	<span class="attribute">transform</span>: <span class="built_in">translate</span>(-50%,-50%);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ä¼˜ç‚¹</strong></p>
<p>ä»£ç é‡å°‘</p>
<p><strong>ç¼ºç‚¹</strong></p>
<p>IE8ä¸æ”¯æŒ, å±æ€§éœ€è¦è¿½åŠ æµè§ˆå™¨å‚å•†å‰ç¼€, å¯èƒ½å¹²æ‰°å…¶ä»– transform æ•ˆæœ, æŸäº›æƒ…å½¢ä¸‹ä¼šå‡ºç°æ–‡æœ¬æˆ–å…ƒç´ è¾¹ç•Œæ¸²æŸ“æ¨¡ç³Šçš„ç°è±¡.</p>
<h4 id="å…ƒç´ é«˜åº¦å›ºå®š"><a href="#å…ƒç´ é«˜åº¦å›ºå®š" class="headerlink" title="å…ƒç´ é«˜åº¦å›ºå®š"></a>å…ƒç´ é«˜åº¦å›ºå®š</h4><p>7) è®¾ç½®çˆ¶å…ƒç´ ç›¸å¯¹å®šä½(position:relative), å­å…ƒç´ å¦‚ä¸‹cssæ ·å¼:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.son</span>&#123;</div><div class="line">	<span class="attribute">position</span>:absolute;</div><div class="line">	<span class="attribute">top</span>:<span class="number">50%</span>;</div><div class="line">	<span class="attribute">height</span>:å›ºå®š;</div><div class="line">	<span class="attribute">margin-top</span>:-<span class="number">0.5</span>é«˜åº¦;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ä¼˜ç‚¹</strong></p>
<p>é€‚ç”¨äºæ‰€æœ‰æµè§ˆå™¨.</p>
<p><strong>ç¼ºç‚¹</strong></p>
<p>çˆ¶å…ƒç´ ç©ºé—´ä¸å¤Ÿæ—¶, å­å…ƒç´ å¯èƒ½ä¸å¯è§(å½“æµè§ˆå™¨çª—å£ç¼©å°æ—¶,æ»šåŠ¨æ¡ä¸å‡ºç°æ—¶).å¦‚æœå­å…ƒç´ è®¾ç½®äº†overflow:auto, åˆ™é«˜åº¦ä¸å¤Ÿæ—¶, ä¼šå‡ºç°æ»šåŠ¨æ¡.</p>
<p>8) è®¾ç½®çˆ¶å…ƒç´ ç›¸å¯¹å®šä½(position:relative), å­å…ƒç´ å¦‚ä¸‹cssæ ·å¼:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.son</span>&#123;</div><div class="line">	<span class="attribute">position</span>:absolute;</div><div class="line">	<span class="attribute">height</span>:å›ºå®š;</div><div class="line">	<span class="attribute">top</span>:<span class="number">0</span>;</div><div class="line">	<span class="attribute">bottom</span>:<span class="number">0</span>;</div><div class="line">	<span class="attribute">margin</span>:auto <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ä¼˜ç‚¹</strong></p>
<p>ç®€å•</p>
<p><strong>ç¼ºç‚¹</strong></p>
<p>æ²¡æœ‰è¶³å¤Ÿç©ºé—´æ—¶, å­å…ƒç´ ä¼šè¢«æˆªæ–­, ä½†ä¸ä¼šæœ‰æ»šåŠ¨æ¡.</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æ°´å¹³å±…ä¸­è¾ƒä¸ºç®€å•, å…±æä¾›äº†8ç§æ–¹æ³•, ä¸€èˆ¬æƒ…å†µä¸‹ text-align:center,marin:0 auto; è¶³çŸ£</p>
<ul>
<li>â‘  text-align:center;</li>
</ul>
<ul>
<li>â‘¡ margin:0 auto;</li>
<li>â‘¢ width:fit-content;</li>
<li>â‘£ flex</li>
<li>â‘¤ ç›’æ¨¡å‹</li>
<li>â‘¥ transform</li>
<li>â‘¦ â‘§ ä¸¤ç§ä¸åŒçš„ç»å¯¹å®šä½æ–¹æ³•</li>
</ul>
<p>å‚ç›´å±…ä¸­, å…±æä¾›äº†8ç§æ–¹æ³•.</p>
<ul>
<li>â‘  å•è¡Œæ–‡æœ¬, line-height</li>
<li>â‘¡ è¡Œå†…å—çº§å…ƒç´ , ä½¿ç”¨ display: inline-block, vertical-align: middle; åŠ ä¸Šä¼ªå…ƒç´ è¾…åŠ©å®ç°</li>
<li>â‘¢ vertical-align</li>
<li>â‘£ flex</li>
<li>â‘¤ ç›’æ¨¡å‹</li>
<li>â‘¥ transform</li>
<li>â‘¦ â‘§ ä¸¤ç§ä¸åŒçš„ç»å¯¹å®šä½æ–¹æ³•</li>
</ul>
<p>æˆ‘ä»¬å‘ç°, flex, ç›’æ¨¡å‹, transform, ç»å¯¹å®šä½, è¿™å‡ ç§æ–¹æ³•åŒæ—¶é€‚ç”¨äºæ°´å¹³å±…ä¸­å’Œå‚ç›´å±…ä¸­.</p>
<p>å¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©.</p>
<hr>
<p>æœ¬é—®å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/03/12/css-center/">http://louiszhai.github.io/2016/03/12/css-center/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="http://blog.csdn.net/freshlover/article/details/11579669" target="_blank" rel="external">ç›˜ç‚¹8ç§CSSå®ç°å‚ç›´å±…ä¸­æ°´å¹³å±…ä¸­çš„ç»å¯¹å®šä½å±…ä¸­æŠ€æœ¯ - freshloverçš„ä¸“æ  - åšå®¢é¢‘é“ - CSDN.NET</a></li>
<li><a href="https://www.smashingmagazine.com/2013/05/centering-elements-with-flexbox/" target="_blank" rel="external">Designing CSS Layouts With Flexbox Is As Easy As Pie â€“ Smashing Magazine</a></li>
<li><a href="http://www.w3cplus.com/css/elements-horizontally-center-with-css.html" target="_blank" rel="external">å…­ç§å®ç°å…ƒç´ æ°´å¹³å±…ä¸­<em>æ°´å¹³å±…ä¸­, å‚ç›´å±…ä¸­ æ•™ç¨‹\</em>å¤§æ¼ </a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      css æ°´å¹³å±…ä¸­ å‚ç›´å±…ä¸­ fit-content flex translate line-height vertical-align
    
    </summary>
    
    
      <category term="CSS" scheme="http://louiszhai.github.io/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>floatæ·±å…¥åˆ†æ</title>
    <link href="http://louiszhai.github.io/2016/03/12/css-float/"/>
    <id>http://louiszhai.github.io/2016/03/12/css-float/</id>
    <published>2016-03-12T09:55:04.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>floatå³æµ®åŠ¨, ä½¿ç”¨float, è¯¥æµ®åŠ¨å…ƒç´ ä¾¿ä¼šè„±ç¦»æ­£å¸¸çš„æ–‡æ¡£æµ, ä½¿å…¶æµ®åŠ¨åˆ°çˆ¶å…ƒç´ çš„è¡Œçš„ä¸€ç«¯(å…ƒç´ å‘å·¦æˆ–å‘å³ç§»åŠ¨, ç›´åˆ°ç¢°åˆ°æµ®åŠ¨å…ƒç´ , æˆ–è€…è¾¾åˆ°çˆ¶å…ƒç´ å†…å®¹çš„è¾¹ç•Œ, ä¸åŒ…æ‹¬padding), å¹¶ä¸”å…¶ä»–å…ƒç´ å°†å¿½ç•¥è¯¥æµ®åŠ¨å…ƒç´ å¹¶å¡«è¡¥å…¶åŸå…ˆçš„ç©ºé—´.</p>
<p>è¿™é‡Œéœ€è¦æ‹æ¸…ä¸€ä¸ªæ¦‚å¿µ, æ‰€è°“æ–‡æ¡£æµæ˜¯ä»€ä¹ˆ?</p>
<p><strong>æ–‡æ¡£æµ</strong>: å…ƒç´ æŒ‰ç…§è‡ªä¸Šåˆ°ä¸‹, è‡ªå·¦åˆ°å³çš„é¡ºåºä¾æ¬¡æ’æ”¾, å³æ–‡æ¡£æµ.</p>
<p>floatç‰¹åˆ«é€‚åˆè¿™ç§å›¾æ–‡æ··æ’, æ–‡å­—ç¯ç»•å›¾ç‰‡çš„æ•ˆæœ, å¸ƒå±€ä¸Šçµæ´»å¤šå˜. ä½†ä¸å¤ªé€‚åˆåŠ¨ç”», å› å…¶å¯èƒ½é€ æˆreflowæ€§èƒ½é—®é¢˜, æ­¤æ—¶å®œç”¨ç»å¯¹å®šä½(position:absolute)æˆ–è€…å›ºå®šå®šä½(position:fixed).</p>
<a id="more"></a>
<h3 id="floatå¯¹å¸ƒå±€çš„å½±å“"><a href="#floatå¯¹å¸ƒå±€çš„å½±å“" class="headerlink" title="floatå¯¹å¸ƒå±€çš„å½±å“"></a>floatå¯¹å¸ƒå±€çš„å½±å“</h3><h4 id="å¯¹è¡Œæ¡†çš„å½±å“"><a href="#å¯¹è¡Œæ¡†çš„å½±å“" class="headerlink" title="å¯¹è¡Œæ¡†çš„å½±å“"></a>å¯¹è¡Œæ¡†çš„å½±å“</h4><p>æµ®åŠ¨å…ƒç´ æ—è¾¹çš„è¡Œæ¡†è¢«ç¼©çŸ­, ä»è€Œç»™æµ®åŠ¨æ¡†ç•™å‡ºç©ºé—´, è¡Œæ¡†å›´ç»•æµ®åŠ¨æ¡†.</p>
<p>å› æ­¤, åˆ›å»ºæµ®åŠ¨æ¡†å¯ä»¥ä½¿æ–‡æœ¬å›´ç»•å›¾åƒ, å¦‚ä¸‹:</p>
<p>float01.gif</p>
<p>float02.gif</p>
<h4 id="å¯¹çˆ¶å…ƒç´ çš„å½±å“"><a href="#å¯¹çˆ¶å…ƒç´ çš„å½±å“" class="headerlink" title="å¯¹çˆ¶å…ƒç´ çš„å½±å“"></a>å¯¹çˆ¶å…ƒç´ çš„å½±å“</h4><p>å…ƒç´ æµ®åŠ¨å, ä¼šè„±ç¦»æ­£å¸¸æ–‡æ¡£æµ, åŸæ–‡æ¡£ä¸­, è¯¥æµ®åŠ¨å…ƒç´ ä¼¼ä¹æ¶ˆå¤±äº†, å› æ­¤å®ƒä¸èƒ½æ’‘å¼€çˆ¶å…ƒç´ , å®¹æ˜“é€ æˆçˆ¶å…ƒç´ çš„å¡Œé™·.</p>
<h4 id="å¯¹å…„å¼Ÿå…ƒç´ çš„å½±å“"><a href="#å¯¹å…„å¼Ÿå…ƒç´ çš„å½±å“" class="headerlink" title="å¯¹å…„å¼Ÿå…ƒç´ çš„å½±å“"></a>å¯¹å…„å¼Ÿå…ƒç´ çš„å½±å“</h4><p>è‹¥å…„å¼Ÿå…ƒç´ æ˜¯ <strong>å—çº§å…ƒç´ </strong>.</p>
<p>ç°ä»£æµè§ˆå™¨åŠIE8+ä¸‹, è¯¥å…„å¼Ÿå…ƒç´ ä¼šå¿½è§†æµ®åŠ¨å…ƒç´ è€Œå æ®å®ƒçš„ä½ç½®, å¹¶ä¸”è¯¥å…„å¼Ÿå…ƒç´ ä¼šå¤„äºæµ®åŠ¨å…ƒç´ çš„ä¸‹å±‚(å¹¶ä¸”æ— æ³•é€šè¿‡z-indexå±æ€§æ”¹å˜ä»–ä»¬çš„å±‚å å…³ç³»), ç„¶è€Œå®ƒçš„å†…å®¹æ–‡å­—å’Œå…¶ä»–è¡Œå†…å…ƒå°†ä¼šç¯ç»•æµ®åŠ¨å…ƒç´ .</p>
<p>å¯¹æ­¤, IE6,7åˆ†åˆ«æœ‰ä¸åŒçš„è¡¨ç°. IE6,7ä¸­, è¯¥å…„å¼Ÿå…ƒç´ ä¼šç´§è·Ÿåœ¨æµ®åŠ¨å…ƒç´ çš„å³ä¾§, å¹¶ä¸”IE6ä¸­ä¼šä¿ç•™3pxçš„ç©ºéš™; IE7ä¸­åˆ™æ²¡æœ‰ç©ºéš™.</p>
<p>è‹¥å…„å¼Ÿå…ƒç´ æ˜¯ <strong>å†…è”å…ƒç´ </strong></p>
<p>åˆ™å†…è”å…ƒç´ å°†ç¯ç»•æµ®åŠ¨å…ƒç´ æ’åˆ—.</p>
<h4 id="å¯¹å…„å¼Ÿå…ƒç´ -æµ®åŠ¨-çš„å½±å“"><a href="#å¯¹å…„å¼Ÿå…ƒç´ -æµ®åŠ¨-çš„å½±å“" class="headerlink" title="å¯¹å…„å¼Ÿå…ƒç´ (æµ®åŠ¨)çš„å½±å“"></a>å¯¹å…„å¼Ÿå…ƒç´ (æµ®åŠ¨)çš„å½±å“</h4><p>è‹¥å…„å¼Ÿå…ƒç´ æ˜¯ <strong>åŒä¸€æ–¹å‘æµ®åŠ¨</strong>.</p>
<p>åˆ™å…„å¼Ÿå…ƒç´ ç›¸å¯¹è¯¥æµ®åŠ¨å…ƒç´ æŒ‰ç…§ä»å·¦åˆ°å³(float:left)æˆ–è€…ä»å³åˆ°å·¦(float:right)çš„é¡ºåºä¾æ¬¡æ’åˆ—.</p>
<p>è‹¥å…„å¼Ÿå…ƒç´ æ˜¯ <strong>åæ–¹å‘æµ®åŠ¨</strong>.</p>
<p>åˆ™å…„å¼Ÿå…ƒç´ å’Œæµ®åŠ¨å…ƒç´ å°†ç»„æˆä¸¤ä¸ªå‘å·¦æˆ–å‘å³çš„æµ®åŠ¨é˜Ÿåˆ—, åˆ†åˆ«ç›¸å¯¹æµ®åŠ¨æ–¹å‘åŒæ—¶å‘è¡Œä¸­é—´æµ®åŠ¨. ä»–ä»¬å°½å¯èƒ½å¤„äºåŒä¸€è¡Œ, å¦‚æœè¡Œçš„å®½åº¦ä¸è¶³ä»¥å®¹çº³è¿™ä¸¤ä¸ªé˜Ÿåˆ—, ä¸¤ä¸ªé˜Ÿåˆ—å°†é”™å¼€æˆä¸¤è¡Œ, DOMç»“æ„ä¸­å¤„äºä¹‹å‰çš„æµ®åŠ¨é˜Ÿåˆ—å°†ä¼˜å…ˆæ’åœ¨ä¸Šé¢ä¸€è¡Œ, å¦ä¸€ä¸ªæµ®åŠ¨é˜Ÿåˆ—å°†æ’åœ¨ä¸‹ä¸€è¡Œæˆ–è€…éƒ¨åˆ†æ’åœ¨ä¸‹ä¸€è¡Œ.</p>
<h4 id="å¯¹è‡ªèº«å…ƒç´ çš„å½±å“"><a href="#å¯¹è‡ªèº«å…ƒç´ çš„å½±å“" class="headerlink" title="å¯¹è‡ªèº«å…ƒç´ çš„å½±å“"></a>å¯¹è‡ªèº«å…ƒç´ çš„å½±å“</h4><p>æµ®åŠ¨å…ƒç´ é»˜è®¤è¢«è§†ä½œ<strong>å—çº§å¯¹è±¡</strong>(block-level).</p>
<h4 id="å¯¹å­å…ƒç´ çš„å½±å“"><a href="#å¯¹å­å…ƒç´ çš„å½±å“" class="headerlink" title="å¯¹å­å…ƒç´ çš„å½±å“"></a>å¯¹å­å…ƒç´ çš„å½±å“</h4><p>æµ®åŠ¨å…ƒç´ , å…¶é«˜åº¦æˆ–å®½åº¦å–æµ®åŠ¨å­å…ƒç´ å’Œéæµ®åŠ¨å­å…ƒç´ é«˜åº¦æˆ–å®½åº¦çš„æœ€å¤§å€¼.</p>
<h4 id="å¯¹çˆ¶å…ƒç´ éæµ®åŠ¨å…„å¼Ÿå…ƒç´ çš„å½±å“"><a href="#å¯¹çˆ¶å…ƒç´ éæµ®åŠ¨å…„å¼Ÿå…ƒç´ çš„å½±å“" class="headerlink" title="å¯¹çˆ¶å…ƒç´ éæµ®åŠ¨å…„å¼Ÿå…ƒç´ çš„å½±å“"></a>å¯¹çˆ¶å…ƒç´ éæµ®åŠ¨å…„å¼Ÿå…ƒç´ çš„å½±å“</h4><p>çˆ¶å…ƒç´ ä¹‹å¤–çš„éæµ®åŠ¨å…ƒç´ å°†ä¼šæ— è§†è¯¥æµ®åŠ¨å…ƒç´ , ä»–ä»¬åªä¼šç›¸å¯¹çˆ¶å…ƒç´ æŒ‰ç…§æ­£å¸¸æ–‡æ¡£æµå»æ’åˆ—.</p>
<h4 id="å¯¹çˆ¶å…ƒç´ æµ®åŠ¨å…„å¼Ÿå…ƒç´ çš„å½±å“"><a href="#å¯¹çˆ¶å…ƒç´ æµ®åŠ¨å…„å¼Ÿå…ƒç´ çš„å½±å“" class="headerlink" title="å¯¹çˆ¶å…ƒç´ æµ®åŠ¨å…„å¼Ÿå…ƒç´ çš„å½±å“"></a>å¯¹çˆ¶å…ƒç´ æµ®åŠ¨å…„å¼Ÿå…ƒç´ çš„å½±å“</h4><p>çˆ¶å…ƒç´ ä¹‹å¤–çš„æµ®åŠ¨å…„å¼Ÿå…ƒç´ , ä¼šæœ¬èƒ½çš„æ‰¾åˆ°è¯¥æµ®åŠ¨å…ƒç´ , ç°è±¡å‚ç…§ â€œå¯¹å…„å¼Ÿå…ƒç´ (æµ®åŠ¨)çš„å½±å“â€.</p>
<h3 id="æ¸…é™¤æµ®åŠ¨çš„2ç§æ–¹æ³•"><a href="#æ¸…é™¤æµ®åŠ¨çš„2ç§æ–¹æ³•" class="headerlink" title="æ¸…é™¤æµ®åŠ¨çš„2ç§æ–¹æ³•"></a>æ¸…é™¤æµ®åŠ¨çš„2ç§æ–¹æ³•</h3><p>å¦‚ä¸Š, floatä¼šå¸¦æ¥çˆ¶å…ƒç´ çš„å¡Œé™·, ä¸‹é¢æä¾›ä¸¤ç§è§£å†³æ–¹æ¡ˆ, ä»¥å¼¥è¡¥floatçš„ç¼ºé™·.</p>
<p>å¦‚ä¸‹DOM, ç”±äºå­å…ƒç´ è®¾ç½®ä¸ºfloat:left, æ­¤æ—¶çˆ¶å…ƒç´ å¹¶ä¸ä¼šè¢«æ’‘å¤§, é«˜åº¦ä¸º0, èƒŒæ™¯å°†æ— æ³•å±•ç¤º.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></div><div class="line">	<span class="selector-class">.outer</span>&#123;</div><div class="line">		<span class="attribute">background</span>:<span class="number">#ccc</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="selector-class">.inner</span>&#123;</div><div class="line">		<span class="attribute">float</span>:left;</div><div class="line">		<span class="attribute">width</span>:<span class="number">150px</span>;</div><div class="line">		<span class="attribute">height</span>:<span class="number">100px</span>;</div><div class="line">		<span class="attribute">margin</span>:<span class="number">10px</span>;</div><div class="line">		<span class="attribute">border</span>:<span class="number">1px</span> solid red;</div><div class="line">	&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"outer"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>IE6~7ä¸‹å¯é€šè¿‡è®¾ç½®çˆ¶å…ƒç´ çš„æ ·å¼ä¸ºzoom:1æ¥æ¸…é™¤æµ®åŠ¨, å…¶ä»–æµè§ˆå™¨è¯·å‚è€ƒå¦‚ä¸‹ä¸¤ç§æ–¹æ³•æ¸…é™¤æµ®åŠ¨.</p>
<h4 id="overflow"><a href="#overflow" class="headerlink" title="overflow"></a>overflow</h4><p>çˆ¶å…ƒç´ ä½¿ç”¨overflow:auto|hidden, åˆ‡è®°ä¸å¯ä½¿ç”¨overflow:visible.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.outer</span>&#123;</div><div class="line">	<span class="attribute">overflow</span>:auto|hidden;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="afterä¼ªç±»"><a href="#afterä¼ªç±»" class="headerlink" title="afterä¼ªç±»"></a>afterä¼ªç±»</h4><p>åˆ©ç”¨clear:bothå±æ€§, åŒæ—¶ä¸ºé¿å…åŠ å…¥domå…ƒç´ , ä½¿ç”¨afterä¼ªå…ƒç´ è®¾ç½®å¦‚ä¸‹å±æ€§å³å¯:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.outer</span><span class="selector-pseudo">::after</span>&#123;</div><div class="line">	<span class="attribute">content</span>:<span class="string">''</span>;</div><div class="line">	<span class="attribute">display</span>:block;</div><div class="line">	<span class="attribute">clear</span>:both;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æœ¬æ–‡å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/03/12/css-float/">http://louiszhai.github.io/2016/03/12/css-float/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="http://www.w3cplus.com/css/float.html" target="_blank" rel="external">floatæ·±å…¥å‰–æ_float æ•™ç¨‹_w3cplus</a></li>
<li><a href="http://www.wuwenyuan.com/1079.html" target="_blank" rel="external">ç½‘ç«™CSSå¸ƒå±€ï¼šfloatå¸ƒå±€ä¸positionä¼˜åŠ¿å¯¹æ¯” | ç½‘ç»œè¥é”€æŠ€å·§</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      css float clear:both overflow:auto æ–‡æ¡£æµ
    
    </summary>
    
    
      <category term="CSS" scheme="http://louiszhai.github.io/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>xssæ”»é˜²æµ…è°ˆ</title>
    <link href="http://louiszhai.github.io/2016/03/05/xss/"/>
    <id>http://louiszhai.github.io/2016/03/05/xss/</id>
    <published>2016-03-05T01:48:09.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p><strong>XSS</strong> (Cross-Site Script) æ”»å‡»åˆå«è·¨ç«™è„šæœ¬æ”»å‡», æœ¬è´¨æ˜¯ä¸€ç§æ³¨å…¥æ”»å‡». å…¶åŸç†, ç®€å•çš„è¯´å°±æ˜¯åˆ©ç”¨å„ç§æ‰‹æ®µæŠŠæ¶æ„ä»£ç æ·»åŠ åˆ°ç½‘é¡µä¸­, å¹¶è®©å—å®³è€…æ‰§è¡Œè¿™æ®µè„šæœ¬. XSSèƒ½åšç”¨æˆ·ä½¿ç”¨æµè§ˆå™¨èƒ½åšçš„ä¸€åˆ‡äº‹æƒ…. ä¼Ÿå¤§çš„åŒæºç­–ç•¥ä¹Ÿæ— æ³•ä¿è¯ä¸å—XSSæ”»å‡»ï¼Œå› ä¸ºæ­¤æ—¶æ”»å‡»è€…å°±åœ¨åŒæºä¹‹å†….</p>
<a id="more"></a>
<h3 id="xssæ”»å‡»æ–¹å¼"><a href="#xssæ”»å‡»æ–¹å¼" class="headerlink" title="xssæ”»å‡»æ–¹å¼"></a>xssæ”»å‡»æ–¹å¼</h3><p>ä»æ”»å‡»çš„æ–¹å¼å¯ä»¥åˆ†ä¸º</p>
<ul>
<li>åå°„å‹</li>
<li>å­˜å‚¨å‹</li>
<li>æ–‡æ¡£å‹</li>
</ul>
<p>è¿™ç§åˆ†ç±»æ–¹å¼æœ‰äº›è¿‡æ—¶, é•¿ä¹…ä»¥æ¥, äººä»¬è®¤ä¸ºXSSåˆ†ç±»æœ‰ä»¥ä¸Šä¸‰ç§, ä½†å®é™…æƒ…å†µä¸­ç»å¸¸æ— æ³•åŒºåˆ†, æ‰€ä»¥æ›´æ˜ç¡®çš„åˆ†ç±»æ–¹å¼å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»:</p>
<ul>
<li>client(å®¢æˆ·ç«¯å‹)</li>
<li>server(æœåŠ¡ç«¯å‹)</li>
</ul>
<p>å½“ä¸€ç«¯xssä»£ç æ˜¯åœ¨æœåŠ¡ç«¯è¢«æ’å…¥çš„, é‚£ä¹ˆè¿™å°±æ˜¯æœåŠ¡ç«¯å‹xss, åŒç†, å¦‚æœä»£ç åœ¨å®¢æˆ·ç«¯æ’å…¥, å°±æ˜¯å®¢æˆ·ç«¯å‹xss.</p>
<h3 id="é˜²æ­¢xssæ”»å‡»"><a href="#é˜²æ­¢xssæ”»å‡»" class="headerlink" title="é˜²æ­¢xssæ”»å‡»"></a>é˜²æ­¢xssæ”»å‡»</h3><h4 id="è½¬ä¹‰"><a href="#è½¬ä¹‰" class="headerlink" title="è½¬ä¹‰"></a>è½¬ä¹‰</h4><p>æ— è®ºæ˜¯æœåŠ¡ç«¯å‹è¿˜æ˜¯å®¢æˆ·ç«¯å‹xssï¼Œæ”»å‡»è¾¾æˆéƒ½éœ€è¦ä¸¤ä¸ªæ¡ä»¶</p>
<ul>
<li>ä»£ç è¢«æ³¨å…¥</li>
<li>ä»£ç è¢«æ‰§è¡Œ</li>
</ul>
<p>å…¶å®åªè¦åšå¥½æ— è®ºä»»ä½•æƒ…å†µä¸‹ä¿è¯ä»£ç ä¸è¢«æ‰§è¡Œå°±èƒ½å®Œå…¨æœç»xssæ”»å‡».</p>
<p>æ€»ä¹‹, ä»»ä½•æ—¶å€™éƒ½ä¸è¦æŠŠä¸å—ä¿¡ä»»çš„æ•°æ®ç›´æ¥æ’å…¥åˆ°domä¸­çš„ä»»ä½•ä½ç½®, ä¸€å®šè¦åšè½¬ä¹‰ã€‚</p>
<p><strong>å¯¹äºæŸäº›ä½ç½®,ä¸å—ä¿¡ä»»çš„æ•°æ®åšè½¬ä¹‰å°±å¯ä»¥ä¿è¯å®‰å…¨</strong></p>
<ul>
<li>ä¸€èˆ¬çš„æ ‡ç­¾å±æ€§å€¼</li>
<li>div body çš„å†…éƒ¨html</li>
</ul>
<p><strong>å¯¹äºæŸäº›ä½ç½®ï¼Œå³ä½¿åšäº†è½¬ä¹‰ä¾ç„¶ä¸å®‰å…¨</strong></p>
<ul>
<li>scriptæ ‡ç­¾ä¸­</li>
<li>æ³¨é‡Šä¸­</li>
<li>è¡¨ç­¾çš„å±æ€§åå</li>
<li>æ ‡ç­¾å</li>
<li>cssæ ‡ç­¾ä¸­</li>
</ul>
<p>ä½¿ç”¨JSON.parse è€Œä¸æ˜¯eval, request çš„content-typeè¦æŒ‡å®šæ˜¯Content-Type: application/json;</p>
<p>å¦‚æœé“¾æ¥çš„URLä¸­éƒ¨åˆ†æ˜¯åŠ¨æ€ç”Ÿæˆçš„, ä¸€å®šè¦åšè½¬ä¹‰.</p>
<h4 id="ä½¿ç”¨æµè§ˆå™¨è‡ªå¸¦çš„xss-filter"><a href="#ä½¿ç”¨æµè§ˆå™¨è‡ªå¸¦çš„xss-filter" class="headerlink" title="ä½¿ç”¨æµè§ˆå™¨è‡ªå¸¦çš„xss-filter"></a>ä½¿ç”¨æµè§ˆå™¨è‡ªå¸¦çš„xss-filter</h4><p><img src="http://louiszhai.github.io/docImages/xss01.png" alt="xss-filter"></p>
<blockquote>
<p>å¯ä»¥é€šè¿‡httpå¤´æ§åˆ¶æ˜¯å¦æ‰“å¼€ xss-filter, é»˜è®¤ä¸ºå¼€å¯.</p>
</blockquote>
<p>é€šå¸¸æƒ…å†µä¸‹, åœ¨http headerä¸­åŠ å…¥ä»¥ä¸‹å­—æ®µè¡¨ç¤ºå¯ç”¨xss-filter.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attr">X-XSS-Protection:</span><span class="number">1</span> (é»˜è®¤)</div><div class="line"><span class="attr">X-XSS-Protection:</span><span class="number">1</span>;mode=block (å¼ºåˆ¶ä¸æ¸²æŸ“, chromeè·³ç©ºç™½é¡µ,IEå±•ç¤ºä¸€ä¸ª<span class="comment">#å·)</span></div></pre></td></tr></table></figure>
<p>å¦‚éœ€ç¦ç”¨xss-filter, å°† <code>X-XSS-Protection</code> è®¾ç½®ä¸º0å³å¯.</p>
<p>å¦‚ä¸Š, ç°ä»£æµè§ˆå™¨éƒ½å¯¹åå°„å‹xssæœ‰ä¸€å®šçš„é˜²å¾¡åŠ›, å…¶åŸç†æ˜¯æ£€æŸ¥urlå’Œdomä¸­å…ƒç´ çš„ç›¸å…³æ€§. ä½†è¿™å¹¶ä¸èƒ½å®Œå…¨é˜²æ­¢åå°„å‹xss. è¿™é‡Œæœ‰ä¸ªå¯ä¾›æµ‹è¯•çš„é“¾æ¥, ä¼ é€é—¨: <a href="http://www.enhanceie.com/test/xss/" target="_blank" rel="external">XSS Test Page</a>.</p>
<p>å¦å¤–, æµè§ˆå™¨å¯¹äºå­˜å‚¨å‹xsså¹¶æ²¡æœ‰æŠµæŠ—åŠ›, åŸå› å¾ˆç®€å•, ç”¨æˆ·çš„éœ€æ±‚æ˜¯å¤šç§å¤šæ ·çš„. æ‰€ä»¥, æŠµå¾¡xssè¿™ä»¶äº‹æƒ…ä¸èƒ½æŒ‡æœ›æµè§ˆå™¨.</p>
<h4 id="Content-Security-Policy"><a href="#Content-Security-Policy" class="headerlink" title="Content Security Policy"></a>Content Security Policy</h4><p>Content Security Policy, å³å†…å®¹å®‰å…¨ç­–ç•¥, ç®€ç§°csp.</p>
<p>ä¸ºäº†ç¼“è§£å¾ˆå¤§ä¸€éƒ¨åˆ†æ½œåœ¨çš„è·¨ç«™è„šæœ¬é—®é¢˜, æµè§ˆå™¨çš„æ‰©å±•ç¨‹åºç³»ç»Ÿå¼•å…¥äº†CSP. CSP ç®¡ç†ç½‘ç«™å…è®¸åŠ è½½çš„å†…å®¹, å¹¶ä¸”ä½¿ç”¨ç™½åå•çš„æœºåˆ¶å¯¹ç½‘ç«™åŠ è½½æˆ–æ‰§è¡Œçš„èµ„æºèµ·ä½œç”¨. åœ¨ç½‘é¡µä¸­, è¿™æ ·çš„ç­–ç•¥é€šè¿‡ HTTP å¤´ä¿¡æ¯æˆ–è€… meta å…ƒç´ å®šä¹‰.</p>
<p>CSP å¹¶ä¸æ˜¯ç”¨æ¥é˜²æ­¢ xss æ”»å‡»çš„, è€Œæ˜¯æœ€å°åŒ– xss å‘ç”Ÿåæ‰€é€ æˆçš„ä¼¤å®³. å®é™…ä¸Š, é™¤äº†å¼€å‘è€…è‡ªå·±åšå¥½ xss è½¬ä¹‰, å¹¶æ²¡æœ‰åˆ«çš„æ–¹æ³•å¯ä»¥é˜²æ­¢ xss çš„å‘ç”Ÿ. CSP å¯ä»¥è¯´æ˜¯HTML5ç»™webå®‰å…¨å¸¦æ¥çš„æœ€å®æƒ çš„ä¸œè¥¿. é‚£ä¹ˆå¦‚ä½•å¼•å…¥ CSP å‘¢?</p>
<ol>
<li>é€šè¿‡responseå¤´</li>
</ol>
<blockquote>
<p>åªå…è®¸è„šæœ¬ä»æœ¬æºåŠ è½½Content-Security-Policy: script-src â€˜selfâ€™</p>
</blockquote>
<ol>
<li>é€šè¿‡HTMLçš„METAæ ‡ç­¾</li>
</ol>
<blockquote>
<p>ä½œç”¨åŒä¸Š&lt;meta http-equiv=â€Content-Security-Policyâ€ content=â€script-src â€˜selfâ€™â€&gt;</p>
</blockquote>
<p>é‚£ä¹ˆCSP é™¤äº†é™åˆ¶script-src ä¹‹å¤–è¿˜èƒ½é™åˆ¶ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<blockquote>
<p>base-uri : é™åˆ¶è¿™ç¯‡æ–‡æ¡£çš„uri  </p>
<p>child-src ï¼šé™åˆ¶å­çª—å£çš„æº(iframe,å¼¹çª—ç­‰),å–ä»£frame-src  </p>
<p>connect-src ï¼šé™åˆ¶è„šæœ¬å¯ä»¥è®¿é—®çš„æº  </p>
<p>font-src : é™åˆ¶å­—ä½“çš„æº  </p>
<p>form-action : é™åˆ¶è¡¨å•èƒ½å¤Ÿæäº¤åˆ°çš„æº  </p>
<p>frame-ancestors : é™åˆ¶äº†å½“å‰é¡µé¢å¯ä»¥è¢«å“ªäº›é¡µé¢ä»¥iframe,frame,objectç­‰æ–¹å¼åŠ è½½  </p>
<p>frame-src ï¼šdeprecated with child-src,é™åˆ¶äº†å½“å‰é¡µé¢å¯ä»¥åŠ è½½å“ªäº›æºï¼Œä¸frame-ancestorså¯¹åº” </p>
<p>img-src : é™åˆ¶å›¾ç‰‡å¯ä»¥ä»å“ªäº›æºåŠ è½½  </p>
<p>media-src : é™åˆ¶video, audio, source, track èƒ½å¤Ÿä»å“ªäº›æºåŠ è½½  </p>
<p>object-src ï¼šé™åˆ¶æ’ä»¶å¯ä»¥ä»å“ªäº›æºåŠ è½½  </p>
<p>sandbox ï¼šå¼ºåˆ¶æ‰“å¼€æ²™ç›’æ¨¡å¼</p>
</blockquote>
<p>å¯ä»¥çœ‹å‡º, CSPæ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç­–ç•¥, å‡ ä¹å¯ä»¥é™åˆ¶äº†æ‰€æœ‰èƒ½å¤Ÿç”¨åˆ°çš„èµ„æºçš„æ¥æº. ä½¿ç”¨å¥½CSPå¯ä»¥å¾ˆå¤§æˆéƒ½é™ä½XSSå¸¦æ¥çš„é£é™©.</p>
<p>å¦å¤–, CSPè¿˜æä¾›ä¸€ä¸ªæŠ¥å‘Šçš„å¤´åŸŸ <code>Content-Security-Policy-Report-Only</code>, ä½¿ç”¨è¿™ä¸ªå¤´åŸŸ, æµè§ˆå™¨ä¼šå‘æœåŠ¡å™¨æŠ¥å‘ŠcspçŠ¶æ€.</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">Content-Security-Policy-Report-Only</span>: script-src 'self'; report-uri http://cspReport/</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨äº†ä¸Šé¢çš„è®¾ç½®, è‹¥é¡µé¢ä¸Šå­˜åœ¨å†…è”çš„js, å®ƒä¾ç„¶ä¼šæ‰§è¡Œ, ä¸è¿‡æµè§ˆå™¨ä¼šå‘å‘é€ä¸€ä¸ªpostè¯·æ±‚, åŒ…å«å¦‚ä¸‹ä¿¡æ¯.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123; </div><div class="line">  <span class="attr">"csp-report"</span>:</div><div class="line">  	&#123; </div><div class="line">      <span class="attr">"document-uri"</span>: <span class="string">"http://cspReport/test.php"</span>,</div><div class="line">      <span class="attr">"referrer"</span>: <span class="string">""</span>,</div><div class="line">      <span class="attr">"violated-directive"</span>: <span class="string">"script-src 'self'"</span>,</div><div class="line">      <span class="attr">"original-policy"</span>: <span class="string">"script-src 'self'; report-uri http://cspReport/"</span>,</div><div class="line">      <span class="attr">"blocked-uri"</span>: <span class="string">""</span></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>CSP ç›®å‰æœ‰ä¸¤ç‰ˆ, [CSP1][<a href="https://www.w3.org/TR/2012/CR-CSP-20121115/" target="_blank" rel="external">https://www.w3.org/TR/2012/CR-CSP-20121115/</a>] å’Œ [CSP2][<a href="https://www.w3.org/TR/CSP2/" target="_blank" rel="external">https://www.w3.org/TR/CSP2/</a>]. ä¸¤ç‰ˆçš„æ”¯æŒçŠ¶æ€å¯ä»¥åœ¨ <a href="http://caniuse.com/#search=csp" target="_blank" rel="external">http://caniuse.com/#search=csp</a> ä¸­æŸ¥åˆ°. å¦‚ä¸‹:</p>
<p><strong>CSP1æ”¯æŒæ€§</strong></p>
<p><img src="http://louiszhai.github.io/docImages/xss03-csp1.png" alt="CSP1"></p>
<p><strong>CSP2æ”¯æŒæ€§</strong></p>
<p><img src="http://louiszhai.github.io/docImages/xss03-csp2.png" alt="CSP2"></p>
<p>CSPè™½ç„¶æä¾›äº†å¼ºå¤§çš„å®‰å…¨ä¿æŠ¤, ä½†æ˜¯ä»–ä¹Ÿé€ æˆäº†å¦‚ä¸‹é—®é¢˜: EvalåŠç›¸å…³å‡½æ•°è¢«ç¦ç”¨ã€å†…åµŒçš„JavaScriptä»£ç å°†ä¸ä¼šæ‰§è¡Œã€åªèƒ½é€šè¿‡ç™½åå•æ¥åŠ è½½è¿œç¨‹è„šæœ¬.</p>
<h4 id="X-Frame-Options"><a href="#X-Frame-Options" class="headerlink" title="X-Frame-Options"></a>X-Frame-Options</h4><p>X-Frame-Options å“åº”å¤´æ˜¯ç”¨æ¥ç»™æµè§ˆå™¨æŒ‡ç¤ºå…è®¸ä¸€ä¸ªé¡µé¢å¯å¦åœ¨ <code>frame</code>, <code>iframe</code> æˆ–è€… <code>object</code> ç­‰æ ‡ç­¾ä¸­å±•ç°çš„æ ‡è®°. ç½‘ç«™å¯ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½, æ¥ç¡®ä¿è‡ªå·±ç½‘ç«™çš„å†…å®¹æ²¡æœ‰è¢«åµŒåˆ°åˆ«äººçš„ç½‘ç«™ä¸­å», ä¹Ÿä»è€Œé¿å…äº†ç‚¹å‡»åŠ«æŒ (clickjacking) çš„æ”»å‡». ä½†ä»¥åå¯èƒ½è¢«CSPçš„ frame-ancestorså–ä»£ã€‚ç›®å‰æ”¯æŒçš„çŠ¶æ€æ¯”èµ· CSP frame-ancestorsè¦å¥½.</p>
<p>X-Frame-Options å…±æœ‰ä¸‰ä¸ªå€¼:</p>
<ul>
<li>DENY è¡¨ç¤ºè¿™ä¸ªé¡µé¢ä¸å…è®¸è¢«ä»¥frameçš„æ–¹å¼åŠ è½½ </li>
<li>SAMEORIGIN è¡¨ç¤ºè¿™ä¸ªé¡µé¢åªå…è®¸è¢«åŒæºé¡µé¢åŠ è½½</li>
<li>ALLOW-FROM uri è¡¨ç¤ºè¿™ä¸ªé¡µé¢åªèƒ½è¢«ç‰¹å®šçš„åŸŸåŠ è½½</li>
</ul>
<p>æœåŠ¡å™¨é…ç½®</p>
<p><strong>javaä»£ç :</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">response.addHeader(<span class="string">"x-frame-options"</span>,<span class="string">"SAMEORIGIN"</span>);</div></pre></td></tr></table></figure>
<p><strong>Nginxé…ç½®:</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">addî€†header X-Frame-Options SAMEORIGIN</div></pre></td></tr></table></figure>
<p><strong>Apacheé…ç½®:</strong></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute"><span class="nomarkup">Header</span></span> always append X-Frame-Options SAMEORIGIN</div></pre></td></tr></table></figure>
<p><strong>æµè§ˆå™¨å…¼å®¹æ€§</strong></p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>Chrome</th>
<th>Firefox (Gecko)</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
</tr>
</thead>
<tbody>
<tr>
<td>åŸºç¡€æ”¯æŒ</td>
<td>4.1.249.1042</td>
<td><a href="https://developer.mozilla.org/en-US/Firefox/Releases/NaN" target="_blank" rel="external">3.6.9</a> (1.9.2.9)</td>
<td>8.0</td>
<td>10.5</td>
<td>4.0</td>
</tr>
<tr>
<td>ALLOW-FROM æ”¯æŒ</td>
<td>Not supported</td>
<td><a href="https://developer.mozilla.org/en-US/Firefox/Releases/18" target="_blank" rel="external">18.0</a></td>
<td>8.0?</td>
<td>?</td>
<td>Not supported</td>
</tr>
</tbody>
</table>
<h4 id="Http-Only"><a href="#Http-Only" class="headerlink" title="Http-Only"></a>Http-Only</h4><p>ä½¿ç”¨ http-onlyå, å¯ç¦æ­¢jsè¯»å†™cookie,  å¯ä»¥ä¿è¯å³ä½¿å‘ç”Ÿäº†xss, ç”¨æˆ·çš„cookieä¹Ÿæ˜¯å®‰å…¨çš„.</p>
<h4 id="iframe-æ²™ç®±ç¯å¢ƒ"><a href="#iframe-æ²™ç®±ç¯å¢ƒ" class="headerlink" title="iframe æ²™ç®±ç¯å¢ƒ"></a>iframe æ²™ç®±ç¯å¢ƒ</h4><p>HTML5ä¸ºiframeæä¾›äº†å®‰å…¨å±æ€§ sandbox, è¿›è€Œé™åˆ¶iframeçš„èƒ½åŠ›. å¦‚ä¸‹:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">"untrusted.html"</span> <span class="attr">sandbox</span>=<span class="string">"allow-scripts allow-forms"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="å…¶ä»–å®‰å…¨ç›¸å…³çš„HTTPå¤´"><a href="#å…¶ä»–å®‰å…¨ç›¸å…³çš„HTTPå¤´" class="headerlink" title="å…¶ä»–å®‰å…¨ç›¸å…³çš„HTTPå¤´"></a>å…¶ä»–å®‰å…¨ç›¸å…³çš„HTTPå¤´</h4><h5 id="X-Content-Type-Options"><a href="#X-Content-Type-Options" class="headerlink" title="X-Content-Type-Options"></a>X-Content-Type-Options</h5><p>X-Content-Type-Options é˜»æ­¢æµè§ˆå™¨è¿›è¡Œcontent-type å—…æ¢, èƒ½å¤Ÿé˜²æ­¢ç±»å‹å—…æ¢æ”»å‡».</p>
<p>è¿™ä¸ªheaderä¸»è¦ç”¨æ¥é˜²æ­¢åœ¨IE9ã€chromeå’Œsafariä¸­çš„MIMEç±»å‹æ··æ·†æ”»å‡». é€šå¸¸æµè§ˆå™¨å¯ä»¥é€šè¿‡å—…æ¢å†…å®¹æœ¬èº«çš„æ–¹æ³•æ¥å†³å®šå®ƒæ˜¯ä»€ä¹ˆç±»å‹, è€Œä¸æ˜¯çœ‹å“åº”ä¸­çš„content-typeå€¼. é€šè¿‡è®¾ç½® X-Content-Type-Optionsï¼šå¦‚æœcontent-typeå’ŒæœŸæœ›çš„ç±»å‹åŒ¹é…ï¼Œåˆ™ä¸éœ€è¦å—…æ¢ï¼Œåªèƒ½ä»å¤–éƒ¨åŠ è½½ç¡®å®šç±»å‹çš„èµ„æº. ä¸¾ä¸ªä¾‹å­, å¦‚æœåŠ è½½äº†ä¸€ä¸ªæ ·å¼è¡¨, é‚£ä¹ˆèµ„æºçš„MIMEç±»å‹åªèƒ½æ˜¯text/css, å¯¹äºIEä¸­çš„è„šæœ¬èµ„æº, ä»¥ä¸‹çš„å†…å®¹ç±»å‹æ˜¯æœ‰æ•ˆçš„:</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">application</span>/ecmascript  </div><div class="line"><span class="built_in">application</span>/javascript  </div><div class="line"><span class="built_in">application</span>/x-javascript  </div><div class="line"><span class="built_in">text</span>/ecmascript  </div><div class="line"><span class="built_in">text</span>/javascript  </div><div class="line"><span class="built_in">text</span>/jscript  </div><div class="line"><span class="built_in">text</span>/x-javascript  </div><div class="line"><span class="built_in">text</span>/vbs  </div><div class="line"><span class="built_in">text</span>/vbscript</div></pre></td></tr></table></figure>
<p>å¯¹äºchrome, åˆ™æ”¯æŒä¸‹é¢çš„MIME ç±»å‹:</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">text</span>/javascript  </div><div class="line"><span class="built_in">text</span>/ecmascript  </div><div class="line"><span class="built_in">application</span>/javascript  </div><div class="line"><span class="built_in">application</span>/ecmascript  </div><div class="line"><span class="built_in">application</span>/x-javascript  </div><div class="line"><span class="built_in">text</span>/javascript1<span class="number">.1</span>  </div><div class="line"><span class="built_in">text</span>/javascript1<span class="number">.2</span>  </div><div class="line"><span class="built_in">text</span>/javascript1<span class="number">.3</span>  </div><div class="line"><span class="built_in">text</span>/jscript  </div><div class="line"><span class="built_in">text</span>/live <span class="keyword">script</span></div></pre></td></tr></table></figure>
<p><strong>æ­£ç¡®çš„è®¾ç½®</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nosniff â€“ è¿™ä¸ªæ˜¯å”¯ä¸€æ­£ç¡®çš„è®¾ç½®.</div></pre></td></tr></table></figure>
<p>é€šå¸¸ä¸æ­£ç¡®çš„è®¾ç½®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">â€˜nosniffâ€™ â€“ å¼•å·æ˜¯ä¸å…è®¸çš„</div><div class="line">: nosniff â€“ å†’å·ä¹Ÿæ˜¯é”™è¯¯çš„</div></pre></td></tr></table></figure>
<p><strong>å¦‚ä½•æ£€æµ‹</strong></p>
<p>åœ¨IEå’Œchromeä¸­æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œåœ¨æ§åˆ¶å°ä¸­è§‚å¯Ÿé…ç½®äº†nosniffå’Œæ²¡æœ‰é…ç½®nosniffçš„è¾“å‡ºæœ‰å•¥åŒºåˆ«.</p>
<h5 id="HPKP-Public-Key-Pinning"><a href="#HPKP-Public-Key-Pinning" class="headerlink" title="HPKP(Public Key Pinning)"></a>HPKP(Public Key Pinning)</h5><p>HPKP æ˜¯ä¸€ä¸ªresponse å¤´, ç”¨æ¥æ£€æµ‹ä¸€ä¸ªè¯ä¹¦çš„å…¬é’¥æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜, é˜²æ­¢ä¸­é—´äººæ”»å‡».</p>
<p>æˆ‘ä»¬çŸ¥é“, å—ä¿¡ä»»çš„ CAï¼ˆè¯ä¹¦é¢å‘æœºæ„ï¼‰æœ‰å¥½å‡ ç™¾ä¸ª, ä»–ä»¬æˆä¸ºæ•´ä¸ªç½‘ç«™èº«ä»½è®¤è¯è¿‡ç¨‹ä¸­ä¸€ä¸ªè¾ƒå¤§çš„æ”»å‡»é¢. ç°æœ‰çš„è¯ä¹¦ä¿¡ä»»é“¾æœºåˆ¶æœ€å¤§çš„é—®é¢˜æ˜¯, ä»»ä½•ä¸€å®¶å—ä¿¡ä»»çš„ CA éƒ½å¯ä»¥ç­¾å‘ä»»æ„ç½‘ç«™çš„ç«™ç‚¹è¯ä¹¦, è¿™äº›è¯ä¹¦åœ¨æµè§ˆå™¨çœ‹æ¥, éƒ½æ˜¯åˆæ³•çš„.</p>
<p>HPKP æŠ€æœ¯ç»™äºˆæˆ‘ä»¬ä¸»åŠ¨é€‰æ‹©ä¿¡ä»» CA çš„æƒåˆ©. å®ƒçš„å·¥ä½œåŸç†æ˜¯é€šè¿‡å“åº”å¤´æˆ–è€… <meta> æ ‡ç­¾å‘Šè¯‰æµè§ˆå™¨å½“å‰ç½‘ç«™çš„è¯ä¹¦æŒ‡çº¹, ä»¥åŠè¿‡æœŸæ—¶é—´ç­‰å…¶å®ƒä¿¡æ¯. æœªæ¥ä¸€æ®µæ—¶é—´å†…, æµè§ˆå™¨å†æ¬¡è®¿é—®è¿™ä¸ªç½‘ç«™å¿…é¡»éªŒè¯è¯ä¹¦é“¾ä¸­çš„è¯ä¹¦æŒ‡çº¹, å¦‚æœè·Ÿä¹‹å‰æŒ‡å®šçš„å€¼ä¸åŒ¹é…, å³ä¾¿è¯ä¹¦æœ¬èº«æ˜¯åˆæ³•çš„, ä¹Ÿå¿…é¡»æ–­å¼€è¿æ¥.</p>
<p>HPKP å®˜æ–¹æ–‡æ¡£è§ <a href="https://tools.ietf.org/html/rfc7469" target="_blank" rel="external">RFC7469</a> , ç›®å‰ Firefox 35+ å’Œ Chrome 38+ å·²ç»æ”¯æŒ. å®ƒçš„åŸºæœ¬æ ¼å¼å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Public-Key-Pins: pin-sha256=&quot;base64==&quot;; max-age=expireTime [; includeSubdomains][; report-uri=&quot;reportURI&quot;]</div></pre></td></tr></table></figure>
<h5 id="HSTS-HTTP-Strict-Transport-Security"><a href="#HSTS-HTTP-Strict-Transport-Security" class="headerlink" title="HSTS (HTTP Strict-Transport-Security)"></a>HSTS (HTTP Strict-Transport-Security)</h5><p>HSTS æ˜¯å›½é™…äº’è”ç½‘å·¥ç¨‹ç»„ç»‡IETEæ­£åœ¨æ¨è¡Œä¸€ç§æ–°çš„Webå®‰å…¨åè®®, å¯ä»¥ç”¨æ¥æŠµå¾¡ä¸­é—´äººæ”»å‡», å®ƒå¼ºåˆ¶æµè§ˆå™¨ä½¿ç”¨TSLä½œä¸ºæ•°æ®é€šé“, å³å¼ºåˆ¶ä½¿ç”¨HTTPSä¸æœåŠ¡å™¨åˆ›å»ºè¿æ¥.</p>
<p>æœåŠ¡å™¨å¼€å¯HSTSçš„æ–¹æ³•æ˜¯, å½“å®¢æˆ·ç«¯é€šè¿‡HTTPSå‘å‡ºè¯·æ±‚æ—¶, åœ¨æœåŠ¡å™¨è¿”å›çš„è¶…æ–‡æœ¬ä¼ è¾“åè®®å“åº”å¤´ä¸­åŒ…å«Strict-Transport-Securityå­—æ®µ. éåŠ å¯†ä¼ è¾“æ—¶è®¾ç½®çš„HSTSå­—æ®µæ— æ•ˆ.</p>
<p>æ¯”å¦‚, <a href="https://xxx" target="_blank" rel="external">https://xxx</a> çš„å“åº”å¤´å«æœ‰Strict-Transport-Security: max-age=31536000; includeSubDomains. è¿™æ„å‘³ç€ä¸¤ç‚¹:</p>
<p>åœ¨æ¥ä¸‹æ¥çš„ä¸€å¹´ï¼ˆå³31536000ç§’ï¼‰ä¸­, æµè§ˆå™¨åªè¦å‘xxxæˆ–å…¶å­åŸŸåå‘é€HTTPè¯·æ±‚æ—¶, å¿…é¡»é‡‡ç”¨HTTPSæ¥å‘èµ·è¿æ¥. æ¯”å¦‚, ç”¨æˆ·ç‚¹å‡»è¶…é“¾æ¥æˆ–åœ¨åœ°å€æ è¾“å…¥ <a href="http://xxx/" target="_blank" rel="external">http://xxx/</a> , æµè§ˆå™¨åº”å½“è‡ªåŠ¨å°† http è½¬å†™æˆ https, ç„¶åç›´æ¥å‘ <a href="https://xxx/" target="_blank" rel="external">https://xxx/</a> å‘é€è¯·æ±‚.</p>
<p>åœ¨æ¥ä¸‹æ¥çš„ä¸€å¹´ä¸­, å¦‚æœ xxx æœåŠ¡å™¨å‘é€çš„TLSè¯ä¹¦æ— æ•ˆ, ç”¨æˆ·ä¸èƒ½å¿½ç•¥æµè§ˆå™¨è­¦å‘Šç»§ç»­è®¿é—®ç½‘ç«™.</p>
<p>ä¸è¶³å°±æ˜¯, ç”¨æˆ·é¦–æ¬¡è®¿é—®ç½‘å€æ˜¯ä¸å—HSTSä¿æŠ¤çš„, è¿™æ˜¯å› ä¸ºé¦–æ¬¡è¿˜æœªæ”¶åˆ°HSTS. è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ä¸ª, ä¸€æ˜¯æµè§ˆå™¨é¢„ç½® HSTSåŸŸååˆ—è¡¨, Google Chromeã€Firefox å’Œ Internet Explorer å®ç°äº†è¿™ä¸€æ–¹æ¡ˆ. äºŒæ˜¯å°†HSTSä¿¡æ¯åŠ å…¥åˆ°åŸŸåç³»ç»Ÿè®°å½•ä¸­.</p>
<h3 id="å‰ç«¯xssè¿‡æ»¤"><a href="#å‰ç«¯xssè¿‡æ»¤" class="headerlink" title="å‰ç«¯xssè¿‡æ»¤"></a>å‰ç«¯xssè¿‡æ»¤</h3><p>æœ€åæä¾›ä¸€ç§å‰ç«¯xssè¿‡æ»¤çš„æ–¹æ³•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">xssCheck</span>(<span class="params">str,reg</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> str ? str.replace(reg || <span class="regexp">/[&amp;&lt;"&gt;'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span>(b)&#123;</div><div class="line">      <span class="keyword">return</span> a;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        <span class="string">'&lt;'</span>:<span class="string">'&amp;lt;'</span>,</div><div class="line">        <span class="string">'&amp;'</span>:<span class="string">'&amp;amp;'</span>,</div><div class="line">        <span class="string">'"'</span>:<span class="string">'&amp;quot;'</span>,</div><div class="line">        <span class="string">'&gt;'</span>:<span class="string">'&amp;gt;'</span>,</div><div class="line">        <span class="string">"'"</span>:<span class="string">'&amp;#39;'</span>,</div><div class="line">      &#125;[a]</div><div class="line">    &#125;</div><div class="line">  &#125;) : <span class="string">''</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>æœ¬æ–‡å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/03/05/xss/">http://louiszhai.github.io/2016/03/05/xss/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="http://drops.wooyun.org/web/13009?hmsr=toutiao.io&amp;utmî€†medium=toutiao.io&amp;utmî€†source=toutiao.io" target="_blank" rel="external">å‰ç«¯é˜²å¾¡XSS | WooYunçŸ¥è¯†åº“</a></li>
<li><a href="http://www.freebuf.com/articles/web/61268.html" target="_blank" rel="external">XSSæ”»å‡»å†·é—¨èŠ±æ ·ç©æ³•æ€»ç»“ - FreeBuf.COM | å…³æ³¨é»‘å®¢ä¸æå®¢</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzIyMDEzMTA2MQ==&amp;mid=401875767&amp;idx=1&amp;sn=86a401bcc11370535d313e41fcbcc6d7&amp;scene=0&amp;key=710a5d99946419d9484c49931c8df7fccdb8be90ca92888dfb8ade9a572144b5de476f1987b1fbfb8a5c196503e7db51&amp;ascene=0&amp;uin=MTM4MjU5NzA0MA%3D%3D&amp;devicetype=iMac+MacBookPro12%2C1+OSX+OSX+10.11.3+build(15D21)&amp;version=11020012&amp;pass_ticket=1exiEovV05ofjBqO9qcL3sCuVBh%2BiM6aXpmJHZAB5a7ELhT%2FamprKJVHp83U9s2C" target="_blank" rel="external">å…³äºWebå®‰å…¨ï¼Œ99%çš„ç½‘ç«™éƒ½å¿½ç•¥äº†è¿™äº›</a></li>
<li><a href="http://www.tuicool.com/articles/jURNfy" target="_blank" rel="external">HTTP Public Key Pinning ä»‹ç» - æ¨é…·</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      xss xssæ¼æ´ xssæ”»å‡» xssæµ…è°ˆ å‰ç«¯xss
    
    </summary>
    
    
      <category term="XSS" scheme="http://louiszhai.github.io/tags/XSS/"/>
    
  </entry>
  
  <entry>
    <title>JSå­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•</title>
    <link href="http://louiszhai.github.io/2016/01/12/js.String/"/>
    <id>http://louiszhai.github.io/2016/01/12/js.String/</id>
    <published>2016-01-12T12:27:09.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>javaScript ä¸­, å­—ç¬¦ä¸²æ— å¤„ä¸åœ¨, å¹¶ä¸”æ‰€æœ‰çš„å­—ç¬¦ä¸²æ–¹æ³•å‡æ¥è‡ª String.prototype, è¿™ä¸€èŠ‚, æˆ‘ä»¬èµ°è¿›çœ‹ä¸€çœ‹Stringå†…éƒ¨, æ¢è®¨é‚£äº›å¸¸ç”¨æˆ–ä¸å¸¸ç”¨çš„å­—ç¬¦ä¸²æ“ä½œæ–¹æ³•.</p>
<a id="more"></a>
<h3 id="String-prototype"><a href="#String-prototype" class="headerlink" title="String.prototype"></a>String.prototype</h3><p>String.prototype å±æ€§æŒ‡å‘ String çš„åŸå‹å¯¹è±¡. ä»¥ä¸‹æ˜¯å®ƒçš„å±æ€§ç‰¹æ€§:</p>
<table>
<thead>
<tr>
<th>writable</th>
<th>false</th>
</tr>
</thead>
<tbody>
<tr>
<td>enumerable</td>
<td>false</td>
</tr>
<tr>
<td>configurable</td>
<td>false</td>
</tr>
</tbody>
</table>
<p>æ‰€æœ‰çš„å­—ç¬¦ä¸²å®ä¾‹éƒ½ç»§æ‰¿è‡ª String.prototype. å› æ­¤ä»»ä½• String.prototype ä¸Šçš„æ”¹å˜éƒ½ä¼šåœ¨å­—ç¬¦ä¸²ä¸Šä½“ç°å‡ºæ¥.</p>
<h4 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><ul>
<li>String.prototype.constructor æŒ‡å‘æ„é€ å™¨(String())</li>
<li>String.prototype.length è¡¨ç¤ºå­—ç¬¦ä¸²é•¿åº¦</li>
</ul>
<h4 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h4><p>å­—ç¬¦ä¸²æ–¹æ³•åˆ†ä¸ºä¸¤ç§, ä¸€ç§æ˜¯htmlæ— å…³çš„æ–¹æ³•, ä¸€ç§æ˜¯htmlæœ‰å…³çš„æ–¹æ³•. æˆ‘ä»¬å…ˆçœ‹ç¬¬ä¸€ç§. ä½†æ˜¯æ— è®ºå­—ç¬¦ä¸²æ–¹æ³•å¦‚ä½•å‰å®³, éƒ½ä¸è‡³äºå¼ºå¤§åˆ°å¯ä»¥æ”¹å˜åŸå­—ç¬¦ä¸².</p>
<h5 id="HTMLæ— å…³çš„æ–¹æ³•"><a href="#HTMLæ— å…³çš„æ–¹æ³•" class="headerlink" title="HTMLæ— å…³çš„æ–¹æ³•"></a>HTMLæ— å…³çš„æ–¹æ³•</h5><p>å¸¸ç”¨çš„æ–¹æ³•æœ‰, charAt, charCodeAt, concat, indexOf, lastIndexOf, localeCompare, match, replace, search, slice, split, substr, substring, toLocaleLowerCase, toLocaleUpperCase, toLowerCase, toString, toUpperCase, trim, valueof ç­‰ES5æ”¯æŒçš„, ä»¥åŠ codePointAt, contains, endsWith, normalize, repeat, startsWith ç­‰ES6æ”¯æŒçš„, è¿˜åŒ…æ‹¬ quote, toSource, trimLeft, trimRight ç­‰éæ ‡å‡†çš„.</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†å¯¹å„ä¸ªæ–¹æ³•åˆ†åˆ«ä¸¾ä¾‹é˜è¿°å…¶ç”¨æ³•. è‹¥æ²¡æœ‰ç‰¹åˆ«è¯´æ˜, è¯¥æ–¹æ³•å°†å…¼å®¹æ‰€æœ‰ç›®å‰ä¸»æµæµè§ˆå™¨.</p>
<h6 id="charAt"><a href="#charAt" class="headerlink" title="charAt"></a>charAt</h6><p>charAt() æ–¹æ³•è¿”å›å­—ç¬¦ä¸²ä¸­æŒ‡å®šä½ç½®çš„å­—ç¬¦ã€‚</p>
<p>è¯­æ³•: <em>str</em>.charAt(index)</p>
<p>index ä¸ºå­—ç¬¦ä¸²ç´¢å¼•(å–å€¼ä»0è‡³length-1), å¦‚æœè¶…å‡ºè¯¥èŒƒå›´, åˆ™è¿”å›ç©ºä¸².</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">"Hello, World"</span>.charAt(<span class="number">8</span>));<span class="comment">//o, è¿”å›ä¸‹æ ‡ä¸º8çš„å­—ç¬¦ä¸²o</span></div></pre></td></tr></table></figure>
<h6 id="charCodeAt"><a href="#charCodeAt" class="headerlink" title="charCodeAt"></a>charCodeAt</h6><p>charCodeAt() è¿”å›æŒ‡å®šç´¢å¼•å¤„å­—ç¬¦çš„ Unicode æ•°å€¼.</p>
<p>è¯­æ³•: str.charCodeAt(index)</p>
<p>index ä¸ºä¸€ä¸ªä»0è‡³length-1çš„æ•´æ•°. å¦‚æœä¸æ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œåˆ™é»˜è®¤ä¸º 0, å¦‚æœå°äº0æˆ–è€…å¤§äºå­—ç¬¦ä¸²é•¿åº¦, åˆ™è¿”å› NaN.</p>
<p>Unicode ç¼–ç å•å…ƒï¼ˆcode pointsï¼‰çš„èŒƒå›´ä» 0 åˆ° 1,114,111ã€‚å¼€å¤´çš„ 128 ä¸ª Unicode ç¼–ç å•å…ƒå’Œ ASCII å­—ç¬¦ç¼–ç ä¸€æ ·. </p>
<p>charCodeAt() æ€»æ˜¯è¿”å›ä¸€ä¸ªå°äº 65,536 çš„å€¼. å› ä¸ºé«˜ä½ç¼–ç å•å…ƒéœ€è¦ç”±ä¸€å¯¹å­—ç¬¦æ¥è¡¨ç¤º, ä¸ºäº†æŸ¥çœ‹å…¶ç¼–ç çš„å®Œæˆå­—ç¬¦, éœ€è¦æŸ¥çœ‹ charCodeAt(i) ä»¥åŠ charCodeAt(i+1) çš„å€¼. å¦‚éœ€æ›´å¤šäº†è§£è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/prototype" target="_blank" rel="external">fixedCharCodeAt</a>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">"Hello, World"</span>.charCodeAt(<span class="number">8</span>));<span class="comment">//111</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"å‰ç«¯å·¥ç¨‹å¸ˆ"</span>.charCodeAt(<span class="number">2</span>));<span class="comment">//24037, å¯è§ä¹Ÿå¯ä»¥æŸ¥çœ‹ä¸­æ–‡Unicodeç¼–ç </span></div></pre></td></tr></table></figure>
<h6 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h6><p>concat() æ–¹æ³•å°†ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ä¸²æ‹¼æ¥åœ¨ä¸€èµ·, ç»„æˆæ–°çš„å­—ç¬¦ä¸²å¹¶è¿”å›.</p>
<p>è¯­æ³•: <em>str</em>.concat(string2, string3, â€¦)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">"æ—©"</span>.concat(<span class="string">"ä¸Š"</span>,<span class="string">"å¥½"</span>));<span class="comment">//æ—©ä¸Šå¥½</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ concat çš„æ€§èƒ½è¡¨ç°ä¸ä½³, å¼ºçƒˆæ¨èä½¿ç”¨èµ‹å€¼æ“ä½œç¬¦(+, +=) ä»£æ›¿ concat. â€œ+â€ æ“ä½œç¬¦å¤§æ¦‚å¿«äº† concat å‡ åå€.(æ•°æ®å‚è€ƒ <a href="http://jsperf.com/concat-vs-plus-vs-join" target="_blank" rel="external">æ€§èƒ½æµ‹è¯•</a>).</p>
<h6 id="indexOf"><a href="#indexOf" class="headerlink" title="indexOf"></a>indexOf</h6><h6 id="lastIndexOf"><a href="#lastIndexOf" class="headerlink" title="lastIndexOf"></a>lastIndexOf</h6><p>indexOf() æ–¹æ³•ç”¨äºæŸ¥æ‰¾å­å­—ç¬¦ä¸²åœ¨å­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®. æ²¡æœ‰åˆ™è¿”å› -1. è¯¥æ–¹æ³•ä¸¥æ ¼åŒºåˆ†å¤§å°å†™, å¹¶ä¸”ä»å·¦å¾€å³æŸ¥æ‰¾. è€Œ lastIndexOf åˆ™ä»å³å¾€å·¦æŸ¥æ‰¾, å…¶å®ƒä¸å‰è€…ä¸€è‡´.</p>
<p>è¯­æ³•: str.indexOf(searchValue [, fromIndex=0])</p>
<p>searchValue è¡¨ç¤ºè¢«æŸ¥æ‰¾çš„å­—ç¬¦ä¸², fromIndex è¡¨ç¤ºå¼€å§‹æŸ¥æ‰¾çš„ä½ç½®, é»˜è®¤ä¸º0, å¦‚æœå°äº0, åˆ™æŸ¥æ‰¾æ•´ä¸ªå­—ç¬¦ä¸², è‹¥è¶…è¿‡å­—ç¬¦ä¸²é•¿åº¦, åˆ™è¯¥æ–¹æ³•è¿”å›-1, é™¤éè¢«æŸ¥æ‰¾çš„æ˜¯ç©ºå­—ç¬¦ä¸², æ­¤æ—¶è¿”å›å­—ç¬¦ä¸²é•¿åº¦.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">""</span>.indexOf(<span class="string">""</span>,<span class="number">100</span>));<span class="comment">//0</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"ITæ”¹å˜ä¸–ç•Œ"</span>.indexOf(<span class="string">"ä¸–ç•Œ"</span>));<span class="comment">//4</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"ITæ”¹å˜ä¸–ç•Œ"</span>.lastIndexOf(<span class="string">"ä¸–ç•Œ"</span>));<span class="comment">//4</span></div></pre></td></tr></table></figure>
<h6 id="locateCompare"><a href="#locateCompare" class="headerlink" title="locateCompare"></a>locateCompare</h6><p>locateCompare() æ–¹æ³•ç”¨æ¥æ¯”è¾ƒå­—ç¬¦ä¸², å¦‚æœæŒ‡å®šå­—ç¬¦ä¸²åœ¨åŸå­—ç¬¦ä¸²çš„å‰é¢åˆ™è¿”å›è´Ÿæ•°, å¦åˆ™è¿”å›æ­£æ•°æˆ–0, å…¶ä¸­0 è¡¨ç¤ºä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸åŒ. è¯¥æ–¹æ³•å®ç°ä¾èµ–å…·ä½“çš„æœ¬åœ°å®ç°, ä¸åŒçš„è¯­è¨€ä¸‹å¯èƒ½æœ‰ä¸åŒçš„è¿”å›.</p>
<p>è¯­æ³•: <em>str</em>.localeCompare(str2 [, locales [, options]])</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"apple"</span>;</div><div class="line"><span class="keyword">var</span> str2 = <span class="string">"orange"</span>;</div><div class="line"><span class="built_in">console</span>.log(str.localeCompare(str2));<span class="comment">//-1</span></div><div class="line"><span class="built_in">console</span>.log(str.localeCompare(<span class="string">"123"</span>));<span class="comment">//1</span></div></pre></td></tr></table></figure>
<p>ç›®å‰ Safari æµè§ˆå™¨æš‚ä¸æ”¯æŒè¯¥æ–¹æ³•. Chrome 24, Firefox 29, IE11, Opera 15 å·²å®ç°äº†å®ƒ.</p>
<h6 id="match"><a href="#match" class="headerlink" title="match"></a>match</h6><p>match() æ–¹æ³•ç”¨äºæµ‹è¯•å­—ç¬¦ä¸²æ˜¯å¦æ”¯æŒæŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™, å³ä½¿ä¼ å…¥çš„æ˜¯éæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡, å®ƒä¹Ÿä¼šéšå¼åœ°ä½¿ç”¨ new RegExp(obj) å°†å…¶è½¬æ¢ä¸ºæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡.</p>
<p>è¯­æ³•: <em>str</em>.match(regexp)</p>
<p>è¯¥æ–¹æ³•è¿”å›åŒ…å«åŒ¹é…ç»“æœçš„æ•°ç»„, å¦‚æœæ²¡æœ‰åŒ¹é…é¡¹, åˆ™è¿”å› null.</p>
<p><strong>æè¿°</strong></p>
<ul>
<li>è‹¥æ­£åˆ™è¡¨è¾¾å¼æ²¡æœ‰ g æ ‡å¿—, åˆ™è¿”å›åŒ RegExp.exec(str) ç›¸åŒçš„ç»“æœ. è€Œä¸”è¿”å›çš„æ•°ç»„æ‹¥æœ‰ä¸€ä¸ªé¢å¤–çš„ input å±æ€§, è¯¥å±æ€§åŒ…å«åŸå§‹å­—ç¬¦ä¸², å¦å¤–è¯¥æ•°ç»„è¿˜æ‹¥æœ‰ä¸€ä¸ª index å±æ€§, è¯¥å±æ€§è¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²åœ¨åŸå­—ç¬¦ä¸²ä¸­ç´¢å¼•(ä»0å¼€å§‹).</li>
<li>è‹¥æ­£åˆ™è¡¨è¾¾å¼åŒ…å« g æ ‡å¿—, åˆ™è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰åŒ¹é…ç»“æœçš„æ•°ç»„, æ²¡æœ‰åŒ¹é…åˆ°åˆ™è¿”å› null.</li>
</ul>
<p><strong>ç›¸å…³ RegExp æ–¹æ³•</strong></p>
<ul>
<li>è‹¥éœ€æµ‹è¯•å­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…æ­£åˆ™, è¯·å‚è€ƒ RegExp.test(str).</li>
<li>è‹¥åªéœ€ç¬¬ä¸€ä¸ªåŒ¹é…ç»“æœ, è¯·å‚è€ƒ RegExp.exec(str).</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"World Internet Conference"</span>;</div><div class="line"><span class="built_in">console</span>.log(str.match(<span class="regexp">/[a-d]/i</span>));<span class="comment">//["d", index: 4, input: "World Internet Conference"]</span></div><div class="line"><span class="built_in">console</span>.log(str.match(<span class="regexp">/[a-d]/gi</span>));<span class="comment">//["d", "C", "c"]</span></div><div class="line"><span class="comment">//RegExp æ–¹æ³•å¦‚ä¸‹</span></div><div class="line"><span class="built_in">console</span>.log(<span class="regexp">/[a-d]/gi</span>.test(str));<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(<span class="regexp">/[a-d]/gi</span>.exec(str));<span class="comment">//["d", index: 4, input: "World Internet Conference"]</span></div></pre></td></tr></table></figure>
<p>ç”±ä¸Šå¯çŸ¥, RegExp.test(str) æ–¹æ³•åªè¦åŒ¹é…åˆ°äº†ä¸€ä¸ªå­—ç¬¦ä¹Ÿè¿”å›true. è€Œ</p>
<p>RegExp.exec(str) æ–¹æ³•æ— è®ºæ­£åˆ™ä¸­æœ‰æ²¡æœ‰åŒ…å« g æ ‡å¿—, RegExp.execå°†ç›´æ¥è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…ç»“æœ, ä¸”è¯¥ç»“æœåŒ str.match(regexp) æ–¹æ³•ä¸åŒ…å« g æ ‡å¿—æ—¶çš„è¿”å›ä¸€è‡´.</p>
<h6 id="replace"><a href="#replace" class="headerlink" title="replace"></a>replace</h6><p>è¯¥æ–¹æ³•åœ¨ä¹‹å‰å·²ç»è®²è¿‡, è¯¦ç»†è¯·å‚è€ƒ <a href="http://louiszhai.github.io/2015/12/11/js.replace/"><code>String.prototype.replaceé«˜é˜¶æŠ€èƒ½</code></a> .</p>
<h6 id="search"><a href="#search" class="headerlink" title="search"></a>search</h6><p>search() æ–¹æ³•ç”¨äºæµ‹è¯•å­—ç¬¦ä¸²å¯¹è±¡æ˜¯å¦åŒ…å«æŸä¸ªæ­£åˆ™åŒ¹é…. ç›¸å½“äºæ­£åˆ™è¡¨è¾¾å¼çš„ test æ–¹æ³•. ä¸”è¯¥æ–¹æ³•æ¯” match() æ–¹æ³•æ›´å¿«. å¦‚æœåŒ¹é…æˆåŠŸ, search() è¿”å›æ­£åˆ™è¡¨è¾¾å¼åœ¨å­—ç¬¦ä¸²ä¸­é¦–æ¬¡åŒ¹é…é¡¹çš„ç´¢å¼•, å¦åˆ™è¿”å›-1.</p>
<p>è¯­æ³•: <em>str</em>.search(regexp)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"abcdefg"</span>;</div><div class="line"><span class="built_in">console</span>.log(str.search(<span class="regexp">/[d-g]/</span>));<span class="comment">//3, åŒ¹é…åˆ°å­ä¸²"defg",è€Œdåœ¨åŸå­—ç¬¦ä¸²ä¸­çš„ç´¢å¼•ä¸º3</span></div></pre></td></tr></table></figure>
<p>search() æ–¹æ³•ä¸æ”¯æŒå…¨å±€åŒ¹é…(æ­£åˆ™ä¸­åŒ…å«gå‚æ•°), å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(str.search(<span class="regexp">/[d-g]/g</span>));<span class="comment">//3, ä¸æ— gå‚æ•°æ—¶,è¿”å›ç›¸åŒ</span></div></pre></td></tr></table></figure>
<h6 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h6><p>slice() æ–¹æ³•æå–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†, å¹¶è¿”å›æ–°çš„å­—ç¬¦ä¸². è¯¥æ–¹æ³•æœ‰äº›ç±»ä¼¼Array.prototype.slice æ–¹æ³•.</p>
<p>è¯­æ³•: <em>str</em>.slice(start, end)</p>
<p>é¦–å…ˆ end å‚æ•°å¯é€‰, startå¯å–æ­£å€¼, ä¹Ÿå¯å–è´Ÿå€¼. </p>
<p>å–æ­£å€¼æ—¶è¡¨ç¤ºä»ç´¢å¼•ä¸ºstartçš„ä½ç½®æˆªå–åˆ°endçš„ä½ç½®(ä¸åŒ…æ‹¬endæ‰€åœ¨ä½ç½®çš„å­—ç¬¦, å¦‚æœendçœç•¥åˆ™æˆªå–åˆ°å­—ç¬¦ä¸²æœ«å°¾).</p>
<p>å–è´Ÿå€¼æ—¶è¡¨ç¤ºä»ç´¢å¼•ä¸º length+start ä½ç½®æˆªå–åˆ°endæ‰€åœ¨ä½ç½®çš„å­—ç¬¦.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"It is our choices that show what we truly are, far more than our abilities."</span>;</div><div class="line"><span class="built_in">console</span>.log(str.slice(<span class="number">0</span>,<span class="number">-30</span>));<span class="comment">//It is our choices that show what we truly are</span></div><div class="line"><span class="built_in">console</span>.log(str.slice(<span class="number">-30</span>));<span class="comment">//, far more than our abilities.</span></div></pre></td></tr></table></figure>
<h6 id="split"><a href="#split" class="headerlink" title="split"></a>split</h6><p>split() æ–¹æ³•æŠŠåŸå­—ç¬¦ä¸²åˆ†å‰²æˆå­å­—ç¬¦ä¸²ç»„æˆæ•°ç»„, å¹¶è¿”å›è¯¥æ•°ç»„.</p>
<p>è¯­æ³•: <em>str</em>.split(separator, limit)</p>
<p>ä¸¤ä¸ªå‚æ•°å‡æ˜¯å¯é€‰çš„, å…¶ä¸­ separator è¡¨ç¤ºåˆ†éš”ç¬¦, å®ƒå¯ä»¥æ˜¯å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯æ­£åˆ™è¡¨è¾¾å¼. å¦‚æœå¿½ç•¥ separator, åˆ™è¿”å›çš„æ•°ç»„åŒ…å«ä¸€ä¸ªç”±åŸå­—ç¬¦ä¸²ç»„æˆçš„å…ƒç´ . å¦‚æœ separator æ˜¯ä¸€ä¸ªç©ºä¸², åˆ™ str å°†ä¼šè¢«åˆ†å‰²æˆä¸€ä¸ªç”±åŸå­—ç¬¦ä¸²ä¸­å­—ç¬¦ç»„æˆçš„æ•°ç»„. limit è¡¨ç¤ºä»è¿”å›çš„æ•°ç»„ä¸­æˆªå–å‰ limit ä¸ªå…ƒç´ , ä»è€Œé™å®šè¿”å›çš„æ•°ç»„é•¿åº¦.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"today is a sunny day"</span>;</div><div class="line"><span class="built_in">console</span>.log(str.split());<span class="comment">//["today is a sunny day"]</span></div><div class="line"><span class="built_in">console</span>.log(str.split(<span class="string">""</span>));<span class="comment">//["t", "o", "d", "a", "y", " ", "i", "s", " ", "a", " ", "s", "u", "n", "n", "y", " ", "d", "a", "y"]</span></div><div class="line"><span class="built_in">console</span>.log(str.split(<span class="string">" "</span>));<span class="comment">//["today", "is", "a", "sunny", "day"]</span></div></pre></td></tr></table></figure>
<p>ä½¿ç”¨limité™å®šè¿”å›çš„æ•°ç»„å¤§å°. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(str.split(<span class="string">" "</span>));<span class="comment">//["today"]</span></div></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ­£åˆ™åˆ†éš”ç¬¦(RegExp separator). å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(str.split(<span class="regexp">/\s*is\s*/</span>));<span class="comment">//["today", "a sunny day"]</span></div></pre></td></tr></table></figure>
<p>è‹¥æ­£åˆ™åˆ†éš”ç¬¦é‡ŒåŒ…å«æ•è·æ‹¬å·, åˆ™æ‹¬å·åŒ¹é…çš„ç»“æœå°†ä¼šåŒ…å«åœ¨è¿”å›çš„æ•°ç»„ä¸­.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(str.split(<span class="regexp">/(\s*is\s*)/</span>));<span class="comment">//["today", " is ", "a sunny day"]</span></div></pre></td></tr></table></figure>
<h6 id="substr"><a href="#substr" class="headerlink" title="substr"></a>substr</h6><p>substr() æ–¹æ³•è¿”å›å­—ç¬¦ä¸²æŒ‡å®šä½ç½®å¼€å§‹çš„æŒ‡å®šæ•°é‡çš„å­—ç¬¦.</p>
<p>è¯­æ³•: <em>str</em>.substr(start[, length])</p>
<p>start è¡¨ç¤ºå¼€å§‹æˆªå–å­—ç¬¦çš„ä½ç½®, å¯å–æ­£å€¼æˆ–è´Ÿå€¼. å–æ­£å€¼æ—¶è¡¨ç¤ºstartä½ç½®çš„ç´¢å¼•, å–è´Ÿå€¼æ—¶è¡¨ç¤º length+startä½ç½®çš„ç´¢å¼•.</p>
<p>length è¡¨ç¤ºæˆªå–çš„å­—ç¬¦é•¿åº¦.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"Yesterday is history. Tomorrow is mystery. But today is a gift."</span>;</div><div class="line"><span class="built_in">console</span>.log(str.substr(<span class="number">47</span>));<span class="comment">//today is a gift.</span></div><div class="line"><span class="built_in">console</span>.log(str.substr(<span class="number">-16</span>));<span class="comment">//today is a gift.</span></div></pre></td></tr></table></figure>
<p>ç›®å‰ Microsoftâ€™s JScript ä¸æ”¯æŒ start å‚æ•°å–è´Ÿçš„ç´¢å¼•, å¦‚éœ€åœ¨ IE ä¸‹æ”¯æŒ, è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/substr#Description" target="_blank" rel="external">Polyfill</a>.</p>
<h6 id="substring"><a href="#substring" class="headerlink" title="substring"></a>substring</h6><p>substring() æ–¹æ³•è¿”å›å­—ç¬¦ä¸²ä¸¤ä¸ªç´¢å¼•ä¹‹é—´çš„å­ä¸².</p>
<p>è¯­æ³•: <em>str</em>.substring(indexA[, indexB])</p>
<p>indexA, indexB è¡¨ç¤ºå­—ç¬¦ä¸²ç´¢å¼•, å…¶ä¸­ indexB å¯é€‰, å¦‚æœçœç•¥, åˆ™è¡¨ç¤ºè¿”å›ä» indexA åˆ°å­—ç¬¦ä¸²æœ«å°¾çš„å­ä¸².</p>
<p><strong>æè¿°</strong></p>
<p>substring è¦æˆªå–çš„æ˜¯ä» indexA åˆ° indexB(ä¸åŒ…å«)ä¹‹é—´çš„å­—ç¬¦, ç¬¦åˆä»¥ä¸‹è§„å¾‹:</p>
<ul>
<li>è‹¥ indexA == indexB, åˆ™è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²;</li>
<li>è‹¥ çœç•¥ indexB, åˆ™æå–å­—ç¬¦ä¸€ç›´åˆ°å­—ç¬¦ä¸²æœ«å°¾;</li>
<li>è‹¥ ä»»ä¸€å‚æ•°å°äº 0 æˆ– NaN, åˆ™è¢«å½“ä½œ 0;</li>
<li>è‹¥ ä»»ä¸€å‚æ•°å¤§äº length, åˆ™è¢«å½“ä½œ length.</li>
</ul>
<p>è€Œ å¦‚æœ indexA &gt; indexB, åˆ™ substring çš„æ‰§è¡Œæ•ˆæœå°±åƒæ˜¯ä¸¤ä¸ªå‚æ•°è°ƒæ¢ä¸€èˆ¬. æ¯”å¦‚: str.substring(0,1) == str.substring(1,0)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"Get outside every day. Miracles are waiting everywhere."</span>;</div><div class="line"><span class="built_in">console</span>.log(str.substring(<span class="number">1</span>,<span class="number">1</span>));<span class="comment">//""</span></div><div class="line"><span class="built_in">console</span>.log(str.substring(<span class="number">0</span>));<span class="comment">//Get outside every day. Miracles are waiting everywhere.</span></div><div class="line"><span class="built_in">console</span>.log(str.substring(<span class="number">-1</span>));<span class="comment">//Get outside every day. Miracles are waiting everywhere.</span></div><div class="line"><span class="built_in">console</span>.log(str.substring(<span class="number">0</span>,<span class="number">100</span>));<span class="comment">//Get outside every day. Miracles are waiting everywhere.</span></div><div class="line"><span class="built_in">console</span>.log(str.substring(<span class="number">22</span>,<span class="literal">NaN</span>));<span class="comment">//Get outside every day.</span></div></pre></td></tr></table></figure>
<h6 id="toLocaleLowerCase"><a href="#toLocaleLowerCase" class="headerlink" title="toLocaleLowerCase"></a>toLocaleLowerCase</h6><h6 id="toLocaleUpperCase"><a href="#toLocaleUpperCase" class="headerlink" title="toLocaleUpperCase"></a>toLocaleUpperCase</h6><p>toLocaleLowerCase() æ–¹æ³•è¿”å›è°ƒç”¨è¯¥æ–¹æ³•çš„å­—ç¬¦ä¸²è¢«è½¬æ¢æˆå°å†™çš„å€¼, è½¬æ¢è§„åˆ™æ ¹æ®æœ¬åœ°åŒ–çš„å¤§å°å†™æ˜ å°„. è€Œ toLocaleUpperCase() æ–¹æ³•åˆ™æ˜¯è½¬æ¢æˆå¤§å†™çš„å€¼.</p>
<p>è¯­æ³•: <em>str</em>.toLocaleLowerCase(), <em>str</em>.toLocaleUpperCase()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'ABCDEFG'</span>.toLocaleLowerCase());<span class="comment">//abcdefg</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'abcdefg'</span>.toLocaleUpperCase());<span class="comment">//ABCDEFG</span></div></pre></td></tr></table></figure>
<h6 id="toLowerCase"><a href="#toLowerCase" class="headerlink" title="toLowerCase"></a>toLowerCase</h6><h6 id="toUpperCase"><a href="#toUpperCase" class="headerlink" title="toUpperCase"></a>toUpperCase</h6><p>è¿™ä¸¤ä¸ªæ–¹æ³•åˆ†åˆ«è¡¨ç¤ºå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºç›¸åº”çš„å°å†™,å¤§å†™å½¢å¼, å¹¶è¿”å›. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'ABCDEFG'</span>.toLowerCase());<span class="comment">//abcdefg</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'abcdefg'</span>.toUpperCase());<span class="comment">//ABCDEFG</span></div></pre></td></tr></table></figure>
<h6 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString"></a>toString</h6><h6 id="valueOf-NaN"><a href="#valueOf-NaN" class="headerlink" title="valueOf"></a>valueOf</h6><p>è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯è¿”å›æŒ‡å®šå¯¹è±¡çš„å­—ç¬¦ä¸²å½¢å¼.</p>
<p>è¯­æ³•: <em>str</em>.toString(), <em>str</em>.valueOf()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"abc"</span>;</div><div class="line"><span class="built_in">console</span>.log(str.toString());<span class="comment">//abc</span></div><div class="line"><span class="built_in">console</span>.log(str.toString()==str.valueOf());<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>å°½ç®¡ä»–ä»¬æ˜¯å¦‚æ­¤çš„ç›¸ä¼¼, ä½†ä»èƒ½æŠ“ä½ä»–ä»¬ä¹‹é—´ç»†å¾®çš„å·®åˆ«, è¯·å°è¯•è¿è¡Œä»¥ä¸‹ä¸€æ®µä»£ç :</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = &#123;</div><div class="line">    <span class="attr">toString</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="string">"test"</span>; &#125;,</div><div class="line">    <span class="attr">valueOf</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="number">123</span>; &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">alert(x); <span class="comment">// test</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"x="</span> + x); <span class="comment">// "x=123"</span></div><div class="line"><span class="built_in">console</span>.log(x + <span class="string">"=x"</span>); <span class="comment">// "123=x"</span></div><div class="line"><span class="built_in">console</span>.log(x + <span class="string">"1"</span>); <span class="comment">// 1231</span></div><div class="line"><span class="built_in">console</span>.log(x + <span class="number">1</span>); <span class="comment">// 124</span></div><div class="line"><span class="built_in">console</span>.log([<span class="string">"x="</span>, x].join(<span class="string">""</span>)); <span class="comment">// "x=test"</span></div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å‘ç°å½“ â€œ+â€ æ“ä½œç¬¦å­˜åœ¨æ—¶, xè¶‹å‘äºè½¬æ¢ä¸ºæ•°å­—, è¡¨è¾¾å¼ä¼šä¼˜å…ˆè°ƒç”¨ valueOf æ–¹æ³•, å¦‚æœè°ƒç”¨æ•°ç»„çš„ join æ–¹æ³•, xè¶‹å‘äºè½¬æ¢ä¸ºå­—ç¬¦ä¸², è¡¨è¾¾å¼ä¼šä¼˜å…ˆè°ƒç”¨ toString æ–¹æ³•.</p>
<h6 id="trim"><a href="#trim" class="headerlink" title="trim"></a>trim</h6><p>trim() æ–¹æ³•æ¸…é™¤å­—ç¬¦ä¸²é¦–å°¾çš„ç©ºç™½å¹¶è¿”å›.</p>
<p>è¯­æ³•: <em>str</em>.trim()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">"    abc    "</span>.trim());<span class="comment">//abc</span></div></pre></td></tr></table></figure>
<p>trim() æ–¹æ³•æ˜¯ ECMAScript 5.1 æ ‡å‡†åŠ å…¥çš„, å®ƒå¹¶ä¸æ”¯æŒIE9ä»¥ä¸‹çš„ä½ç‰ˆæœ¬IEæµè§ˆå™¨, å¦‚éœ€æ”¯æŒ, è¯·å‚è€ƒä»¥ä¸‹å…¼å®¹å†™æ³•:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(!<span class="built_in">String</span>.prototype.trim) &#123;</div><div class="line">  <span class="built_in">String</span>.prototype.trim = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.replace(<span class="regexp">/^\s+|\s+$/g</span>,<span class="string">''</span>);</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h6 id="codePointAt"><a href="#codePointAt" class="headerlink" title="codePointAt"></a>codePointAt</h6><p>codePointAt() æ–¹æ³•è¿”å›ä½¿ç”¨UTF-16ç¼–ç çš„ç»™å®šä½ç½®çš„å€¼çš„éè´Ÿæ•´æ•°. è¯¥æ–¹æ³•éµå¾ª ES6æ ‡å‡†, å¹¶éæ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒ.</p>
<p>è¯­æ³•: <em>str</em>.codePointAt(position)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">"a"</span>.codePointAt(<span class="number">0</span>));<span class="comment">//97</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"\u4f60\u597d"</span>.codePointAt(<span class="number">0</span>));<span class="comment">//20320</span></div></pre></td></tr></table></figure>
<p>codePointAt ç¬¦åˆ ES6 æ ‡å‡†, å¦‚éœ€æ”¯æŒ, è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/codePointAt#Polyfill" target="_blank" rel="external">Polyfill</a> .</p>
<h6 id="contains"><a href="#contains" class="headerlink" title="contains"></a>contains</h6><p>contains() æ–¹æ³•å°šå¤„äº ES6 è§„èŒƒçš„è‰æ¡ˆä¸­, å®ƒç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦å±äºå¦ä¸€ä¸ªå­—ç¬¦, å¦‚æœæ˜¯, åˆ™è¿”å›true, å¦‚æœä¸æ˜¯, åˆ™è¿”å›false.</p>
<p>è¯­æ³•: <em>str</em>.contains(subString [, position])</p>
<p>subString è¡¨ç¤ºè¦æœç´¢çš„å­—ç¬¦ä¸², position è¡¨ç¤ºä»å½“å‰å­—ç¬¦ä¸²çš„å“ªä¸ªä½ç½®å¼€å§‹æœç´¢å­—ç¬¦ä¸², é»˜è®¤å€¼ä¸º0.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"Practice makes perfect."</span>;</div><div class="line"><span class="built_in">console</span>.log(str.contains(<span class="string">"perfect"</span>));<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(str.contains(<span class="string">"perfect"</span>,<span class="number">100</span>));<span class="comment">//false</span></div></pre></td></tr></table></figure>
<p>å®é™…ä¸Š, ç›®å‰åªæœ‰ Firefox 17åŠä¹‹åçš„ç‰ˆæœ¬å®ç°äº†è¯¥æ–¹æ³•.</p>
<h6 id="endsWith"><a href="#endsWith" class="headerlink" title="endsWith"></a>endsWith</h6><p>endsWith() æ–¹æ³•åŸºæœ¬ä¸ contains() åŠŸèƒ½ç›¸åŒ, ä¸åŒçš„æ˜¯, å®ƒç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯åŸå­—ç¬¦ä¸²çš„ç»“å°¾. è‹¥æ˜¯åˆ™è¿”å›true, å¦åˆ™è¿”å›false.</p>
<p>è¯­æ³•: <em>str</em>.endsWith(substring [, position])</p>
<p>ä¸contains æ–¹æ³•ä¸åŒ, position å‚æ•°çš„é»˜è®¤å€¼ä¸ºå­—ç¬¦ä¸²é•¿åº¦.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"Learn and live."</span>;</div><div class="line"><span class="built_in">console</span>.log(str.endsWith(<span class="string">"live."</span>));<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(str.endsWith(<span class="string">"Learn"</span>,<span class="number">5</span>));<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>åŒæ ·ç›®å‰åªæœ‰ Firefox 17ç‰ˆæœ¬åŠä¹‹åçš„ç‰ˆæœ¬å®ç°äº†è¯¥æ–¹æ³•. å…¶ä»–æµè§ˆå™¨è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith#Polyfill" target="_blank" rel="external">Polyfill</a>.</p>
<h6 id="normalize"><a href="#normalize" class="headerlink" title="normalize"></a>normalize</h6><p>normalize() æ–¹æ³•å°šå¤„äº ES6 è§„èŒƒçš„è‰æ¡ˆä¸­, å®ƒä¼šæŒ‰ç…§æŒ‡å®šçš„ Unicode æ­£è§„å½¢å¼å°†åŸå­—ç¬¦ä¸²æ­£è§„åŒ–.</p>
<p>è¯­æ³•: <em>str</em>.normalize([form])</p>
<p>form å‚æ•°å¯çœç•¥, ç›®å‰æœ‰å››ç§ Unicode æ­£è§„å½¢å¼, å³ â€œNFCâ€, â€œNFDâ€, â€œNFKCâ€ ä»¥åŠ â€œNFKDâ€, formçš„é»˜è®¤å€¼ä¸º â€œNFCâ€. å¦‚æœform ä¼ å…¥äº†éæ³•çš„å‚æ•°å€¼, åˆ™ä¼šæŠ›å‡º RangeError å¼‚å¸¸.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"\u4f60\u597d"</span>;</div><div class="line"><span class="built_in">console</span>.log(str.normalize());<span class="comment">//ä½ å¥½</span></div><div class="line"><span class="built_in">console</span>.log(str.normalize(<span class="string">"NFC"</span>));<span class="comment">//ä½ å¥½</span></div><div class="line"><span class="built_in">console</span>.log(str.normalize(<span class="string">"NFD"</span>));<span class="comment">//ä½ å¥½</span></div><div class="line"><span class="built_in">console</span>.log(str.normalize(<span class="string">"NFKC"</span>));<span class="comment">//ä½ å¥½</span></div><div class="line"><span class="built_in">console</span>.log(str.normalize(<span class="string">"NFKD"</span>));<span class="comment">//ä½ å¥½</span></div></pre></td></tr></table></figure>
<p>ç›®å‰åªæœ‰ Chrome, Firefox æµè§ˆå™¨å®ç°äº†è¯¥æ–¹æ³•.</p>
<h6 id="repeat"><a href="#repeat" class="headerlink" title="repeat"></a>repeat</h6><p>repeat() æ–¹æ³•å°šå¤„äº ES6 è§„èŒƒçš„è‰æ¡ˆä¸­, å®ƒè¿”å›é‡å¤åŸå­—ç¬¦ä¸²å¤šæ¬¡çš„æ–°å­—ç¬¦ä¸².</p>
<p>è¯­æ³•: <em>str</em>.repeat(count)</p>
<p>count å‚æ•°åªèƒ½å–å¤§äºç­‰äº0 çš„æ•°å­—, è‹¥è¯¥æ•°å­—ä¸ä¸ºæ•´æ•°, å°†è‡ªåŠ¨è½¬æ¢ä¸ºæ•´æ•°å½¢å¼. å¦‚æœå–è´Ÿæ•°æˆ–è€…å…¶ä»–å€¼å°†æŠ¥é”™</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"A still tongue makes a wise head."</span>;</div><div class="line"><span class="built_in">console</span>.log(str.repeat(<span class="number">0</span>));<span class="comment">//""</span></div><div class="line"><span class="built_in">console</span>.log(str.repeat(<span class="number">1</span>));<span class="comment">//A still tongue makes a wise head.</span></div><div class="line"><span class="built_in">console</span>.log(str.repeat(<span class="number">1.5</span>));<span class="comment">//A still tongue makes a wise head.</span></div><div class="line"><span class="built_in">console</span>.log(str.repeat(<span class="number">-1</span>));<span class="comment">//RangeError:Invalid count value</span></div></pre></td></tr></table></figure>
<p>ç›®å‰åªæœ‰ Chrome 41, Firefox 24ç‰ˆæœ¬æµè§ˆå™¨å®ç°äº†è¯¥æ–¹æ³•. å…¶ä»–æµè§ˆå™¨è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/repeat#Polyfill" target="_blank" rel="external">Polyfill</a>.</p>
<h6 id="startsWith"><a href="#startsWith" class="headerlink" title="startsWith"></a>startsWith</h6><p>startsWith() æ–¹æ³•ç”¨æ¥åˆ¤æ–­å½“å‰å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ä»¥ç»™å®šå­—ç¬¦ä¸²å¼€å§‹çš„, è‹¥æ˜¯åˆ™è¿”å›true, å¦åˆ™è¿”å›false.</p>
<p>è¯­æ³•: <em>str</em>.startsWith(subString [, position])</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"Where there is a will, there is a way."</span>;</div><div class="line"><span class="built_in">console</span>.log(str.startsWith(<span class="string">"Where"</span>));<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(str.startsWith(<span class="string">"there"</span>,<span class="number">6</span>));<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>ç›®å‰åªæœ‰ Firefox 17 ç‰ˆæœ¬å®ç°äº†è¯¥æ–¹æ³•, å…¶ä»–æµè§ˆå™¨è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith#Polyfill" target="_blank" rel="external">Polyfill</a>.</p>
<p>å…¶å®ƒéæ ‡å‡†çš„æ–¹æ³•æš‚æ—¶ä¸ä½œä»‹ç». å¦‚éœ€äº†è§£è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/prototype" target="_blank" rel="external">String.prototype - JavaScript | MDN</a> ä¸­æ ‡æ³¨ä¸ºæ„Ÿå¹å·çš„æ–¹æ³•.</p>
<h5 id="HTMLæœ‰å…³çš„æ–¹æ³•"><a href="#HTMLæœ‰å…³çš„æ–¹æ³•" class="headerlink" title="HTMLæœ‰å…³çš„æ–¹æ³•"></a>HTMLæœ‰å…³çš„æ–¹æ³•</h5><p>å¸¸ç”¨çš„æ–¹æ³•æœ‰ anchor, link å…¶å®ƒæ–¹æ³•å¦‚ big, blink, bold, fixed, fontcolor, fontsize, italics, small, strike, sub, supå‡å·²åºŸé™¤.</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä»‹ç» anchorå’Œlink ä¸¤ä¸ªæ–¹æ³•, å…¶ä»–åºŸé™¤æ–¹æ³•ä¸ä½œä»‹ç».</p>
<h6 id="anchor"><a href="#anchor" class="headerlink" title="anchor"></a>anchor</h6><p>anchor() æ–¹æ³•åˆ›å»ºä¸€ä¸ªé”šæ ‡ç­¾.</p>
<p>è¯­æ³•: <em>str</em>.anchor(name)</p>
<p>name æŒ‡å®šè¢«åˆ›å»ºçš„aæ ‡ç­¾çš„nameå±æ€§, ä½¿ç”¨è¯¥æ–¹æ³•åˆ›å»ºçš„é”šç‚¹, å°†ä¼šæˆä¸º document.anchors æ•°ç»„çš„å…ƒç´ .</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"this is a anchor tag"</span>;</div><div class="line"><span class="built_in">document</span>.body.innerHTML = <span class="built_in">document</span>.body.innerHTML + str.anchor(<span class="string">"anchor1"</span>);<span class="comment">//bodyæœ«å°¾å°†ä¼šè¿½åŠ è¿™äº›å†…å®¹ &lt;a name="anchor1"&gt;this is a anchor tag&lt;/a&gt;</span></div></pre></td></tr></table></figure>
<h6 id="link"><a href="#link" class="headerlink" title="link"></a>link</h6><p>link() æ–¹æ³•åŒæ ·åˆ›å»ºä¸€ä¸ªaæ ‡ç­¾.</p>
<p>è¯­æ³•: <em>str</em>.link(url)</p>
<p>url æŒ‡å®šè¢«åˆ›å»ºçš„aæ ‡ç­¾çš„hrefå±æ€§, å¦‚æœurlä¸­åŒ…å«ç‰¹æ®Šå­—ç¬¦, å°†è‡ªåŠ¨è¿›è¡Œç¼–ç . ä¾‹å¦‚ &amp;ä¼šè¢«è½¬ä¹‰ä¸º &amp;, â€œ ä¼šè¢«è½¬ä¹‰ä¸º â€œ &amp;\quot; ä½¿ç”¨è¯¥æ–¹æ³•åˆ›å»ºçš„aæ ‡ç­¾, å°†ä¼šæˆä¸º document.links æ•°ç»„ä¸­çš„å…ƒç´ .</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"ç™¾åº¦"</span>;</div><div class="line"><span class="built_in">document</span>.write(str.link(<span class="string">"https://www.baidu.com"</span>));<span class="comment">//&lt;a href="https://www.baidu.com"&gt;ç™¾åº¦&lt;/a&gt;</span></div></pre></td></tr></table></figure>
<hr>
<p>å®é™…ä¸Š String.prototype ä¸­, å¸¸ç”¨çš„æ–¹æ³•å°±charAt, indexOf, lastIndexOf, match, replace, search, slice, split, substr, substring, toLowerCase, toUpperCase, trim, valueof ç­‰è¿™äº›. ç†Ÿæ‚‰å®ƒä»¬çš„è¯­æ³•è§„åˆ™å°±èƒ½ç†Ÿç»ƒåœ°é©¾é©­å­—ç¬¦ä¸².</p>
<hr>
<p>æœ¬æ–‡å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/01/12/js.String/">http://louiszhai.github.io/2016/01/12/js.String/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/prototype" target="_blank" rel="external">String.prototype - JavaScript | MDN</a></li>
<li><a href="http://stackoverflow.com/questions/2485632/valueof-vs-tostring-in-javascript" target="_blank" rel="external">valueOf() vs. toString() in Javascript - Stack Overflow</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      JavaScript String String.prototype indexOf charAt match search split valueOf trim substr substring
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://louiszhai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Function.prototype.bindæ–¹æ³•æŒ‡å—</title>
    <link href="http://louiszhai.github.io/2016/01/11/bind/"/>
    <id>http://louiszhai.github.io/2016/01/11/bind/</id>
    <published>2016-01-11T00:01:33.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>ES5æ–°å¢äº† Function.prototype.bind æ–¹æ³•, è¯¥æ–¹æ³•ä¸åŒäºjqueryçš„bind æ–¹æ³•, å®ƒä¸»è¦ç”¨äºå›ºå®š this ä½œç”¨åŸŸ, é¿å…å„ç§ç”±äºä¸Šä¸‹æ–‡åˆ‡æ¢é€ æˆçš„è¯­ä¹‰é—®é¢˜. å¸¸ç”¨åœ¨ setTimeout, forå¾ªç¯ç­‰å†…éƒ¨.</p>
<a id="more"></a>
<h3 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h3><p>è¯­æ³•: func.bind(thisArg, arg1, arg2, â€¦.)</p>
<p>bind() æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°å‡½æ•°, åˆå«ç»‘å®šå‡½æ•°, å½“è°ƒç”¨è¿™ä¸ªç»‘å®šå‡½æ•°æ—¶, ç»‘å®šå‡½æ•°ä¼šä»¥åˆ›å»ºå®ƒæ—¶ä¼ å…¥ bind() æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå½“å‰çš„ä¸Šä¸‹æ–‡, å³this, ä¼ å…¥ bind() æ–¹æ³•çš„ç¬¬äºŒä¸ªåŠä¹‹åçš„å‚æ•°åŠ ä¸Šç»‘å®šå‡½æ•°è¿è¡Œæ—¶è‡ªèº«çš„å‚æ•°æŒ‰ç…§é¡ºåºä½œä¸ºåŸå‡½æ•°çš„å‚æ•°æ¥è°ƒç”¨åŸå‡½æ•°.</p>
<p>ç»‘å®šå‡½æ•°ä¹Ÿèƒ½ä½¿ç”¨newæ“ä½œç¬¦åˆ›å»ºå¯¹è±¡; è¿™å°±å¥½æ¯”æŠŠåŸå‡½æ•°å½“åšæ„é€ å™¨. æ­¤æ—¶æä¾›çš„thiså°†è¢«å¿½ç•¥, thisä¹‹åçš„å‚æ•°å°†ä¾ç„¶å‰ç½®åˆ°è¿è¡Œæ—¶çš„å‚æ•°åˆ—è¡¨ä¸­.</p>
<h4 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h4><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹bind çš„åŸºæœ¬ç”¨æ³•.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">8</span>;</div><div class="line"><span class="keyword">var</span> o = &#123;</div><div class="line">  <span class="attr">x</span>: <span class="number">10</span>,</div><div class="line">  <span class="attr">getX</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  	<span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> f = o.getX;</div><div class="line">f();<span class="comment">//8, ç”±äºæ²¡æœ‰ç»‘å®šæ‰§è¡Œæ—¶çš„ä¸Šä¸‹æ–‡, thisé»˜è®¤æŒ‡å‘window, æ‰“å°äº†å…¨å±€å˜é‡xçš„å€¼</span></div><div class="line"><span class="keyword">var</span> g = f.bind(o);</div><div class="line">g();<span class="comment">//10, ç»‘å®šthiså, æˆåŠŸçš„æ‰“å°äº†oå¯¹è±¡çš„xå±æ€§çš„å€¼.</span></div></pre></td></tr></table></figure>
<h4 id="åˆ†ç¦»å‚æ•°"><a href="#åˆ†ç¦»å‚æ•°" class="headerlink" title="åˆ†ç¦»å‚æ•°"></a>åˆ†ç¦»å‚æ•°</h4><p>bind() æ–¹æ³•è¿˜å¯ä»¥è®¾ç½®å‡½æ•°æ‹¥æœ‰çš„åˆå§‹å‚æ•°. è¿™äº›å‚æ•°ä½œä¸ºbind() çš„ç¬¬2,3â€¦ä¸ªå‚æ•°è·Ÿåœ¨this(æˆ–å…¶ä»–å¯¹è±¡çš„åé¢), è°ƒç”¨ç»‘å®šå‡½æ•°æ—¶, è¿™äº›å‚æ•°å°†æ’å…¥åˆ°å‚æ•°åˆ—è¡¨çš„æœ€å¼€å§‹ä½ç½®, è€Œä¼ é€’ç»™ç»‘å®šå‡½æ•°çš„å‚æ•°å°†è·Ÿåœ¨ä»–ä»¬åé¢.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ‰“å°åä¸ªæ–æ³¢é‚£å¥‘æ•°</span></div><div class="line"><span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span>(<span class="params">n1, n2, length</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="built_in">arguments</span>.length&lt;<span class="number">3</span>) <span class="built_in">console</span>.log(<span class="string">'å‚æ•°ä¸å¤Ÿ...'</span>);</div><div class="line">  <span class="keyword">var</span> array = [n1, n2];</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">2</span>;i&lt;length;i++)&#123;</div><div class="line">  	array[i] = array[i<span class="number">-2</span>] + array[i<span class="number">-1</span>];</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> g = f.bind(<span class="literal">null</span>, <span class="number">1</span>, <span class="number">1</span>);</div><div class="line"><span class="built_in">console</span>.log(g(<span class="number">10</span>));<span class="comment">//[1, 1, 2, 3, 5, 8, 13, 21, 34, 55]</span></div></pre></td></tr></table></figure>
<h4 id="ç»‘å®šå‚æ•°"><a href="#ç»‘å®šå‚æ•°" class="headerlink" title="ç»‘å®šå‚æ•°"></a>ç»‘å®šå‚æ•°</h4><p>å¦‚æœä½¿ç”¨new æ“ä½œç¬¦å»æ„é€ ç»‘å®šå‡½æ•°çš„å®ä¾‹æ—¶, åŸæ¥æä¾›çš„this å°†è¢«å¿½ç•¥, thisä¹‹åçš„å‚æ•°å°†ä¾ç„¶å‰ç½®åˆ°æ„é€ å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸­. æ­¤æ—¶ bind() æ–¹æ³•ä¾¿å…·å¤‡äº†ä¿ç•™å‚æ•°çš„èƒ½åŠ›, æˆ‘ä»¬å¯ä»¥æ­¤è¾¾åˆ°ç±»ä¼¼æŸ¯é‡ŒåŒ–çš„æ•ˆæœ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="built_in">arguments</span>.length!=<span class="number">0</span>)</div><div class="line">  	<span class="keyword">this</span>.sum = <span class="built_in">Array</span>.prototype.reduce.call(<span class="built_in">arguments</span>,<span class="function"><span class="keyword">function</span>(<span class="params">prev,item</span>)</span>&#123;<span class="comment">//å¯¹ä¼ å…¥å‚æ•°æ±‚å’Œ</span></div><div class="line"> 		<span class="keyword">return</span> prev + item;</div><div class="line">	&#125;);</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.join.call(<span class="built_in">arguments</span>);<span class="comment">// è¿”å›ä¼ å…¥å‚æ•°çš„å­—ç¬¦ä¸²å½¢å¼</span></div><div class="line">&#125;</div><div class="line">f.prototype.toString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.sum;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> g = f.bind(<span class="literal">null</span>,<span class="number">2</span>);</div><div class="line"><span class="keyword">var</span> x = <span class="keyword">new</span> g(<span class="number">8</span>);</div><div class="line"><span class="built_in">console</span>.log(x.toString());<span class="comment">//10, å¯è§xè¢«ç»‘å®šäº†2+8=10</span></div><div class="line"><span class="built_in">console</span>.log(g(<span class="number">8</span>));<span class="comment">//2,8 è¿™å‘Šè¯‰æˆ‘ä»¬ç»‘å®šçš„ä¸¤ä¸ªå‚æ•°æ­£æ˜¯2å’Œ8</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(x <span class="keyword">instanceof</span> g);<span class="comment">//true, å¯è§é€šè¿‡newåˆ›å»ºçš„xç»§æ‰¿äº†g</span></div><div class="line"><span class="built_in">console</span>.log(x <span class="keyword">instanceof</span> f);<span class="comment">//true, å¯è§xä¹Ÿç»§æ‰¿äº†f</span></div><div class="line"><span class="built_in">console</span>.log(g <span class="keyword">instanceof</span> <span class="built_in">Function</span>);<span class="comment">//true, å¯è§bind f()æ–¹æ³•ä¹‹å, è¿”å›äº†ä¸€ä¸ªæ–°çš„å‡½æ•°g</span></div><div class="line"><span class="comment">//å‡½æ•°gå¯ç”¨äºæ±‚å’Œ,å¦‚ä¸‹:</span></div><div class="line"><span class="built_in">console</span>.log(g(<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>));<span class="comment">//27 2+1+3+5+7+9=27</span></div></pre></td></tr></table></figure>
<h4 id="å¿«æ·è°ƒç”¨"><a href="#å¿«æ·è°ƒç”¨" class="headerlink" title="å¿«æ·è°ƒç”¨"></a>å¿«æ·è°ƒç”¨</h4><p>ä½¿ç”¨Array.prototypeçš„æ–¹æ³•å¤„ç†ç±»æ•°ç»„å¯¹è±¡æ—¶(é¸­å¼è¾¨å‹), ä¸å¯é¿å…çš„éœ€è¦å€Ÿç”¨call æˆ–è€… apply æ–¹æ³•, ä½¿ç”¨ bind() æ–¹æ³•, æˆ‘ä»¬å¯ä»¥ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _slice = <span class="built_in">Array</span>.prototype.slice;</div><div class="line"><span class="keyword">var</span> slice = <span class="built_in">Function</span>.prototype.call.bind(_slice);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> slice(<span class="built_in">arguments</span>,<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line">f(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>);<span class="comment">//[2, 3, 4, 5]</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢çš„å®ä¾‹å°†è§£é‡Š bind() æ–¹æ³•åšäº†ä¸€ä»¶ä»€ä¹ˆäº‹æƒ…:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _slice = <span class="built_in">Array</span>.prototype.slice;</div><div class="line"><span class="keyword">var</span> slice = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> _slice.apply(<span class="built_in">arguments</span>[<span class="number">0</span>],_slice.call(<span class="built_in">arguments</span>,<span class="number">1</span>));</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> slice(<span class="built_in">arguments</span>,<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line">f(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>);<span class="comment">//[2, 3, 4, 5]</span></div></pre></td></tr></table></figure>
<p>å¦‚ä¸‹, æ˜¯bind() æ–¹æ³•çš„ç®€å•å®ç°.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Function</span>.prototype.bind = <span class="function"><span class="keyword">function</span>(<span class="params">thisArg,argN</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> _this = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">var</span> _arg = _slice.call(<span class="built_in">arguments</span>,<span class="number">1</span>);</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   	<span class="keyword">var</span> arg = _slice.call(<span class="built_in">arguments</span>);</div><div class="line">    arg = _arg.concat(arg);</div><div class="line">  	<span class="keyword">return</span> _this.apply(thisArg,arg);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºæ¥, ä½¿ç”¨ bind() æ–¹æ³•å, ä»£ç ä¼˜é›…å¾—å¤š.</p>
<p>æ³¨: ä½œä¸ºES5æ ‡å‡†åŠ å…¥çš„bindæ–¹æ³•æ˜¾ç„¶ä¸æ”¯æŒ IE9ä¹‹å‰çš„ä½ç‰ˆæœ¬IE, å¦‚éœ€ä½¿ç”¨, è¯·å‚è€ƒ<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind#Compatibility" target="_blank" rel="external">Polyfill</a>.</p>
<hr>
<p>æœ¬æ–‡å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/01/11/bind/">http://louiszhai.github.io/2016/01/11/bind/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind" target="_blank" rel="external">Function.prototype.bind() - JavaScript | MDN</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      JavaScript bind Function.prototype.bind call apply
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://louiszhai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>ç”±åŒæºç­–ç•¥åˆ°å‰ç«¯è·¨åŸŸ</title>
    <link href="http://louiszhai.github.io/2016/01/11/cross-domain/"/>
    <id>http://louiszhai.github.io/2016/01/11/cross-domain/</id>
    <published>2016-01-11T00:01:33.000Z</published>
    <updated>2017-03-03T15:04:59.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>åŒæºç­–ç•¥ (Same-Origin Policy) æœ€æ—©ç”± Netscape å…¬å¸æå‡º, æ‰€è°“åŒæºå°±æ˜¯è¦æ±‚, åŸŸå, åè®®, ç«¯å£ç›¸åŒ. éåŒæºçš„è„šæœ¬ä¸èƒ½è®¿é—®æˆ–è€…æ“ä½œå…¶ä»–åŸŸçš„é¡µé¢å¯¹è±¡(å¦‚DOMç­‰). ä½œä¸ºè‘—åçš„å®‰å…¨ç­–ç•¥, è™½ç„¶å®ƒåªæ˜¯ä¸€ä¸ªè§„èŒƒ, å¹¶ä¸å¼ºåˆ¶è¦æ±‚,  ä½†ç°åœ¨æ‰€æœ‰æ”¯æŒ javaScript çš„æµè§ˆå™¨éƒ½ä¼šä½¿ç”¨è¿™ä¸ªç­–ç•¥. ä»¥è‡³äºè¯¥ç­–ç•¥æˆä¸ºæµè§ˆå™¨æœ€æ ¸å¿ƒæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½, å¦‚æœç¼ºå°‘äº†åŒæºç­–ç•¥, webçš„å®‰å…¨å°†æ— ä»è°ˆèµ·.</p>
<a id="more"></a>
<h3 id="åŒæºç­–ç•¥çš„é™åˆ¶"><a href="#åŒæºç­–ç•¥çš„é™åˆ¶" class="headerlink" title="åŒæºç­–ç•¥çš„é™åˆ¶"></a>åŒæºç­–ç•¥çš„é™åˆ¶</h3><p>åŒæºç­–ç•¥ä¸‹çš„webä¸–ç•Œ, åŸŸçš„å£å’é«˜ç­‘, ä»è€Œä¿è¯å„ä¸ªç½‘é¡µç›¸äº’ç‹¬ç«‹, äº’ç›¸ä¹‹é—´ä¸èƒ½ç›´æ¥è®¿é—®, iframe, ajax å‡å—å…¶é™åˆ¶, è€Œscriptæ ‡ç­¾ä¸å—æ­¤é™åˆ¶.</p>
<p>æ³¨: ä»¥ä¸‹å¦‚éç‰¹åˆ«è¯´æ˜, å‡æŒ‡éCORSçš„, æ™®é€šè·¨åŸŸè¯·æ±‚.</p>
<h4 id="iframeé™åˆ¶"><a href="#iframeé™åˆ¶" class="headerlink" title="iframeé™åˆ¶"></a>iframeé™åˆ¶</h4><ul>
<li>å¯ä»¥è®¿é—®åŒåŸŸèµ„æº, å¯è¯»å†™;</li>
<li>è®¿é—®è·¨åŸŸé¡µé¢æ—¶, åªè¯».</li>
</ul>
<h4 id="Ajaxé™åˆ¶"><a href="#Ajaxé™åˆ¶" class="headerlink" title="Ajaxé™åˆ¶"></a>Ajaxé™åˆ¶</h4><p>Ajax çš„é™åˆ¶æ¯” iframe é™åˆ¶æ›´ä¸¥.</p>
<ul>
<li>åŒåŸŸèµ„æºå¯è¯»å†™;</li>
<li>è·¨åŸŸè¯·æ±‚ä¼šç›´æ¥è¢«æµè§ˆå™¨æ‹¦æˆª.(chromeä¸‹è·¨åŸŸè¯·æ±‚ä¸ä¼šå‘èµ·, å…¶ä»–æµè§ˆå™¨ä¸€èˆ¬æ˜¯å¯å‘é€è·¨åŸŸè¯·æ±‚, ä½†å“åº”è¢«æµè§ˆå™¨æ‹¦æˆª)</li>
</ul>
<h4 id="Scripté™åˆ¶"><a href="#Scripté™åˆ¶" class="headerlink" title="Scripté™åˆ¶"></a>Scripté™åˆ¶</h4><p>scriptå¹¶æ— è·¨åŸŸé™åˆ¶, è¿™æ˜¯å› ä¸ºscriptæ ‡ç­¾å¼•å…¥çš„æ–‡ä»¶ä¸èƒ½å¤Ÿè¢«å®¢æˆ·ç«¯çš„ js è·å–åˆ°, ä¸ä¼šå½±å“åˆ°åŸé¡µé¢çš„å®‰å…¨, å› æ­¤scriptæ ‡ç­¾å¼•å…¥çš„æ–‡ä»¶æ²¡å¿…è¦éµå¾ªæµè§ˆå™¨çš„åŒæºç­–ç•¥. ç›¸å, ajax åŠ è½½çš„æ–‡ä»¶å†…å®¹å¯è¢«å®¢æˆ·ç«¯ js è·å–åˆ°, å¼•å…¥çš„æ–‡ä»¶å†…å®¹å¯èƒ½ä¼šæ³„æ¼æˆ–è€…å½±å“åŸé¡µé¢å®‰å…¨, æ•…, ajaxå¿…é¡»éµå¾ªåŒæºç­–ç•¥.</p>
<h4 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h4><p>åŒæºç­–ç•¥è¦æ±‚ä¸‰åŒ, å³: <strong>åŒåŸŸ</strong>, <strong>åŒåè®®</strong>, <strong>åŒç«¯å£</strong>.</p>
<ul>
<li>åŒåŸŸå³hostç›¸åŒ, é¡¶çº§åŸŸå, ä¸€çº§åŸŸå, äºŒçº§åŸŸå, ä¸‰çº§åŸŸåç­‰å¿…é¡»ç›¸åŒ, ä¸”åŸŸåä¸èƒ½ä¸ ip å¯¹åº”;</li>
<li>åŒåè®®è¦æ±‚, httpä¸httpsåè®®å¿…é¡»ä¿æŒä¸€è‡´;</li>
<li>åŒç«¯å£è¦æ±‚, ç«¯å£å·å¿…é¡»ç›¸åŒ.</li>
</ul>
<p>IEæœ‰äº›ä¾‹å¤–, å®ƒä»…ä»…åªæ˜¯éªŒè¯ä¸»æœºåä»¥åŠè®¿é—®åè®®ï¼Œè€Œå¿½ç•¥äº†ç«¯å£å·.</p>
<p>è¿™é‡Œéœ€è¦æ¾„æ¸…ä¸€ä¸ªæ¦‚å¿µ, æ‰€è°“çš„åŸŸ, è·Ÿ js ç­‰èµ„æºçš„å­˜æ”¾æœåŠ¡å™¨æ²¡æœ‰å…³ç³», æ¯”å¦‚ä½ åˆ° baidu.com ä½¿ç”¨ script æ ‡ç­¾è¯·æ±‚äº† google.com ä¸‹çš„js, é‚£ä¹ˆè¯¥ js æ‰€åœ¨åŸŸæ˜¯ baidu.com, è€Œä¸æ˜¯ google.com. æ¢è¨€ä¹‹, å®ƒèƒ½æ“ä½œbaidu.comçš„é¡µé¢å¯¹è±¡, å´ä¸èƒ½æ“ä½œgoogle.comçš„é¡µé¢å¯¹è±¡.</p>
<h3 id="è·¨åŸŸè®¿é—®"><a href="#è·¨åŸŸè®¿é—®" class="headerlink" title="è·¨åŸŸè®¿é—®"></a>è·¨åŸŸè®¿é—®</h3><p>å®é™…ä¸Š, æˆ‘ä»¬åˆä¸å¯é¿å…åœ°éœ€è¦åšä¸€äº›è·¨åŸŸçš„è¯·æ±‚, ä¸‹é¢æä¾›å‡ ç§æ–¹æ¡ˆå»ç»•è¿‡åŒæºç­–ç•¥:</p>
<h4 id="ä½¿ç”¨ä»£ç†"><a href="#ä½¿ç”¨ä»£ç†" class="headerlink" title="ä½¿ç”¨ä»£ç†"></a>ä½¿ç”¨ä»£ç†</h4><p>è™½ç„¶ajaxå’Œiframeå—åŒæºç­–ç•¥é™åˆ¶, ä½†æœåŠ¡å™¨ç«¯ä»£ç è¯·æ±‚, å´ä¸å—æ­¤é™åˆ¶, æˆ‘ä»¬å¯ä»¥åŸºäºæ­¤å»ä¼ªé€ ä¸€ä¸ªåŒæºè¯·æ±‚, å®ç°è·¨åŸŸçš„è®¿é—®. å¦‚ä¸‹ä¾¿æ˜¯å®ç°æ€è·¯:</p>
<ol>
<li>è¯·æ±‚åŒåŸŸä¸‹çš„webæœåŠ¡å™¨;</li>
<li>webæœåŠ¡å™¨åƒä»£ç†ä¸€æ ·å»è¯·æ±‚çœŸæ­£çš„ç¬¬ä¸‰æ–¹æœåŠ¡å™¨;</li>
<li>ä»£ç†æ‹¿åˆ°æ•°æ®è¿‡å, ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ajax.</li>
</ol>
<p>è¿™æ ·, æˆ‘ä»¬ä¾¿æ‹¿åˆ°äº†è·¨åŸŸæ•°æ®.</p>
<h4 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h4><p>ç”±ä¸Š, scriptæ ‡ç­¾å¹¶ä¸å—åŒæºç­–ç•¥çº¦æŸ, åŸºäºscript æ ‡ç­¾å¯åš jsonp å½¢å¼çš„è®¿é—®, å¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹æœåŠ¡å™¨ç”ŸæˆåŠ¨æ€çš„jsä»£ç æ¥å›è°ƒæœ¬åœ°çš„jsæ–¹æ³•ï¼Œè€Œæ–¹æ³•ä¸­çš„å‚æ•°åˆ™ç”±ç¬¬ä¸‰æ–¹æœåŠ¡å™¨åœ¨åå°è·å–ï¼Œå¹¶ä»¥JSONçš„å½¢å¼å¡«å……åˆ°JSæ–¹æ³•å½“ä¸­. å³ JSON with Padding. å…·ä½“å¦‚ä¸‹:</p>
<p>1) å¯ç”¨jsç”Ÿæˆä»¥ä¸‹html ä»£ç , å»åšjsonpçš„è¯·æ±‚.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"https://www.targetDomain.com/jsonp?callback=callbackName"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ jquery, å³</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">jQuery.getJSON(</div><div class="line">  <span class="string">"https://www.yourdomain.com/jsonp?callback=?"</span>,</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">"name: "</span> + data.name);</div><div class="line">  &#125;</div><div class="line">);</div></pre></td></tr></table></figure>
<p>å…¶ä¸­å›è°ƒå‡½æ•°å â€œcallbackâ€ ä¸º â€œ?â€, å³ä¸éœ€è¦ç”¨æˆ·æŒ‡å®šï¼Œè€Œæ˜¯ç”±jqueryç”Ÿæˆ.</p>
<p>2) æœåŠ¡å™¨ç«¯,ä»¥ java ä¸ºä¾‹, å‚è€ƒå¦‚ä¸‹: </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</div><div class="line">  //è·å–JSONæ•°æ®</div><div class="line">  String jsonData = "&#123;\"name\":\"jsonp\""&#125;";</div><div class="line">  //è·å–å›è°ƒå‡½æ•°å</div><div class="line">  String callback = req.getParameter("callback");  </div><div class="line">  //æ‹¼æ¥åŠ¨æ€JSä»£ç </div><div class="line">  String output = callback + "(" + jsonData + ");</div><div class="line">    resp.setContentType("text/javascript");</div><div class="line">  PrintWriter out = resp.getWriter();</div><div class="line">  out.println(output);</div><div class="line">  // å“åº”ä¸º callbackName(&#123;\"name\":\"jsonp\""&#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="postMessage"><a href="#postMessage" class="headerlink" title="postMessage"></a>postMessage</h4><p>ES5æ–°å¢çš„ postMessage() æ–¹æ³•å…è®¸æ¥è‡ªä¸åŒæºçš„è„šæœ¬é‡‡ç”¨å¼‚æ­¥æ–¹å¼è¿›è¡Œæœ‰é™çš„é€šä¿¡ï¼Œå¯ä»¥å®ç°è·¨æ–‡æœ¬æ¡£ã€å¤šçª—å£ã€è·¨åŸŸæ¶ˆæ¯ä¼ é€’.</p>
<p>è¯­æ³•: postMessage(data,origin)</p>
<p><strong>data</strong>: è¦ä¼ é€’çš„æ•°æ®ï¼Œhtml5è§„èŒƒä¸­æåˆ°è¯¥å‚æ•°å¯ä»¥æ˜¯JavaScriptçš„ä»»æ„åŸºæœ¬ç±»å‹æˆ–å¯å¤åˆ¶çš„å¯¹è±¡ï¼Œç„¶è€Œå¹¶ä¸æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½åšåˆ°äº†è¿™ç‚¹å„¿ï¼Œéƒ¨åˆ†æµè§ˆå™¨åªèƒ½å¤„ç†å­—ç¬¦ä¸²å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä¼ é€’å‚æ•°çš„æ—¶å€™å»ºè®®ä½¿ç”¨JSON.stringify()æ–¹æ³•å¯¹å¯¹è±¡å‚æ•°åºåˆ—åŒ–ï¼Œåœ¨ä½ç‰ˆæœ¬IEä¸­å¼•ç”¨json2.jså¯ä»¥å®ç°ç±»ä¼¼æ•ˆæœ.</p>
<p><strong>origin</strong>ï¼šå­—ç¬¦ä¸²å‚æ•°ï¼ŒæŒ‡æ˜ç›®æ ‡çª—å£çš„æºï¼Œåè®®+ä¸»æœº+ç«¯å£å·[+URL]ï¼ŒURLä¼šè¢«å¿½ç•¥ï¼Œæ‰€ä»¥å¯ä»¥ä¸å†™ï¼Œè¿™ä¸ªå‚æ•°æ˜¯ä¸ºäº†å®‰å…¨è€ƒè™‘ï¼ŒpostMessage()æ–¹æ³•åªä¼šå°†messageä¼ é€’ç»™æŒ‡å®šçª—å£ï¼Œå½“ç„¶å¦‚æœæ„¿æ„ä¹Ÿå¯ä»¥å»ºå‚æ•°è®¾ç½®ä¸ºâ€*â€ï¼Œè¿™æ ·å¯ä»¥ä¼ é€’ç»™ä»»æ„çª—å£ï¼Œå¦‚æœè¦æŒ‡å®šå’Œå½“å‰çª—å£åŒæºçš„è¯è®¾ç½®ä¸ºâ€/â€œã€‚</p>
<p>çˆ¶é¡µé¢å‘é€æ¶ˆæ¯: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.frames[<span class="number">0</span>].postMessage(<span class="string">'message'</span>, origin)</div></pre></td></tr></table></figure>
<p>iframeæ¥å—æ¶ˆæ¯: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'message'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">	<span class="keyword">if</span>(e.source!=<span class="built_in">window</span>.parent) <span class="keyword">return</span>;<span class="comment">//è‹¥æ¶ˆæ¯æºä¸æ˜¯çˆ¶é¡µé¢åˆ™é€€å‡º</span></div><div class="line">  	<span class="comment">//TODO ...</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ e å¯¹è±¡æœ‰ä¸‰ä¸ªé‡è¦çš„å±æ€§    </p>
<ul>
<li>data, è¡¨ç¤ºçˆ¶é¡µé¢ä¼ é€’è¿‡æ¥çš„message</li>
<li>source, è¡¨ç¤ºå‘é€æ¶ˆæ¯çš„çª—å£å¯¹è±¡</li>
<li>origin, è¡¨ç¤ºå‘é€æ¶ˆæ¯çª—å£çš„æº(åè®®+ä¸»æœº+ç«¯å£å·)</li>
</ul>
<h4 id="CORS-è·¨åŸŸè®¿é—®"><a href="#CORS-è·¨åŸŸè®¿é—®" class="headerlink" title="CORS è·¨åŸŸè®¿é—®"></a>CORS è·¨åŸŸè®¿é—®</h4><p>HTML5å¸¦æ¥äº†ä¸€ç§æ–°çš„è·¨åŸŸè¯·æ±‚çš„æ–¹å¼ â€” CORS, å³ <a href="https://www.w3.org/TR/cors/" target="_blank" rel="external">Cross-origin resource sharing</a>. å®ƒæ›´åŠ å®‰å…¨, ä¸Šè¿°çš„ JSONP, postMessage ç­‰, èµ„æºæœ¬èº«æ²¡æœ‰èƒ½åŠ›ä¿è¯è‡ªå·±ä¸è¢«æ»¥ç”¨. CORSçš„ç›®æ ‡æ˜¯ä¿æŠ¤èµ„æºåªè¢«å¯ä¿¡çš„è®¿é—®æºä»¥æ­£ç¡®çš„æ–¹å¼è®¿é—®.</p>
<p>ç›®å‰, ä¸»æµçš„æµè§ˆå™¨éƒ½æ”¯æŒæ­¤åè®®, å¯ä»¥åœ¨caniuse.com ä¸­æŸ¥åˆ°<a href="http://caniuse.com/#search=cors" target="_blank" rel="external">http://caniuse.com/#search=cors</a>.</p>
<p>ç®€è€Œè¨€ä¹‹, æµè§ˆå™¨ä¸å†ä¸€å‘³ç¦æ­¢è·¨åŸŸè®¿é—®, è€Œæ˜¯æ£€æŸ¥ç›®çš„ç«™ç‚¹çš„å“åº”å¤´åŸŸ, è¿›è€Œåˆ¤æ–­æ˜¯å¦å…è®¸å½“å‰ç«™ç‚¹è®¿é—®. é€šå¸¸, æœåŠ¡å™¨ä½¿ç”¨ä»¥ä¸‹çš„è¿™äº›å“åº”å¤´åŸŸç”¨æ¥é€šçŸ¥æµè§ˆå™¨:</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Response headers[edit]</div><div class="line"><span class="keyword">Access</span>-Control-Allow-Origin</div><div class="line"><span class="keyword">Access</span>-Control-Allow-Credentials</div><div class="line"><span class="keyword">Access</span>-Control-Allow-Methods</div><div class="line"><span class="keyword">Access</span>-Control-Allow-Headers</div><div class="line"><span class="keyword">Access</span>-Control-Expose-Headers</div><div class="line"><span class="keyword">Access</span>-Control-<span class="built_in">Max</span>-Age</div></pre></td></tr></table></figure>
<p>CORSçš„è§£å†³åŠæ³•æ˜¯åœ¨æœåŠ¡ç«¯Responseçš„HTTPå¤´åŸŸåŠ å…¥èµ„æºçš„è®¿é—®æƒé™ä¿¡æ¯. å¦‚: Aç«™åªéœ€è¦åœ¨responseå¤´ä¸­åŠ ä¸€ä¸ªå­—æ®µå°±èƒ½è®©Bç«™è·¨ç«™è®¿é—®.</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">access</span>-control-allow-origin:*</div></pre></td></tr></table></figure>
<p>å…¶ä¸­<code>*</code> è¡¨ç¤ºé€šé…, æ‰€æœ‰çš„åŸŸéƒ½èƒ½è®¿é—®æ­¤èµ„æº, å¦‚æœä¸¥è°¨ä¸€äº›åªå…è®¸Bç«™è®¿é—®:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">access-control-allow-origin:<span class="xml"><span class="tag">&lt;<span class="name">B-DOMAIN</span>&gt;</span></span></div></pre></td></tr></table></figure>
<p>è¿™æ ·Bç«™å°±å¯ä»¥ç›´æ¥è®¿é—®æ­¤èµ„æº, ä¸éœ€è¦JSONP ä¹Ÿä¸éœ€è¦iframeäº†.</p>
<p>CORSéœ€è¦æŒ‡å®šMETHODè®¿é—®, å¯¹äºGETå’ŒPOSTè¯·æ±‚, è‡³å°‘è¦æŒ‡å®šä»¥ä¸‹ä¸‰ç§methods, å¦‚ä¸‹:</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Access</span>-Control-Allow-Methods: POST, GET, OPTIONS</div></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯POSTè¯·æ±‚, ä¸”æäº¤çš„æ•°æ®ç±»å‹æ˜¯json, é‚£ä¹ˆ, CORSéœ€è¦æŒ‡å®šheaders.</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Access</span>-Control-Allow-Headers: Content-<span class="keyword">Type</span></div></pre></td></tr></table></figure>
<p>CORSé»˜è®¤æ˜¯ä¸å¸¦cookieçš„, è®¾ç½®ä»¥ä¸‹å­—æ®µå°†å…è®¸æµè§ˆå™¨å‘é€cookie.</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Access</span>-Control-Allow-Credentials: <span class="literal">true</span></div></pre></td></tr></table></figure>
<p>é™¤æ­¤ä¹‹å¤–, ä¸ºäº†è·¨ç«™å‘é€cookieç­‰éªŒè¯ä¿¡æ¯, <code>access-control-allow-origin</code> å­—æ®µå°†ä¸å…è®¸è®¾ç½®ä¸º<code>*</code>, å®ƒéœ€è¦æ˜ç¡®æŒ‡å®šä¸è¯·æ±‚ç½‘é¡µä¸€è‡´çš„åŸŸå.</p>
<p>åŒæ—¶, è¯·æ±‚ç½‘é¡µä¸­éœ€è¦åšå¦‚ä¸‹æ˜¾å¼è®¾ç½®æ‰èƒ½çœŸæ­£å‘é€cookie.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xhr.withCredentials = <span class="literal">true</span>;</div></pre></td></tr></table></figure>
<h4 id="document-domain"><a href="#document-domain" class="headerlink" title="document.domain"></a>document.domain</h4><p>é€šè¿‡ä¿®æ”¹documentçš„domainå±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸŸå’Œå­åŸŸæˆ–è€…ä¸åŒçš„å­åŸŸä¹‹é—´é€šä¿¡(å³å®ƒä»¬å¿…é¡»åœ¨åŒä¸€ä¸ªä¸€çº§åŸŸåä¸‹). åŒåŸŸç­–ç•¥è®¤ä¸ºåŸŸå’Œå­åŸŸéš¶å±äºä¸åŒçš„åŸŸï¼Œæ¯”å¦‚a.comå’Œ script.a.comæ˜¯ä¸åŒçš„åŸŸï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬æ— æ³•åœ¨a.comä¸‹çš„é¡µé¢ä¸­è°ƒç”¨script.a.comä¸­å®šä¹‰çš„JavaScriptæ–¹æ³•ã€‚ä½†æ˜¯å½“æˆ‘ä»¬æŠŠå®ƒä»¬documentçš„domainå±æ€§éƒ½ä¿®æ”¹ä¸ºa.comï¼Œæµè§ˆå™¨å°±ä¼šè®¤ä¸ºå®ƒä»¬å¤„äºåŒä¸€ä¸ªåŸŸä¸‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥äº’ç›¸è·å–å¯¹æ–¹æ•°æ®æˆ–è€…æ“ä½œå¯¹æ–¹DOMäº†ã€‚</p>
<p>æ¯”å¦‚, æˆ‘ä»¬åœ¨ www.a.com/a.html ä¸‹, ç°åœ¨æƒ³è·å– www.script.a.com/b.html, å³ä¸»åŸŸåç›¸åŒ, äºŒçº§åŸŸåä¸åŒ. é‚£ä¹ˆå¯ä»¥è¿™ä¹ˆåš:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.domain = <span class="string">'a.com'</span>;</div><div class="line"><span class="keyword">var</span> iframe = <span class="built_in">document</span>.createElement(<span class="string">'iframe'</span>);</div><div class="line">iframe.src = <span class="string">'http://www.script.a.com/b.html'</span>;</div><div class="line">iframe.style.display = <span class="string">'none'</span>;</div><div class="line"><span class="built_in">document</span>.body.appendChild(iframe);</div><div class="line">iframe.addEventListener(<span class="string">'load'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="comment">//TODO è½½å…¥å®Œæˆæ—¶åšçš„äº‹æƒ…</span></div><div class="line">	<span class="comment">//var _document = iframe.contentWindow.document;</span></div><div class="line"> 	<span class="comment">//...</span></div><div class="line">&#125;,<span class="literal">false</span>);</div></pre></td></tr></table></figure>
<p>æ³¨æ„: </p>
<ul>
<li>2ä¸ªé¡µé¢éƒ½è¦è®¾ç½®, å“ªæ€• a.html é¡µå·²å¤„äº <em>a.com</em> åŸŸåä¸‹, ä¹Ÿå¿…é¡»æ˜¾å¼è®¾ç½®.</li>
<li>document.domainåªèƒ½è®¾ç½®ä¸ºä¸€çº§åŸŸåï¼Œæ¯”å¦‚è¿™é‡Œaé¡µä¸èƒ½è®¾ç½®ä¸º<em>www.a.com</em> (äºŒçº§åŸŸå).</li>
</ul>
<p>åˆ©ç”¨domainå±æ€§è·¨åŸŸå…·æœ‰ä»¥ä¸‹å±€é™æ€§:</p>
<ul>
<li>ä¸¤ä¸ªé¡µé¢è¦åœ¨åŒä¸€ä¸ªä¸€çº§åŸŸåä¸‹, ä¸”å¿…é¡»åŒåè®®, åŒç«¯å£, å³å­åŸŸäº’è·¨;</li>
<li>åªé€‚ç”¨äºiframe.</li>
</ul>
<h5 id="Internet-ExploreråŒæºç­–ç•¥ç»•è¿‡"><a href="#Internet-ExploreråŒæºç­–ç•¥ç»•è¿‡" class="headerlink" title="Internet ExploreråŒæºç­–ç•¥ç»•è¿‡"></a>Internet ExploreråŒæºç­–ç•¥ç»•è¿‡</h5><p>Internet Explorer8ä»¥åŠå‰é¢çš„ç‰ˆæœ¬å¾ˆå®¹æ˜“é€šè¿‡document.domainå®ç°åŒæºç­–ç•¥ç»•è¿‡, é€šè¿‡é‡å†™æ–‡æ¡£å¯¹è±¡, åŸŸå±æ€§è¿™ä¸ªé—®é¢˜å¯ä»¥ååˆ†è½»æ¾çš„è¢«åˆ©ç”¨.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="built_in">document</span>;</div><div class="line"><span class="built_in">document</span> = &#123;&#125;;</div><div class="line"><span class="built_in">document</span>.domain = <span class="string">'http://www.a.com'</span>;</div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">document</span>.domain);</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ åœ¨æœ€æ–°çš„æµè§ˆå™¨ä¸­è¿è¡Œè¿™æ®µä»£ç , å¯èƒ½åœ¨JavaScriptæ§åˆ¶å°ä¼šæ˜¾ç¤ºä¸€ä¸ªåŒæºç­–ç•¥ç»•è¿‡é”™è¯¯.</p>
<h4 id="window-name"><a href="#window-name" class="headerlink" title="window.name"></a>window.name</h4><p>window å¯¹è±¡çš„nameå±æ€§æ˜¯ä¸€ä¸ªå¾ˆç‰¹åˆ«çš„å±æ€§, å½“è¯¥windowçš„locationå˜åŒ–, ç„¶åé‡æ–°åŠ è½½, å®ƒçš„nameå±æ€§å¯ä»¥ä¾ç„¶ä¿æŒä¸å˜. é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨é¡µé¢ Aä¸­ç”¨iframeåŠ è½½å…¶ä»–åŸŸçš„é¡µé¢B, è€Œé¡µé¢Bä¸­ç”¨JavaScriptæŠŠéœ€è¦ä¼ é€’çš„æ•°æ®èµ‹å€¼ç»™window.name, iframeåŠ è½½å®Œæˆä¹‹åï¼ˆiframe.onloadï¼‰, é¡µé¢Aä¿®æ”¹iframeçš„åœ°å€, å°†å…¶å˜æˆåŒåŸŸçš„ä¸€ä¸ªåœ°å€, ç„¶åå°±å¯ä»¥è¯»å‡ºiframeçš„window.nameçš„å€¼äº†(å› ä¸ºAä¸­çš„window.nameå’Œiframeä¸­çš„window.nameäº’ç›¸ç‹¬ç«‹çš„, æ‰€ä»¥ä¸èƒ½ç›´æ¥åœ¨Aä¸­è·å–window.name, è€Œè¦é€šè¿‡iframeè·å–å…¶window.name). è¿™ä¸ªæ–¹å¼éå¸¸é€‚åˆå•å‘çš„æ•°æ®è¯·æ±‚ï¼Œè€Œä¸”åè®®ç®€å•ã€å®‰å…¨. ä¸ä¼šåƒJSONPé‚£æ ·ä¸åšé™åˆ¶åœ°æ‰§è¡Œå¤–éƒ¨è„šæœ¬.</p>
<h4 id="location-hash"><a href="#location-hash" class="headerlink" title="location.hash"></a>location.hash</h4><p><strong>location.hash(ä¸¤ä¸ªiframeä¹‹é—´), åˆç§°FIM, Fragment Identitier Messagingçš„ç®€å†™</strong>.</p>
<p>å› ä¸ºçˆ¶çª—å£å¯ä»¥å¯¹iframeè¿›è¡ŒURLè¯»å†™, iframeä¹Ÿå¯ä»¥è¯»å†™çˆ¶çª—å£çš„URL, URLæœ‰ä¸€éƒ¨åˆ†è¢«ç§°ä¸ºhash, å°±æ˜¯#å·åŠå…¶åé¢çš„å­—ç¬¦, å®ƒä¸€èˆ¬ç”¨äºæµè§ˆå™¨é”šç‚¹å®šä½, Serverç«¯å¹¶ä¸å…³å¿ƒè¿™éƒ¨åˆ†, æ‰€ä»¥è¿™éƒ¨åˆ†çš„ä¿®æ”¹ä¸ä¼šäº§ç”ŸHTTPè¯·æ±‚, ä½†æ˜¯ä¼šäº§ç”Ÿæµè§ˆå™¨å†å²è®°å½•. æ­¤æ–¹æ³•çš„åŸç†å°±æ˜¯æ”¹å˜URLçš„hashéƒ¨åˆ†æ¥è¿›è¡ŒåŒå‘é€šä¿¡. æ¯ä¸ªwindowé€šè¿‡æ”¹å˜å…¶ä»– windowçš„locationæ¥å‘é€æ¶ˆæ¯ï¼ˆç”±äºä¸¤ä¸ªé¡µé¢ä¸åœ¨åŒä¸€ä¸ªåŸŸä¸‹IEã€Chromeä¸å…è®¸ä¿®æ”¹parent.location.hashçš„å€¼ï¼Œæ‰€ä»¥è¦å€ŸåŠ©äºçˆ¶çª—å£åŸŸåä¸‹çš„ä¸€ä¸ªä»£ç†iframeï¼‰, å¹¶é€šè¿‡ç›‘å¬è‡ªå·±çš„URLçš„å˜åŒ–æ¥æ¥æ”¶æ¶ˆæ¯. è¿™ä¸ªæ–¹å¼çš„é€šä¿¡ä¼šé€ æˆä¸€äº›ä¸å¿…è¦çš„æµè§ˆå™¨å†å²è®°å½•, è€Œä¸”æœ‰äº›æµè§ˆå™¨ä¸æ”¯æŒonhashchangeäº‹ä»¶, éœ€è¦è½®è¯¢æ¥è·çŸ¥URLçš„æ”¹å˜, æœ€å, è¿™æ ·åšä¹Ÿå­˜åœ¨ç¼ºç‚¹, æ¯”å¦‚æ•°æ®ç›´æ¥æš´éœ²åœ¨äº†urlä¸­, æ•°æ®å®¹é‡å’Œç±»å‹éƒ½æœ‰é™ç­‰.</p>
<h4 id="Access-Control"><a href="#Access-Control" class="headerlink" title="Access Control"></a>Access Control</h4><p>æ­¤è·¨åŸŸæ–¹æ³•ç›®å‰åªåœ¨å¾ˆå°‘çš„æµè§ˆå™¨ä¸­å¾—ä»¥æ”¯æŒ, è¿™äº›æµè§ˆå™¨å¯ä»¥å‘é€ä¸€ä¸ªè·¨åŸŸçš„HTTPè¯·æ±‚ï¼ˆFirefox, Google Chromeç­‰é€šè¿‡XMLHTTPRequestå®ç°, IE8ä¸‹é€šè¿‡XDomainRequestå®ç°ï¼‰, è¯·æ±‚çš„å“åº”å¿…é¡»åŒ…å«ä¸€ä¸ªAccess- Control-Allow-Originçš„HTTPå“åº”å¤´, è¯¥å“åº”å¤´å£°æ˜äº†è¯·æ±‚åŸŸçš„å¯è®¿é—®æƒé™. ä¾‹å¦‚baidu.comå¯¹google.comä¸‹çš„getUsers.phpå‘é€äº†ä¸€ä¸ªè·¨åŸŸçš„HTTPè¯·æ±‚ï¼ˆé€šè¿‡ajaxï¼‰, é‚£ä¹ˆgetUsers.phpå¿…é¡»åŠ å…¥å¦‚ä¸‹çš„å“åº”å¤´:</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">header(<span class="string">"Access-Control-Allow-Origin: http://www.baidu.com"</span>);<span class="comment">//è¡¨ç¤ºå…è®¸baidu.comè·¨åŸŸè¯·æ±‚æœ¬æ–‡ä»¶</span></div></pre></td></tr></table></figure>
<h4 id="flash-URLLoder"><a href="#flash-URLLoder" class="headerlink" title="flash URLLoder"></a>flash URLLoder</h4><p>flashæœ‰è‡ªå·±çš„ä¸€å¥—å®‰å…¨ç­–ç•¥, æœåŠ¡å™¨å¯ä»¥é€šè¿‡crossdomain.xmlæ–‡ä»¶æ¥å£°æ˜èƒ½è¢«å“ªäº›åŸŸçš„SWFæ–‡ä»¶è®¿é—®, SWFä¹Ÿå¯ä»¥é€šè¿‡APIæ¥ç¡®å®šè‡ªèº«èƒ½è¢«å“ªäº›åŸŸçš„SWFåŠ è½½. å½“è·¨åŸŸè®¿é—®èµ„æºæ—¶, ä¾‹å¦‚ä»åŸŸ a.com è¯·æ±‚åŸŸ b.comä¸Šçš„æ•°æ®, æˆ‘ä»¬å¯ä»¥å€ŸåŠ©flashæ¥å‘é€HTTPè¯·æ±‚. </p>
<ul>
<li>é¦–å…ˆ, ä¿®æ”¹åŸŸ b.comä¸Šçš„ crossdomain.xml(ä¸€èˆ¬å­˜æ”¾åœ¨æ ¹ç›®å½•, å¦‚æœæ²¡æœ‰éœ€è¦æ‰‹åŠ¨åˆ›å»º) , æŠŠ a.com åŠ å…¥åˆ°ç™½åå•;</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span><span class="meta">?&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">cross-domain-policy</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">site-control</span> <span class="attr">permitted-cross-domain-policies</span>=<span class="string">"by-content-type"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">allow-access-from</span> <span class="attr">domain</span>=<span class="string">"a.com"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">cross-domain-policy</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>å…¶æ¬¡, é€šè¿‡Flash URLLoaderå‘é€HTTPè¯·æ±‚, æ‹¿åˆ°è¯·æ±‚åå¹¶è¿”å›;</li>
<li>æœ€å, é€šè¿‡Flash APIæŠŠå“åº”ç»“æœä¼ é€’ç»™JavaScript.</li>
</ul>
<p>Flash URLLoaderæ˜¯ä¸€ç§å¾ˆæ™®éçš„è·¨åŸŸè§£å†³æ–¹æ¡ˆï¼Œä¸è¿‡éœ€è¦æ”¯æŒiOSçš„è¯ï¼Œè¿™ä¸ªæ–¹æ¡ˆå°±ä¸å¯è¡Œäº†.</p>
<h4 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h4><p>åœ¨WebSocketå‡ºç°ä¹‹å‰, å¾ˆå¤šç½‘ç«™ä¸ºäº†å®ç°å®æ—¶æ¨é€æŠ€æœ¯, é€šå¸¸é‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯è½®è¯¢(Polling)å’ŒCometæŠ€æœ¯, Cometåˆå¯ç»†åˆ†ä¸ºä¸¤ç§å®ç°æ–¹å¼, ä¸€ç§æ˜¯é•¿è½®è¯¢æœºåˆ¶, ä¸€ç§ç§°ä¸ºæµæŠ€æœ¯, è¿™ä¸¤ç§æ–¹å¼å®é™…ä¸Šæ˜¯å¯¹è½®è¯¢æŠ€æœ¯çš„æ”¹è¿›, è¿™äº›æ–¹æ¡ˆå¸¦æ¥å¾ˆæ˜æ˜¾çš„ç¼ºç‚¹, éœ€è¦ç”±æµè§ˆå™¨å¯¹æœåŠ¡å™¨å‘å‡ºHTTP request, å¤§é‡æ¶ˆè€—æœåŠ¡å™¨å¸¦å®½å’Œèµ„æº. é¢å¯¹è¿™ç§çŠ¶å†µ, HTML5å®šä¹‰äº†WebSocketåè®®, èƒ½æ›´å¥½çš„èŠ‚çœæœåŠ¡å™¨èµ„æºå’Œå¸¦å®½å¹¶å®ç°çœŸæ­£æ„ä¹‰ä¸Šçš„å®æ—¶æ¨é€.</p>
<p>WebSocket æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŸºäºTCPçš„åè®®, å®ƒçš„ç›®æ ‡æ˜¯åœ¨ä¸€ä¸ªå•ç‹¬çš„æŒä¹…é“¾æ¥ä¸Šæä¾›å…¨åŒå·¥(full-duplex), åŒå‘é€šä¿¡, ä»¥åŸºäºäº‹ä»¶çš„æ–¹å¼, èµ‹äºˆæµè§ˆå™¨å®æ—¶é€šä¿¡èƒ½åŠ›. æ—¢ç„¶æ˜¯åŒå‘é€šä¿¡, å°±æ„å‘³ç€æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯å¯ä»¥åŒæ—¶å‘é€å¹¶å“åº”è¯·æ±‚, è€Œä¸å†åƒHTTPçš„è¯·æ±‚å’Œå“åº”. (åŒæºç­–ç•¥å¯¹ web sockets ä¸é€‚ç”¨)</p>
<p>åŸç†: ä¸ºäº†å»ºç«‹ä¸€ä¸ªWebSocketè¿æ¥ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨é¦–å…ˆè¦å‘æœåŠ¡å™¨å‘èµ·ä¸€ä¸ªHTTPè¯·æ±‚, è¿™ä¸ªè¯·æ±‚å’Œé€šå¸¸çš„HTTPè¯·æ±‚ä¸åŒ, åŒ…å«äº†ä¸€äº›é™„åŠ å¤´ä¿¡æ¯, å…¶ä¸­é™„åŠ å¤´ä¿¡æ¯â€Upgrade: WebSocketâ€è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç”³è¯·åè®®å‡çº§çš„HTTPè¯·æ±‚, æœåŠ¡å™¨ç«¯è§£æè¿™äº›é™„åŠ çš„å¤´ä¿¡æ¯ç„¶åäº§ç”Ÿåº”ç­”ä¿¡æ¯è¿”å›ç»™å®¢æˆ·ç«¯, å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„WebSocketè¿æ¥å°±å»ºç«‹èµ·æ¥äº†, åŒæ–¹å°±å¯ä»¥é€šè¿‡è¿™ä¸ªè¿æ¥é€šé“è‡ªç”±çš„ä¼ é€’ä¿¡æ¯, å¹¶ä¸”è¿™ä¸ªè¿æ¥ä¼šæŒç»­å­˜åœ¨ç›´åˆ°å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡å™¨ç«¯çš„æŸä¸€æ–¹ä¸»åŠ¨çš„å…³é—­è¿æ¥.</p>
<p><em>ä¸€ä¸ªå…¸å‹WebSocketå®¢æˆ·ç«¯è¯·æ±‚å¤´ï¼š</em></p>
<p><img src="/docImages/cross-domain03.jpg" alt=""></p>
<hr>
<p>æœ¬é—®å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/03/02/cross-domain/">http://louiszhai.github.io/2016/03/02/cross-domain/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="http://lc87624.iteye.com/blog/1123148" target="_blank" rel="external">å­¦ä¹ æ€»ç»“ å‰ç«¯è·¨åŸŸè¯·æ±‚çš„è§£å†³åŠæ³•â€”â€”JSONP-å“¥å¢¨è¿¹çš„iteye-ITeyeæŠ€æœ¯ç½‘ç«™</a></li>
<li><a href="http://www.cnblogs.com/dolphinX/p/3464056.html" target="_blank" rel="external">html5 postMessageè§£å†³è·¨åŸŸã€è·¨çª—å£æ¶ˆæ¯ä¼ é€’-Samaritans-åšå®¢å›­</a></li>
<li><a href="http://blog.csdn.net/kongjiea/article/details/44201021" target="_blank" rel="external">æ·±å…¥ç†è§£å‰ç«¯è·¨åŸŸæ–¹æ³•å’ŒåŸç†-kongjieaç¬”è®°-åšå®¢é¢‘é“-CSDN.NET</a></li>
<li><a href="http://web.jobbole.com/83864/" target="_blank" rel="external">è·¨åŸŸè®¿é—®å’Œé˜²ç›—é“¾åŸºæœ¬åŸç†-WEBå‰ç«¯-ä¼¯ä¹åœ¨çº¿</a></li>
<li><a href="http://unicorn-kid.com/fe-node/2014/08/07/JavaScript%20%E8%B7%A8%E5%9F%9F%20%E4%B9%8B%E4%B8%80%20%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5.html" target="_blank" rel="external">Javascript è·¨åŸŸ ä¹‹ä¸€ åŒæºç­–ç•¥ - KID</a></li>
<li><a href="http://www.freebuf.com/articles/web/65468.html" target="_blank" rel="external">åŒæºç­–ç•¥è¯¦è§£åŠç»•è¿‡ï¼ˆPart1ï¼‰ - FreeBuf.COM | å…³æ³¨é»‘å®¢ä¸æå®¢</a></li>
<li><a href="http://www.plhwin.com/2014/05/28/nodejs-socketio/" target="_blank" rel="external">ä½¿ç”¨Node.js+Socket.IOæ­å»ºWebSocketå®æ—¶åº”ç”¨ | æ½˜è‰¯è™çš„éšæƒ³å½•</a></li>
<li><a href="http://blog.jackxy.com/cross-origin-123/" target="_blank" rel="external">è·¨åŸŸèµ„æºè®¿é—®çš„å‡ ç§æ–¹å¼</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      JavaScript Same-Origin åŒæºç­–ç•¥ è·¨åŸŸ jsonp postMessage CORS domain
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://louiszhai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>webå®šæ—¶å™¨ä¹‹setTimeout &amp; setInterval</title>
    <link href="http://louiszhai.github.io/2016/01/10/js.timer/"/>
    <id>http://louiszhai.github.io/2016/01/10/js.timer/</id>
    <published>2016-01-10T05:52:11.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>è®¾ç½®webå®šæ—¶å™¨åº”å½“æ˜¯ä¸€ä¸ªç›¸å½“å¸¸è§çš„éœ€æ±‚, å®é™…ä¸Š, æˆ‘ä»¬ä¹Ÿæœ‰ä¸¤å¤§å·¥å…·å‡½æ•°å¯ä»¥ä»»æ„è°ƒç”¨: setTimeout, setInterval. ç„¶è€Œ js é‡Œå´æ²¡æœ‰javaçš„é‚£ç§wait(), å®šæ—¶åˆæœªå¿…å‡†æ—¶, è¦æƒ³å†™ä¸ªå®šæ—¶å™¨è¿˜é¡»å¾—æ·±å…¥ç†è§£ setTimeout å’Œ setInterval çš„è¿è¡ŒåŸç†æ‰è¡Œ.</p>
<a id="more"></a>
<h3 id="è¿è¡ŒåŸç†"><a href="#è¿è¡ŒåŸç†" class="headerlink" title="è¿è¡ŒåŸç†"></a>è¿è¡ŒåŸç†</h3><p>setTimeout å’Œ setInterval å¹¶éå¼‚æ­¥è°ƒç”¨, æ‰€è°“çš„â€å¼‚æ­¥è°ƒç”¨â€, åªæ˜¯å› å®ƒä»¬éƒ½å¾€ js å¼•æ“çš„ <code>å¾…å¤„ç†ä»»åŠ¡é˜Ÿåˆ—</code> æœ«å°¾æ’å…¥ä»£ç , çœ‹èµ·æ¥åƒâ€å¼‚æ­¥è°ƒç”¨â€è€Œå·².</p>
<p>é‚£ä¹ˆå¦‚ä½•è®¡ç®—æ’å…¥çš„æ—¶é—´ç‚¹å‘¢? è‡ªç„¶è¦ç”¨åˆ°æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„ timer (ä¹Ÿå«è®¡æ—¶å™¨), å½“æ‰§è¡Œ setTimeout å’Œ setInterval å‡½æ•°çš„æ—¶å€™, timerä¼šæ ¹æ®è®¾å®šå¥½çš„æ—¶é—´ç‚¹æ‰¾åˆ°ä»£ç çš„æ’å…¥ç‚¹, è¿”å›timer callback, ä¹Ÿå°±æ˜¯æˆ‘ä»¬è®¾å®šçš„å›è°ƒå‡½æ•°.</p>
<h3 id="setTimeout"><a href="#setTimeout" class="headerlink" title="setTimeout"></a>setTimeout</h3><p>è¯­æ³•1: setTimeout(func, millisec, [param1, param2, â€¦])</p>
<p>è¯­æ³•2: setTimeout(code, millisec)</p>
<p>setTimeout() æ–¹æ³•åœ¨æŒ‡å®šçš„æ—¶é—´å, æ‰§è¡Œä¸€æ¬¡ä¼ å…¥çš„å‡½æ•°. å¯é€šè¿‡ window.clearTimeout å‡½æ•°å–æ¶ˆ setTimeout æ“ä½œ.</p>
<h4 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(+<span class="keyword">new</span> <span class="built_in">Date</span>());</div><div class="line">&#125;</div><div class="line">setTimeout(fn, <span class="number">1000</span>);<span class="comment">//1452405077119, å»¶è¿Ÿ1såæ‰“å°äº†å½“å‰çš„æ—¶é—´æˆ³</span></div><div class="line">setTimeout(<span class="string">"console.log(+new Date())"</span>, <span class="number">1000</span>);<span class="comment">//1452405077120, å»¶è¿Ÿ1såæ‰§è¡Œäº†å­—ç¬¦ä¸²ä¸­çš„è¯­å¥</span></div></pre></td></tr></table></figure>
<h4 id="jså¼•æ“çš„æ’é˜Ÿæœºåˆ¶"><a href="#jså¼•æ“çš„æ’é˜Ÿæœºåˆ¶" class="headerlink" title="jså¼•æ“çš„æ’é˜Ÿæœºåˆ¶"></a>jså¼•æ“çš„æ’é˜Ÿæœºåˆ¶</h4><p>javaScriptçš„ä¸–ç•Œé‡Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹, ä»æ¥å°±æ²¡æœ‰åŒæ—¶åšä¸¤ä»¶äº‹çš„èƒ½åŠ›, å› æ­¤setTimeoutåªæ˜¯ä¸€ç§å§”æ‰˜æœºåˆ¶. å®ƒå‘Šè¯‰js å¼•æ“, å¸®å®ƒåœ¨æŒ‡å®šçš„æ—¶é—´ç‚¹å°†ä¸€æ®µä»£ç æ’å…¥åˆ° js å¼•æ“çš„ <code>å¾…å¤„ç†ä»»åŠ¡é˜Ÿåˆ—</code>  æœ«å°¾, æ’å…¥çš„ä»£ç å¹¶ä¸èƒ½ç«‹å³æ‰§è¡Œ, è‡³å°‘ä¹Ÿè¦ç­‰åˆ°é˜Ÿåˆ—å‰é¢çš„ä»£ç å…¨éƒ¨æ‰§è¡Œå®Œæ¯•(å¦‚æœé˜Ÿåˆ—åˆšå¥½ä¸ºç©º, åˆ™æ˜¯æŒ‡å®šæ—¶é—´ç«‹å³æ‰§è¡Œ, å¦åˆ™è¦ç­‰å¾…é˜Ÿåˆ—å‰é¢çš„ä»£ç é¡ºåºæ‰§è¡Œå®Œæ¯•).</p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥é€šè¿‡æ —å­æ„Ÿå—ä¸€ä¸‹setTimeoutæ˜¯æ€ä¹ˆæ’é˜Ÿçš„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å‡å¦‚æˆ‘ä»¬è¦åœ¨è¾“å…¥æ¡†å¤±å»ç„¦ç‚¹æ—¶, åšä¸€äº›äº‹æƒ…, ç„¶åé‡æ–°è·å–ç„¦ç‚¹</span></div><div class="line">$(<span class="string">'input'</span>).blur(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">//To do something...</span></div><div class="line">  $(<span class="keyword">this</span>).focus();</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>åƒä¸Šé¢è¿™ç§å†™æ³•åœ¨IEä¸‹æ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜, è¾“å…¥æ¡†å¤±å»ç„¦ç‚¹åé©¬ä¸Šå°±èƒ½è·å–ç„¦ç‚¹, ç„¶è€ŒFirefoxå°±æ²¡é‚£ä¹ˆå¹¸è¿äº†, å› ä¸ºFirefoxçš„focusåªèƒ½å‡ºç°åœ¨blurä¹‹å. åˆ©ç”¨ setTimeout çš„æ’é˜Ÿç‰¹ç‚¹, æˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·å®ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'input'</span>).blur(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">//To do something...</span></div><div class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $(<span class="keyword">this</span>).focus();</div><div class="line">  &#125;,<span class="number">0</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è™½ç„¶ setTimeout å»¶æ—¶ä¸º0, ä½†è·å–ç„¦ç‚¹çš„è¯­å¥å¹¶ä¸ä¼šç«‹å³æ‰§è¡Œ, åŸå› å°±åœ¨äº setTimeout åªæ˜¯å°†è·å–ç„¦ç‚¹çš„è¯­å¥æ’å…¥åˆ° js å¼•æ“çš„ <code>å¾…å¤„ç†ä»»åŠ¡é˜Ÿåˆ—</code>  æœ«å°¾, å®ƒéœ€è¦ç­‰å¾…æ•´ä¸ª blur å®Œå…¨æ‰§è¡Œå®Œæ‰èƒ½å‘æŒ¥ä½œç”¨, è¿™æ ·å°±ä¿è¯äº† focus äº‹ä»¶åœ¨ blur äº‹ä»¶ä¹‹åå‘ç”Ÿäº†.</p>
<h4 id="å……å½“å®šæ—¶å™¨"><a href="#å……å½“å®šæ—¶å™¨" class="headerlink" title="å……å½“å®šæ—¶å™¨"></a>å……å½“å®šæ—¶å™¨</h4><p>setTimeout åŸæœ¬åªèƒ½å»¶è¿Ÿä¸€æ®µæ—¶é—´æ‰§è¡Œä¸€æ®µä»£ç , å¦‚æœæˆ‘ä»¬å°† setTimeout å†™åœ¨å‡½æ•°å†…éƒ¨, å¹¶åœ¨ setTimeout é‡Œè°ƒç”¨å‡½æ•°æœ¬èº«, è¿™æ ·å°±å®Œæˆäº†ç®€å•çš„å®šæ—¶å™¨. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">i</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(!i) i = <span class="number">0</span>;</div><div class="line">  ++i;</div><div class="line">  <span class="keyword">if</span>(i&lt;<span class="number">10</span>) setTimeout(fn,<span class="number">100</span>,i);</div><div class="line">  <span class="keyword">else</span> <span class="built_in">console</span>.log(i);</div><div class="line">&#125;</div><div class="line">fn();<span class="comment">//10, fnæ¯éš”100msæ‰§è¡Œä¸€æ¬¡, ç›´åˆ°ç¬¬10æ¬¡, å› ä¸ç¬¦åˆæ¡ä»¶(i=10), é€€å‡ºå®šæ—¶å™¨, ä»è€Œè¾“å‡º10</span></div></pre></td></tr></table></figure>
<h4 id="thiså¸¦æ¥çš„é—®é¢˜"><a href="#thiså¸¦æ¥çš„é—®é¢˜" class="headerlink" title="thiså¸¦æ¥çš„é—®é¢˜"></a>thiså¸¦æ¥çš„é—®é¢˜</h4><p>ç”±setTimeout()è°ƒç”¨çš„ä»£ç è¿è¡Œåœ¨ä¸æ‰€åœ¨å‡½æ•°å®Œå…¨åˆ†ç¦»çš„æ‰§è¡Œç¯å¢ƒä¸Š. è¿™ä¼šå¯¼è‡´,è¿™äº›ä»£ç ä¸­åŒ…å«çš„ <code>this</code> å…³é”®å­—ä¼šæŒ‡å‘ <code>window</code> (æˆ–<code>å…¨å±€</code>)å¯¹è±¡. </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="attr">fruit</span>: <span class="string">"apple"</span>&#125;;</div><div class="line">o.shareFruit = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.fruit);</div><div class="line">&#125;</div><div class="line">o.shareFruit();<span class="comment">//apple</span></div><div class="line">setTimeout(o.shareFruit,<span class="number">1000</span>);<span class="comment">//undefined</span></div><div class="line">setTimeout.call(o,o.shareFruit,<span class="number">1000</span>);<span class="comment">//Illegal operation on WrappedNative prototype object</span></div></pre></td></tr></table></figure>
<p>ç”šè‡³è¿ call æ–¹æ³•éƒ½æ²¡æœ‰åŠæ³•æ”¹å˜å½“å‰ä½œç”¨åŸŸ, ä½¿ç”¨ä¸­è¦ç‰¹åˆ«æ³¨æ„é¿å…è¿™ä¸ªé—®é¢˜. å¯å‚è€ƒå¦‚ä¸‹æ–¹æ¡ˆ: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">setTimeout(o.shareFruit.bind(o), <span class="number">1000</span>);<span class="comment">//apple</span></div></pre></td></tr></table></figure>
<h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><p>ä¸‹é¢æˆ‘ä»¬æ¥ä½¿ç”¨ä¸¤ä¸ªéåŸç”Ÿçš„ setTimeout å’Œ setInterval å…¨å±€å‡½æ•°ä»£æ›¿åŸç”Ÿçš„, ä½¿å¾—å®ƒä»¬èƒ½å¤Ÿå€Ÿç”¨ call æ–¹æ³•æ¿€æ´»æ­£ç¡®çš„ä½œç”¨åŸŸ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Enable the passage of the 'this' object through the JavaScript timers</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> __nativeST__ = <span class="built_in">window</span>.setTimeout, __nativeSI__ = <span class="built_in">window</span>.setInterval;</div><div class="line"></div><div class="line"><span class="built_in">window</span>.setTimeout = <span class="function"><span class="keyword">function</span> (<span class="params">vCallback, nDelay</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> oThis = <span class="keyword">this</span>, aArgs = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">2</span>);</div><div class="line">  <span class="keyword">return</span> __nativeST__(vCallback <span class="keyword">instanceof</span> <span class="built_in">Function</span> ? <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    vCallback.apply(oThis, aArgs);</div><div class="line">  &#125; : vCallback, nDelay);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">window</span>.setInterval = <span class="function"><span class="keyword">function</span> (<span class="params">vCallback, nDelay</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> oThis = <span class="keyword">this</span>, aArgs = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">2</span>);</div><div class="line">  <span class="keyword">return</span> __nativeSI__(vCallback <span class="keyword">instanceof</span> <span class="built_in">Function</span> ? <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    vCallback.apply(oThis, aArgs);</div><div class="line">  &#125; : vCallback, nDelay);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//å†è¿è¡Œä»¥ä¸‹ä»£ç å°†èƒ½æ­£ç¡®æ‰§è¡Œ</span></div><div class="line">setTimeout.call(o,o.shareFruit,<span class="number">1000</span>);<span class="comment">//apple</span></div></pre></td></tr></table></figure>
<h3 id="setInterval"><a href="#setInterval" class="headerlink" title="setInterval"></a>setInterval</h3><p>è¯­æ³•1: setInterval(func, millisec, [param1, param2, â€¦])</p>
<p>è¯­æ³•2: setInterval(code, millisec)</p>
<p>setInterval() æ–¹æ³•æŒ‰ç…§æŒ‡å®šçš„å‘¨æœŸ(ä»¥æ¯«ç§’ä¸ºå•ä½)æ¥è°ƒç”¨å‡½æ•°æˆ–è¡¨è¾¾å¼. å¯é€šè¿‡ window.clearInterval å‡½æ•°å–æ¶ˆ setInterval æ“ä½œ.</p>
<h4 id="åŸºæœ¬ç”¨æ³•-1"><a href="#åŸºæœ¬ç”¨æ³•-1" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h4><p>setInterval ä¸ setTimeout ä¸åŒ, å®ƒä¼šå‘¨æœŸæ€§çš„å»è°ƒç”¨å‡½æ•°æˆ–è€…è¡¨è¾¾å¼, ç›´åˆ°å®ƒæœ¬èº«è¢«å–æ¶ˆ. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  ++i;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> timer = setInterval(fn,<span class="number">100</span>);<span class="comment">//è®¾ç½®äº†ä¸€ä¸ªå®šæ—¶å™¨, æ¯100msæ‰§è¡Œä¸€æ¬¡fnå‡½æ•°</span></div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">window</span>.clearInterval(timer);</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line">&#125;,<span class="number">2000</span>);<span class="comment">//ä¸¤ç§’åæ¸…é™¤å®šæ—¶å™¨, å¹¶æ‰“å°içš„å€¼</span></div><div class="line"><span class="comment">//20, å¯è§2såfnåˆšå¥½è¢«æ‰§è¡Œäº†20æ¬¡</span></div></pre></td></tr></table></figure>
<h4 id="å®ƒçœŸçš„å¯ä»¥ä½œä¸ºå®šæ—¶å™¨å—"><a href="#å®ƒçœŸçš„å¯ä»¥ä½œä¸ºå®šæ—¶å™¨å—" class="headerlink" title="å®ƒçœŸçš„å¯ä»¥ä½œä¸ºå®šæ—¶å™¨å—"></a>å®ƒçœŸçš„å¯ä»¥ä½œä¸ºå®šæ—¶å™¨å—</h4><p>å®é™…ä¸Š setInterval çœŸçš„èƒ½ä½œä¸ºå®šæ—¶å™¨, å‡†ç¡®æ— è¯¯çš„åœ¨æŒ‡å®šé—´éš”æ—¶é—´å†…æ‰§è¡Œå‡½æ•° fn å—?</p>
<p>ç­”æ¡ˆæ˜¯ no. è¯·çœ‹ä¸‹é¢æ —å­:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  ++i;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> timer = setInterval(fn,<span class="number">2</span>);<span class="comment">//è®¾ç½®äº†ä¸€ä¸ªå®šæ—¶å™¨, å°†æ—¶é—´é—´éš”å‡å°‘è‡³2ms</span></div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">window</span>.clearInterval(timer);</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line">&#125;,<span class="number">2000</span>);<span class="comment">//ä¸¤ç§’åæ¸…é™¤å®šæ—¶å™¨, å¹¶æ‰“å°içš„å€¼</span></div><div class="line"><span class="comment">//501, å¯è§2såfnåªæ˜¯è¢«æ‰§è¡Œäº†501æ¬¡(ä¸ºä»€ä¹ˆä¸æ˜¯1000æ¬¡?)</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Š fn åº”è¯¥è¢«æ‰§è¡Œ 2000 æ¬¡, å®é™…ä¸Šæ‰æ‰§è¡Œ501æ¬¡, è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢?</p>
<p>åŸæ¥, js å¼•æ“åœ¨æŒ‡å®šæ—¶é—´ç‚¹å¾€ <code>å¾…å¤„ç†æ¶ˆæ¯é˜Ÿåˆ—</code> æ’å…¥ä»£ç ç‰‡æ®µè¿™ç§æœºåˆ¶æœ‰ä¸ªç‰¹ç‚¹, jså¼•æ“åªå…è®¸æœ‰ä¸€ä»½æœªæ‰§è¡Œçš„processä»£ç (ç›¸å½“äºfn), å¯¹ä¸Šè¿°ä»£ç ä¸ºè€Œè¨€, æ¯å½“1msæ¥ä¸´æ—¶, jså¼•æ“å…ˆåˆ¤æ–­é˜Ÿåˆ—ä¸­æœ‰æ²¡æœ‰processä»£ç , å¦‚æœ fn å‡½æ•°æ‰§è¡Œæ—¶é—´å¤§äº1ms, è¿™å°±æ„å‘³ç€fnå°šæœªè¢«æ‰§è¡Œå®Œ, å®šæ—¶å°±æ¥äº†, ç„¶åå®šæ—¶å€™ç€, é™é™åœ°ç­‰å¾… fnçš„æ‰§è¡Œ, è¿™ç§æƒ…å†µä¸‹å¼•æ“é˜Ÿåˆ—ä¸­å°±å¯èƒ½å­˜åœ¨å°šæœªæ‰§è¡Œçš„processä»£ç , å¦‚æœæœ‰åˆ™æœ¬æ¬¡æ’å…¥çš„æ—¶é—´ç‚¹å°±è¢«æ— æƒ…çš„è·³è¿‡. </p>
<p>ç”±æ­¤å¯è§, ä¸Šè¿°ä»£ç ä¸­, fn å‡½æ•°è¢«æ— æƒ…çš„è·³è¿‡äº†499æ¬¡. æˆ‘ä»¬ä¹Ÿå¯ä»¥æ®æ­¤è®¡ç®—å‡ºè¿è¡Œä¸€æ¬¡ fn å‡½æ•°å¤§è‡´éœ€è¦2000/501~ = 4ms. è€Œå½“æˆ‘ä»¬å°†ä¸Šè¿° timer çš„æ—¶é—´é—´éš”è®¾ç½®ä¸º4msæ—¶, fn åˆšå¥½è¢«æ‰§è¡Œäº† 500 æ¬¡.</p>
<p>å› æ­¤ä¸Šé¢çš„è¿™æ®µä»£ç å¹¶ä¸å¯é , ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ›´ä¸ºå¯é çš„ç‰ˆæœ¬:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> i = <span class="number">0</span>,timer;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(++i &gt;= <span class="number">1000</span>)&#123;<span class="comment">//fnè°ƒç”¨1000æ¬¡åè‡ªåŠ¨é€€å‡º</span></div><div class="line">    <span class="built_in">console</span>.log(i);</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line">  timer = setTimeout(<span class="built_in">arguments</span>.callee, <span class="number">4</span>);<span class="comment">//è®¾ç½®å»¶æ—¶2msåæ‰§è¡Œè‡ªèº«</span></div><div class="line">&#125;</div><div class="line">fn();</div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(i)</div><div class="line">  <span class="built_in">window</span>.clearTimeout(timer);</div><div class="line">&#125;,<span class="number">2000</span>);<span class="comment">//384</span></div></pre></td></tr></table></figure>
<p>å¯è§, 2sä¹‹åå–æ¶ˆå®šæ—¶å™¨æ—¶, fnè¢«æ‰§è¡Œäº†384æ¬¡,å¦‚æœä»…ä»…å¸Œæœ›fnè¢«æ‰§è¡Œ1000æ¬¡åé€€å‡º, åˆ é™¤æœ€åä¸€ä¸ªsetTimeoutå³å¯. æ­¤æ—¶, æœ¬æ¬¡fnè°ƒç”¨ ä¸ ä¸‹æ¬¡è°ƒç”¨, é—´éš”æ—¶é—´å°†å¤§äºæˆ–è€…ç­‰äº2ms. è¿™æ ·æ—¢ä¿è¯äº†è°ƒç”¨æ¬¡æ•°, åˆåŸºæœ¬ä¿è¯äº†è°ƒç”¨é—´éš”.</p>
<p>å®é™…ä¸Š, ä¸Šè¿°æµ‹è¯•ä¸­æœ‰ä¸ªå¾ˆå¤§çš„é—®é¢˜. <strong>HTML5æ ‡å‡†è§„å®šäº†setTimeout æœ€çŸ­è¿è¡Œé—´éš”æ˜¯4ms</strong>, å¦‚æœä½äºè¿™ä¸ªå€¼, åˆ™ä¼šè‡ªåŠ¨æŒ‰4msé—´éš”è¿è¡Œ. <strong>è€ç‰ˆæœ¬æµè§ˆå™¨ä¸€èˆ¬å°†è¿™ä¸ªæœ€çŸ­é—´éš”è®¾ç½®ä¸º10ms</strong>. å°†ä¸Šè¿° setTimeout æ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°è®¾ç½®ä¸º4, æµ‹è¯•å‘ç°, åˆšå¥½è¿è¡Œ384æ¬¡. åœ¨è€ç‰ˆIEæµè§ˆå™¨ä¸­æµ‹è¯•, å‘ç°è¿è¡Œ198æ¬¡, æ¥è¿‘200æ¬¡, ä¹ŸéªŒè¯äº†è€ç‰ˆæµè§ˆå™¨10msçš„æ—¶é—´é—´éš”.</p>
<p>æ³¨: IE9 åŠæ›´æ—©ç‰ˆæœ¬çš„IE æµè§ˆå™¨ä¸æ”¯æŒå®ƒä»¬ç¬¬ä¸€ä¸ªè¯­æ³•ä¸­çš„å‘å›è°ƒå‡½æ•°ä¸­ä¼ å‚æ•°çš„åŠŸèƒ½. å¦‚éœ€æ”¯æŒ, è¯·å‚è€ƒ<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/setTimeout#å›è°ƒå‚æ•°" target="_blank" rel="external">å…¼å®¹å†™æ³•</a>, æˆ–è€…å€Ÿç”¨ Function.prototype.bind å‡½æ•°, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params">arg1</span>)</span>&#123;&#125;.bind(<span class="literal">undefined</span>, <span class="number">10</span>), <span class="number">1000</span>);</div></pre></td></tr></table></figure>
<hr>
<p>æœ¬æ–‡å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2016/01/10/js.timer/">http://louiszhai.github.io/2016/01/10/js.timer/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="http://www.jb51.net/article/26679.htm" target="_blank" rel="external">setTimeoutå’ŒsetIntervalçš„åŒºåˆ«ä½ çœŸçš„äº†è§£å—?_javascriptæŠ€å·§_è„šæœ¬ä¹‹å®¶</a></li>
<li><a href="http://www.jb51.net/article/42971.htm" target="_blank" rel="external">setTimeoutå’ŒsetIntervalçš„æ·±å…¥ç†è§£_åŸºç¡€çŸ¥è¯†_è„šæœ¬ä¹‹å®¶</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/setTimeout" target="_blank" rel="external">window.setTimeout - Web API æ¥å£ | MDN</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      JavaScript setTimeout setInterval è½®è¯¢ clearTimeout clearInterval webå®šæ—¶å™¨
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://louiszhai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>æ‹ä¸€æ‹JSçš„æ•°ç»„</title>
    <link href="http://louiszhai.github.io/2015/12/29/array/"/>
    <id>http://louiszhai.github.io/2015/12/29/array/</id>
    <published>2015-12-29T01:00:17.000Z</published>
    <updated>2017-02-25T05:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h3><p>æ•°ç»„æ˜¯ä¸€ç§éå¸¸é‡è¦çš„æ•°æ®ç±»å‹, å®ƒè¯­æ³•ç®€å•, çµæ´»,é«˜æ•ˆ, åœ¨å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­, æ•°ç»„éƒ½å……å½“ç€è‡³å…³é‡è¦çš„è§’è‰², ä»¥è‡³äºå¾ˆéš¾æƒ³è±¡æ²¡æœ‰æ•°ç»„çš„ç¼–ç¨‹è¯­è¨€ä¼šæ˜¯ä»€ä¹ˆæ ·å­. è¿™æœŸæˆ‘ä»¬å°±æ¥ä¾ƒä¾ƒJavaScriptçš„æ•°ç»„, è¶´è¶´å®ƒçš„é‚£ç‚¹ç ´äº‹å„¿. è¿™ç¯‡åšå®¢ä»2015å¹´å†™åˆ°äº†2016å¹´, æƒå½“æ˜¯è·¨å¹´çš„æ€»ç»“å§, ç¥å¤§å®¶æ–°å¹´å¿«ä¹, 2016æ›´å¥½, æœªæ¥æ›´å¥½!</p>
<a id="more"></a>
<p>å£°æ˜: ä»¥ä¸‹æœªç‰¹åˆ«æ ‡æ˜çš„æ–¹æ³•å‡ä¸ºES5å·²å®ç°çš„æ–¹æ³•.</p>
<h3 id="åŸå‹"><a href="#åŸå‹" class="headerlink" title="åŸå‹"></a>åŸå‹</h3><p>jsä¸­æ‰€æœ‰çš„æ•°ç»„æ–¹æ³•å‡æ¥è‡ªäºArray.prototype, å’Œå…¶ä»–æ„é€ å‡½æ•°ä¸€æ ·, ä½ å¯ä»¥é€šè¿‡æ‰©å±• <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Array" target="_blank" rel="external"><code>Array</code></a> çš„ <code>prototype</code> å±æ€§ä¸Šçš„æ–¹æ³•æ¥ç»™æ‰€æœ‰æ•°ç»„å®ä¾‹å¢åŠ æ–¹æ³•.</p>
<p>å€¼å¾—ä¸€è¯´çš„æ˜¯, Array.prototypeæœ¬èº«å°±æ˜¯ä¸€ä¸ªæ•°ç»„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.isArray(<span class="built_in">Array</span>.prototype); <span class="comment">// true</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.prototype.length);<span class="comment">//0</span></div></pre></td></tr></table></figure>
<p>å¾ˆæ˜æ˜¾, æ•°ç»„çš„åŸå‹æ˜¯ä¸€ä¸ªç©ºæ•°ç»„, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log([].__proto__.length);<span class="comment">//0</span></div><div class="line"><span class="built_in">console</span>.log([].__proto__);<span class="comment">//[Symbol(Symbol.unscopables): Object]</span></div></pre></td></tr></table></figure>
<p>æœ‰å…³Symbol(Symbol.unscopables)çš„çŸ¥è¯†, è¿™é‡Œä¸åšè¯¦è¿°, å…·ä½“è¯·ç§»æ­¥åç»­ç« èŠ‚.</p>
<h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><p>Array.prototypeçš„æ–¹æ³•åŒ…å«ä¸‰ç§, ä¸€ç§æ˜¯ä¼šæ”¹å˜è‡ªèº«å€¼çš„, ä¸€ç§æ˜¯ä¸ä¼šæ”¹å˜è‡ªèº«å€¼çš„, å¦å¤–ä¸€ç§æ˜¯éå†æ–¹æ³•.</p>
<p>ç”±äº Array.prototype çš„æŸäº›å±æ€§è¢«è®¾ç½®ä¸º[[DontEnum]], å› æ­¤ä¸èƒ½ç”¨ä¸€èˆ¬çš„æ–¹æ³•è¿›è¡Œéå†, æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è·å– Array.prototype çš„æ‰€æœ‰æ–¹æ³•:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.getOwnPropertyNames(<span class="built_in">Array</span>.prototype);<span class="comment">//["length", "constructor", "toString", "toLocaleString", "join", "pop", "push", "reverse", "shift", "unshift", "slice", "splice", "sort", "filter", "forEach", "some", "every", "map", "indexOf", "lastIndexOf", "reduce", "reduceRight", "copyWithin", "find", "findIndex", "fill", "includes", "entries", "keys", "concat"]</span></div></pre></td></tr></table></figure>
<h4 id="æ”¹å˜è‡ªèº«å€¼çš„æ–¹æ³•-9ä¸ª"><a href="#æ”¹å˜è‡ªèº«å€¼çš„æ–¹æ³•-9ä¸ª" class="headerlink" title="æ”¹å˜è‡ªèº«å€¼çš„æ–¹æ³•(9ä¸ª)"></a>æ”¹å˜è‡ªèº«å€¼çš„æ–¹æ³•(9ä¸ª)</h4><p>åŸºäºES6, æ”¹å˜è‡ªèº«å€¼çš„æ–¹æ³•ä¸€å…±æœ‰9ä¸ª, åˆ†åˆ«ä¸ºpop, push, reverse, shift, sort, splice, unshift, ä»¥åŠä¸¤ä¸ªES6æ–°å¢çš„æ–¹æ³•copyWithin, fill.</p>
<h5 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h5><p>pop() æ–¹æ³•åˆ é™¤ä¸€ä¸ªæ•°ç»„ä¸­çš„æœ€åçš„ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”è¿”å›è¿™ä¸ªå…ƒç´ .</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"cat"</span>, <span class="string">"dog"</span>, <span class="string">"cow"</span>, <span class="string">"chicken"</span>, <span class="string">"mouse"</span>];</div><div class="line"><span class="keyword">var</span> item = array.pop();</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["cat", "dog", "cow", "chicken"]</span></div><div class="line"><span class="built_in">console</span>.log(item);<span class="comment">//mouse</span></div></pre></td></tr></table></figure>
<p>ç”±äºè®¾è®¡ä¸Šçš„å·§å¦™, popæ–¹æ³•å¯ä»¥åº”ç”¨åœ¨ç±»æ•°ç»„å¯¹è±¡ä¸Š, å³ <code>é¸­å¼è¾¨å‹</code>. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"cat"</span>, <span class="number">1</span>:<span class="string">"dog"</span>, <span class="number">2</span>:<span class="string">"cow"</span>, <span class="number">3</span>:<span class="string">"chicken"</span>, <span class="number">4</span>:<span class="string">"mouse"</span>, <span class="attr">length</span>:<span class="number">5</span>&#125;</div><div class="line"><span class="keyword">var</span> item = <span class="built_in">Array</span>.prototype.pop.call(o);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//Object &#123;0: "cat", 1: "dog", 2: "cow", 3: "chicken", length: 4&#125;</span></div><div class="line"><span class="built_in">console</span>.log(item);<span class="comment">//mouse</span></div></pre></td></tr></table></figure>
<p>ä½†å¦‚æœç±»æ•°ç»„å¯¹è±¡ä¸å…·æœ‰lengthå±æ€§, é‚£ä¹ˆè¯¥å¯¹è±¡å°†è¢«åˆ›å»ºlengthå±æ€§, lengthå€¼ä¸º0, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"cat"</span>, <span class="number">1</span>:<span class="string">"dog"</span>, <span class="number">2</span>:<span class="string">"cow"</span>, <span class="number">3</span>:<span class="string">"chicken"</span>, <span class="number">4</span>:<span class="string">"mouse"</span>&#125;</div><div class="line"><span class="keyword">var</span> item = <span class="built_in">Array</span>.prototype.pop.call(o);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//Object &#123;0: "cat", 1: "dog", 2: "cow", 3: "chicken", 4: "mouse", length: 0&#125;</span></div><div class="line"><span class="built_in">console</span>.log(item);<span class="comment">//undefined</span></div></pre></td></tr></table></figure>
<h5 id="push"><a href="#push" class="headerlink" title="push"></a>push</h5><p>push()æ–¹æ³•æ·»åŠ ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ åˆ°æ•°ç»„æœ«å°¾, å¹¶ä¸”è¿”å›æ•°ç»„æ–°çš„é•¿åº¦.</p>
<p>è¯­æ³•: arr.push(element1, â€¦, elementN)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"football"</span>, <span class="string">"basketball"</span>, <span class="string">"volleyball"</span>, <span class="string">"Table tennis"</span>, <span class="string">"badminton"</span>];</div><div class="line"><span class="keyword">var</span> i = array.push(<span class="string">"golfball"</span>);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["football", "basketball", "volleyball", "Table tennis", "badminton", "golfball"]</span></div><div class="line"><span class="built_in">console</span>.log(i);<span class="comment">//6</span></div></pre></td></tr></table></figure>
<p>åŒpopæ–¹æ³•ä¸€æ ·, pushæ–¹æ³•ä¹Ÿå¯ä»¥åº”ç”¨åˆ°ç±»æ•°ç»„å¯¹è±¡ä¸Š, å¦‚æœlengthä¸èƒ½è¢«è½¬æˆä¸€ä¸ªæ•°å€¼æˆ–è€…ä¸å­˜åœ¨lengthå±æ€§æ—¶, åˆ™æ’å…¥çš„å…ƒç´ ç´¢å¼•ä¸º0, ä¸”lengthå±æ€§ä¸å­˜åœ¨æ—¶, å°†ä¼šåˆ›å»ºå®ƒ.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"football"</span>, <span class="number">1</span>:<span class="string">"basketball"</span>&#125;;</div><div class="line"><span class="keyword">var</span> i = <span class="built_in">Array</span>.prototype.push.call(o, <span class="string">"golfball"</span>);</div><div class="line"><span class="built_in">console</span>.log(o);<span class="comment">//Object &#123;0: "golfball", 1: "basketball", length: 1&#125;</span></div><div class="line"><span class="built_in">console</span>.log(i);<span class="comment">//1</span></div></pre></td></tr></table></figure>
<p>å®é™…ä¸Š, pushæ–¹æ³•æ˜¯æ ¹æ®lengthå±æ€§æ¥å†³å®šä»å“ªé‡Œå¼€å§‹æ’å…¥ç»™å®šçš„å€¼.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"football"</span>, <span class="number">1</span>:<span class="string">"basketball"</span>,<span class="attr">length</span>:<span class="number">1</span>&#125;;</div><div class="line"><span class="keyword">var</span> i = <span class="built_in">Array</span>.prototype.push.call(o,<span class="string">"golfball"</span>);</div><div class="line"><span class="built_in">console</span>.log(o);<span class="comment">//Object &#123;0: "football", 1: "golfball", length: 2&#125;</span></div><div class="line"><span class="built_in">console</span>.log(i);<span class="comment">//2</span></div></pre></td></tr></table></figure>
<p>åˆ©ç”¨pushæ ¹æ®lengthå±æ€§æ’å…¥å…ƒç´ è¿™ä¸ªç‰¹ç‚¹, å¯ä»¥å®ç°æ•°ç»„çš„åˆå¹¶, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"football"</span>, <span class="string">"basketball"</span>];</div><div class="line"><span class="keyword">var</span> array2 = [<span class="string">"volleyball"</span>, <span class="string">"golfball"</span>];</div><div class="line"><span class="keyword">var</span> i = <span class="built_in">Array</span>.prototype.push.apply(array,array2);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["football", "basketball", "volleyball", "golfball"]</span></div><div class="line"><span class="built_in">console</span>.log(i);<span class="comment">//4</span></div></pre></td></tr></table></figure>
<h5 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h5><p>reverse()æ–¹æ³•é¢ å€’æ•°ç»„ä¸­å…ƒç´ çš„ä½ç½®, ç¬¬ä¸€ä¸ªä¼šæˆä¸ºæœ€åä¸€ä¸ª, æœ€åä¸€ä¸ªä¼šæˆä¸ºç¬¬ä¸€ä¸ª, è¯¥æ–¹æ³•è¿”å›å¯¹æ•°ç»„çš„å¼•ç”¨.</p>
<p>è¯­æ³•:arr.reverse()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</div><div class="line"><span class="keyword">var</span> array2 = array.reverse();</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//[5,4,3,2,1]</span></div><div class="line"><span class="built_in">console</span>.log(array2===array);<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>åŒä¸Š, reverse ä¹Ÿæ˜¯é¸­å¼è¾¨å‹çš„å—ç›Šè€…, é¢ å€’å…ƒç´ çš„èŒƒå›´å—lengthå±æ€§åˆ¶çº¦, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"a"</span>, <span class="number">1</span>:<span class="string">"b"</span>, <span class="number">2</span>:<span class="string">"c"</span>, <span class="attr">length</span>:<span class="number">2</span>&#125;;</div><div class="line"><span class="keyword">var</span> o2 = <span class="built_in">Array</span>.prototype.reverse.call(o);</div><div class="line"><span class="built_in">console</span>.log(o);<span class="comment">//Object &#123;0: "b", 1: "a", 2: "c", length: 2&#125;</span></div><div class="line"><span class="built_in">console</span>.log(o === o2);<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>å¦‚æœ length å±æ€§å°äº2 æˆ–è€… length å±æ€§ä¸ä¸ºæ•°å€¼, é‚£ä¹ˆåŸç±»æ•°ç»„å¯¹è±¡å°†æ²¡æœ‰å˜åŒ–. å³ä½¿ length å±æ€§ä¸å­˜åœ¨, è¯¥å¯¹è±¡ä¹Ÿä¸ä¼šå»åˆ›å»º length å±æ€§. ç‰¹åˆ«çš„æ˜¯, å½“ length å±æ€§è¾ƒå¤§æ—¶, ç±»æ•°ç»„å¯¹è±¡çš„â€ç´¢å¼•â€ä¼šå°½å¯èƒ½çš„å‘ length çœ‹é½. å¦‚ä¸‹: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"a"</span>, <span class="number">1</span>:<span class="string">"b"</span>, <span class="number">2</span>:<span class="string">"c"</span>,<span class="attr">length</span>:<span class="number">100</span>&#125;;</div><div class="line"><span class="keyword">var</span> o2 = <span class="built_in">Array</span>.prototype.reverse.call(o);</div><div class="line"><span class="built_in">console</span>.log(o);<span class="comment">//Object &#123;97: "c", 98: "b", 99: "a", length: 100&#125;</span></div><div class="line"><span class="built_in">console</span>.log(o === o2);<span class="comment">//true</span></div></pre></td></tr></table></figure>
<h5 id="shift"><a href="#shift" class="headerlink" title="shift"></a>shift</h5><p>shift()æ–¹æ³•åˆ é™¤æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ , å¹¶è¿”å›è¿™ä¸ªå…ƒç´ .</p>
<p>è¯­æ³•: arr.shift()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</div><div class="line"><span class="keyword">var</span> item = array.shift();</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//[2,3,4,5]</span></div><div class="line"><span class="built_in">console</span>.log(item);<span class="comment">//1</span></div></pre></td></tr></table></figure>
<p>åŒæ ·å—ç›Šäºé¸­å¼è¾¨å‹, å¯¹äºç±»æ•°ç»„å¯¹è±¡, shiftä»ç„¶èƒ½å¤Ÿå¤„ç†, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"a"</span>, <span class="number">1</span>:<span class="string">"b"</span>, <span class="number">2</span>:<span class="string">"c"</span>, <span class="attr">length</span>:<span class="number">3</span>&#125;;</div><div class="line"><span class="keyword">var</span> item = <span class="built_in">Array</span>.prototype.shift.call(o);</div><div class="line"><span class="built_in">console</span>.log(o);<span class="comment">//Object &#123;0: "b", 1: "c", length: 2&#125;</span></div><div class="line"><span class="built_in">console</span>.log(item);<span class="comment">//a</span></div></pre></td></tr></table></figure>
<p>å¦‚æœç±»æ•°ç»„å¯¹è±¡lengthå±æ€§ä¸å­˜åœ¨, å°†æ·»åŠ lengthå±æ€§, å¹¶åˆå§‹åŒ–ä¸º0,å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"a"</span>, <span class="number">1</span>:<span class="string">"b"</span>, <span class="number">2</span>:<span class="string">"c"</span>&#125;;</div><div class="line"><span class="keyword">var</span> item = <span class="built_in">Array</span>.prototype.shift.call(o);</div><div class="line"><span class="built_in">console</span>.log(o);<span class="comment">//Object &#123;0: "a", 1: "b", 2:"c" length: 0&#125;</span></div><div class="line"><span class="built_in">console</span>.log(item);<span class="comment">//undefined</span></div></pre></td></tr></table></figure>
<h5 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h5><p>sort()æ–¹æ³•å¯¹æ•°ç»„å…ƒç´ è¿›è¡Œæ’åº, å¹¶è¿”å›è¿™ä¸ªæ•°ç»„.</p>
<p>è¯­æ³•: arr.sort([comparefn]), comparefnæ˜¯å¯é€‰çš„, å¦‚æœçœç•¥, æ•°ç»„å…ƒç´ å°†æŒ‰ç…§å„è‡ªè½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„Unicode(ä¸‡å›½ç )ä½ç‚¹é¡ºåºæ’åº, ä¾‹å¦‚â€boyâ€å°†æ’åˆ°â€Appleâ€ä¹‹å‰. å½“å¯¹æ•°å­—æ’åºçš„æ—¶å€™, 25å°†ä¼šæ’åˆ°8ä¹‹å‰, å› ä¸ºè½¬æ¢ä¸ºå­—ç¬¦ä¸²å, â€œ25â€å°†æ¯”â€8â€é å‰. ä¾‹å¦‚:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"Apple"</span>,<span class="string">"boy"</span>,<span class="string">"Cat"</span>,<span class="string">"dog"</span>];</div><div class="line"><span class="keyword">var</span> array2 = array.sort();</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["Apple", "Cat", "boy", "dog"]</span></div><div class="line"><span class="built_in">console</span>.log(array2 == array);<span class="comment">//true</span></div><div class="line"></div><div class="line">array = [<span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">20</span>];</div><div class="line"><span class="keyword">var</span> array3 = array.sort();</div><div class="line"><span class="built_in">console</span>.log(array3);<span class="comment">//[1, 10, 20, 3]</span></div></pre></td></tr></table></figure>
<p>å¦‚æœæŒ‡æ˜äº†comparefn, æ•°ç»„å°†æŒ‰ç…§è°ƒç”¨è¯¥å‡½æ•°çš„è¿”å›å€¼æ¥æ’åº. è‹¥ a å’Œ b æ˜¯ä¸¤ä¸ªå°†è¦æ¯”è¾ƒçš„å…ƒç´ :</p>
<ul>
<li>è‹¥ comparefn(a, b) &lt; 0 , é‚£ä¹ˆa å°†æ’åˆ° b å‰é¢;</li>
<li>è‹¥ comparefn(a, b) = 0 , é‚£ä¹ˆa å’Œ b ç›¸å¯¹ä½ç½®ä¸å˜;</li>
<li>è‹¥ comparefn(a, b) &gt; 0 , é‚£ä¹ˆa , b å°†è°ƒæ¢ä½ç½®;</li>
</ul>
<p>å¦‚æœæ•°ç»„å…ƒç´ ä¸ºæ•°å­—, åˆ™æ’åºå‡½æ•°comparefnæ ¼å¼å¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">compare</span>(<span class="params">a, b</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> a-b;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœæ•°ç»„å…ƒç´ ä¸ºéASCIIå­—ç¬¦çš„å­—ç¬¦ä¸²(å¦‚åŒ…å«ç±»ä¼¼ e, Ã©, Ã¨, a, Ã¤ æˆ–ä¸­æ–‡å­—ç¬¦ç­‰éè‹±æ–‡å­—ç¬¦çš„å­—ç¬¦ä¸²), åˆ™éœ€è¦ä½¿ç”¨String.localeCompare. ä¸‹é¢è¿™ä¸ªå‡½æ•°å°†æ’åˆ°æ­£ç¡®çš„é¡ºåº.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">'äº’'</span>,<span class="string">'è”'</span>,<span class="string">'ç½‘'</span>,<span class="string">'æ”¹'</span>,<span class="string">'å˜'</span>,<span class="string">'ä¸–'</span>,<span class="string">'ç•Œ'</span>];</div><div class="line"><span class="keyword">var</span> array2 = array.sort();</div><div class="line"></div><div class="line"><span class="keyword">var</span> array = [<span class="string">'äº’'</span>,<span class="string">'è”'</span>,<span class="string">'ç½‘'</span>,<span class="string">'æ”¹'</span>,<span class="string">'å˜'</span>,<span class="string">'ä¸–'</span>,<span class="string">'ç•Œ'</span>];<span class="comment">//é‡æ–°èµ‹å€¼,é¿å…å¹²æ‰°array2</span></div><div class="line"><span class="keyword">var</span> array3 = array.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> a.localeCompare(b);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(array2);<span class="comment">//["ä¸–", "äº’", "å˜", "æ”¹", "ç•Œ", "ç½‘", "è”"]</span></div><div class="line"><span class="built_in">console</span>.log(array3);<span class="comment">//["å˜", "æ”¹", "äº’", "ç•Œ", "è”", "ä¸–", "ç½‘"]</span></div></pre></td></tr></table></figure>
<p>å¦‚ä¸Š, â€œäº’è”ç½‘æ”¹å˜ä¸–ç•Œâ€ è¿™ä¸ªæ•°ç»„, sortå‡½æ•°é»˜è®¤æŒ‰ç…§æ•°ç»„å…ƒç´ unicodeå­—ç¬¦ä¸²å½¢å¼è¿›è¡Œæ’åº, ç„¶è€Œå®é™…ä¸Š, æˆ‘ä»¬æœŸæœ›çš„æ˜¯æŒ‰ç…§æ‹¼éŸ³å…ˆåé¡ºåºè¿›è¡Œæ’åº, æ˜¾ç„¶String.localeCompare å¸®åŠ©æˆ‘ä»¬è¾¾åˆ°äº†è¿™ä¸ªç›®çš„.</p>
<p>ä¸ºä»€ä¹ˆä¸Šé¢æµ‹è¯•ä¸­éœ€è¦é‡æ–°ç»™arrayèµ‹å€¼å‘¢, è¿™æ˜¯å› ä¸ºsortæ¯æ¬¡æ’åºæ—¶æ”¹å˜çš„æ˜¯æ•°ç»„æœ¬èº«, å¹¶ä¸”è¿”å›æ•°ç»„å¼•ç”¨. å¦‚æœä¸è¿™ä¹ˆåš, ç»è¿‡è¿ç»­ä¸¤æ¬¡æ’åºå, array2 å’Œ array3 å°†æŒ‡å‘åŒä¸€ä¸ªæ•°ç»„, æœ€ç»ˆå½±å“æˆ‘ä»¬æµ‹è¯•. arrayé‡æ–°èµ‹å€¼åå°±æ–­å¼€äº†å¯¹åŸæ•°ç»„çš„å¼•ç”¨.</p>
<p>åŒä¸Š, sortä¸€æ ·å—ç›Šäºé¸­å¼è¾¨å‹, æ¯”å¦‚:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">'äº’'</span>,<span class="number">1</span>:<span class="string">'è”'</span>,<span class="number">2</span>:<span class="string">'ç½‘'</span>,<span class="number">3</span>:<span class="string">'æ”¹'</span>,<span class="number">4</span>:<span class="string">'å˜'</span>,<span class="number">5</span>:<span class="string">'ä¸–'</span>,<span class="number">6</span>:<span class="string">'ç•Œ'</span>,<span class="attr">length</span>:<span class="number">7</span>&#125;;</div><div class="line"><span class="built_in">Array</span>.prototype.sort.call(o,<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> a.localeCompare(b);</div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(o);<span class="comment">//Object &#123;0: "å˜", 1: "æ”¹", 2: "äº’", 3: "ç•Œ", 4: "è”", 5: "ä¸–", 6: "ç½‘", length: 7&#125;, å¯è§åŒä¸Šè¿°æ’åºç»“æœä¸€è‡´</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„: ä½¿ç”¨sortçš„é¸­å¼è¾¨å‹ç‰¹æ€§æ—¶, è‹¥ç±»æ•°ç»„å¯¹è±¡ä¸å…·æœ‰lengthå±æ€§,å®ƒå¹¶ä¸ä¼šè¿›è¡Œæ’åº, ä¹Ÿä¸ä¼šä¸ºå…¶æ·»åŠ lengthå±æ€§.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">'äº’'</span>,<span class="number">1</span>:<span class="string">'è”'</span>,<span class="number">2</span>:<span class="string">'ç½‘'</span>,<span class="number">3</span>:<span class="string">'æ”¹'</span>,<span class="number">4</span>:<span class="string">'å˜'</span>,<span class="number">5</span>:<span class="string">'ä¸–'</span>,<span class="number">6</span>:<span class="string">'ç•Œ'</span>&#125;;</div><div class="line"><span class="built_in">Array</span>.prototype.sort.call(o,<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> a.localeCompare(b);</div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(o);<span class="comment">//Object &#123;0: "äº’", 1: "è”", 2: "ç½‘", 3: "æ”¹", 4: "å˜", 5: "ä¸–", 6: "ç•Œ"&#125;, å¯è§å¹¶æœªæ·»åŠ lengthå±æ€§</span></div></pre></td></tr></table></figure>
<h6 id="ä½¿ç”¨æ˜ å°„æ”¹å–„æ’åº"><a href="#ä½¿ç”¨æ˜ å°„æ”¹å–„æ’åº" class="headerlink" title="ä½¿ç”¨æ˜ å°„æ”¹å–„æ’åº"></a>ä½¿ç”¨æ˜ å°„æ”¹å–„æ’åº</h6><p>comparefn å¦‚æœéœ€è¦å¯¹æ•°ç»„å…ƒç´ å¤šæ¬¡è½¬æ¢ä»¥å®ç°æ’åº, é‚£ä¹ˆä½¿ç”¨mapè¾…åŠ©æ’åºå°†æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©. åŸºæœ¬æ€æƒ³å°±æ˜¯å°†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ å®é™…æ¯”è¾ƒçš„å€¼å–å‡ºæ¥, æ’åºåå†å°†æ•°ç»„æ¢å¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// éœ€è¦è¢«æ’åºçš„æ•°ç»„</span></div><div class="line"><span class="keyword">var</span> array = [<span class="string">'dog'</span>, <span class="string">'Cat'</span>, <span class="string">'Boy'</span>, <span class="string">'apple'</span>];</div><div class="line"><span class="comment">// å¯¹éœ€è¦æ’åºçš„æ•°å­—å’Œä½ç½®çš„ä¸´æ—¶å­˜å‚¨</span></div><div class="line"><span class="keyword">var</span> mapped = array.map(<span class="function"><span class="keyword">function</span>(<span class="params">el, i</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123; <span class="attr">index</span>: i, <span class="attr">value</span>: el.toLowerCase() &#125;;</div><div class="line">&#125;)</div><div class="line"><span class="comment">// æŒ‰ç…§å¤šä¸ªå€¼æ’åºæ•°ç»„</span></div><div class="line">mapped.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> +(a.value &gt; b.value) || +(a.value === b.value) - <span class="number">1</span>;</div><div class="line">&#125;);</div><div class="line"><span class="comment">// æ ¹æ®ç´¢å¼•å¾—åˆ°æ’åºçš„ç»“æœ</span></div><div class="line"><span class="keyword">var</span> result = mapped.map(<span class="function"><span class="keyword">function</span>(<span class="params">el</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> array[el.index];</div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(result);<span class="comment">//["apple", "Boy", "Cat", "dog"]</span></div></pre></td></tr></table></figure>
<h6 id="å¥‡æ€ªçš„chrome"><a href="#å¥‡æ€ªçš„chrome" class="headerlink" title="å¥‡æ€ªçš„chrome"></a>å¥‡æ€ªçš„chrome</h6><p>å®é™…ä¸Š, ECMAscriptè§„èŒƒä¸­å¹¶æœªè§„å®šå…·ä½“çš„sortç®—æ³•, è¿™å°±åŠ¿å¿…å¯¼è‡´å„ä¸ªæµè§ˆå™¨ä¸å°½ç›¸åŒçš„sortç®—æ³•, è¯·çœ‹sortæ–¹æ³•åœ¨Chromeæµè§ˆå™¨ä¸‹è¡¨ç°:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [&#123; <span class="attr">n</span>: <span class="string">"a"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"b"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"c"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"d"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"e"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"f"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"g"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"h"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"i"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"j"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"k"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, ];</div><div class="line">array.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> a.v - b.v;</div><div class="line">&#125;);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>,len = array.length; i &lt; len; i++) &#123;</div><div class="line">    <span class="built_in">console</span>.log(array[i].n);</div><div class="line">&#125;</div><div class="line"><span class="comment">//f a c d e b g h i j k</span></div></pre></td></tr></table></figure>
<p>ç”±äºvå€¼ç›¸ç­‰, arrayæ•°ç»„æ’åºå‰ååº”è¯¥ä¸å˜, ç„¶è€ŒChromeå´è¡¨ç°å¼‚å¸¸, è€Œå…¶ä»–æµè§ˆå™¨(å¦‚IE æˆ– Firefox) è¡¨ç°æ­£å¸¸.</p>
<p>è¿™æ˜¯å› ä¸ºv8å¼•æ“ä¸ºäº†é«˜æ•ˆæ’åº(é‡‡ç”¨äº†ä¸ç¨³å®šæ’åº). å³æ•°ç»„é•¿åº¦è¶…è¿‡10æ¡æ—¶, ä¼šè°ƒç”¨å¦ä¸€ç§æ’åºæ–¹æ³•(å¿«é€Ÿæ’åº); è€Œ10æ¡åŠä»¥ä¸‹é‡‡ç”¨çš„æ˜¯æ’å…¥ç®—æ³•,æ­¤æ—¶ç»“æœå°†æ˜¯ç¨³å®šçš„, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [&#123; <span class="attr">n</span>: <span class="string">"a"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"b"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"c"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"d"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"e"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"f"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"g"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"h"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"i"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">n</span>: <span class="string">"j"</span>, <span class="attr">v</span>: <span class="number">1</span> &#125;,];</div><div class="line">array.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> a.v - b.v;</div><div class="line">&#125;);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>,len = array.length; i &lt; len; i++) &#123;</div><div class="line">    <span class="built_in">console</span>.log(array[i].n);</div><div class="line">&#125;</div><div class="line"><span class="comment">//a b c d e f g h i j</span></div></pre></td></tr></table></figure>
<p>ä»a åˆ° j åˆšå¥½10æ¡æ•°æ®.</p>
<p>é‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•è§„é¿Chromeæµè§ˆå™¨çš„è¿™ç§â€bugâ€å‘¢? å…¶å®å¾ˆç®€å•, åªéœ€ç•¥åŠ¨æ‰‹è„š, æ”¹å˜æ’åºæ–¹æ³•çš„è¿”å›å€¼å³å¯, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">array.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> a.v - b.v || array.indexOf(a)-array.indexOf(b);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ•°ç»„çš„sortæ–¹æ³•éœ€è¦æ³¨æ„ä¸€ç‚¹: å„æµè§ˆå™¨çš„é’ˆå¯¹sortæ–¹æ³•å†…éƒ¨ç®—æ³•å®ç°ä¸å°½ç›¸åŒ, æ’åºå‡½æ•°å°½é‡åªè¿”å›-1, 0, 1ä¸‰ç§ä¸åŒçš„å€¼, ä¸è¦å°è¯•è¿”å›trueæˆ–falseç­‰å…¶å®ƒæ•°å€¼, å› ä¸ºå¯èƒ½å¯¼è‡´ä¸å¯é çš„æ’åºç»“æœ.</p>
<h6 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h6><p>sortæ–¹æ³•ä¼ å…¥çš„æ’åºå‡½æ•°å¦‚æœè¿”å›å¸ƒå°”å€¼ä¼šå¯¼è‡´ä»€ä¹ˆæ ·çš„ç»“æœå‘¢?</p>
<p>ä»¥ä¸‹æ˜¯å¸¸è§çš„æµè§ˆå™¨ä»¥åŠè„šæœ¬å¼•æ“:</p>
<table>
<thead>
<tr>
<th>Browser Name</th>
<th>ECMAScript Engine</th>
</tr>
</thead>
<tbody>
<tr>
<td>Internet Explorer 6 - 8</td>
<td>JScript</td>
</tr>
<tr>
<td>Internet Explorer 9 - 10</td>
<td>Chakra</td>
</tr>
<tr>
<td>Firefox</td>
<td>IonMonkey(Monkeyç³»åˆ—å¼•æ“), TraceMonkey, Gecko</td>
</tr>
<tr>
<td>Chrome</td>
<td>V8</td>
</tr>
<tr>
<td>Safair</td>
<td>JavaScriptCore(SquirrelFish Extreme)</td>
</tr>
<tr>
<td>Opera</td>
<td>Carakan</td>
</tr>
</tbody>
</table>
<p>åˆ†æä»¥ä¸‹ä»£ç ï¼Œé¢„æœŸå°†æ•°ç»„å…ƒç´ è¿›è¡Œå‡åºæ’åºï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">9</span>];</div><div class="line"><span class="keyword">var</span> comparefn = <span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> x &gt; y;</div><div class="line">&#125;;</div><div class="line">array.sort(comparefn);</div></pre></td></tr></table></figure>
<p>ä»£ç ä¸­ï¼Œcomparefn å‡½æ•°è¿”å›å€¼ä¸º bool ç±»å‹ï¼Œå¹¶éä¸ºè§„èŒƒè§„å®šçš„ -1ã€0ã€1 å€¼ã€‚é‚£ä¹ˆæ‰§è¡Œæ­¤ä»£ç ï¼Œå„ JS è„šæœ¬å¼•æ“å®ç°æƒ…å†µå¦‚ä½•ï¼Ÿ</p>
<table>
<thead>
<tr>
<th></th>
<th>è¾“å‡ºç»“æœ</th>
<th>æ˜¯å¦ç¬¦åˆé¢„æœŸ</th>
</tr>
</thead>
<tbody>
<tr>
<td>JScript</td>
<td>[2, 3, 5, 1, 4, 6, 7, 0, 8, 9]</td>
<td>å¦</td>
</tr>
<tr>
<td>Carakan</td>
<td>[0, 1, 3, 8, 2, 4, 9, 5, 6, 7]</td>
<td>å¦</td>
</tr>
<tr>
<td>Chakra &amp; JavaScriptCore</td>
<td>[7, 6, 5, 4, 3, 2, 1, 0, 8, 9]</td>
<td>å¦</td>
</tr>
<tr>
<td>IonMonkey</td>
<td>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>V8</td>
<td>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</td>
<td>æ˜¯</td>
</tr>
</tbody>
</table>
<p><strong>æ ¹æ®è¡¨ä¸­æ•°æ®å¯è§ï¼Œå½“æ•°ç»„å†…å…ƒç´ ä¸ªæ•°å°äºç­‰äº 10 æ—¶:</strong></p>
<ul>
<li>JScript &amp; Carakan æ’åºç»“æœæœ‰è¯¯</li>
<li>Chakra &amp; JavaScriptCore çœ‹èµ·æ¥æ²¡æœ‰è¿›è¡Œæ’åº</li>
<li>IonMonkey è¿”å›äº†é¢„æœŸçš„æ­£ç¡®ç»“æœ</li>
<li>V8 æš‚æ—¶çœ‹èµ·æ¥æ’åºæ­£ç¡®</li>
</ul>
<p><strong>å°†æ•°ç»„å…ƒç´ æ‰©å¤§è‡³ 11 ä½:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">8</span>];</div><div class="line"><span class="keyword">var</span> comparefn = <span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> x &gt; y;</div><div class="line">&#125;;</div><div class="line">array.sort(comparefn);</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>è¾“å‡ºç»“æœ</th>
<th>æ˜¯å¦ç¬¦åˆé¢„æœŸ</th>
</tr>
</thead>
<tbody>
<tr>
<td>JScript</td>
<td>[2, 3, 5, 1, 4, 6, 7, 0, 8, 9, 10]</td>
<td>å¦</td>
</tr>
<tr>
<td>Carakan</td>
<td>[0, 1, 3, 8, 2, 4, 9, 5, 10, 6, 7]</td>
<td>å¦</td>
</tr>
<tr>
<td>Chakra &amp; JavaScriptCore</td>
<td>[7, 6, 5, 4, 3, 2, 1, 0, 10, 8, 9]</td>
<td>å¦</td>
</tr>
<tr>
<td>IonMonkey</td>
<td>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>V8</td>
<td>[5, 0, 1, 2, 3, 4, 6, 7, 8, 9, 10]</td>
<td>å¦</td>
</tr>
</tbody>
</table>
<p><strong>æ ¹æ®è¡¨ä¸­æ•°æ®å¯è§ï¼Œå½“æ•°ç»„å†…å…ƒç´ ä¸ªæ•°å¤§äº 10 æ—¶ï¼š</strong></p>
<ul>
<li>JScript &amp; Carakan æ’åºç»“æœæœ‰è¯¯</li>
<li>Chakra &amp; JavaScriptCore çœ‹èµ·æ¥æ²¡æœ‰è¿›è¡Œæ’åº</li>
<li>IonMonkey è¿”å›äº†é¢„æœŸçš„æ­£ç¡®ç»“æœ</li>
<li>V8 <strong>æ’åºç»“æœç”±æ­£ç¡®è½¬ä¸ºä¸æ­£ç¡®</strong></li>
</ul>
<h5 id="splice"><a href="#splice" class="headerlink" title="splice"></a>splice</h5><p>splice()æ–¹æ³•ç”¨æ–°å…ƒç´ æ›¿æ¢æ—§å…ƒç´ çš„æ–¹å¼æ¥ä¿®æ”¹æ•°ç»„.</p>
<p>è¯­æ³•: arr.splice(start,deleteCount[, item1[, item2[, â€¦]]])</p>
<p>start æŒ‡å®šä»å“ªä¸€ä½å¼€å§‹ä¿®æ”¹å†…å®¹. å¦‚æœè¶…è¿‡äº†æ•°ç»„é•¿åº¦, åˆ™ä»æ•°ç»„æœ«å°¾å¼€å§‹æ·»åŠ å†…å®¹; å¦‚æœæ˜¯è´Ÿå€¼, åˆ™å…¶æŒ‡å®šçš„ç´¢å¼•ä½ç½®ç­‰åŒäº length+start (lengthä¸ºæ•°ç»„çš„é•¿åº¦), è¡¨ç¤ºä»æ•°ç»„æœ«å°¾å¼€å§‹çš„ç¬¬ -start ä½.</p>
<p>deleteCount æŒ‡å®šè¦åˆ é™¤çš„å…ƒç´ ä¸ªæ•°, è‹¥ç­‰äº0 ,åˆ™ä¸åˆ é™¤. è¿™ç§æƒ…å†µä¸‹, è‡³å°‘åº”è¯¥æ·»åŠ ä¸€ä½æ–°å…ƒç´ . è‹¥å¤§äºstartä¹‹åçš„å…ƒç´ æ€»å’Œ, åˆ™startåŠä¹‹åçš„å…ƒç´ éƒ½å°†è¢«åˆ é™¤.</p>
<p>itemN æŒ‡å®šæ–°å¢çš„å…ƒç´ , å¦‚æœç¼ºçœ, åˆ™è¯¥æ–¹æ³•åªåˆ é™¤æ•°ç»„å…ƒç´ .</p>
<p>è¿”å›å€¼ ç”±åŸæ•°ç»„ä¸­è¢«åˆ é™¤å…ƒç´ ç»„æˆçš„æ•°ç»„,å¦‚æœæ²¡æœ‰åˆ é™¤, åˆ™è¿”å›ä¸€ä¸ªç©ºæ•°ç»„.</p>
<p>ä¸‹é¢æ¥ä¸¾æ —å­è¯´æ˜:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"apple"</span>,<span class="string">"boy"</span>];</div><div class="line"><span class="keyword">var</span> splices = array.splice(<span class="number">1</span>,<span class="number">1</span>);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["apple"]</span></div><div class="line"><span class="built_in">console</span>.log(splices);<span class="comment">//["boy"] ,å¯è§æ˜¯ä»æ•°ç»„ä¸‹æ ‡ä¸º1çš„å…ƒç´ å¼€å§‹åˆ é™¤,å¹¶ä¸”åˆ é™¤ä¸€ä¸ªå…ƒç´ ,ç”±äºitemNç¼ºçœ,æ•…æ­¤æ—¶è¯¥æ–¹æ³•åªåˆ é™¤å…ƒç´ </span></div><div class="line"></div><div class="line">array = [<span class="string">"apple"</span>,<span class="string">"boy"</span>];</div><div class="line">splices = array.splice(<span class="number">2</span>,<span class="number">1</span>,<span class="string">"cat"</span>);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["apple", "boy", "cat"]</span></div><div class="line"><span class="built_in">console</span>.log(splices);<span class="comment">//[], å¯è§ç”±äºstartè¶…è¿‡æ•°ç»„é•¿åº¦,æ­¤æ—¶ä»æ•°ç»„æœ«å°¾å¼€å§‹æ·»åŠ å…ƒç´ ,å¹¶ä¸”åŸæ•°ç»„ä¸ä¼šå‘ç”Ÿåˆ é™¤è¡Œä¸º</span></div><div class="line"></div><div class="line">array = [<span class="string">"apple"</span>,<span class="string">"boy"</span>];</div><div class="line">splices = array.splice(<span class="number">-2</span>,<span class="number">1</span>,<span class="string">"cat"</span>);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["cat", "boy"]</span></div><div class="line"><span class="built_in">console</span>.log(splices);<span class="comment">//["apple"], å¯è§å½“startä¸ºè´Ÿå€¼æ—¶,æ˜¯ä»æ•°ç»„æœ«å°¾å¼€å§‹çš„ç¬¬-startä½å¼€å§‹åˆ é™¤,åˆ é™¤ä¸€ä¸ªå…ƒç´ ,å¹¶ä¸”ä»æ­¤å¤„æ’å…¥äº†ä¸€ä¸ªå…ƒç´ </span></div><div class="line"></div><div class="line">array = [<span class="string">"apple"</span>,<span class="string">"boy"</span>];</div><div class="line">splices = array.splice(<span class="number">-3</span>,<span class="number">1</span>,<span class="string">"cat"</span>);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["cat", "boy"]</span></div><div class="line"><span class="built_in">console</span>.log(splices);<span class="comment">//["apple"], å¯è§å³ä½¿-startè¶…å‡ºæ•°ç»„é•¿åº¦,æ•°ç»„é»˜è®¤ä»é¦–ä½å¼€å§‹åˆ é™¤</span></div><div class="line"></div><div class="line">array = [<span class="string">"apple"</span>,<span class="string">"boy"</span>];</div><div class="line">splices = array.splice(<span class="number">0</span>,<span class="number">3</span>,<span class="string">"cat"</span>);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["cat"]</span></div><div class="line"><span class="built_in">console</span>.log(splices);<span class="comment">//["apple", "boy"], å¯è§å½“deleteCountå¤§äºæ•°ç»„startä¹‹åçš„å…ƒç´ æ€»å’Œæ—¶,startåŠä¹‹åçš„å…ƒç´ éƒ½å°†è¢«åˆ é™¤</span></div></pre></td></tr></table></figure>
<p>åŒä¸Š, spliceä¸€æ ·å—ç›Šäºé¸­å¼è¾¨å‹, æ¯”å¦‚:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"apple"</span>,<span class="number">1</span>:<span class="string">"boy"</span>,<span class="attr">length</span>:<span class="number">2</span>&#125;;</div><div class="line"><span class="keyword">var</span> splices = <span class="built_in">Array</span>.prototype.splice.call(o,<span class="number">1</span>,<span class="number">1</span>);</div><div class="line"><span class="built_in">console</span>.log(o);<span class="comment">//Object &#123;0: "apple", length: 1&#125;, å¯è§å¯¹è±¡oåˆ é™¤äº†ä¸€ä¸ªå±æ€§,å¹¶ä¸”length-1</span></div><div class="line"><span class="built_in">console</span>.log(splices);<span class="comment">//["boy"]</span></div></pre></td></tr></table></figure>
<p>æ³¨: å¦‚æœç±»æ•°ç»„å¯¹è±¡æ²¡æœ‰lengthå±æ€§, spliceå°†ä¸ºè¯¥ç±»æ•°ç»„å¯¹è±¡æ·»åŠ lengthå±æ€§,å¹¶åˆå§‹åŒ–ä¸º0. æ­¤å¤„æ —å­å¿½ç•¥. å¦‚æœéœ€è¦è¯·åœ¨<a href="https://github.com/Louiszhai" target="_blank" rel="external">è¯„è®º</a>é‡Œåé¦ˆ.</p>
<p>å¦‚æœéœ€è¦åˆ é™¤æ•°ç»„ä¸­ä¸€ä¸ªå·²å­˜åœ¨çš„å…ƒç´ , å¯å‚è€ƒå¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>];</div><div class="line">array.splice(array.indexOf(<span class="string">'b'</span>),<span class="number">1</span>);</div></pre></td></tr></table></figure>
<h5 id="unshift"><a href="#unshift" class="headerlink" title="unshift"></a>unshift</h5><p>unshift() æ–¹æ³•ç”¨äºåœ¨æ•°ç»„å¼€å§‹å¤„æ’å…¥ä¸€äº›å…ƒç´ (æ„Ÿè§‰åƒæ ˆåº•æ’å…¥), å¹¶è¿”å›æ•°ç»„æ–°çš„é•¿åº¦.</p>
<p>è¯­æ³•: arr.unshift(element1, â€¦, elementN)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"red"</span>, <span class="string">"green"</span>, <span class="string">"blue"</span>];</div><div class="line"><span class="keyword">var</span> length = array.unshift(<span class="string">"yellow"</span>);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//["yellow", "red", "green", "blue"]</span></div><div class="line"><span class="built_in">console</span>.log(length);<span class="comment">//4</span></div></pre></td></tr></table></figure>
<p>å¦‚æœç»™unshiftæ–¹æ³•ä¼ å…¥ä¸€ä¸ªæ•°ç»„å‘¢?</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"red"</span>, <span class="string">"green"</span>, <span class="string">"blue"</span>];</div><div class="line"><span class="keyword">var</span> length = array.unshift([<span class="string">"yellow"</span>]);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//[["yellow"], "red", "green", "blue"]</span></div><div class="line"><span class="built_in">console</span>.log(length);<span class="comment">//4, å¯è§æ•°ç»„ä¹Ÿèƒ½æˆåŠŸæ’å…¥</span></div></pre></td></tr></table></figure>
<p>åŒä¸Š, unshiftä¹Ÿå—ç›Šäºé¸­å¼è¾¨å‹, å‘ˆä¸Šæ —å­:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"red"</span>, <span class="number">1</span>:<span class="string">"green"</span>, <span class="number">2</span>:<span class="string">"blue"</span>,<span class="attr">length</span>:<span class="number">3</span>&#125;;</div><div class="line"><span class="keyword">var</span> length = <span class="built_in">Array</span>.prototype.unshift.call(o,<span class="string">"gray"</span>);</div><div class="line"><span class="built_in">console</span>.log(o);<span class="comment">//Object &#123;0: "gray", 1: "red", 2: "green", 3: "blue", length: 4&#125;</span></div><div class="line"><span class="built_in">console</span>.log(length);<span class="comment">//4</span></div></pre></td></tr></table></figure>
<p>æ³¨: å¦‚æœç±»æ•°ç»„å¯¹è±¡ä¸æŒ‡å®šlengthå±æ€§, åˆ™è¿”å›ç»“æœæ˜¯è¿™æ ·çš„ Object {0: â€œgrayâ€, 1: â€œgreenâ€, 2: â€œblueâ€, length: 1}, shiftä¼šè®¤ä¸ºæ•°ç»„é•¿åº¦ä¸º0, æ­¤æ—¶å°†ä»å¯¹è±¡ä¸‹æ ‡ä¸º0çš„ä½ç½®å¼€å§‹æ’å…¥, ç›¸åº”ä½ç½®å±æ€§å°†è¢«æ›¿æ¢, æ­¤æ—¶åˆå§‹åŒ–ç±»æ•°ç»„å¯¹è±¡çš„lengthå±æ€§ä¸ºæ’å…¥å…ƒç´ ä¸ªæ•°.</p>
<h5 id="copyWithin"><a href="#copyWithin" class="headerlink" title="copyWithin"></a>copyWithin</h5><p>copyWithin() æ–¹æ³•ç”¨äºæ•°ç»„å†…çš„å…ƒç´ æ›¿æ¢, å³æ›¿æ¢å…ƒç´ å’Œè¢«æ›¿æ¢å…ƒç´ å‡æ˜¯æ•°ç»„å†…çš„å…ƒç´ .</p>
<p>è¯­æ³•: arr.copyWithin(target, start[, end = this.length])</p>
<p>taget æŒ‡å®šè¢«æ›¿æ¢å…ƒç´ çš„ç´¢å¼•, start æŒ‡å®šæ›¿æ¢å…ƒç´ èµ·å§‹çš„ç´¢å¼•, end å¯é€‰, æŒ‡çš„æ˜¯æ›¿æ¢å…ƒç´ ç»“æŸä½ç½®çš„ç´¢å¼•.</p>
<p>å¦‚æœstartä¸ºè´Ÿï¼Œåˆ™å…¶æŒ‡å®šçš„ç´¢å¼•ä½ç½®ç­‰åŒäºlength+startï¼Œlengthä¸ºæ•°ç»„çš„é•¿åº¦ã€‚endä¹Ÿæ˜¯å¦‚æ­¤.</p>
<p>æ³¨: ç›®å‰åªæœ‰Firefox(ç‰ˆæœ¬32åŠå…¶ä»¥ä¸Šç‰ˆæœ¬)å®ç°äº†è¯¥æ–¹æ³•.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]; </div><div class="line"><span class="keyword">var</span> array2 = array.copyWithin(<span class="number">0</span>,<span class="number">3</span>);</div><div class="line"><span class="built_in">console</span>.log(array===array2,array2);<span class="comment">// true [4, 5, 3, 4, 5]</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]; </div><div class="line"><span class="built_in">console</span>.log(array.copyWithin(<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>));<span class="comment">// [4, 2, 3, 4, 5]</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]; </div><div class="line"><span class="built_in">console</span>.log(array.copyWithin(<span class="number">0</span>,<span class="number">-2</span>,<span class="number">-1</span>));<span class="comment">// [4, 2, 3, 4, 5]</span></div></pre></td></tr></table></figure>
<p>åŒä¸Š, copyWithinä¸€æ ·å—ç›Šäºé¸­å¼è¾¨å‹, ä¾‹å¦‚:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="number">1</span>, <span class="number">1</span>:<span class="number">2</span>, <span class="number">2</span>:<span class="number">3</span>, <span class="number">3</span>:<span class="number">4</span>, <span class="number">4</span>:<span class="number">5</span>,<span class="attr">length</span>:<span class="number">5</span>&#125;</div><div class="line"><span class="keyword">var</span> o2 = <span class="built_in">Array</span>.prototype.copyWithin.call(o,<span class="number">0</span>,<span class="number">3</span>);</div><div class="line"><span class="built_in">console</span>.log(o===o2,o2);<span class="comment">//true Object &#123; 0=4,  1=5,  2=3,  æ›´å¤š...&#125;</span></div></pre></td></tr></table></figure>
<p>å¦‚éœ€åœ¨Firefoxä¹‹å¤–çš„æµè§ˆå™¨ä½¿ç”¨copyWithinæ–¹æ³•,è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/copyWithin#Polyfill" target="_blank" rel="external">Polyfill</a>.</p>
<h5 id="fill"><a href="#fill" class="headerlink" title="fill"></a>fill</h5><p>fill() æ–¹æ³•åŒæ ·ç”¨äºæ•°ç»„å…ƒç´ æ›¿æ¢, å®ƒå¯å°†æ•°ç»„æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ æ›¿æ¢ä¸ºæŸä¸ªå€¼.</p>
<p>è¯­æ³•: <em>arr</em>.fill(value, start[, end = this.length])</p>
<p>value æŒ‡å®šè¢«æ›¿æ¢çš„å€¼, start æŒ‡å®šæ›¿æ¢å…ƒç´ èµ·å§‹çš„ç´¢å¼•, end å¯é€‰, æŒ‡çš„æ˜¯æ›¿æ¢å…ƒç´ ç»“æŸä½ç½®çš„ç´¢å¼•.</p>
<p>å¦‚æœstartä¸ºè´Ÿï¼Œåˆ™å…¶æŒ‡å®šçš„ç´¢å¼•ä½ç½®ç­‰åŒäºlength+startï¼Œlengthä¸ºæ•°ç»„çš„é•¿åº¦ã€‚endä¹Ÿæ˜¯å¦‚æ­¤.</p>
<p>æ³¨: ç›®å‰åªæœ‰Firefox(ç‰ˆæœ¬31åŠå…¶ä»¥ä¸Šç‰ˆæœ¬)å®ç°äº†è¯¥æ–¹æ³•.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</div><div class="line"><span class="keyword">var</span> array2 = array.fill(<span class="number">10</span>,<span class="number">0</span>,<span class="number">3</span>);</div><div class="line"><span class="built_in">console</span>.log(array===array2,array2);<span class="comment">// true [10, 10, 10, 4, 5], å¯è§æ•°ç»„åŒºé—´[0,3]çš„å…ƒç´ å…¨éƒ¨æ›¿æ¢ä¸º10</span></div><div class="line"><span class="comment">//å…¶ä»–çš„ä¸¾ä¾‹è¯·å‚è€ƒcopyWithin</span></div></pre></td></tr></table></figure>
<p>åŒä¸Š, fill ä¸€æ ·å—ç›Šäºé¸­å¼è¾¨å‹, ä¾‹å¦‚:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="number">1</span>, <span class="number">1</span>:<span class="number">2</span>, <span class="number">2</span>:<span class="number">3</span>, <span class="number">3</span>:<span class="number">4</span>, <span class="number">4</span>:<span class="number">5</span>,<span class="attr">length</span>:<span class="number">5</span>&#125;</div><div class="line"><span class="keyword">var</span> o2 = <span class="built_in">Array</span>.prototype.fill.call(o,<span class="number">10</span>,<span class="number">0</span>,<span class="number">2</span>);</div><div class="line"><span class="built_in">console</span>.log(o===o2,o2); <span class="literal">true</span> <span class="built_in">Object</span> &#123; <span class="number">0</span>=<span class="number">10</span>,  <span class="number">1</span>=<span class="number">10</span>,  <span class="number">2</span>=<span class="number">3</span>,  æ›´å¤š...&#125;</div></pre></td></tr></table></figure>
<p>å¦‚éœ€åœ¨Firefoxä¹‹å¤–çš„æµè§ˆå™¨ä½¿ç”¨copyWithinæ–¹æ³•,è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/fill#Compatibility" target="_blank" rel="external">Polyfill</a>.</p>
<h4 id="ä¸ä¼šæ”¹å˜è‡ªèº«çš„æ–¹æ³•-9ä¸ª"><a href="#ä¸ä¼šæ”¹å˜è‡ªèº«çš„æ–¹æ³•-9ä¸ª" class="headerlink" title="ä¸ä¼šæ”¹å˜è‡ªèº«çš„æ–¹æ³•(9ä¸ª)"></a>ä¸ä¼šæ”¹å˜è‡ªèº«çš„æ–¹æ³•(9ä¸ª)</h4><p>åŸºäºES7, ä¸ä¼šæ”¹å˜è‡ªèº«çš„æ–¹æ³•ä¸€å…±æœ‰9ä¸ª, åˆ†åˆ«ä¸ºconcat, join, slice, toString, toLocateString, indexOf, lastIndexOf, æœªæ ‡å‡†çš„toSource, ä»¥åŠES7æ–°å¢çš„æ–¹æ³•includes.z</p>
<h5 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h5><p>concat() æ–¹æ³•å°†ä¼ å…¥çš„æ•°ç»„æˆ–è€…å…ƒç´ ä¸åŸæ•°ç»„åˆå¹¶, ç»„æˆä¸€ä¸ªæ–°çš„æ•°ç»„å¹¶è¿”å›.</p>
<p>è¯­æ³•: <em>arr</em>.concat(<em>value1</em>, <em>value2</em>, â€¦, <em>valueN</em>)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> array2 = array.concat(<span class="number">4</span>,[<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]);</div><div class="line"><span class="built_in">console</span>.log(array2);<span class="comment">//[1, 2, 3, 4, 5, 6, 7, 8, 9]</span></div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//[1, 2, 3], å¯è§åŸæ•°ç»„å¹¶æœªè¢«ä¿®æ”¹</span></div></pre></td></tr></table></figure>
<p>åŒä¸Š, concat ä¸€æ ·å—ç›Šäºé¸­å¼è¾¨å‹, ä½†å…¶æ•ˆæœå¯èƒ½è¾¾ä¸åˆ°æˆ‘ä»¬çš„æœŸæœ›, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"a"</span>, <span class="number">1</span>:<span class="string">"b"</span>, <span class="number">2</span>:<span class="string">"c"</span>,<span class="attr">length</span>:<span class="number">3</span>&#125;;</div><div class="line"><span class="keyword">var</span> o2 = <span class="built_in">Array</span>.prototype.concat.call(o,<span class="string">'d'</span>,&#123;<span class="number">3</span>:<span class="string">'e'</span>,<span class="number">4</span>:<span class="string">'f'</span>,<span class="attr">length</span>:<span class="number">2</span>&#125;,[<span class="string">'g'</span>,<span class="string">'h'</span>,<span class="string">'i'</span>]);</div><div class="line"><span class="built_in">console</span>.log(o2);<span class="comment">//[&#123;0:"a", 1:"b", 2:"c", length:3&#125;, 'd', &#123;3:'e', 4:'f', length:2&#125;, 'g', 'h', 'i']</span></div></pre></td></tr></table></figure>
<p>å¯è§, ç±»æ•°ç»„å¯¹è±¡åˆå¹¶åè¿”å›çš„æ˜¯ä¾ç„¶æ˜¯æ•°ç»„, å¹¶ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„å¯¹è±¡.</p>
<h5 id="join"><a href="#join" class="headerlink" title="join"></a>join</h5><p>join() æ–¹æ³•å°†æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸².</p>
<p>è¯­æ³•: str = arr.join([separator = â€˜,â€™]) separatorå¯é€‰, ç¼ºçœé»˜è®¤ä¸ºé€—å·</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">'We'</span>, <span class="string">'are'</span>, <span class="string">'Chinese'</span>];</div><div class="line"><span class="built_in">console</span>.log(array.join());<span class="comment">//We,are,Chinese</span></div><div class="line"><span class="built_in">console</span>.log(array.join(<span class="string">'+'</span>));<span class="comment">//We+are+Chinese</span></div><div class="line"><span class="built_in">console</span>.log(array.join(<span class="string">''</span>));<span class="comment">//WeareChinese</span></div></pre></td></tr></table></figure>
<p>åŒä¸Š, join ä¸€æ ·å—ç›Šäºé¸­å¼è¾¨å‹, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"We"</span>, <span class="number">1</span>:<span class="string">"are"</span>, <span class="number">2</span>:<span class="string">"Chinese"</span>, <span class="attr">length</span>:<span class="number">3</span>&#125;;</div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.prototype.join.call(o,<span class="string">'+'</span>));<span class="comment">//We+are+Chinese</span></div></pre></td></tr></table></figure>
<h5 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h5><p>slice() æ–¹æ³•å°†æ•°ç»„ä¸­ä¸€éƒ¨åˆ†å…ƒç´ æµ…å¤åˆ¶å­˜å…¥æ–°çš„æ•°ç»„å¯¹è±¡, å¹¶ä¸”è¿”å›è¿™ä¸ªæ•°ç»„å¯¹è±¡.</p>
<p>è¯­æ³•: arr.slice(start[, end])</p>
<p>å‚æ•° start æŒ‡å®šå¤åˆ¶å¼€å§‹ä½ç½®çš„ç´¢å¼•, endå¦‚æœæœ‰å€¼åˆ™è¡¨ç¤ºå¤åˆ¶ç»“æŸä½ç½®çš„ç´¢å¼•(ä¸åŒ…æ‹¬æ­¤ä½ç½®).</p>
<p>å¦‚æœ start çš„å€¼ä¸ºè´Ÿæ•°, å‡å¦‚æ•°ç»„é•¿åº¦ä¸º length, åˆ™è¡¨ç¤ºä» length+start çš„ä½ç½®å¼€å§‹å¤åˆ¶, æ­¤æ—¶å‚æ•° end å¦‚æœæœ‰å€¼, åªèƒ½æ˜¯æ¯” start å¤§çš„è´Ÿæ•°, å¦åˆ™å°†è¿”å›ç©ºæ•°ç»„.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"one"</span>, <span class="string">"two"</span>, <span class="string">"three"</span>,<span class="string">"four"</span>, <span class="string">"five"</span>];</div><div class="line"><span class="keyword">var</span> array2 = array.slice(<span class="number">2</span>,<span class="number">3</span>);</div><div class="line"><span class="built_in">console</span>.log(array2);<span class="comment">//["three"]</span></div></pre></td></tr></table></figure>
<p><em>æµ…å¤åˆ¶</em> æ˜¯æŒ‡å½“å¯¹è±¡çš„è¢«å¤åˆ¶æ—¶, åªæ˜¯å¤åˆ¶äº†å¯¹è±¡çš„å¼•ç”¨, æŒ‡å‘çš„ä¾ç„¶æ˜¯åŒä¸€ä¸ªå¯¹è±¡. ä¸‹é¢æ¥è¯´æ˜sliceä¸ºä»€ä¹ˆæ˜¯æµ…å¤åˆ¶.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [&#123;<span class="attr">color</span>:<span class="string">"yellow"</span>&#125;, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> array2 = array.slice(<span class="number">0</span>,<span class="number">1</span>);</div><div class="line"><span class="built_in">console</span>.log(array2);<span class="comment">//[&#123;color:"yellow"&#125;]</span></div><div class="line">array[<span class="number">0</span>][<span class="string">"color"</span>] = <span class="string">"blue"</span>;</div><div class="line"><span class="built_in">console</span>.log(array2);<span class="comment">//[&#123;color:"bule"&#125;]</span></div></pre></td></tr></table></figure>
<p>ç”±äºsliceæ˜¯æµ…å¤åˆ¶, å¤åˆ¶åˆ°çš„å¯¹è±¡åªæ˜¯ä¸€ä¸ªå¼•ç”¨, æ”¹å˜åŸæ•°ç»„arrayçš„å€¼, array2ä¹Ÿéšä¹‹æ”¹å˜.</p>
<p>åŒæ—¶, ç¨å¾®åˆ©ç”¨ä¸‹ slice æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè´Ÿæ•°æ—¶çš„ç‰¹æ€§, æˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿çš„æ‹¿åˆ°æ•°ç»„çš„æœ€åä¸€é¡¹å…ƒç´ , å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].slice(<span class="number">-1</span>));<span class="comment">//[3]</span></div></pre></td></tr></table></figure>
<p>åŒä¸Š, slice ä¸€æ ·å—ç›Šäºé¸­å¼è¾¨å‹, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:&#123;<span class="string">"color"</span>:<span class="string">"yellow"</span>&#125;, <span class="number">1</span>:<span class="number">2</span>, <span class="number">2</span>:<span class="number">3</span>, <span class="attr">length</span>:<span class="number">3</span>&#125;;</div><div class="line"><span class="keyword">var</span> o2 = <span class="built_in">Array</span>.prototype.slice.call(o,<span class="number">0</span>,<span class="number">1</span>);</div><div class="line"><span class="built_in">console</span>.log(o2);<span class="comment">//[&#123;color:"yellow"&#125;] ,æ¯«æ— è¿å’Œæ„Ÿ...</span></div></pre></td></tr></table></figure>
<p>é‰´äºIE9ä»¥ä¸‹ç‰ˆæœ¬å¯¹äºè¯¥æ–¹æ³•æ”¯æŒæ€§å¹¶ä¸æ˜¯å¾ˆå¥½, å¦‚éœ€æ›´å¥½çš„æ”¯æŒä½ç‰ˆæœ¬IEæµè§ˆå™¨, è¯·å‚è€ƒ<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/slice#æ›´å¯é åœ°è·¨æµè§ˆå™¨" target="_blank" rel="external">æ›´å¯é åœ°è·¨æµè§ˆå™¨</a></p>
<h5 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString"></a>toString</h5><p>toString() æ–¹æ³•è¿”å›æ•°ç»„çš„å­—ç¬¦ä¸²å½¢å¼, è¯¥å­—ç¬¦ä¸²ç”±æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ <code>toString()</code> è¿”å›å€¼ç»è°ƒç”¨ <code>join()</code> æ–¹æ³•è¿æ¥ï¼ˆç”±é€—å·éš”å¼€ï¼‰ç»„æˆ.</p>
<p>è¯­æ³•: <em>arr</em>.toString()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">'Jan'</span>, <span class="string">'Feb'</span>, <span class="string">'Mar'</span>, <span class="string">'Apr'</span>];</div><div class="line"><span class="keyword">var</span> str = array.toString();</div><div class="line"><span class="built_in">console</span>.log(str);<span class="comment">//Jan,Feb,Mar,Apr</span></div></pre></td></tr></table></figure>
<p>å½“æ•°ç»„ç›´æ¥å’Œå­—ç¬¦ä¸²ä½œè¿æ¥æ“ä½œæ—¶, å°†ä¼šè‡ªåŠ¨è°ƒç”¨å…¶toString() æ–¹æ³•.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = [<span class="string">'Jan'</span>, <span class="string">'Feb'</span>, <span class="string">'Mar'</span>, <span class="string">'Apr'</span>] + <span class="string">',May'</span>;</div><div class="line"><span class="built_in">console</span>.log(str);<span class="comment">//Jan,Feb,Mar,Apr,May</span></div><div class="line"><span class="comment">//ä¸‹é¢æˆ‘ä»¬æ¥è¯•è¯•é¸­å¼è¾¨å‹</span></div><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">'Jan'</span>, <span class="number">1</span>:<span class="string">'Feb'</span>, <span class="number">2</span>:<span class="string">'Mar'</span>, <span class="attr">length</span>:<span class="number">3</span>&#125;;</div><div class="line"><span class="keyword">var</span> o2 = <span class="built_in">Array</span>.prototype.toString.call(o);</div><div class="line"><span class="built_in">console</span>.log(o2);<span class="comment">//[object Object]</span></div><div class="line"><span class="built_in">console</span>.log(o.toString()==o2);<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>å¯è§, Array.prototype.toString()æ–¹æ³•å¤„ç†ç±»æ•°ç»„å¯¹è±¡æ—¶, è·Ÿç±»æ•°ç»„å¯¹è±¡ç›´æ¥è°ƒç”¨Object.prototype.toString() æ–¹æ³•ç»“æœå®Œå…¨ä¸€è‡´, è¯´å¥½çš„é¸­å¼è¾¨å‹å‘¢?</p>
<p>æ ¹æ®ES5è¯­ä¹‰, toString() æ–¹æ³•æ˜¯é€šç”¨çš„, å¯è¢«ç”¨äºä»»ä½•å¯¹è±¡, å¦‚æœå¯¹è±¡æœ‰ä¸€ä¸ªjoin() æ–¹æ³•, å°†ä¼šè¢«è°ƒç”¨, å…¶è¿”å›å€¼å°†è¢«è¿”å›, æ²¡æœ‰åˆ™è°ƒç”¨Object.prototype.toString(), ä¸ºæ­¤, æˆ‘ä»¬ç»™oå¯¹è±¡æ·»åŠ ä¸€ä¸ªjoinæ–¹æ³•, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;</div><div class="line">  <span class="number">0</span>:<span class="string">'Jan'</span>, </div><div class="line">  <span class="number">1</span>:<span class="string">'Feb'</span>, </div><div class="line">  <span class="number">2</span>:<span class="string">'Mar'</span>, </div><div class="line">  <span class="attr">length</span>:<span class="number">3</span>, </div><div class="line">  <span class="attr">join</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.join.call(<span class="keyword">this</span>);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.prototype.toString.call(o));<span class="comment">//Jan,Feb,Mar</span></div></pre></td></tr></table></figure>
<h5 id="toLocaleString-NaN"><a href="#toLocaleString-NaN" class="headerlink" title="toLocaleString"></a>toLocaleString</h5><p>toLocaleString() ç±»ä¼¼toString()çš„å˜ä½“, è¯¥å­—ç¬¦ä¸²ç”±æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ <code>toLocaleString()</code> è¿”å›å€¼ç»è°ƒç”¨ <code>join()</code> æ–¹æ³•è¿æ¥ï¼ˆç”±é€—å·éš”å¼€ï¼‰ç»„æˆ.</p>
<p>è¯­æ³•: <em>arr</em>.toLocaleString()</p>
<p>æ•°ç»„ä¸­çš„å…ƒç´ å°†è°ƒç”¨å„è‡ªçš„ toLocaleString æ–¹æ³•:</p>
<ul>
<li><code>Object</code>: <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/toLocaleString" target="_blank" rel="external"><code>Object.prototype.toLocaleString()</code></a></li>
<li><code>Number</code>: <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Number/toLocaleString" target="_blank" rel="external"><code>Number.prototype.toLocaleString()</code></a></li>
<li><code>Date</code>: <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleString" target="_blank" rel="external"><code>Date.prototype.toLocaleString()</code></a></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array= [&#123;<span class="attr">name</span>:<span class="string">'zz'</span>&#125;, <span class="number">123</span>, <span class="string">"abc"</span>, <span class="keyword">new</span> <span class="built_in">Date</span>()];</div><div class="line"><span class="keyword">var</span> str = array.toLocaleString();</div><div class="line"><span class="built_in">console</span>.log(str);<span class="comment">//[object Object],123,abc,2016/1/5 ä¸‹åˆ1:06:23</span></div></pre></td></tr></table></figure>
<p>å…¶é¸­å¼è¾¨å‹çš„å†™æ³•ä¹ŸåŒtoString ä¿æŒä¸€è‡´, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;</div><div class="line">  <span class="number">0</span>:<span class="number">123</span>, </div><div class="line">  <span class="number">1</span>:<span class="string">'abc'</span>, </div><div class="line">  <span class="number">2</span>:<span class="keyword">new</span> <span class="built_in">Date</span>(), </div><div class="line">  <span class="attr">length</span>:<span class="number">3</span>, </div><div class="line">  <span class="attr">join</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.join.call(<span class="keyword">this</span>);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.prototype.toLocaleString.call(o));<span class="comment">//123,abc,2016/1/5 ä¸‹åˆ1:16:50</span></div></pre></td></tr></table></figure>
<h5 id="indexOf"><a href="#indexOf" class="headerlink" title="indexOf"></a>indexOf</h5><p>indexOf() æ–¹æ³•ç”¨äºæŸ¥æ‰¾å…ƒç´ åœ¨æ•°ç»„ä¸­ç¬¬ä¸€æ¬¡å‡ºç°æ—¶çš„ç´¢å¼•, å¦‚æœæ²¡æœ‰, åˆ™è¿”å›-1.</p>
<p>è¯­æ³•: <em>arr</em>.indexOf(element, fromIndex=0)</p>
<p>element ä¸ºéœ€è¦æŸ¥æ‰¾çš„å…ƒç´ </p>
<p>fromIndex ä¸ºå¼€å§‹æŸ¥æ‰¾çš„ä½ç½®, ç¼ºçœé»˜è®¤ä¸º0. å¦‚æœè¶…å‡ºæ•°ç»„é•¿åº¦, åˆ™è¿”å›-1. å¦‚æœä¸ºè´Ÿå€¼, å‡è®¾æ•°ç»„é•¿åº¦ä¸ºlength, åˆ™ä»æ•°ç»„çš„ç¬¬ length + fromIndexé¡¹å¼€å§‹å¾€æ•°ç»„æœ«å°¾æŸ¥æ‰¾, å¦‚æœlength + fromIndex&lt;0 åˆ™æ•´ä¸ªæ•°ç»„éƒ½ä¼šè¢«æŸ¥æ‰¾.</p>
<p>indexOfä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰(å³ä½¿ç”¨ === å»åŒ¹é…æ•°ç»„ä¸­çš„å…ƒç´ )</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">'abc'</span>, <span class="string">'def'</span>, <span class="string">'ghi'</span>,<span class="string">'123'</span>];</div><div class="line"><span class="built_in">console</span>.log(array.indexOf(<span class="string">'def'</span>));<span class="comment">//1</span></div><div class="line"><span class="built_in">console</span>.log(array.indexOf(<span class="string">'def'</span>,<span class="number">-1</span>));<span class="comment">//1 æ­¤æ—¶è¡¨ç¤ºä»æœ€åä¸€ä¸ªå…ƒç´ å¾€åæŸ¥æ‰¾,å› æ­¤æŸ¥æ‰¾å¤±è´¥è¿”å›-1</span></div><div class="line"><span class="built_in">console</span>.log(array.indexOf(<span class="string">'def'</span>,<span class="number">-4</span>));<span class="comment">//1 ç”±äº4å¤§äºæ•°ç»„é•¿åº¦,æ­¤æ—¶å°†æŸ¥æ‰¾æ•´ä¸ªæ•°ç»„,å› æ­¤è¿”å›1</span></div><div class="line"><span class="built_in">console</span>.log(array.indexOf(<span class="number">123</span>));<span class="comment">//-1, ç”±äºæ˜¯ä¸¥æ ¼åŒ¹é…,å› æ­¤å¹¶ä¸ä¼šåŒ¹é…åˆ°å­—ç¬¦ä¸²'123'</span></div></pre></td></tr></table></figure>
<p>å¾—ç›Šäºé¸­å¼è¾¨å‹, indexOf å¯ä»¥å¤„ç†ç±»æ•°ç»„å¯¹è±¡, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">'abc'</span>, <span class="number">1</span>:<span class="string">'def'</span>, <span class="number">2</span>:<span class="string">'ghi'</span>, <span class="attr">length</span>:<span class="number">3</span>&#125;;</div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.prototype.indexOf.call(o,<span class="string">'ghi'</span>,<span class="number">-4</span>));<span class="comment">//2</span></div></pre></td></tr></table></figure>
<p>ç„¶è€Œè¯¥æ–¹æ³•å¹¶ä¸æ”¯æŒIE9ä»¥ä¸‹ç‰ˆæœ¬, å¦‚éœ€æ›´å¥½çš„æ”¯æŒä½ç‰ˆæœ¬IEæµè§ˆå™¨(IE6~8), è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf#Polyfill" target="_blank" rel="external">Polyfill</a>.</p>
<h5 id="lastIndexOf"><a href="#lastIndexOf" class="headerlink" title="lastIndexOf"></a>lastIndexOf</h5><p>lastIndexOf() æ–¹æ³•ç”¨äºæŸ¥æ‰¾å…ƒç´ åœ¨æ•°ç»„ä¸­æœ€åä¸€æ¬¡å‡ºç°æ—¶çš„ç´¢å¼•, å¦‚æœæ²¡æœ‰, åˆ™è¿”å›-1. å¹¶ä¸”å®ƒæ˜¯indexOfçš„é€†å‘æŸ¥æ‰¾, å³ä»æ•°ç»„æœ€åä¸€ä¸ªå¾€å‰æŸ¥æ‰¾.</p>
<p>è¯­æ³•: <em>arr</em>.lastIndexOf(element, fromIndex=length-1)</p>
<p>element ä¸ºéœ€è¦æŸ¥æ‰¾çš„å…ƒç´ </p>
<p>fromIndex ä¸ºå¼€å§‹æŸ¥æ‰¾çš„ä½ç½®, ç¼ºçœé»˜è®¤ä¸ºæ•°ç»„é•¿åº¦length-1. å¦‚æœè¶…å‡ºæ•°ç»„é•¿åº¦, ç”±äºæ˜¯é€†å‘æŸ¥æ‰¾, åˆ™æŸ¥æ‰¾æ•´ä¸ªæ•°ç»„. å¦‚æœä¸ºè´Ÿå€¼, åˆ™ä»æ•°ç»„çš„ç¬¬ length + fromIndexé¡¹å¼€å§‹å¾€æ•°ç»„å¼€å¤´æŸ¥æ‰¾, å¦‚æœlength + fromIndex&lt;0 åˆ™æ•°ç»„ä¸ä¼šè¢«æŸ¥æ‰¾.</p>
<p>åŒ indexOf ä¸€æ ·, lastIndexOf ä¹Ÿæ˜¯ä¸¥æ ¼åŒ¹é…æ•°ç»„å…ƒç´ .</p>
<p>æ —å­å‚è€ƒ <code>indexOf</code> , ä¸å†è¯¦è¿°, å…¼å®¹ä½ç‰ˆæœ¬IEæµè§ˆå™¨(IE6~8), è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/lastIndexOf#Compatibility" target="_blank" rel="external">Polyfill</a>.</p>
<h5 id="includes-ES6"><a href="#includes-ES6" class="headerlink" title="includes(ES6)"></a>includes(ES6)</h5><p>includes() æ–¹æ³•åŸºäº<strong>ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ</strong>, å®ƒç”¨æ¥åˆ¤æ–­å½“å‰æ•°ç»„æ˜¯å¦åŒ…å«æŸä¸ªæŒ‡å®šçš„å€¼, å¦‚æœæ˜¯, åˆ™è¿”å› true, å¦åˆ™è¿”å› false.</p>
<p>è¯­æ³•: <em>arr</em>.includes(element, fromIndex=0)</p>
<p>element ä¸ºéœ€è¦æŸ¥æ‰¾çš„å…ƒç´ </p>
<p>fromIndex è¡¨ç¤ºä»è¯¥ç´¢å¼•ä½ç½®å¼€å§‹æŸ¥æ‰¾ element, ç¼ºçœä¸º0, å®ƒæ˜¯æ­£å‘æŸ¥æ‰¾, å³ä»ç´¢å¼•å¤„å¾€æ•°ç»„æœ«å°¾æŸ¥æ‰¾.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="literal">NaN</span>];</div><div class="line"><span class="built_in">console</span>.log(array.includes(<span class="number">1</span>));<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(array.includes(<span class="literal">NaN</span>));<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(array.includes(<span class="number">2</span>,<span class="number">-4</span>));<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•åŒæ ·å—ç›Šäºé¸­å¼è¾¨å‹. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">'a'</span>, <span class="number">1</span>:<span class="string">'b'</span>, <span class="number">2</span>:<span class="string">'c'</span>, <span class="attr">length</span>:<span class="number">3</span>&#125;;</div><div class="line"><span class="keyword">var</span> bool = <span class="built_in">Array</span>.prototype.includes.call(o, <span class="string">'a'</span>);</div><div class="line"><span class="built_in">console</span>.log(bool);<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•åªæœ‰åœ¨Chrome 47, opera 34, Safari 9ç‰ˆæœ¬åŠå…¶æ›´é«˜ç‰ˆæœ¬ä¸­æ‰äºˆä»¥å®ç°. å¦‚éœ€æ”¯æŒå…¶ä»–æµè§ˆå™¨, è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/includes#Polyfill" target="_blank" rel="external">Polyfill</a>.</p>
<h5 id="toSource"><a href="#toSource" class="headerlink" title="toSource"></a>toSource</h5><p>toSource() æ–¹æ³•æ˜¯éæ ‡å‡†çš„, è¯¥æ–¹æ³•è¿”å›æ•°ç»„çš„æºä»£ç , ç›®å‰åªæœ‰ Firefox å®ç°äº†å®ƒ.</p>
<p>è¯­æ³•: <em>arr</em>.toSource()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</div><div class="line"><span class="built_in">console</span>.log(array.toSource());<span class="comment">//["a", "b", "c"]</span></div><div class="line"><span class="comment">//æµ‹è¯•é¸­å¼è¾¨å‹</span></div><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">'a'</span>, <span class="number">1</span>:<span class="string">'b'</span>, <span class="number">2</span>:<span class="string">'c'</span>, <span class="attr">length</span>:<span class="number">3</span>&#125;;</div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.prototype.toSource.call(o));<span class="comment">//["a","b","c"]</span></div></pre></td></tr></table></figure>
<h4 id="éå†æ–¹æ³•-12ä¸ª"><a href="#éå†æ–¹æ³•-12ä¸ª" class="headerlink" title="éå†æ–¹æ³•(12ä¸ª)"></a>éå†æ–¹æ³•(12ä¸ª)</h4><p>åŸºäºES6, ä¸ä¼šæ”¹å˜è‡ªèº«çš„æ–¹æ³•ä¸€å…±æœ‰12ä¸ª, åˆ†åˆ«ä¸ºforEach, every, some, filter, map, reduce, reduceRight, ä»¥åŠES6æ–°å¢çš„æ–¹æ³•entries, find, findIndex, keys, values.</p>
<h5 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h5><p>forEach() æ–¹æ³•æŒ‡å®šæ•°ç»„çš„æ¯é¡¹å…ƒç´ éƒ½æ‰§è¡Œä¸€æ¬¡ä¼ å…¥çš„å‡½æ•°, è¿”å›å€¼ä¸ºundefined.</p>
<p>è¯­æ³•: <em>arr</em>.forEach(fn, thisArg)</p>
<p>fn è¡¨ç¤ºåœ¨æ•°ç»„æ¯ä¸€é¡¹ä¸Šæ‰§è¡Œçš„å‡½æ•°, æ¥å—ä¸‰ä¸ªå‚æ•°:</p>
<ul>
<li>value å½“å‰æ­£åœ¨è¢«å¤„ç†çš„å…ƒç´ çš„å€¼</li>
<li>index å½“å‰å…ƒç´ çš„æ•°ç»„ç´¢å¼•</li>
<li>array æ•°ç»„æœ¬èº«</li>
</ul>
<p>thisArg å¯é€‰, ç”¨æ¥å½“åšfnå‡½æ•°å†…çš„thiså¯¹è±¡(context ä¸Šä¸‹æ–‡).</p>
<p>forEach å°†ä¸ºæ•°ç»„ä¸­æ¯ä¸€é¡¹æ‰§è¡Œä¸€æ¬¡ fn å‡½æ•°, é‚£äº›å·²åˆ é™¤, æ–°å¢æˆ–è€…ä»æœªèµ‹å€¼çš„é¡¹å°†è¢«è·³è¿‡(ä½†ä¸åŒ…æ‹¬å€¼ä¸º undefined çš„é¡¹). éå†è¿‡ç¨‹ä¸­, fnä¼šè¢«ä¼ å…¥ä¸Šè¿°ä¸‰ä¸ªå‚æ•°.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>];</div><div class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">name</span>:<span class="string">'cc'</span>&#125;;</div><div class="line"><span class="keyword">var</span> sReturn = array.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, array</span>)</span>&#123;</div><div class="line">  array[index] = value * value;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);<span class="comment">//ccè¢«æ‰“å°äº†ä¸‰æ¬¡</span></div><div class="line">&#125;,obj);</div><div class="line"><span class="built_in">console</span>.log(array);<span class="comment">//[1, 9, 25], å¯è§åŸæ•°ç»„æ”¹å˜äº†</span></div><div class="line"><span class="built_in">console</span>.log(sReturn);<span class="comment">//undefined, å¯è§è¿”å›å€¼ä¸ºundefined</span></div></pre></td></tr></table></figure>
<p>å¾—ç›Šäºé¸­å¼è¾¨å‹, è™½ç„¶forEachä¸èƒ½ç›´æ¥éå†å¯¹è±¡, ä½†å®ƒå¯ä»¥é€šè¿‡callæ–¹å¼éå†ç±»æ•°ç»„å¯¹è±¡. å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="number">1</span>, <span class="number">1</span>:<span class="number">3</span>, <span class="number">2</span>:<span class="number">5</span>, <span class="attr">length</span>:<span class="number">3</span>&#125;;</div><div class="line"><span class="built_in">Array</span>.prototype.forEach.call(o,<span class="function"><span class="keyword">function</span>(<span class="params">value, index, obj</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(value,index,obj);</div><div class="line">  obj[index] = value * value;</div><div class="line">&#125;,o);</div><div class="line"><span class="comment">//1 0 Object &#123;0: 1, 1: 3, 2: 5, length: 3&#125;</span></div><div class="line"><span class="comment">//3 1 Object &#123;0: 1, 1: 3, 2: 5, length: 3&#125;</span></div><div class="line"><span class="comment">//5 2 Object &#123;0: 1, 1: 9, 2: 5, length: 3&#125;</span></div><div class="line"><span class="built_in">console</span>.log(o);<span class="comment">//Object &#123;0: 1, 1: 9, 2: 25, length: 3&#125;</span></div></pre></td></tr></table></figure>
<p>å‚è€ƒå‰é¢çš„æ–‡ç«  <a href="http://louiszhai.github.io/2015/12/18/traverse/#forEach"><code>è¯¦è§£JSéå†</code></a> ä¸­ forEachçš„è®²è§£, æˆ‘ä»¬çŸ¥é“, forEachæ— æ³•ç›´æ¥é€€å‡ºå¾ªç¯, åªèƒ½ä½¿ç”¨return æ¥è¾¾åˆ°forå¾ªç¯ä¸­continueçš„æ•ˆæœ, å¹¶ä¸”forEachä¸èƒ½åœ¨ä½ç‰ˆæœ¬IE(6~8)ä¸­ä½¿ç”¨, å…¼å®¹å†™æ³•è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach#å…¼å®¹æ—§ç¯å¢ƒï¼ˆPolyfillï¼‰" target="_blank" rel="external">Polyfill</a> .</p>
<h5 id="every"><a href="#every" class="headerlink" title="every"></a>every</h5><p>every() æ–¹æ³•ä½¿ç”¨ä¼ å…¥çš„å‡½æ•°æµ‹è¯•æ‰€æœ‰å…ƒç´ , åªè¦å…¶ä¸­æœ‰ä¸€ä¸ªå‡½æ•°è¿”å›å€¼ä¸º false, é‚£ä¹ˆè¯¥æ–¹æ³•çš„ç»“æœä¸º false; å¦‚æœå…¨éƒ¨è¿”å› true, é‚£ä¹ˆè¯¥æ–¹æ³•çš„ç»“æœæ‰ä¸º true. å› æ­¤ every æ–¹æ³•å­˜åœ¨å¦‚ä¸‹è§„å¾‹:</p>
<ul>
<li>è‹¥éœ€æ£€æµ‹æ•°ç»„ä¸­å­˜åœ¨å…ƒç´ å¤§äº100 (å³, one &gt; 100), é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨ä¼ å…¥çš„å‡½æ•°ä¸­æ„é€  â€œfalseâ€ è¿”å›å€¼ (å³, è¿”å› item &lt;= 100), åŒæ—¶æ•´ä¸ªæ–¹æ³•ç»“æœä¸º false æ‰è¡¨ç¤ºæ•°ç»„å­˜åœ¨å…ƒç´ æ»¡è¶³æ¡ä»¶; (ç®€å•ç†è§£ä¸º, è‹¥æ˜¯å•é¡¹åˆ¤æ–­, å¯ç”¨ one false ===&gt; false)</li>
</ul>
<ul>
<li>è‹¥éœ€æ£€æµ‹æ•°ç»„ä¸­æ˜¯å¦æ‰€æœ‰å…ƒç´ éƒ½å¤§äº100 (å³, all &gt; 100),  é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨ä¼ å…¥çš„å‡½æ•°ä¸­æ„é€  â€œtrueâ€ è¿”å›å€¼ (å³, è¿”å› item &gt; 100), åŒæ—¶æ•´ä¸ªæ–¹æ³•ç»“æœä¸º true æ‰è¡¨ç¤ºæ•°ç»„æ‰€æœ‰å…ƒç´ å‡æ»¡è¶³æ¡ä»¶. (ç®€å•ç†è§£ä¸º, è‹¥æ˜¯å…¨éƒ¨åˆ¤æ–­, å¯ç”¨ all true ===&gt; true)</li>
</ul>
<p>è¯­æ³•åŒä¸Šè¿°forEach, å…·ä½“è¿˜å¯ä»¥å‚è€ƒ <a href="http://louiszhai.github.io/2015/12/18/traverse/#every"><code>è¯¦è§£JSéå†</code></a> ä¸­everyçš„è®²è§£.</p>
<p>ä»¥ä¸‹æ˜¯é¸­å¼è¾¨å‹çš„å†™æ³•:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="number">10</span>, <span class="number">1</span>:<span class="number">8</span>, <span class="number">2</span>:<span class="number">25</span>, <span class="attr">length</span>:<span class="number">3</span>&#125;;</div><div class="line"><span class="keyword">var</span> bool = <span class="built_in">Array</span>.prototype.every.call(o,<span class="function"><span class="keyword">function</span>(<span class="params">value, index, obj</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> value &gt;= <span class="number">8</span>;</div><div class="line">&#125;,o);</div><div class="line"><span class="built_in">console</span>.log(bool);<span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>every ä¸€æ ·ä¸èƒ½åœ¨ä½ç‰ˆæœ¬IE(6~8)ä¸­ä½¿ç”¨, å…¼å®¹å†™æ³•è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/every#Compatibility" target="_blank" rel="external">Polyfill</a> .</p>
<h5 id="some"><a href="#some" class="headerlink" title="some"></a>some</h5><p>some() æ–¹æ³•åˆšå¥½åŒ every() æ–¹æ³•ç›¸å, some æµ‹è¯•æ•°ç»„å…ƒç´ æ—¶, åªè¦æœ‰ä¸€ä¸ªå‡½æ•°è¿”å›å€¼ä¸º true, åˆ™è¯¥æ–¹æ³•è¿”å› true, è‹¥å…¨éƒ¨è¿”å› false, åˆ™è¯¥æ–¹æ³•è¿”å› false. å› æ­¤ some æ–¹æ³•å­˜åœ¨å¦‚ä¸‹è§„å¾‹:</p>
<ul>
<li>è‹¥éœ€æ£€æµ‹æ•°ç»„ä¸­å­˜åœ¨å…ƒç´ å¤§äº100 (å³, one &gt; 100), é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨ä¼ å…¥çš„å‡½æ•°ä¸­æ„é€  â€œtrueâ€ è¿”å›å€¼ (å³, è¿”å› item &gt; 100), åŒæ—¶æ•´ä¸ªæ–¹æ³•ç»“æœä¸º true æ‰è¡¨ç¤ºæ•°ç»„å­˜åœ¨å…ƒç´ æ»¡è¶³æ¡ä»¶; (ç®€å•ç†è§£ä¸º, è‹¥æ˜¯å•é¡¹åˆ¤æ–­, å¯ç”¨ one true ===&gt; true)</li>
</ul>
<ul>
<li>è‹¥éœ€æ£€æµ‹æ•°ç»„ä¸­æ˜¯å¦æ‰€æœ‰å…ƒç´ éƒ½å¤§äº100 (å³, all &gt; 100),  é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨ä¼ å…¥çš„å‡½æ•°ä¸­æ„é€  â€œfalseâ€ è¿”å›å€¼ (å³, è¿”å› item &lt;= 100), åŒæ—¶æ•´ä¸ªæ–¹æ³•ç»“æœä¸º false æ‰è¡¨ç¤ºæ•°ç»„æ‰€æœ‰å…ƒç´ å‡æ»¡è¶³æ¡ä»¶. (ç®€å•ç†è§£ä¸º, è‹¥æ˜¯å…¨éƒ¨åˆ¤æ–­, å¯ç”¨ all false ===&gt; false)</li>
</ul>
<p>some çš„é¸­å¼è¾¨å‹å†™æ³•å¯ä»¥å‚ç…§every,  åŒæ ·å®ƒä¹Ÿä¸èƒ½åœ¨ä½ç‰ˆæœ¬IE(6~8)ä¸­ä½¿ç”¨, å…¼å®¹å†™æ³•è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/some#Compatibility" target="_blank" rel="external">Polyfill</a> .</p>
<h5 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h5><p>filter() æ–¹æ³•ä½¿ç”¨ä¼ å…¥çš„å‡½æ•°æµ‹è¯•æ‰€æœ‰å…ƒç´ , å¹¶è¿”å›æ‰€æœ‰é€šè¿‡æµ‹è¯•çš„å…ƒç´ ç»„æˆçš„æ–°æ•°ç»„.</p>
<p>è¯­æ³•: <em>arr</em>.filter(fn, thisArg)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">18</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">35</span>, <span class="number">80</span>];</div><div class="line"><span class="keyword">var</span> array2 = array.filter(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, array</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> value &gt; <span class="number">20</span>;</div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(array2);<span class="comment">//[35, 80]</span></div></pre></td></tr></table></figure>
<p>filterä¸€æ ·æ”¯æŒé¸­å¼è¾¨å‹, å…·ä½“è¯·å‚è€ƒeveryæ–¹æ³•é¸­å¼è¾¨å‹å†™æ³•. å…¶åœ¨ä½ç‰ˆæœ¬IE(6~8) çš„å…¼å®¹å†™æ³•è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/filter#Compatibility" target="_blank" rel="external">Polyfill</a> .</p>
<h5 id="map"><a href="#map" class="headerlink" title="map"></a>map</h5><p>map() æ–¹æ³•éå†æ•°ç»„, ä½¿ç”¨ä¼ å…¥å‡½æ•°å¤„ç†æ¯ä¸ªå…ƒç´ , å¹¶è¿”å›å‡½æ•°çš„è¿”å›å€¼ç»„æˆçš„æ–°æ•°ç»„.</p>
<p>è¯­æ³•: <em>arr</em>.map(fn, thisArg)</p>
<p>å‚æ•°ä»‹ç»åŒ forEach æ–¹æ³•çš„å‚æ•°ä»‹ç».</p>
<p>å…·ä½“ç”¨æ³•è¯·å‚è€ƒ <a href="http://louiszhai.github.io/2015/12/18/traverse/#map"><code>è¯¦è§£JSéå†</code></a> ä¸­ map çš„è®²è§£.</p>
<p>map ä¸€æ ·æ”¯æŒé¸­å¼è¾¨å‹, å…·ä½“è¯·å‚è€ƒeveryæ–¹æ³•é¸­å¼è¾¨å‹å†™æ³•.</p>
<p>å…¶åœ¨ä½ç‰ˆæœ¬IE(6~8) çš„å…¼å®¹å†™æ³•è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/map#Compatibility" target="_blank" rel="external">Polyfill</a> .</p>
<h5 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h5><p>reduce() æ–¹æ³•æ¥æ”¶ä¸€ä¸ªæ–¹æ³•ä½œä¸ºç´¯åŠ å™¨, æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼(ä»å·¦è‡³å³) å¼€å§‹åˆå¹¶, æœ€ç»ˆä¸ºä¸€ä¸ªå€¼.</p>
<p>è¯­æ³•: <em>arr</em>.reduce(fn, initialValue)</p>
<p>fn è¡¨ç¤ºåœ¨æ•°ç»„æ¯ä¸€é¡¹ä¸Šæ‰§è¡Œçš„å‡½æ•°, æ¥å—å››ä¸ªå‚æ•°:</p>
<ul>
<li>previousValue ä¸Šä¸€æ¬¡è°ƒç”¨å›è°ƒè¿”å›çš„å€¼, æˆ–è€…æ˜¯æä¾›çš„åˆå§‹å€¼</li>
<li>value æ•°ç»„ä¸­å½“å‰è¢«å¤„ç†å…ƒç´ çš„å€¼</li>
<li>index å½“å‰å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•</li>
<li>array æ•°ç»„è‡ªèº«</li>
</ul>
<p>initialValue æŒ‡å®šç¬¬ä¸€æ¬¡è°ƒç”¨ fn çš„ç¬¬ä¸€ä¸ªå‚æ•°.</p>
<p>å½“ fn ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶, </p>
<ul>
<li>å¦‚æœ initialValue åœ¨è°ƒç”¨ reduce æ—¶è¢«æä¾›, é‚£ä¹ˆç¬¬ä¸€ä¸ª previousValue å°†ç­‰äº initialValue, æ­¤æ—¶ item ç­‰äºæ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå€¼;</li>
<li>å¦‚æœ initialValue æœªè¢«æä¾›, é‚£ä¹ˆ previousVaule ç­‰äºæ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå€¼, item ç­‰äºæ•°ç»„ä¸­çš„ç¬¬äºŒä¸ªå€¼. æ­¤æ—¶å¦‚æœæ•°ç»„ä¸ºç©º, é‚£ä¹ˆå°†æŠ›å‡º TypeError.</li>
<li>å¦‚æœæ•°ç»„ä»…æœ‰ä¸€ä¸ªå…ƒç´ , å¹¶ä¸”æ²¡æœ‰æä¾› initialValue, æˆ–æä¾›äº† initialValue ä½†æ•°ç»„ä¸ºç©º, é‚£ä¹ˆfnä¸ä¼šè¢«æ‰§è¡Œ, æ•°ç»„çš„å”¯ä¸€å€¼å°†è¢«è¿”å›.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</div><div class="line"><span class="keyword">var</span> s = array.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">previousValue, value, index, array</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> previousValue * value;</div><div class="line">&#125;,<span class="number">1</span>);</div><div class="line"><span class="built_in">console</span>.log(s);<span class="comment">//24</span></div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå›è°ƒè¢«è°ƒç”¨4æ¬¡, æ¯æ¬¡çš„å‚æ•°å’Œè¿”å›è§ä¸‹è¡¨:</p>
<table>
<thead>
<tr>
<th style="text-align:center">callback</th>
<th style="text-align:center">previousValue</th>
<th style="text-align:center">currentValue</th>
<th style="text-align:center">index</th>
<th style="text-align:center">array</th>
<th style="text-align:center">return value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ç¬¬1æ¬¡</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">[1,2,3,4]</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">ç¬¬2æ¬¡</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2</td>
<td style="text-align:center">2</td>
<td style="text-align:center">[1,2,3,4]</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">ç¬¬3æ¬¡</td>
<td style="text-align:center">2</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3</td>
<td style="text-align:center">[1,2,3,4]</td>
<td style="text-align:center">6</td>
</tr>
<tr>
<td style="text-align:center">ç¬¬4æ¬¡</td>
<td style="text-align:center">6</td>
<td style="text-align:center">4</td>
<td style="text-align:center">4</td>
<td style="text-align:center">[1,2,3,4]</td>
<td style="text-align:center">24</td>
</tr>
</tbody>
</table>
<p>reduce ä¸€æ ·æ”¯æŒé¸­å¼è¾¨å‹, å…·ä½“è¯·å‚è€ƒeveryæ–¹æ³•é¸­å¼è¾¨å‹å†™æ³•.</p>
<p>å…¶åœ¨ä½ç‰ˆæœ¬IE(6~8) çš„å…¼å®¹å†™æ³•è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce#å…¼å®¹æ—§ç¯å¢ƒï¼ˆPolyfillï¼‰" target="_blank" rel="external">Polyfill</a> .</p>
<h5 id="reduceRight"><a href="#reduceRight" class="headerlink" title="reduceRight"></a>reduceRight</h5><p>reduceRight() æ–¹æ³•æ¥æ”¶ä¸€ä¸ªæ–¹æ³•ä½œä¸ºç´¯åŠ å™¨, æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼(ä»å³è‡³å·¦) å¼€å§‹åˆå¹¶, æœ€ç»ˆä¸ºä¸€ä¸ªå€¼. é™¤äº†ä¸reduceæ‰§è¡Œæ–¹å‘ç›¸åå¤–, å…¶ä»–å®Œå…¨ä¸å…¶ä¸€è‡´, è¯·å‚è€ƒä¸Šè¿° reduce æ–¹æ³•ä»‹ç».</p>
<p>å…¶åœ¨ä½ç‰ˆæœ¬IE(6~8) çš„å…¼å®¹å†™æ³•è¯·å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/reduceRight#.E5.85.BC.E5.AE.B9.E6.80.A7.E6.97.A7.E7.8E.AF.E5.A2.83.EF.BC.88Polyfill.EF.BC.89" target="_blank" rel="external">Polyfill</a> .</p>
<h5 id="entries-ES6"><a href="#entries-ES6" class="headerlink" title="entries(ES6)"></a>entries(ES6)</h5><p>entries() æ–¹æ³•åŸºäº<strong>ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ</strong>, è¿”å›ä¸€ä¸ªæ•°ç»„è¿­ä»£å™¨å¯¹è±¡, è¯¥å¯¹è±¡åŒ…å«æ•°ç»„ä¸­æ¯ä¸ªç´¢å¼•çš„é”®å€¼å¯¹.</p>
<p>è¯­æ³•: <em>arr</em>.entries()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>];</div><div class="line"><span class="keyword">var</span> iterator = array.entries();</div><div class="line"><span class="built_in">console</span>.log(iterator.next().value);<span class="comment">//[0, "a"]</span></div><div class="line"><span class="built_in">console</span>.log(iterator.next().value);<span class="comment">//[1, "b"]</span></div><div class="line"><span class="built_in">console</span>.log(iterator.next().value);<span class="comment">//[2, "c"]</span></div><div class="line"><span class="built_in">console</span>.log(iterator.next().value);<span class="comment">//undefined, è¿­ä»£å™¨å¤„äºæ•°ç»„æœ«å°¾æ—¶, å†è¿­ä»£å°±ä¼šè¿”å›undefined</span></div></pre></td></tr></table></figure>
<p>å¾ˆæ˜æ˜¾, entries ä¹Ÿå—ç›Šäºé¸­å¼è¾¨å‹, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;<span class="number">0</span>:<span class="string">"a"</span>, <span class="number">1</span>:<span class="string">"b"</span>, <span class="number">2</span>:<span class="string">"c"</span>, <span class="attr">length</span>:<span class="number">3</span>&#125;;</div><div class="line"><span class="keyword">var</span> iterator = <span class="built_in">Array</span>.prototype.entries.call(o);</div><div class="line"><span class="built_in">console</span>.log(iterator.next().value);<span class="comment">//[0, "a"]</span></div><div class="line"><span class="built_in">console</span>.log(iterator.next().value);<span class="comment">//[1, "b"]</span></div><div class="line"><span class="built_in">console</span>.log(iterator.next().value);<span class="comment">//[2, "c"]</span></div></pre></td></tr></table></figure>
<p>ç”±äºè¯¥æ–¹æ³•åŸºäºES6, å› æ­¤ç›®å‰å¹¶ä¸æ”¯æŒæ‰€æœ‰æµè§ˆå™¨, ä»¥ä¸‹æ˜¯å„æµè§ˆå™¨æ”¯æŒç‰ˆæœ¬:</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Chrome</th>
<th>Firefox (Gecko)</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
</tr>
</thead>
<tbody>
<tr>
<td>Basic support</td>
<td>38</td>
<td><a href="https://developer.mozilla.org/en-US/Firefox/Releases/28" target="_blank" rel="external">28</a> (28)</td>
<td>æœªå®ç°</td>
<td>25</td>
<td>7.1</td>
</tr>
</tbody>
</table>
<h5 id="find-amp-findIndex-ES6"><a href="#find-amp-findIndex-ES6" class="headerlink" title="find&amp;findIndex(ES6)"></a>find&amp;findIndex(ES6)</h5><p>find() æ–¹æ³•åŸºäº<strong>ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ</strong>, è¿”å›æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ (å¦‚æœæœ‰çš„è¯), å¦‚æœæ²¡æœ‰, åˆ™è¿”å›undefined.</p>
<p>findIndex() æ–¹æ³•åˆ™è¿”å›æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ çš„ç´¢å¼•(å¦‚æœæœ‰çš„è¯), å¦åˆ™è¿”å›-1.</p>
<p>è¯­æ³•: <em>arr</em>.find(fn, thisArg), <em>arr</em>.findIndex(fn, thisArg)</p>
<p>æˆ‘ä»¬å‘ç°å®ƒä»¬çš„è¯­æ³•ä¸forEachç­‰ååˆ†ç›¸ä¼¼, å…¶å®ä¸å…‰è¯­æ³•, find(æˆ–findIndex) åœ¨å‚æ•°åŠå…¶ä½¿ç”¨æ³¨æ„äº‹é¡¹ä¸Š, å‡ä¸forEachä¸€è‡´. å› æ­¤æ­¤å¤„å°†ç•¥å» find(æˆ–findIndex) çš„å‚æ•°ä»‹ç». ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸ªæ —å­:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>];</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">value, index, array</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> value%<span class="number">2</span>==<span class="number">0</span>;<span class="comment">//è¿”å›å¶æ•°</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f2</span>(<span class="params">value, index, array</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> value &gt; <span class="number">20</span>;<span class="comment">//è¿”å›å¤§äº20çš„æ•°</span></div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(array.find(f));<span class="comment">//8</span></div><div class="line"><span class="built_in">console</span>.log(array.find(f2));<span class="comment">//undefined</span></div><div class="line"><span class="built_in">console</span>.log(array.findIndex(f));<span class="comment">//4</span></div><div class="line"><span class="built_in">console</span>.log(array.findIndex(f2));<span class="comment">//-1</span></div></pre></td></tr></table></figure>
<p>ç”±äºå…¶é¸­å¼è¾¨å‹å†™æ³•ä¹Ÿä¸forEachæ–¹æ³•ä¸€è‡´, æ•…æ­¤å¤„ç•¥å». </p>
<p>å…¼å®¹æ€§ä¸Šæˆ‘æ²¡æœ‰è¯¦æµ‹, å¯ä»¥çŸ¥é“çš„æ˜¯, æœ€æ–°ç‰ˆçš„Chrome(47), ä»¥åŠFirefoxçš„ç‰ˆæœ¬25å‡å®ç°äº†å®ƒä»¬.</p>
<h5 id="keys-ES6"><a href="#keys-ES6" class="headerlink" title="keys(ES6)"></a>keys(ES6)</h5><p>keys() æ–¹æ³•åŸºäº<strong>ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ</strong>,è¿”å›ä¸€ä¸ªæ•°ç»„ç´¢å¼•çš„è¿­ä»£å™¨. (å®é™…å®ç°å¯èƒ½ä¼šæœ‰è°ƒæ•´)</p>
<p>è¯­æ³•: <em>arr</em>.keys()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"abc"</span>, <span class="string">"xyz"</span>];</div><div class="line"><span class="keyword">var</span> iterator = array.keys();</div><div class="line"><span class="built_in">console</span>.log(iterator.next());<span class="comment">//Object &#123;value: 0, done: false&#125;</span></div><div class="line"><span class="built_in">console</span>.log(iterator.next());<span class="comment">//Object &#123;value: 1, done: false&#125;</span></div><div class="line"><span class="built_in">console</span>.log(iterator.next());<span class="comment">//Object &#123;value: undefined, done: false&#125;</span></div></pre></td></tr></table></figure>
<p>ç´¢å¼•è¿­ä»£å™¨ä¼šåŒ…å«é‚£äº›æ²¡æœ‰å¯¹åº”å…ƒç´ çš„ç´¢å¼•, å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"abc"</span>, , <span class="string">"xyz"</span>];</div><div class="line"><span class="keyword">var</span> sparseKeys = <span class="built_in">Object</span>.keys(arr);</div><div class="line"><span class="keyword">var</span> denseKeys = [...arr.keys()];</div><div class="line"><span class="built_in">console</span>.log(sparseKeys); <span class="comment">// ["0", "2"]</span></div><div class="line"><span class="built_in">console</span>.log(denseKeys);  <span class="comment">// [0, 1, 2]</span></div></pre></td></tr></table></figure>
<p>å…¶é¸­å¼è¾¨å‹å†™æ³•è¯·å‚è€ƒä¸Šè¿° entries æ–¹æ³•.</p>
<p>ç”±äºè¯¥æ–¹æ³•åŸºäºES6, å¹¶æœªå®Œå…¨æ”¯æŒ, ä»¥ä¸‹æ˜¯å„æµè§ˆå™¨æ”¯æŒç‰ˆæœ¬:</p>
<table>
<thead>
<tr>
<th style="text-align:center">Feature</th>
<th style="text-align:center">Chrome</th>
<th style="text-align:center">Firefox (Gecko)</th>
<th style="text-align:center">Internet Explorer</th>
<th style="text-align:center">Opera</th>
<th style="text-align:center">Safari</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Basic support</td>
<td style="text-align:center">38</td>
<td style="text-align:center"><a href="https://developer.mozilla.org/en-US/Firefox/Releases/28" target="_blank" rel="external">28</a> (28)</td>
<td style="text-align:center">æœªå®ç°</td>
<td style="text-align:center">25</td>
<td style="text-align:center">7.1</td>
</tr>
</tbody>
</table>
<h5 id="values-ES6"><a href="#values-ES6" class="headerlink" title="values(ES6)"></a>values(ES6)</h5><p>values() æ–¹æ³•åŸºäº<strong>ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ</strong>, è¿”å›ä¸€ä¸ªæ•°ç»„è¿­ä»£å™¨å¯¹è±¡, è¯¥å¯¹è±¡åŒ…å«æ•°ç»„ä¸­æ¯ä¸ªç´¢å¼•çš„å€¼. å…¶ç”¨æ³•åŸºæœ¬ä¸ä¸Šè¿° entries æ–¹æ³•ä¸€è‡´.</p>
<p>è¯­æ³•: <em>arr</em>.values()</p>
<p>é—æ†¾çš„æ˜¯, ç°åœ¨æ²¡æœ‰æµè§ˆå™¨å®ç°äº†è¯¥æ–¹æ³•, å› æ­¤ä¸‹é¢å°†å°±ç€çœ‹çœ‹å§.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"abc"</span>, <span class="string">"xyz"</span>];</div><div class="line"><span class="keyword">var</span> iterator = array.values();</div><div class="line"><span class="built_in">console</span>.log(iterator.next().value);<span class="comment">//abc</span></div><div class="line"><span class="built_in">console</span>.log(iterator.next().value);<span class="comment">//xyz</span></div></pre></td></tr></table></figure>
<h5 id="Symbol-iterator-ES6"><a href="#Symbol-iterator-ES6" class="headerlink" title="Symbol.iterator(ES6)"></a>Symbol.iterator(ES6)</h5><p>è¯¥æ–¹æ³•åŸºäº<strong>ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ</strong>, åŒ values æ–¹æ³•åŠŸèƒ½ç›¸åŒ.</p>
<p>è¯­æ³•: <em>arr</em>[Symbol.iterator]()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="string">"abc"</span>, <span class="string">"xyz"</span>];</div><div class="line"><span class="keyword">var</span> iterator = array[<span class="built_in">Symbol</span>.iterator]();</div><div class="line"><span class="built_in">console</span>.log(iterator.next().value);<span class="comment">//abc</span></div><div class="line"><span class="built_in">console</span>.log(iterator.next().value);<span class="comment">//xyz</span></div></pre></td></tr></table></figure>
<p>å…¶é¸­å¼è¾¨å‹å†™æ³•è¯·å‚è€ƒä¸Šè¿° entries æ–¹æ³•.</p>
<p>ç”±äºè¯¥æ–¹æ³•åŸºäºES6, å¹¶æœªå®Œå…¨æ”¯æŒ, ä»¥ä¸‹æ˜¯å„æµè§ˆå™¨æ”¯æŒç‰ˆæœ¬:</p>
<table>
<thead>
<tr>
<th style="text-align:center">Feature</th>
<th style="text-align:center">Chrome</th>
<th style="text-align:center">Firefox (Gecko)</th>
<th style="text-align:center">Internet Explorer</th>
<th style="text-align:center">Opera</th>
<th style="text-align:center">Safari</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Basic support</td>
<td style="text-align:center">38</td>
<td style="text-align:center"><a href="https://developer.mozilla.org/en-US/Firefox/Releases/36" target="_blank" rel="external">36</a> (36) <a href="#respond">1</a></td>
<td style="text-align:center">æœªå®ç°</td>
<td style="text-align:center">25</td>
<td style="text-align:center">æœªå®ç°</td>
</tr>
</tbody>
</table>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ä»¥ä¸Š, Array.prototype çš„å„æ–¹æ³• åŸºæœ¬ä»‹ç»å®Œæ¯•, è¿™äº›æ–¹æ³•ä¹‹é—´å­˜åœ¨å¾ˆå¤šå…±æ€§. æ¯”å¦‚:</p>
<ul>
<li>æ‰€æœ‰æ’å…¥å…ƒç´ çš„æ–¹æ³•, æ¯”å¦‚ push, unshift, ä¸€å¾‹è¿”å›æ•°ç»„æ–°çš„é•¿åº¦;</li>
<li>æ‰€æœ‰åˆ é™¤å…ƒç´ çš„æ–¹æ³•, æ¯”å¦‚ pop, shift, splice ä¸€å¾‹è¿”å›åˆ é™¤çš„å…ƒç´ , æˆ–è€…è¿”å›åˆ é™¤çš„å¤šä¸ªå…ƒç´ ç»„æˆçš„æ•°ç»„;</li>
<li><p>éƒ¨åˆ†éå†æ–¹æ³•, æ¯”å¦‚ forEach, every, some, filter, map, find, findIndex, å®ƒä»¬éƒ½æ¥ function(value,index,array){} å’Œ thisArg è¿™æ ·ä¸¤ä¸ªå‚æ•°.</p>
<p>Array.prototype çš„æ‰€æœ‰æ–¹æ³•å‡å…·æœ‰é¸­å¼è¾¨å‹è¿™ç§ç¥å¥‡çš„ç‰¹æ€§. å®ƒä»¬ä¸æ­¢å¯ä»¥ç”¨æ¥å¤„ç†æ•°ç»„å¯¹è±¡, è¿˜å¯ä»¥å¤„ç†ç±»æ•°ç»„å¯¹è±¡. </p>
</li>
</ul>
<p>ä¾‹å¦‚ javascript ä¸­ä¸€ä¸ªçº¯å¤©ç„¶çš„ç±»æ•°ç»„å¯¹è±¡å­—ç¬¦ä¸²(String), åƒjoin æ–¹æ³•å°±å®Œå…¨é€‚ç”¨, å¯æƒœçš„æ˜¯ Array.prototype ä¸­å¾ˆå¤šçš„æ–¹æ³•å‡ä¼šå»è¯•å›¾ä¿®æ”¹å½“å‰å¯¹è±¡çš„ length å±æ€§, æ¯”å¦‚è¯´ pop, push, shift, unshift æ–¹æ³•, æ“ä½œ String å¯¹è±¡æ—¶, å®ƒå°±ä¼šæŠ¥é”™.</p>
<p>è¿˜è®°å¾—ä¹ˆ, Array.prototypeæœ¬èº«å°±æ˜¯ä¸€ä¸ªæ•°ç»„, å¹¶ä¸”å®ƒçš„é•¿åº¦ä¸º0.</p>
<p>åç»­ç« èŠ‚æˆ‘ä»¬å°†ç»§ç»­æ¢ç´¢Arrayçš„ä¸€äº›äº‹æƒ…. æ„Ÿè°¢æ‚¨çš„é˜…è¯»! </p>
<p>åŒæ—¶, ä»¥ä¸‹è¯é¢˜å°†ä¼šé€æ­¥å»æ¢è®¨, æ•¬è¯·å…³æ³¨:</p>
<ul>
<li><code>unicodeç¼–ç è¡¨</code></li>
</ul>
<ul>
<li><code>å¿«é€Ÿæ’åº</code></li>
</ul>
<ul>
<li><code>æ’å…¥æ’åº</code></li>
</ul>
<hr>
<p>æœ¬é—®å°±è®¨è®ºè¿™ä¹ˆå¤šå†…å®¹,å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å¥½çš„æƒ³æ³•æ¬¢è¿åœ¨ä¸‹æ–¹å‚ä¸<a href="#respond">ç•™è¨€å’Œè¯„è®º</a>.</p>
<p>æœ¬æ–‡ä½œè€…: <a href="https://github.com/Louiszhai" target="_blank" rel="external">louis</a></p>
<p>æœ¬æ–‡é“¾æ¥: <a href="http://louiszhai.github.io/2015/12/29/array/">http://louiszhai.github.io/2015/12/29/array/</a></p>
<p>å‚è€ƒæ–‡ç« </p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/prototype" target="_blank" rel="external">Array.prototype - JavaScript | MDN</a></li>
<li><a href="http://www.tuicool.com/articles/YjUBNbN" target="_blank" rel="external">Chromeè°·æ­Œæµè§ˆå™¨ä¸­jsä»£ç Array.sortæ’åºçš„bugä¹±åºè§£å†³åŠæ³• - yzeng - æ¨é…·</a></li>
<li><a href="http://www.w3help.org/zh-cn/causes/SJ9013" target="_blank" rel="external">SJ9013: Array.prototype.sortå½“ä½¿ç”¨äº† comparefn åè¿”å›å€¼ä¸ä¸º -1ã€0ã€1æ—¶ï¼Œå„å¼•æ“å®ç°æ’åºç»“æœä¸ä¸€è‡´ - W3Help</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      JavaScript Array isArray map filter forEach every some push shift unshift sort indexOf
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://louiszhai.github.io/tags/JavaScript/"/>
    
  </entry>
  
</feed>
